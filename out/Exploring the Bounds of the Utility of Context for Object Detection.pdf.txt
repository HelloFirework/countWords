Exploring the Bounds of the Utility of Context for Object Detection

Ehud Barnea and Ohad Ben-Shahar

Dept. of Computer Science, Ben-Gurion University

Beer-Sheva, Israel

{barneaeh, ben-shahar}@cs.bgu.ac.il

Abstract

The recurring context in which objects appear holds
valuable information that can be employed to predict their
existence. This intuitive observation indeed led many re-
searchers to endow appearance-based detectors with ex-
plicit reasoning about context. The underlying thesis sug-
gests that stronger contextual relations would facilitate
greater improvements in detection capacity.
In practice,
however, the observed improvement in many cases is mod-
est at best, and often only marginal. In this work we seek
to improve our understanding of this phenomenon, in part
by pursuing an opposite approach. Instead of attempting to
improve detection scores by employing context, we treat the
utility of context as an optimization problem: to what ex-
tent can detection scores be improved by considering con-
text or any other kind of additional information? With this
approach we explore the bounds on improvement by using
contextual relations between objects and provide a tool for
identifying the most helpful ones. We show that simple co-
occurrence relations can often provide large gains, while in
other cases a signiﬁcant improvement is simply impossible
or impractical with either co-occurrence or more precise
spatial relations. To better understand these results we then
analyze the ability of context to handle different types of
false detections, revealing that tested contextual informa-
tion cannot ameliorate localization errors, severely limiting
its gains. These and additional insights further our under-
standing on where and why utilization of context for object
detection succeeds and fails.

1. Introduction

Historically, object detection has been performed by
“sliding” a window over an image and deciding whether it
contains an object by reasoning about its appearance inside
the window [12, 7]. Naturally, this type of calculation only
takes the object’s local context into account, as more dis-
tant context falls outside of the window. Contemporary de-
tectors based on convolutional neural networks are able to

expand their reasoning beyond local context since the recep-
tive ﬁeld of neurons grows with depth, eventually covering
the entire image. However, the extent to which such a net-
work is able to incorporate context is still not entirely under-
stood [23]. To improve both types of detectors, many works
have sought to explicitly combine their results with contex-
tual reasoning to strengthen detections that appear in favor-
able context and to weaken detections that do not (among
others, see [9, 2, 20, 16, 25, 32, 31, 6, 24, 8, 30, 26, 18, 1]).

These approaches have shown signiﬁcant gains in some
cases [24], but in many others the explicit application of
contextual information has shown negligible improvement
(or even diminished results) [35, 33]. This problem was
ﬁrst discussed by Wolf and Bileschi [32], showing that con-
text learned from low-level features can be used instead of
an appearance-based detector, but provides little aid when
combined with an appearance based detector. Attempting to
explain this behavior, they observed that only few samples
were highly conﬁdent while being out of context. How-
ever, we are still left with no insights as to when context
can be expected to improve and whether the lack of im-
provement observed in many cases should be attributed to
(1) the limited capacity of extracting contextual informa-
tion, (2) the contextual relations employed, (3) the difﬁculty
of combining it with appearance-based conﬁdence, or per-
haps, (4) that contextual information is simply redundant
once appearance information has been accounted for.

To investigate this matter we suggest a novel approach
to compute an upper bound on the improvement that can
be obtained by combining detections’ base conﬁdence with
different contextual relations or any other kind of additional
information. In this formulation a detection’s context can
be represented as a real number that indicates, for example,
the extent to which the context supports the existence of an
object. Alternatively, it may be binary, separating detec-
tions into those for which a contextual relation holds and
those for which it does not (e.g., the relation “is next to
a person” separates detections into two groups). Apply-
ing this method we are able to identify the contextual re-
lations that have the largest improvement bounds, and so a

17412

(a)

(b)

(c)

(d)

Figure 1. Ranking detections for the evaluation of detection results (darker colors represent higher ratios #T P
#F P of true to false detections
in each bin). To evaluate detections by average precision (AP), the conﬁdence space is ﬁrst discretized into bins with equal number of
true detections (a), which are then sorted by decreasing conﬁdence (b) for the calculation of precision at different recall levels. When also
employing context, the space of conﬁdence and context is similarly discretized into bins with equal number of true detections (c), and a
criterion for their ranking is required. We show that the non-parametric function over this space that ranks bins according to their ratio of
true to false detections, as shown in (d), provides the maximal AP.

greater potential for improving detection results. Similarly,
we identify object categories for which no relevant contex-
tual relation provides a large improvement bound. For these
categories the context is meaningless even if it is extracted
accurately and perfectly combined with the conﬁdence pro-
vided by the base detector.

To better understand why employing some relations fails
to improve, we show which types of false detections can be
corrected by use of context. Speciﬁcally, we analyze the
ability of contextual relations to distinguish between true
detections and different types of false detections (i.e. local-
ization errors, confusion between categories, and confusion
with the background [17]). This analysis reveals that while
context in the form of object relations can identify confu-
sions with the background and between categories, it can-
not distinguish between true detections and localization er-
rors in most cases, often rendering it useless. This inability
to handle localization errors means that strengthening de-
tections in favorable context also strengthens localization
errors, an observation that may explain why context some-
times hurts detection results.

Taken together, the aspects studied in our paper tell a
story of detection with context. In a few cases the context
can provide very signiﬁcant improvements, in most other
cases it can provide meaningful improvements if used cor-
rectly, while in some cases the context is simply not infor-
mative (cannot differentiate true and false detections of any
type). In all cases, when more accurate localization is re-
quired the beneﬁts of employing context are reduced. The
goal of this analysis paper is to further our understanding
regarding the role of context and provide a tool for identi-
fying the most promising contextual relations, the maximal
improvement they can be expected to provide, and the ob-
ject categories that will be affected the most/least (if at all).

2. Background and Survey of Detection with

Context

Various contextual relations have been employed for ob-
ject detection, ranging from local context just outside a de-
tection’s window [13], to more global information such as
object co-occurrence [14] or spatial relations between ob-
jects [25] or surfaces [18]. Different models have been sug-
gested for combining such context with appearance-based
scores, employing probabilistic models [14], discrimina-
tive classiﬁers [6], and lately also recurrent neural networks
(RNNs) [2] and neural attention models [20]. Since this
work focuses on model results rather than methodology, we
refer the readers to Mottaghi et al. [24].

Despite the repeated attempts, dissatisfaction with pre-
sented results was expressed in various cases. Yao and Fei-
Fei [33] suggested that “most of the context information has
contributed relatively little to boost performances in recog-
nition tasks” and suggested the lack of strong context as a
reason (thus choosing to work on a different problem that
relies critically on context). Choi et al. [4] claimed that the
PASCAL dataset [11] is not suitable to test context-based
object recognition algorithms as most of its images contain
only a single object class. However, when the more elab-
orate SUN 09 dataset [4] was employed, the improvement
after including context was similar in both cases (a 1.05 in-
crease in AP over PASCAL and 1.31 over SUN09).

In a study of context selection, Yu et al. [35] noted that
“the performance gain from context itself has not been sig-
niﬁcant” in previous works. Yu showed that contextual rela-
tions can predict object locations and that some relations are
more predictive than others. However, these observations
do not attest to the utility of context when combined with a
reasonably good detector, which was shown to be negligible
due to a shortage of conﬁdent false detections that were out
of context [32].

7413

To better understand the state of context models we stud-
ied the results presented in 12 papers [5, 2, 20, 4, 35, 9, 3,
16, 24, 6, 8, 34] over different detection datasets (PASCAL
VOC [11], SUN 09 [4], SUN RGB-D [29], and MSRC-21
[28]). We collected results from papers in which the base
detector’s AP (APbase) and the AP after including context
outside a detection window (APcontext) were reported sep-
arately for each category and presented without additional
algorithmic improvements that were not related to context.
We then calculated all improvements due to the considera-
tion of context by taking the difference APcontext−APbase.
These improvements (and occasional setbacks) are summa-
rized below while the results of each individual method are
provided in the supplementary material.

Examining the different methods, most papers display a
pattern similar to the method of Choi et al. [4] over PAS-
CAL (Fig. 2 blue). In particular, some object categories
exhibit a marked improvement, some show only marginal
improvement (which is deﬁned in this work as an increase
of less than 2 AP units 1), and others suffer from reduced de-
tection results. Fig. 2 shows that applying the same method
to the SUN 09 dataset (that contains more objects and so
intuitively has more contextual information [4]) results in a
similar pattern of results (orange curve), albeit with greater
variance (i.e., larger improvements but also greater dimin-
ished results). That being said, selected works have shown
a different pattern of results with a marked improvement in
most object categories [6, 24, 16], or even in all or them
(green curve) [3].

To show the utility of context per object category, we
summarize the improvement of different algorithms over
PASCAL 2007-2010 in Fig. 3. As shown, while substantial
improvements were obtained for most methods on a few ob-
ject categories (bottle, horse, plane, train, and cat), for most
categories the majority of methods obtained an improve-
ment of less than 2 AP units. However, for each category
there exists a method that achieves a signiﬁcant increase in
detection results. Thus, while a substantial improvement is
possible regardless of category, obtaining such general be-
havior by applying a single method is rather challenging.

3. Bounding the Utility of Context

In this section we present a method for ﬁnding the
best non-parametric function that combines the conﬁdence
scores of appearance based detectors and additional infor-
mation (in this case: context) so as to maximize AP . We
assume that we are given a set of detections {x1, ..., xn},
where each detection xi = (confi , labeli, loci, ctxi) is de-

Detection improvement with context

Choi et al. (PASCAL 2007)
Choi et al. (SUN 09)
Chen et al. (PASCAL 2007)

12

10

8

6

4

2

0

−2

−4

)
P
A
(
 
n
o
i
s
i
c
e
r
p
 
e
g
a
r
e
v
a
 
n
i
 
e
g
n
a
h
C

d
e
v
o
r
p
m

s
t
l
u
s
e
R

 

I

d
e
h
s
i
n
m
D

i

i

s
t
l
u
s
e
R

 

Object categories

Figure 2. Improvement (or change) in detection results per cate-
gory following the incorporation of context. For each method the
change in average precision per object category is reported (where
categories are sorted within method and thus may be ordered dif-
ferently along the X axis in each method or dataset). Most methods
follow the pattern of Choi et al. [4], in which the change is some-
times positive and substantial (above the red line), or positive but
less substantial (below the red line), and it can also be negative.

Summary of improvement by different models

)
P
A
(
 
n
o
i
s
i
c
e
r
p
 
e
g
a
r
e
v
a
 
n
i
 
e
g
n
a
h
C

8

6

4

2

0

−2

−4

d
e
v
o
r
p
m

s
t
l
u
s
e
R

 

I

d
e
h
s
i
n
m
D

i

i

s
t
l
u
s
e
R

 

Bottle

Horse

Plane

TrainCat

Table
Sheep
Bike
Cow

Bird Car

PlantTv
Dog
Chair
Person

Boat

Sofa

Bus
Cycle

Figure 3. Box plot of the improvement (or change) in detection
results measured by average precision following the incorporation
of context by different methods over the PASCAL dataset. Orange
bars inside the boxes represent the median of methods’ context-
related change per category. Box top and bottom edges, as well
as the ends of extending lines, all represent different quartiles. As
can be seen (see also supplementary materials), only few object
categories are signiﬁcantly improved by most methods (i.e., more
than 2 AP units, or above the red line).

1Of course, there is no clear amount of improvement that is considered
substantial. We believe that a 2 AP threshold would seem reasonable to
many in the community and yet stress that it is indeed subjective and that
none of the conclusions presented in this paper hinge on a hard distinction
between results above and below this threshold.

ﬁned by its location loci, object class label labeli, base-
conﬁdence confi assigned by a base detector, and a value
ctxi that represents the detection’s context. ctxi can be a
boolean value, indicating whether some binary contextual

7414

relation holds for xi, e.g., it can indicate whether there is a
person to the left of detection xi. Alternatively, it can be a
real value indicating the extent that the context of xi sup-
ports its label assignment labeli. Formally, ctxi can rep-
resent any kind of additional information about xi that we
may wish to employ in order to improve detection results.

We formulate the problem as context-based re-scoring of
detections similar to most previous models [9, 6, 1, 35] and
deﬁne a context model as a function g that calculates a new
score conf ′

i for each detection xi:

conf ′

i = g(confi , ctxi) .

(1)

We begin by describing the calculation of AP based on con-
ﬁdence bins (depicted in Fig. 1a,b) and the non-parametric
function g that maximizes it given detections and their con-
text, exempliﬁed in Fig. 1c,d. At ﬁrst, ctxi is assumed to
be real valued and for which not many detections share the
same output, as can generally be expected from standard
parametric functions on image data. Later, we handle the
general case in which many detections can be assigned with
the exact same values ctxi. This allow us to experiment
with binary contextual relations based on ground-truth in-
formation, but as we show, the same deﬁnition of g does not
formally maximize AP but can be considered as a heuristic.
Following this, we experiment with different co-occurrence
and spatial contextual relations and state of the art detec-
tors, showing the largest possible improvement in AP by
employing each relation, and then provide evidence that
the suggested heuristic accurately approximates the maxi-
mal AP in the general case.

3.1. Bin based representation of AP

For a given object category, the performance of a de-
tector is commonly evaluated using the average precision
(AP) metric calculated for the detector’s ranked output de-
tections. The AP metric summarizes the shape of the preci-
sion/recall curve, depicting the detector’s precision at each
level of recall. Speciﬁcally, precision is deﬁned as the frac-
tion of all detections above a given rank which are from the
positive class, and recall is deﬁned as the fraction of posi-
tive detections that are ranked above that rank. While the
AP represents an average of precision values, slightly dif-
ferent methods have been used for its calculation [10]. In
PASCAL VOC 2007, it was deﬁned as the mean precision
at a set of eleven equally spaced recall levels [0, 0.1,..., 1]:

AP =

1
11

11

X

i=1

pi ,

(2)

with interpolation of precision values pi. We note that while
AP is in the range [0, 1], in this text we report AP percentage
values between [0, 100] for clarity.

The calculation of AP is based on a ranking of detections
according to their conﬁdence, where detections are ranked
higher when the detector is more conﬁdent. In practice, de-
tections are ranked by sorting them according to decreasing
conﬁdence. Iterating over the sorted detections from start
to end, the recall at each rank gradually increases by
P OS
with every true detection encountered, where P OS is the
number of positive examples or objects. Thus, an example
recall value of 1
10 corresponds to some conﬁdence such that
the number of more conﬁdent detections is a tenth of P OS,
or P OS
m true
detections, a recall of 2
m true detec-
tions, and so on. Therefore, considering m equally spaced
m ], each level corresponds to P OS
recall levels [ 1
true detections in addition to the previous level.

10 . Similarly, a recall of 1

m corresponds to 2 P OS

m corresponds to P OS

m , ..., m

m , 2

m

1

We follow a procedure similar to PASCAL 2007 without
interpolation, and deﬁne the AP as the mean precision at a
set of m recall levels [ 1

m , 2

m , ..., m

m ]:

AP =

1
m

m

X

i=1

pi .

(3)

These m increasing recall levels correspond to m decreas-
ing conﬁdence values c1, ..., cm that discretize the practical
conﬁdence range [cm, ∞), into m conﬁdence bins. Each
conﬁdence bin contains an equal number of true detections
t = P OS
m . We note that the conﬁdence values are not neces-
sarily equally spaced, and pi = 0 is set for recall levels that
cannot be obtained due to missed objects. This discretiza-
tion is depicted in Fig. 1a and the corresponding recalls
in Fig. 1b. Let us denote by ti, fi the number of true and
false detections in bin i. The AP can now be similarly rep-
resented according to the conﬁdence bins:

AP =

1
m

m

X

i=1

j=1 tj

Pi
j=1(tj + fj)

Pi

,

(4)

and since bins have equal values of ti = t:

AP =

1
m

m

X

i=1

it
it + Pi

j=1 fj

.

(5)

3.2. Real valued representation of context

A non-parametric function g : R2 → R deﬁned over de-
tections’ conﬁdence and context (as in Eq. 1) discretizes its
input domain into 2D bins and assigns new conﬁdence val-
ues to detections according to the input bin in which they
fall. The deﬁnition of a non-parametric function requires
to deﬁne this discretization, i.e., the bounding values of its
bins. Since the calculation of AP discretizes the conﬁdence
space into m bins, we similarly discretize the range of con-
text values into m bins of equal number of true detections
P OS
m . This way, the bins of g coincide with those of AP .

7415

To do so, we ﬁrst discretize the conﬁdence axis into m1 bins
with P OS
positives, and then similarly discretize the con-
m1
text axis for each conﬁdence bin into m2 bins, each with
P OS
positives. The total number of bins in this case is
m1m2
m = m1m2. The result of this process is exempliﬁed in
Fig. 1c.

Following this discretization, the deﬁnition of g requires
to assign a new conﬁdence value to each bin (or rather,
to detections inside it). The calculation of AP for the re-
sults of g begins with the ranking of detections according
to this new conﬁdence. Because of this, what is important
are not the exact values assigned by g, but rather the rank-
ing they induce, or more speciﬁcally, the ranking of g’s m
bins. Thus, the question is which bin ranking provides the
maximal AP and how to ﬁnd it.

The bins in Eq. 5 are ordered by increasing recall. As
can be seen, bins ordered by increasing number of false de-
tections fi maximize AP since the divisors of some sum-
mands will become larger by switching fi terms with larger
fj terms, thus decreasing AP. Therefore, we deﬁne the new
conﬁdence assigned to detections in bin i to be ti
, as shown
fi
in Fig. 1c,d. Since ti is equal for each i, the conﬁdence de-
creases when the number of false detections increases, pro-
viding the ranking that maximizes AP.

It is important to note that the presented method maxi-
mizes AP for a given discretization. More complicated bin-
ning schemes for g may also have an equal number of true
detections while providing a larger AP , but in this work we
chose to consider a more standard discretization scheme.
Finally, we note that the parameters m1, m2 that form m
are predetermined according to the wanted number of recall
bins in the calculation of AP. Choosing m = 11 corresponds
to a calculation similar to PASCAL 2007 that employs 11
recall bins, and the maximal m corresponds to newer PAS-
CAL versions that use a recall bin for each true detection
(m = P OS).

3.3. General representation of context

In cases when the context value of several true detections
is the same they may not be possible to divide with a thresh-
old. A discretization into bins with equal number of true
detections cannot be ensured in such cases, as well as an
accurate calculation of AP. In practice, when only few true
detections are inseparable the results may not be highly af-
fected, but this may become problematic when many such
true detections exist. While such a result is probably un-
likely with the real-valued context functions often used in
previous works and in Sec. 3.2, it indeed occurs when us-
ing binary contextual relations as we use for experiments in
Section 3.4.

In this section we handle the general case of non-
parametric functions g under arbitrary discretization,
in
which the number of true detections in each bin may vary.

The formulation of AP in Eq. 4 and Eq. 5 can be seen
as an approximation of the area under the precision/recall
curve as a Riemann sum with rectangles of heights pi and
equal width 1
m . As a generalization, we consider an approx-
imation based on a Riemann sum with rectangles of heights
pi and different widths ∆ri. For recall levels [r1, ..., rm]
that are not necessarily equally spaced, we deﬁne ∆ri =
(ri − ri−1) with ∆r1 = r1 and represent AP as:

AP =

m

X

i=1

pi∆ri .

(6)

The new conﬁdence of ti
fi

suggested in Sec. 3.2 does
not generally maximize this AP. For example, we consider
a function with three bins such that t1 = 277, t2 = 371,
t3 = 69, and f1 = 16, f2 = 955, f3 = 178, when the num-
ber of all positives is P OS = t1 + t2 + t3. The assigned
conﬁdence values in this case are 17.3, 0.3884, 0.3876, re-
spectively, and the ranking this induces provides an AP of
60.9. However, switching the conﬁdence values of the sec-
ond and third bins provides a ranking with a larger AP of
62.6. Therefore, in the general case we consider this new
conﬁdence as a heuristic for the maximization of AP. While
a maximal AP is not always achieved, we show in Section
3.4 that it likely provides an accurate approximation of AP.

3.4. Exploring the relations between objects

Using this framework, we can now examine the upper
bound of AP for different co-occurrence and spatial contex-
tual relations where a single relation is considered in each
experiment. We then explore the relations that provide the
highest and lowest AP upper bounds per object category and
present various insights.

Speciﬁcally, we experiment with co-occurrence relations
(e.g. ctxi indicates for detection xi whether a mouse exists
in the image without overlapping xi), spatial relations (e.g.
ctxi indicates whether a mouse exists in a speciﬁc image
location relative to xi), random context (ctxi is random bi-
nary number), or no context (ctxi = 0 for any i). Spatial
relations are calculated in a manner invariant to object size
and image location by examining the center point of each
object in a reference frame centered on xi with bins whose
size is determined as a factor of the height of xi (see Fig.
4). Since different combinations of these relations may be
more meaningful, for each object category we also experi-
ment with and/or pairs of the 50 most improving relations.
More speciﬁcally, for binary relations rel1 and rel2 we in-
clude binary relations rel1 ∧ rel2 and rel1 ∨ rel2.

We test the described contextual relations using detec-
tion results provided by the Faster R-CNN detector [27, 19]
over the COCO [21] validation set containing 80 object cat-
egories. Detections are considered correct/true if they over-
lap a ground-truth object with an intersection over union

7416

stead of 0.5), this ratio goes down to 45%. Therefore, sig-
niﬁcant improvements can be gained simply by recognizing
and employing the existence of other objects in the image,
but unfortunately, this kind of information becomes less rel-
evant when the number of localization errors increases.

Aggregated results are presented in Fig. 5, providing
more general insights into the use of context. The blue
curve presents the maximal obtainable improvement per ob-
ject category. As can be seen, the largest improvement for
most categories is above the red line that marks an improve-
ment of at least 2 AP units, but please remember that the
calculated bounds are based on the best function g and the
context was assumed to be known. Therefore, for many ob-
ject categories the maximal improvement that could be ob-
tained in real conditions is expected to be lower or maybe
even marginal at best.

Due to the reliance on ground-truth information this
method will always yield an improvement and may unjus-
tiﬁably increase its measured amount. We therefore test
the noise in this method by examining the improvement ob-
tained by employing random context. More speciﬁcally, we
show the average improvement of 10 trials with randomly
generated binary context (black curve). As can be seen, the
black curve is signiﬁcantly lower than the blue curve, indi-
cating that the present noise does not have a large effect.

We perform an additional experiment as in the blue curve
in Fig. 5 but this time with a stricter localization criteria of
0.75 IoU. The results can be seen in the green curve that
is now signiﬁcantly lower than the blue and quite similar
to the black curve based on random context. The best ob-
tainable improvement dropped dramatically in most cases,
suggesting that object relations are not suitable when more
accurate localization is required. In Sec. 4 we show that
context is simply unable of handling localization errors, ex-
plaining this drop.

In addition to COCO and Faster-RCNN, we repeat the
same experiment with the SSD detector [22] over the KITTI
dataset [15] containing road scenes for autonomous driving.
The largest improvements for cars, pedestrians, and cyclists
are 0.7, 1.8, and 1.6 AP units, respectively. With localiza-
tion criteria of 0.75 IoU the improvements reduce to 0.7, 1,
and 1.2 AP units. Object relations are much less signiﬁcant
in this case, and still a similar drop is observed with stricter
localization. A drop was not observed for cars, but that may
be due to the already large number of strong localization er-
rors (83% of the errors at recall lower than 0.1 are due to
localization).

Finally, to test the ability of the heuristic suggested in
Section 3.3 to maximize AP we attempt to reach a better AP
by examining all bin orders. For each object category we re-
visit the relation that provided the highest AP upper bound
and re-calculate the AP for any permutation of the bins. To
allow such a costly procedure, we discretize the conﬁdence

7417

Figure 4. The spatial context of a detection (in green) is deter-
mined relative to its location and height. In this case, the value of
the contextual relation “bin [0,3] has mouse” is true, where [0,0]
represents the central bin.

(IoU) of more than 0.5. Toasters and hair dryers are ig-
nored due to their very few appearances. We assume that
the context of each detection is known, and of course, in a
real-world setting the obtained AP will be lower than the
calculated bound since the context will not be perfectly ex-
tracted. As a discretization scheme for function g, the base
conﬁdence values are split into 10 bins and the context val-
ues, that are all binary, are naturally split into 2 bins.

For each object category and contextual relation we ﬁnd
the AP upper bound and deﬁne the best relation as the one
with the largest upper bound. The maximal obtainable im-
provement is then deﬁned as the difference between the best
relation’s AP upper bound and the upper bound without
context (ctxi = 0). We generate a detailed report contain-
ing the best contextual relation per object category as well
as the best relation’s amount of improvement. In the inter-
est of space, we present notable examples and then show
data in aggregate form. The entire report is provided in the
supplementary material.

Two examples from the categories with highest obtain-
able improvement are hot-dog and suitcase, with improve-
ments of 4.7 and 5.5 AP units respectively, while two of
those with the least possible improvement are zebra and cat,
with improvements of 1.5 and 1.6 AP units respectively.
The best relations for these categories were “image has a
person and another hot dog” for hot dog, “image has an-
other suitcase” for suitcase, “bin [0, -1] (left) has a zebra
or bin [0, 2] (right) has a zebra” for zebra, and “image has
a bowl or another cat” for cat. Note that a detection’s cen-
ter deﬁnes bin [0,0] as shown in Fig. 4. Interestingly, for
70% of the categories the best relation consist of only co-
occurrence information (without bin locations), and when
employing a stricter localization criteria of 0.75 IoU (in-

Maximal improvement with context

Best context
Best context (Overlap>0.75)
Random context

)
P
A
(
 
n
o
i
s
i
c
e
r
p
 
e
g
a
r
e
v
a
 
n
i
 
e
g
n
a
h
C

5

4

3

2

1

Object categories

Figure 5. The maximal AP improvement that can be obtained per
object category with any type of context (blue and green), and
with random binary context (black). X axis categories are sorted
according to the blue curve, the blue and black curves are based
on an overlap criteria of 0.5 IoU while the green curve represents
a stricter case requiring 0.75 IoU.

into 5 bins instead of 10 and the context is still discretized
into 2 since the tested context is binary. This requires to ex-
amine 10! bin combinations. Examining the largest AP up-
per bound found for each of the 78 object categories in the
COCO dataset reveals that the AP based on our suggested
heuristic is indeed maximal for most categories apart from
several cases in which it provided a bound that is lower than
the maximal by a negligible amount of at most 0.17 (where
the AP is reported here between the range of 0 and 100).
This result raises our conﬁdence that the ranking of input
bins according to the ratio of true to false detections well
approximates the maximal AP.

4. Analysis of Classiﬁcation Capacity

When given the results of a detector it is reasonable to
wonder what exactly is required of context to improve them.
Considering the role of context as strengthening true detec-
tions and weakening false detections may be generally cor-
rect, but this alone is uninformative. The method described
above enables to analyze the gains that can be expected us-
ing different contextual relations, but it does little to explain
why context may be helpful in some cases and unhelpful
in others. In this section we view the role of context as a
means of distinguishing between true and false detections
with similar base conﬁdence. We then follow with an intu-
itive experiment to show just that by measuring the capacity
of context to classify strong true and false detection.

The immediate effect of context on a set of detections be-
comes apparent when comparing Fig. 1a and Fig. 1c. In the

former, detections of similar base conﬁdence are grouped
into bins, and the distribution of true and false detections
inside the bins determine the AP. In the latter, an additional
context dimension is introduced, further separating detec-
tions that were previously inseparable and allowing new
conﬁdence values to be assigned. All things considered,
the role of context is thus to further separate detections with
similar base conﬁdence.

For a more intuitive understanding of why context helps,
we analyze the capacity of context to classify a set of strong
detections that consists of the same number of true and false
detections. Guided by the discouraging decrease in im-
provement for larger overlap thresholds (Fig. 5), we con-
sider different types of false detections. We follow the anal-
ysis of detection errors by Hoiem et al. [17] and deﬁne
three error types – localization errors, confusion with other
classes, and confusion with the background. Localization
errors are deﬁned as detections with a label that matches
the most overlapping ground-truth object with IoU overlap
larger than 0.1. Confusions with other classes are detec-
tions for which the most overlapping ground-truth object
overlaps by more than 0.1 but has a different label. Finally,
confusions with background are false detections for which
no ground-truth object overlaps by more than 0.1.

To test the classiﬁcation capacity of a contextual relation
for some object category, we collect the n most conﬁdent
true detections and n most conﬁdent false detections of one
of the error types described above. The number n is de-
ﬁned as the minimum between the available number of true
and false detections (of the given error type). A binary rela-
tion separates the 2n detections into two groups containing
a different number of true and false detections. Treating
the context as a classiﬁer, we label each detection as true
if its group contains mostly true detections and false other-
wise. To measure the wellness of classiﬁcation we employ
the accuracy of assigned labels and note that the minimal
obtainable accuracy is 0.5 due to our use of ground-truth
information in this analysis.

We employ the contextual relations described in Sec. 3.4
on Faster R-CNN over COCO. For each object category we
report the maximal accuracy obtained by any of the rela-
tions (see Fig. 6). As can be seen, co-occurrence and spatial
context is better at classifying, i.e. distinguishing between
true and false detections, when errors are only due to confu-
sion with other categories than when errors are only due to
confusion with the background. While it has some capac-
ity to distinguish between true detections and localization
errors, it is signiﬁcantly lower and not much above the 0.5
threshold in most cases. This is likely to be the underlying
cause for the signiﬁcant drop in context-based improvement
when increasing the localization threshold to an IoU of 0.75,
as shown by the green curve in Fig. 5. It also affects the im-
provement at the standard IoU of 0.5 (as shown by the blue

7418

y
c
a
r
u
c
c
a
 
n
o
i
t
a
r
a
p
e
S

1.0

0.9

0.8

0.7

0.6

0.5

Capacity of classifying true and false detections
Confusion with background
Confusion with other categories
Localization errors

Object categories

Figure 6. The maximal classiﬁcation capacity of context per object
category. The context is used to classify detections as true or false,
when only errors due to confusion with the background are em-
ployed as false detections (blue), when only confusions with other
object categories are employed (orange), and when only localiza-
tion errors are employed (green). X axis categories have the same
order as in Fig. 5.

curve), or it might be the reason why context often hurts de-
tection results (since strengthening true detections similarly
affects localization errors).

A similar trend is observed when repeating the experi-
ment with the SSD detector over the KITTI dataset that con-
tains cars, pedestrians, and cyclists. For these three classes
respectively, the maximal classiﬁcation accuracy is 65%,
61%, 64% for confusions with the background, it is 75%,
67%, 58% for confusions with other categories, and 57%,
55%, 54% for localization errors.

5. Discussion

Despite the large body of work done on the inclusion of
context for object detection it still remains somewhat mis-
understood. Our survey of results in Sec. 2 clariﬁes the
current state of research on the topic, showing that in many
cases context does improve results and in many other cases
the improvement is only marginal or even harmful. The
theoretical analysis and empirical experiments in Sections
3.4 and 4 point to localization errors as one aspect that ex-
plains the low utility of context observed in many cases.
This severely limits applications that require accurate local-
ization. However, there may also be other applications for
which accurate localization is not important, and reporting
results that are based on an IoU of 0.5 or more may un-
expectedly make the context appear non worthwhile. Of
course, in some cases the ability of context to classify de-
tections as true or false is rather low regardless or error type
(Fig. 6), implying that for such object categories the tested

context is simply not informative.

In addition to the reported AP, the inability to treat true
detections and localization errors differently may have fur-
ther discouraging properties. As context models are gen-
erally deﬁned to increase the conﬁdence of detections in
favorable context, the same applies to localization errors.
This problem, together with the issue that models are usu-
ally trained on different loss functions than AP, may be the
reason for the large decrease in detection results that is of-
ten observed. For the same reason, it may be possible that
the parameters learned by context models would provide a
weaker context so as to avoid strengthening localization er-
rors. In such cases, for applications that do not require ac-
curate localization it may be preferable to train with a lower
IoU (instead of just evaluating results with a lower IoU).

Another important point is the types of context em-
ployed. The experiments in this work focused on rela-
tions between objects via co-occurrence and spatial rela-
tions. However, there may be other kinds of additional in-
formation that could help when object relations cannot. For
example, it is likely that the aspect ratio of a detection’s
bounding box or additional segmentation of its pixels may
help correct localization errors [9]. These approaches too
can be examined using the suggested analysis method but
are outside the scope of this work.

6. Conclusions

Seeking to shed light on the use of context for object de-
tection we have suggested a method for ﬁnding the function
that combines contextual relations with standard detection
results so as to maximize the detection score. Using this
method we are able to show which relations are not infor-
mative, and to point to those that are more worthwhile to
pursue and to the object categories that beneﬁt the most.
Further experiments highlight that a reason for the often
discouraging results of employing context is its inability to
handle localization errors, thus limiting the possibilities for
improvement when conﬁdent localization errors are abun-
dant. As a general guideline, the context can provide a sig-
niﬁcant improvement depending on the type of errors and
when it is different for true and false detections with similar
base conﬁdence. Finally, we invite researchers to employ
the tools developed here to analyze the improvement they
can expect by incorporating context, and the contextual re-
lations that provide it, in order to improve detection results.

Acknowledgments

This research was supported in part by Israel Ministry
of Science, Technology and Space (MOST Grant 54178).
We also thank the Frankel Fund and Cyber Security Re-
search Center, both at Ben-Gurion University of the Negev,
for their generous support.

7419

References

[1] N. Arbel, T. Avraham, and M. Lindenbaum.

Inner-scene
similarities as a contextual cue for object detection. arXiv
preprint, 2017. 1, 4

[2] S. Bell, C. Lawrence Zitnick, K. Bala, and R. Girshick.
Inside-outside net: Detecting objects in context with skip
pooling and recurrent neural networks.
In CVPR, pages
2874–2883, 2016. 1, 2, 3

[3] G. Chen, Y. Ding, J. Xiao, and T. X. Han. Detection evo-
lution with multi-order contextual co-occurrence. In CVPR,
pages 1798–1805, 2013. 3

[4] M. J. Choi, J. J. Lim, A. Torralba, and A. S. Willsky. Ex-
ploiting hierarchical context on a large database of object
categories. In CVPR, pages 129–136. IEEE, 2010. 2, 3

[5] W. Chu and D. Cai. Deep feature based contextual model for
object detection. arXiv preprint arXiv:1604.04048, 2016. 3
[6] R. G. Cinbis and S. Sclaroff. Contextual object detec-
tion using set-based classiﬁcation. In ECCV, pages 43–57.
Springer, 2012. 1, 2, 3, 4

[7] N. Dalal and B. Triggs. Histograms of oriented gradients for

human detection. In CVPR, pages 886–893, 2005. 1

[8] C. Desai, D. Ramanan, and C. C. Fowlkes. Discriminative
models for multi-class object layout. Int. J. Comput. Vision,
95(1):1–12, 2011. 1, 3

[9] S. K. Divvala, D. Hoiem, J. H. Hays, A. A. Efros, and
M. Hebert. An empirical study of context in object detec-
tion. In CVPR, pages 1271–1278. IEEE, 2009. 1, 3, 4, 8

[10] M. Everingham, S. A. Eslami, L. Van Gool, C. K. Williams,
The pascal visual object
Int. J. Comput. Vision,

J. Winn, and A. Zisserman.
classes challenge: A retrospective.
111(1):98–136, 2015. 4

[11] M. Everingham, L. Van Gool, C. Williams, J. Winn, and
A. Zisserman. The pascal visual object classes (voc) chal-
lenge. Int. J. Comput. Vision, 88(2):303–338, 2010. 2, 3

[12] P. Felzenszwalb, D. McAllester, and D. Ramanan. A dis-
criminatively trained, multiscale, deformable part model. In
CVPR, pages 1–8, 2008. 1

[13] P. F. Felzenszwalb, R. B. Girshick, D. McAllester, and D. Ra-
manan. Object detection with discriminatively trained part-
based models.
IEEE Trans. Pattern Anal. Mach. Intell.,
32(9):1627–1645, 2010. 2

[14] C. Galleguillos, A. Rabinovich, and S. Belongie. Object cat-
egorization using co-occurrence, location and appearance. In
CVPR, pages 1 –8, 2008. 2

[15] A. Geiger, P. Lenz, and R. Urtasun. Are we ready for au-
In

the kitti vision benchmark suite.

tonomous driving?
CVPR, 2012. 6

[16] G. Heitz and D. Koller. Learning spatial context: Using stuff

to ﬁnd things. In ECCV, pages 30–43, 2008. 1, 3

[17] D. Hoiem, Y. Chodpathumwan, and Q. Dai. Diagnosing error

in object detectors. ECCV, pages 340–353, 2012. 2, 7

[18] D. Hoiem, A. A. Efros, and M. Hebert. Putting objects in

perspective. Int. J. Comput. Vision, 80(1):3–15, 2008. 1, 2

[19] J. Huang, V. Rathod, C. Sun, M. Zhu, A. Korattikara,
A. Fathi, I. Fischer, Z. Wojna, Y. Song, S. Guadarrama, and
K. Murphy. Speed/accuracy trade-offs for modern convolu-
tional object detectors. In CVPR, 2017. 5

[20] J. Li, Y. Wei, X. Liang, J. Dong, T. Xu, J. Feng, and S. Yan.
Attentive contexts for object detection. IEEE Transactions
on Multimedia, 19(5):944–954, 2017. 1, 2, 3

[21] T.-Y. Lin, M. Maire, S. Belongie, J. Hays, P. Perona, D. Ra-
manan, P. Doll´ar, and C. L. Zitnick. Microsoft coco: Com-
mon objects in context. In ECCV, pages 740–755. Springer,
2014. 5

[22] W. Liu, D. Anguelov, D. Erhan, C. Szegedy, S. E. Reed, C.-
Y. Fu, and A. C. Berg. Ssd: Single shot multibox detector.
In ECCV, 2016. 6

[23] W. Luo, Y. Li, R. Urtasun, and R. Zemel. Understanding
the effective receptive ﬁeld in deep convolutional neural net-
works. In NIPS, pages 4898–4906, 2016. 1

[24] R. Mottaghi, X. Chen, X. Liu, N.-G. Cho, S.-W. Lee, S. Fi-
dler, R. Urtasun, and A. Yuille. The role of context for object
detection and semantic segmentation in the wild. In CVPR,
pages 891–898, 2014. 1, 2, 3

[25] J. Oramas M, L. De Raedt, and T. Tuytelaars. Allocentric

pose estimation. In ICCV, 2013. 1, 2

[26] R. Perko and A. Leonardis. A framework for visual-context-
aware object detection in still images. CVIU, 114(6):700–
711, 2010. 1

[27] S. Ren, K. He, R. Girshick, and J. Sun. Faster r-cnn: Towards
real-time object detection with region proposal networks. In
NIPS, pages 91–99, 2015. 5

[28] J. Shotton, M. Johnson, and R. Cipolla. Semantic texton
forests for image categorization and segmentation. In CVPR,
pages 1–8. IEEE, 2008. 3

[29] S. Song, S. P. Lichtenberg, and J. Xiao. Sun rgb-d: A rgb-d
scene understanding benchmark suite. In CVPR, pages 567–
576, 2015. 3

[30] A. Torralba, K. P. Murphy, and W. T. Freeman. Contextual
models for object detection using boosted random ﬁelds. In
NIPS, pages 1401–1408, 2004. 1

[31] A. Torralba and P. Sinha. Statistical context priming for ob-
In ICCV, volume 1, pages 763–770. IEEE,

ject detection.
2001. 1

[32] L. Wolf and S. Bileschi. A critical view of context. Int. J.

Comput. Vision, 69(2):251–261, 2006. 1, 2

[33] B. Yao and L. Fei-Fei. Modeling mutual context of object
In

and human pose in human-object interaction activities.
CVPR, pages 17–24. IEEE, 2010. 1, 2

[34] J. Yao, S. Fidler, and R. Urtasun. Describing the scene as
a whole: Joint object detection, scene classiﬁcation and se-
mantic segmentation. In CVPR, pages 702–709. IEEE, 2012.
3

[35] R. Yu, X. Chen, V. I. Morariu, and L. S. Davis. The role of
context selection in object detection. British Machine Vision
Conference, abs/1609.02948, 2016. 1, 2, 3, 4

7420

