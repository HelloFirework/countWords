Learning Regularity in Skeleton Trajectories for Anomaly Detection in Videos

Romero Morais1∗, Vuong Le1, Truyen Tran1, Budhaditya Saha1, Moussa Mansour2

,

3, Svetha Venkatesh1

1Applied Artiﬁcial Intelligence Institute, Deakin University, Australia

2iCetana, Inc. | 3University of Western Australia, Australia

1{ralmeidabaratad,vuong.le,truyen.tran,budhaditya.saha,svetha.venkatesh}@deakin.edu.au

2

moussa@icetana.com.au

Abstract

Appearance features have been widely used in video
anomaly detection even though they contain complex entan-
gled factors. We propose a new method to model the nor-
mal patterns of human movements in surveillance video for
anomaly detection using dynamic skeleton features. We de-
compose the skeletal movements into two sub-components:
global body movement and local body posture. We model
the dynamics and interaction of the coupled features in our
novel Message-Passing Encoder-Decoder Recurrent Net-
work. We observed that the decoupled features collabora-
tively interact in our spatio-temporal model to accurately
identify human-related irregular events from surveillance
video sequences. Compared to traditional appearance-
based models, our method achieves superior outlier detec-
tion performance. Our model also offers “open-box” ex-
amination and decision explanation made possible by the
semantically understandable features and a network archi-
tecture supporting interpretability.

1. Introduction

Video anomaly detection is a core problem of unsuper-
vised video modeling. An effective solution is learning
the regular patterns in normal training video sequences in
an unsupervised setting, based on which irregular events
in test videos can be detected as outliers. The problem is
challenging due to the lack of human supervision and the
ambiguous deﬁnition of human-perceivable abnormality in
video events. Most current approaches operate on pixel-
based appearance and motion features. These features are
usually extracted from whole frames [5, 13, 18, 20, 25], lo-
calized on a grid of image patches [24], or concentrated on
pre-identiﬁed regions [6, 14]. Unfortunately, pixel-based
features are high-dimensional unstructured signals sensitive
to noise, that mask important information about the scene
[28]. Furthermore, the redundant information present in
these features increases the burden on the models trained

Figure 1. We detect human-related anomalies in video by learn-
ing regular spatio-temporal patterns of skeleton features. In this
example, we detect the anomalous event of a person catching a
backpack. This anomaly is detected by using his unusual skeleton
pose and motion compared to those of normal activities. Skele-
tons in red denote high anomaly scores, while skeletons in green
denote low anomaly scores. The order of the frames is speciﬁed
by the blue arrows.

on them to discriminate between signal and noise.

Another key limitation of current methods is the lack of
interpretability due to the semantic gap between visual fea-
tures and the real meaning of the events. This limitation can
be ampliﬁed through processing in deep neural networks
[3]. This lack of understanding prevents practitioners from
using domain knowledge to customize model architectures
and obstructs error analysis.

In this paper, we propose to leverage 2D human skeleton
trajectories for detecting abnormal events related to human
behavior in surveillance videos. The skeleton trajectories
contain the locations of a collection of body joints in the
spatio-temporal domain of video sequences, as illustrated
in Figure 1. By using skeleton features we explicitly exploit
the common structure of surveillance videos, which con-
sists of humans and objects attached to them moving on top
of a static background. Compared to appearance-based rep-

11996

resentations, skeleton features are compact, strongly struc-
tured, semantically rich, and highly descriptive about hu-
man action and movement, which are keys to anomaly de-
tection.

By studying the human skeleton dynamics in a large col-
lection of surveillance videos, we observed that human be-
havioral irregularity can be factorized into a few factors re-
garding body motion and posture, such as location, velocity,
direction, pose and action. Motivated by this natural fac-
torization, we propose to decompose the dynamic skeleton
motions into two sub-processes, one describing global body
movement and the other local body posture. The global
movement tracks the dynamics of the whole body in the
scene, while the local posture describes the skeleton con-
ﬁguration in the canonical coordinate frame of the body’s
bounding box, where the global movement has been fac-
tored out.

We jointly model the two sub-processes in a novel model
called Message-Passing Encoder-Decoder Recurrent Neu-
ral Network (MPED-RNN). The network consists of two
RNN branches dedicated to the global and local feature
components. The branches process their data separately and
interact via cross-branch message-passing at each time step.
The model is trained end-to-end and regularized so that it
distills the most compact proﬁle of the normal patterns of
training data and effectively detects abnormal events.
In
addition to anomaly detection, MPED-RNN supports open-
box interpretation of its internal reasoning by providing the
weights of the contributing factors to the decision and the
visualization of these factors. We trial our method on two of
the most challenging video anomaly datasets and compare
our results with the state-of-the-art on the ﬁeld. The results
show that our proposed method is competitive in detection
performance and easier to analyze the failure modes.

2. Related Work

2.1. Video anomaly detection

Unsupervised video anomaly detection methods have
been an old-timer topic in the video processing and com-
puter vision communities. Traditional approaches consider
video frames as separate data samples and model them
using one-class classiﬁcation methods, such as one-class
SVM [25] and mixture of probabilistic PCA [15]. These
methods usually attain suboptimal performance when pro-
cessing large scale data with a wide variety of anomaly
types.

Recent approaches rejuvenate the ﬁeld by using convo-
lutional neural networks (CNN) to extract high-level fea-
tures from video frame intensity and achieve improved re-
sults. Some of these methods include Convolutional autoen-
coder [13], spatio-temporal autoencoder [5], 3D Convnet
AE [27], and Temporally-coherent Sparse Coding Stacked-
RNN [20]. Acknowledging the limitation of the intensity

based features such as sensitivity to appearance noise, Liu
et al. [18] proposed to use the prediction of optical ﬂow in
their temporal coherent loss, effectively ﬁltering out parts
of the noise in pixel appearance. However, optical ﬂow is
costly to extract and still far from the semantic nature of the
events.

Structured representations have recently attracted in-
creased attention for its potential to get closer to the seman-
tic concepts present in the anomalies. In [26], object trajec-
tories were used to guide the pooling of the visual features
so that interesting areas are paid more attention to. Towards
model interpretability, Hinami et al. [14] proposed to use
object, attribute, and action detection labels to understand
the reason of abnormality scores. Although it works well
for a number of events, their method fails in many cases
due to the incompleteness of the label sets and the distrac-
tion from unrelated information in the labels.

Our method of using skeleton features is another step
towards using low-dimensional semantic-rich features for
anomaly detection. We also advance the research efforts
toward interpretability of the anomaly detection models by
providing the ability to explain every abnormal event in our
factorized semantic space.

2.2. Human trajectory modeling

Human motion in video scenes is an important factor
for studying social behavior.
It has been applied in mul-
tiple computer vision applications, mostly with supervised
learning tasks such as action recognition [7] and person re-
identiﬁcation [8]. Recently, more effort has been invested
into unsupervised learning of human motion in social set-
tings [1, 12, 23] and single pose conﬁguration [10]. In this
work, we propose to expand the application of skeleton mo-
tion features to the task of video anomaly detection.
In
MPED-RNN, we share the encoder-decoder structure with
most unsupervised prediction models. However, instead of
perfectly generating the expected features, we aim at distill-
ing only the principal feature patterns so that anomalies are
left out. This involves building a highly regulated autoen-
coder.

Regarding feature representation and modeling, apart
from traditional methods that rely on hand-crafted local fea-
tures and state machines, several recent works proposed to
use interacting recurrent networks for motion modeling in
social settings [1, 12]. In these approaches, the input data
are in the form of whole body xy-location sequences while
local postures are ignored. To bridge this gap, in [10, 23]
the input of the RNN is extended to the skeleton joint loca-
tions. Recently, Du et al. [7] proposed to divide the skele-
ton joints into ﬁve parts, which are jointly modeled in a
ﬁve-branch bidirectional neural network. Different to pre-
vious approaches, we factorize skeleton motion based on
natural decomposition of human motion into global move-
ment/local deformation and model them jointly in an inter-

11997

active recurrent network.

3. Method

The anomalous human-related events in a surveillance
video scene can be identiﬁed by the irregular human move-
ment patterns observed in the video. Our method detects
those anomalies by learning a regularity model of the dy-
namic skeleton features found in training videos. We as-
sume the skeleton trajectories have already been extracted
from the videos. At each time step t, a skeleton is rep-
resented by a set of joint locations in image coordinates
, where k is the number of skeleton
joints. This set of temporal sequences is the input to our
anomaly detection algorithm.

ft = (cid:0)xi

t(cid:1)i=1..k

t, yi

3.1. Skeleton Motion Decomposition

Figure 2. Global and local decomposition of a skeleton in a frame.
Based on the canonical local reference frame deﬁned by the green
bounding box, the location vector of the left knee jointft (dashed
red) is decomposed into global f g
t (dashed blue) and local f l
t
(dashed green) components. The bounding box’s width and height
are included as global features and used to normalize local fea-
tures.

Naturally, human motion consists of two factors: rigid
movement of the whole body and non-rigid deformation
of the skeleton joints. The simplest way to model hu-
man motion using a recurrent network is by feeding it the
raw sequence of skeleton trajectories in image coordinates

t, yi

ft = (cid:0)xi

t(cid:1) [10, 23], implicitly merging the global and

local factors together. This solution performs well in videos
with uniform skeleton scales and types of activities where
the contribution of the two factors is consistent. On realistic
surveillance videos, however, the scales of human skeletons
vary largely depending on their location and actions. For
skeletons in the near ﬁeld, the observed motion is mainly
inﬂuenced by the local factor. Meanwhile, for skeletons in
the far ﬁeld, the motion is dominated by the global move-
ment while local deformation is mostly ignored.

Inspired by the natural composition of human skeleton
motion and motivated by the factorization models widely
used in statistical modeling, we propose to decompose the
skeletal motion into “global” and “local” components. The
global component carries information about the shape, size
and rigid movement of the human bounding box. The local
component models the internal deformation of the skeleton
and ignores the skeleton’s absolute position in relation to
the environment.

Geometrically, we set a canonical reference frame at-
tached to the human body (called local frame), which is
rooted at the center of the skeleton’s bounding box. The
global component is deﬁned as the absolute location of the
local frame center within the original image frame. On the
other hand, the local component is deﬁned as the residue af-
ter subtracting the global component from the original mo-
tion.
It represents the relative position of skeleton joints
with respect to the bounding box. This decomposition is il-
lustrated in Figure 2 and can be written in 2D vector space
as:

t = f g
f i

t + f l,i

t

(1)

In 2D image space, xy-coordinates alone poorly repre-
sent the real location in the scene because the depth is miss-
ing. However, the size of a skeleton’s bounding box is cor-
related with the skeleton’s depth in the scene. To bridge this
gap, we augment the global component with the width and
height of the skeleton’s bounding box f g = (xg, yg, w, h)
and use them to normalize the local component f l,i =
(xl,i, yl,i). These features can be calculated from the input
features as:

xg =

max(xi) + min(xi)

2

;

yg =

max(yi) + min(yi)

2

w = max(xi) − min(xi); h = max(yi) − min(yi)

xl,i =

xi − xg

w

;

yl,i =

yi − yg

h

(2)

(3)

The global and local dynamics can be modeled sepa-
rately as two concurrent sub-processes. In generic videos,
these two processes can even manifest independently. For
example, a person can move her limbs around while keep-
ing her global location relatively still. Similarly, a person
riding a motorbike can move around while having a rela-
tively ﬁxed pose. However, given a speciﬁc context, regular
human activities contain a strong correlation between these
two components. Therefore breaking the cross-component
correlation is also a sign of abnormality.
In the previous
examples, if those actions occurred in the scene where peo-
ple were normally walking, they would be valid anomaly
events. In the next section, we present how both individ-
ual dynamic patterns and the relationship between these two
components are modeled in our MPED-RNN model.

11998

Figure 3. MPED-RNN consists of two interacting branches for two skeleton feature components. The local branch is drawn in green with
shaded GRU blocks and the global branch is drawn in blue with transparent GRU blocks. The two components interact through messages
(purple dashed) exchanged between the branches. The outputs are generated by a set of MLPs, represented by black rectangles.

3.2. MPED RNN Architecture

MPED-RNN models the global and local components as
two interacting sub-processes where the internal state of one
process is used as extra features to the input of the other pro-
cess. More speciﬁcally, the model consists of two recurrent
encoder-decoder network branches, each of them dedicated
to one of the components. Each branch of the model has the
single-encoder-dual-decoder architecture with three RNNs:
Encoder, Reconstructing Decoder and Predicting Decoder.
This structure is similar to the composite LSTM autoen-
coder (LSTM AE) of Srivastava et al. [22]. However, unlike
LSTM AE, MPED-RNN does not only model the dynamics
of each individual component, but also the interdependen-
cies between them through a cross-branch message-passing
mechanism. We use Gated Recurrent Units (GRU) [4] in
every segment of MPED-RNN for its simplicity and simi-
lar performance to LSTM [11]. At each time step, the GRU
unit of one branch receives a message from the other branch
informing its internal state at the previous time step. This
message is incorporated into the GRU structure by treating
it as an additional input. The same procedure is applied to
the other branch. MPED-RNN’s architecture is depicted in
Figure 3.

Given an input skeleton segment of length T , we ﬁrst
initialize the hidden states of all the GRUs to null. Then, for
each time step t, the skeleton ft is decomposed into f g
t and

f l
t (using Eqs. (1), (2) and (3)), which are input to the global
encoder (Eg) and to the local encoder (El), respectively.
The messages to be exchanged between the global and local
branches are computed as speciﬁed by Eqs. 4 and 5 below.

ml→g
mg→l

t = σ(cid:0)W l→ghl
t = σ(cid:0)W g→lhg

t−1 + bl→g(cid:1)
t−1 + bg→l(cid:1)

For t = 1, 2, . . . , T , the global and local segments are

encoded using Eqs. 6 and 7:

Ege : hge

Ele : hle

t = GRU(cid:16)hf g
t = GRU(cid:16)hf l

t , mle→ge

t

t , mge→le

t

i , hge
t−1(cid:17)
t−1(cid:17)
i , hle

After encoding the input segments, the global and lo-
cal Reconstructing Decoders initialize their hidden states
as hgr
T and hlr
T , respectively, and for t =
T, T − 1, ..., 1, we have:

T = hge

T = hle

(4)

(5)

(6)

(7)

Dg

Dl

r : hgr
r : hlr

t−1 = GRU(mlr→gr
t−1 = GRU(mgr→lr

t

t

, hgr
t )

, hlr
t )

(8)

(9)

Similarly, the global and local Predicting Decoders ini-
tialize their hidden states as hgp
T = hle
T ,
respectively, and for t = T + 1, T + 2, . . . , T + P , we have:

T and hlp

T = hge

Dg

Dl

p : hgp
p : hlp

t = GRU(mlp→gp
t = GRU(mgp→lp

t

t

, hgp
, hlp

t−1)
t−1)

(10)

(11)

11999

In training, the dual decoders in the MPED-RNN’s ar-
chitecture jointly enforce the encoder to learn a compact
representation rich enough to reconstruct its own input and
predict the unseen future. Meanwhile, in testing, the ab-
normal patterns cannot be properly predicted because they
were neither seen before nor follow the normal dynamics.

where P denotes the prediction length and ∗ represents one
of l, g or p. In case of p notice that it makes f p
t equal to ft
of Section 3.1. The prediction loss is truncated if the end of
trajectory is reached within the prediction length.

The three losses contribute to the combined loss by a

weighted sum:

t and hl

t and ˆf l

In each decoder network, the projected features of the
corresponding decoders, ˆf g
t , are independently gen-
erated from the hidden states hg
t by fully-connected
layers. These two projected features are concatenated and
input to another fully-connected layer, which generates the
projected perceptual feature ˆft in the original image space.
Ideally, ˆft can be calculated from ˆf g
t by inverting
Eqs. (2) and (3). However, by being projections into low-
dimensional subspaces, a direct computation is unlikely to
be optimal. Thus, using a fully-connected layer to learn
the inverse mapping allows the computation to be robust to
noise. These projected features are used to evaluate the con-
formity of an input sequence of skeletons to the learned nor-
mal behavior and hence are used to build the loss function
for training and score function for testing. These procedures
are detailed next.

t and ˆf l

3.3. Training MPED RNN

Training setup The trajectory of a person can span many
frames in a video. However, recurrent networks are trained
on ﬁxed-size sequences. To cope with this issue, we extract
ﬁxed-size segments from every skeleton’s trajectory using a
sliding-window strategy. Therefore, each segment is com-
puted as:

segi = {ft}t=bi..ei

(12)

where bi and ei are beginning and ending indices of the i-
th segment calculated from the chosen sliding stride s and
segment length T :

bi = s × i; ei = s × i + T

(13)

During training, batches of training segments are decom-
posed into global and local features, which are input to
MPED-RNN.

Loss functions We consider three loss functions deﬁned
in three related coordinate frames. The Perceptual loss Lp
constrains MPED-RNN to produce the normal sequences in
the image coordinate system. The Global loss Lg and the
Local loss Lp act as regularization terms that enforce that
each encoder-decoder branch of MPED-RNN work as de-
signed. Each of the losses includes the mean squared error
made by the reconstructing and predicting decoders:

L∗(segi) =

1

2  1

T

ei

Xt=bi(cid:13)(cid:13)(cid:13)

ˆf ∗
t − f ∗

t(cid:13)(cid:13)(cid:13)

2

2

+

1
P

ei+P

Xt=ei+1(cid:13)(cid:13)(cid:13)

ˆf ∗
t − f ∗

t(cid:13)(cid:13)(cid:13)

(14)

L(segi) = λgLg(segi) + λlLl(segi) + λpLp(segi)

(15)

where {λg, λl, λp} ≥ 0 are corresponding weights to the
losses.

In training, we minimize the combined loss in Eq. (15)
by optimizing the parameters of GRU cells of the RNN net-
works, message building transformations in Eqs. 4 and 5,
and the output MLPs.

Model regularization When training autoencoder style
models for anomaly detection, a major challenge is that
even if the model learns to generate normal data perfectly,
there is still no guarantee that the model will produce high
errors for abnormal sequences [18].
In training MPED-
RNN, we address this challenge by empirically searching
for the smallest latent space that still adequately covers the
normal patterns so that outliers fall outside the manifold
represented by this subspace.

We implement this intuition by splitting the normal tra-
jectories into training and validation subsets, and use them
to regularize the network’s hyperparameters that govern the
capacity of the model (e.g. number of hidden units). More
speciﬁcally, we train a high capacity network and record
the lowest loss on the validation set. The validation set is
also used for early stopping. Then, we train a network with
lower capacity and record the lowest loss on the validation
set again. We repeat this procedure until we ﬁnd the net-
work with the smallest capacity that is still within 5% of the
initial validation loss attained by the high capacity network.

3.4. Detecting Video Anomalies

To estimate the anomaly score of each frame in a video,

we follow a four-step algorithm:

1. Extract segments: With each trajectory, we select the
overlapping skeleton segments by using a sliding win-
dow of size T and stride s on the trajectory, similar to
Eqs. (12) and (13).

2. Estimate segment losses: We decompose the segment
using Eq. (1) and feed all segment features to the
trained MPED-RNN, which outputs the normality loss
as in Eq. (15).

2

2!

3. Gather skeleton anomaly score: To measure the con-
formity of a sequence to the model given both the past
and future context, we propose a voting scheme to
gather the losses of related segments into an anomaly

12000

score for each skeleton instance:

αft = Pu∈St

|St|

Lp(u)

Table 1. Frame-level ROC AUC performance of MPED-RNN and
other state-of-the-art methods on the ShanghaiTech dataset and its
human-related subset. We use the reported results of the refer-
enced methods on ShanghaiTech and carry out their identical ex-
periments on HR-ShanghaiTech whenever possible.

(16)

where St denotes the set of decoded segments that con-
tain ft from both reconstruction and prediction. For
each of those segments u, the corresponding percep-
tual loss, Lp(u), is calculated by Eq. (14).

4. Calculate frame anomaly score: The anomaly score
of a video frame vt is calculated from the score of all
skeleton instances appearing in that frame by a max
pooling operator:

αvt = max (αft )ft∈Skel(vt)

(17)

where Skel(vt) stands for the set of skeleton instances
appearing in the frame. The choice of max pool-
ing over other aggregation functions is to suppress
the inﬂuence of normal trajectories present in the
scene, since the number of normal trajectories can vary
largely in real surveillance videos. We then use αvt as
the frame-level anomaly score of vt and use it to cal-
culate all accuracy measurements.

3.5. Implementation Details

To detect skeletons in the videos, we utilized Alpha Pose
[9] to independently detect skeletons in each video frame.
To track the skeletons across a video, we combined sparse
optical ﬂow with the detected skeletons to assign similarity
scores between pairs of skeletons in neighboring frames,
and solved the assignment problem using the Hungarian
algorithm [16]. The global and local components of the
skeleton trajectories are standardized by subtracting the me-
dian of each feature, and scaling each feature relative to
the 10%-90% quantile range. All recurrent encoder-decoder
networks have similar architectures but are trained with in-
dependent weights. The regularization of MPED-RNN’s
hyperparameters is done for each data set, following the
method described in Section 3.3.

4. Experiments

We evaluate our method on two datasets for video
anomaly detection: ShanghaiTech Campus [20] and CUHK
Avenue [19]. Each of these datasets has speciﬁc charac-
teristics in terms of data source, video quality and types of
anomaly. Therefore, we setup customized experiments for
each of them.

4.1. ShanghaiTech Campus Dataset

The ShanghaiTech Campus dataset [20] is considered
one of the most comprehensive and realistic datasets for
video anomaly detection currently available.
It combines
footage of 13 different cameras around the ShanghaiTech

HR-ShanghaiTech

ShanghaiTech

Conv-AE [13]

TSC sRNN [20]

Liu et al. [18]

MPED-RNN

0.698

N/A

0.727

0.754

0.704

0.680

0.728

0.734

University campus with a wide spectrum of anomaly types.
Because of the sophistication of the anomaly semantics,
current methods struggle to get adequate performance on
it.

Most of the anomaly events in the ShanghaiTech dataset
are related to humans, which are the target of our method.
We left out 6/107 test videos whose abnormal events were
not related to humans and kept the other 101 videos as a
subset called Human-related (HR) ShanghaiTech. Most of
the experiments discussed in this section are conducted on
the HR-ShanghaiTech dataset.

4.1.1 Comparison with Appearance-based Methods

We train MPED-RNN on all training videos, which is the
practice adopted in previous works. Table 1 compares the
frame-level ROC AUC of MPED-RNN against three state-
of-the-art methods. We observe that on HR-ShanghaiTech,
MPED-RNN outperforms all the compared methods. For
completeness, we also evaluate MPED-RNN on the original
dataset where non-human related anomalies are present and
MPED-RNN still attains the highest frame-level ROC AUC.
To understand how the detection of anomalies is made
by all models, we visually compare in Figure 4 the map
of anomaly scores produced by MPED-RNN to those pro-
duced by Conv-AE [13] and Liu et al. [18]. As we can
observe, our method avoids many irrelevant aspects of the
scene since we focus on skeletons. On the other hand, the
other two methods try to predict the whole scene and are
more susceptible to noise in it.

4.1.2

Interpreting Open-box MPED-RNN

For a deeper understanding on how MPED-RNN works
under the hood, we visualize the features generated from
the global and local predicting decoders, and the predicted
skeleton in image space. For comparison, we also draw
the corresponding features of the input sequence. Figure
5 shows two example sequences from the same scene, a

12001

Table 2. Ablation study about the components of MPED-RNN. We
show the frame-level ROC AUC of simpler models that compose
MPED-RNN on the HR-ShanghaiTech dataset. AE: Frame-level
Autoencoder, ED: Encoder-Decoder, G+L: Global and Local fea-
tures without message passing. The columns stand for different
ways the loss is calculated; Rec: reconstruction only, Pred: pre-
diction ony, Rec+Pred: reconstruction and prediction combined.

HR-ShanghaiTech

Rec.

Pred. Rec. + Pred.

AE/Image

0.674

N/A

ED-RNN/Global

0.680

0.688

ED-RNN/Local

0.700

0.714

ED-RNN/G+L

0.699

0.722

MPED-RNN

0.744

0.745

N/A

0.689

0.715

0.713

0.754

the root causes of the major mistakes.

The most prominent source of errors is from the inac-
curacy of the skeleton detection and tracking. All of the
skeleton detection methods we tried produced inaccurate
skeletons in several common difﬁcult cases such as low
resolution of human area or unwanted lighting, contrast or
shadow. Moreover, when there is occlusion or multiple peo-
ple crossing each other, the tracking IDs can get lost or
swapped and confuse MPED-RNN. Figure 6.a shows an ex-
ample frame containing a badly detected skeleton.

Apart from the input noise, a small portion of error
comes from a more interesting phenomenon when the ab-
normal action of subjects produce similar skeletons to nor-
mal ones. Figure 6.b shows the case of a person slowly
riding a bicycle with motion and posture similar to walking,
which tricks our model into a false negative. This issue is a
predicted downside of geometrical skeleton features, where
all appearance features have been ﬁltered out. Augmenting
the skeleton structure with visual features is a future work
towards solving this issue.

4.2. CUHK Avenue dataset

We also tested MPED-RNN on the CUHK Avenue
dataset, which is another representative dataset for video
anomaly detection. It contains 16 training videos and 21
testing videos captured from a single camera. Based on ear-
lier error analysis on the ShanghaiTech dataset, we under-
stand that the unstable skeleton inputs are the most impor-
tant source of inaccuracy. To avoid this issue, we manually
leave out a set of video frames where the main anomalous
event is non-human related, or the person involved is non-
visible (e.g. person out of view throwing an object into the
scene), or the main subject cannot be detected and tracked.
This selection is detailed in the supplemental material. We

12002

Figure 4. Anomaly score map of Conv-AE [13], Liu et al. [18]
and MPED-RNN in jet color map. Higher scores are represented
closer to red while lower scores are represented closer to blue.
The ﬁrst row shows the original input frames and subsequent rows
show the score map of each method. Since MPED-RNN focuses
on skeletons it does not produce any score on background pixels.

normal example and an anomalous example. This scene
is of the walking area in the campus, where regular activ-
ities include people standing and walking casually. In the
normal sequence, the predictions follow the input closely
in all three domains, which shows that MPED-RNN en-
codes enough information to predict the normal sequence.
On the other hand, the abnormal event contains a person
running. Its predicted global bounding box lags behind the
input bounding box, indicating that the expected movement
is slower than the observed one. The local prediction also
struggles to reproduce the running pose and ends up predict-
ing a walking gait remotely mimicking the original poses.

4.1.3 Ablation Study

Table 2 reports the results of simpliﬁed variants of MPED-
RNN. It conﬁrms that RNN is needed for this problem,
and when both global and local sub-processes are modeled,
message passing between the sub-processes is necessary. It
also shows that the dual decoders are valuable for regular-
izing the model and detecting anomalies.

4.1.4 Error Mode Analysis

Even though MPED-RNN outperforms related methods, it
still makes incorrect decisions. To understand the weak-
nesses of MPED-RNN, we sorted the test sequences by de-
creasing level of error made by MPED-RNN and looked for

Figure 5. Visualization of the predicted features (red) compared to input features (black) in a sample case for a normal trajectory and an
anomalous trajectory.

Figure 6. : Error mode examples. (a) Skeleton detection inaccu-
racy: bad detection of the person reﬂected in the glass lead to bad
predictions by MPED-RNN. (b) Confusion in feature space: The
person riding the bicycle (red) has a moving pattern “similar” to a
person walking.

called the remaining dataset HR-Avenue. On HR-Avenue,
we achieved a frame-level ROC AUC of 0.863, against
0.862 and 0.848 achieved by Liu et al. [18] and Conv-AE
[13], respectively.

5. Discussion

With less than a hundred dimensions per frame on av-
erage, equal to a small fraction of the popular visual fea-
tures for anomaly detection (ResNet features of 2048 [13],
AlexNet fc7 of 4096 [14]), skeleton features still provide
equal or better performance than current state-of-the-art
methods. This revives the hope for using semantic guided
stage-by-stage approaches for anomaly detection amid the
trend of end-to-end image processing deep networks.
It
also reﬂects the current trend of architectures being mod-
ular, with multiple independent modules [2, 17]. Appar-
ently, MPED-RNN’s performance still depends on the qual-
ity of skeleton detection and tracking. This problem be-
comes more signiﬁcant in the case of low quality videos. It
prevents us from trying our method on UCSD Ped1/Ped2
[21], another popular dataset whose video quality is too
low to detect skeletons. Furthermore, for the cases where
skeletons are unavailable, appearance based features can
provide complementary information to help. This opens a

promising direction of combining these features in a cas-
caded model, where they can cover the weaknesses of each
other. Our message-passing scheme can naturally be ex-
tended to incorporate sub-processes with non-skeleton fea-
tures.

Although dynamic movement and posture of single per-
son can reﬂect the anomalies in most cases, they do not
contain information about the interactions between multi-
ple people in the events, and between humans and objects.
The global-local decomposition used in our method can be
extended to objects by exploring the part-based conﬁgura-
tion for each type of them. Towards multi-person/object
anomalies, the message passing framework in MPED-RNN
is ready to extend support to them, by expanding to inter-
entity messages.

6. Conclusions

Through our experiments, we learned that skeleton mo-
tion sequences are effective to identify human-related video
anomalous events. We observed that the decomposition
of the skeleton sequence into global movement and local
deformation – combined with our novel message-passing
encoder-decoder RNN architecture – appropriately sepa-
rates anomalous sequences from normal sequences. MPED-
RNN is simple, achieves competitive performance and is
highly interpretable. Future work includes examining the
regularity of inter-human interactions, combining skeleton
features with appearance counterparts, and expanding the
component based model to non-human objects.

References

[1] Alexandre Alahi, Kratarth Goel, Vignesh Ramanathan,
Alexandre Robicquet, Li Fei-Fei, and Silvio Savarese. So-
cial LSTM: Human trajectory prediction in crowded spaces.
In IEEE Conference on Computer Vision and Pattern Recog-
nition, pages 961–971, 2016. 2.2

[2] Jacob Andreas, Marcus Rohrbach, Trevor Darrell, and Dan

12003

In IEEE Conference on
Klein. Neural module networks.
Computer Vision and Pattern Recognition, pages 39–48,
2016. 5

[3] David Bau, Bolei Zhou, Aditya Khosla, Aude Oliva, and
Antonio Torralba. Network dissection: Quantifying inter-
pretability of deep visual representations. In IEEE Confer-
ence on Computer Vision and Pattern Recognition, pages
3319–3327, 2017. 1

[4] Kyunghyun Cho, Bart van Merrienboer, Caglar Gulcehre,
Dzmitry Bahdanau, Fethi Bougares, Holger Schwenk, and
Yoshua Bengio. Learning phrase representations using RNN
Encoder–Decoder for statistical machine translation. In Con-
ference on Empirical Methods in Natural Language Process-
ing, pages 1724–1734, 2014. 3.2

[5] Yong Shean Chong and Yong Haur Tay. Abnormal event
detection in videos using spatiotemporal autoencoder. In In-
ternational Symposium on Neural Networks, pages 189–196.
Springer, 2017. 1, 2.1

[6] Serhan Cos¸ar, Giuseppe Donatiello, Vania Bogorny, Car-
olina Garate, Luis Otavio Alvares, and Franc¸ois Br´emond.
Toward abnormal trajectory and event detection in video
surveillance. IEEE Transactions on Circuits and Systems for
Video Technology, 27(3):683–695, 2017. 1

[7] Yong Du, Yun Fu, and Liang Wang. Representation learning
of temporal dynamics for skeleton-based action recognition.
IEEE Transactions on Image Processing, 25(7):3010–3022,
2016. 2.2

[8] Amani Elaoud, Walid Barhoumi, Hassen Drira, and Ezzed-
dine Zagrouba. Analysis of skeletal shape trajectories for
person re-identiﬁcation. In International Conference on Ad-
vanced Concepts for Intelligent Vision Systems, pages 138–
149. Springer, 2017. 2.2

[9] Hao-Shu Fang, Shuqin Xie, Yu-Wing Tai, and Cewu Lu.
RMPE: Regional multi-person pose estimation.
In IEEE
International Conference on Computer Vision, pages 2353–
2362, 2017. 3.5

[10] Katerina Fragkiadaki, Sergey Levine, Panna Felsen, and Ji-
tendra Malik. Recurrent network models for human dynam-
ics. In IEEE International Conference on Computer Vision,
pages 4346–4354, 2015. 2.2, 3.1

[11] Klaus Greff, Rupesh K Srivastava, Jan Koutnik, Bas R Ste-
unebrink, and Jurgen Schmidhuber. LSTM: A search space
odyssey. IEEE transactions on neural networks and learning
systems, 28(10):2222–2232, 2017. 3.2

[12] Agrim Gupta, Justin Johnson, Li Fei-Fei, Silvio Savarese,
and Alexandre Alahi. Social gan: Socially acceptable trajec-
tories with generative adversarial networks. In IEEE Con-
ference on Computer Vision and Pattern Recognition, 2018.
2.2

[13] Mahmudul Hasan, Jonghyun Choi, Jan Neumann, Amit K
Roy-Chowdhury, and Larry S Davis. Learning temporal reg-
ularity in video sequences. In IEEE Conference on Computer
Vision and Pattern Recognition, pages 733–742, 2016. 1, 2.1,
1, 4.1.1, 4, 4.2, 5

[14] Ryota Hinami, Tao Mei, and Shin’ichi Satoh. Joint detection
and recounting of abnormal events by learning deep generic
knowledge. In IEEE International Conference on Computer
Vision, pages 3639–3647, 2017. 1, 2.1, 5

[15] Jaechul Kim and Kristen Grauman. Observe locally, infer
globally: a space-time mrf for detecting abnormal activities
with incremental updates. In IEEE Conference on Computer
Vision and Pattern Recognition, pages 2921–2928, 2009. 2.1
[16] Harold W Kuhn. The hungarian method for the assignment
problem. Naval research logistics quarterly, 2(1-2):83–97,
1955. 3.5

[17] Bingbin Liu, Serena Yeung, Edward Chou, De-An Huang,
Li Fei-Fei, and Juan Carlos Niebles. Temporal modular
networks for retrieving complex compositional activities in
videos. In European Conference on Computer Vision, pages
569–586. Springer, 2018. 5

[18] Wen Liu, Weixin Luo, Dongze Lian, and Shenghua Gao. Fu-
ture frame prediction for anomaly detection – a new baseline.
In IEEE Conference on Computer Vision and Pattern Recog-
nition, 2018. 1, 2.1, 3.3, 1, 4.1.1, 4, 4.2

[19] Cewu Lu, Jianping Shi, and Jiaya Jia. Abnormal event de-
tection at 150 FPS in MATLAB. In IEEE International Con-
ference on Computer Vision, pages 2720–2727, 2013. 4

[20] Weixin Luo, Wen Liu, and Shenghua Gao. A revisit of sparse
coding based anomaly detection in stacked RNN frame-
work.
In IEEE International Conference on Computer Vi-
sion, pages 341–349, 2017. 1, 2.1, 4, 4.1, 1

[21] Vijay Mahadevan, Weixin Li, Viral Bhalodia, and Nuno Vas-
concelos. Anomaly detection in crowded scenes. In IEEE
Conference on Computer Vision and Pattern Recognition,
pages 1975–1981, 2010. 5

[22] Nitish Srivastava, Elman Mansimov, and Ruslan Salakhudi-
nov. Unsupervised learning of video representations using
LSTMs. In International Conference on Machine Learning,
pages 843–852, 2015. 3.2

[23] Ruben Villegas, Jimei Yang, Yuliang Zou, Sungryull Sohn,
Xunyu Lin, and Honglak Lee. Learning to generate long-
term future via hierarchical prediction. In International Con-
ference on Machine Learning, pages 3560–3569, 2017. 2.2,
3.1

[24] Hung Vu, Tu Dinh Nguyen, Anthony Travers, Svetha
Energy-based localized
Venkatesh, and Dinh Phung.
anomaly detection in video surveillance.
In Paciﬁc-Asia
Conference on Knowledge Discovery and Data Mining,
pages 641–653. Springer, 2017. 1

[25] Dan Xu, Yan Yan, Elisa Ricci, and Nicu Sebe. Detecting
anomalous events in videos by learning deep representations
of appearance and motion. Computer Vision and Image Un-
derstanding, 156:117–127, 2017. 1, 2.1

[26] Yuan Yuan, Jianwu Fang, and Qi Wang. Online anomaly de-
tection in crowd scenes via structure analysis. IEEE Trans-
actions on Cybernetics, 45(3):548–561, 2015. 2.1

[27] Yiru Zhao, Bing Deng, Chen Shen, Yao Liu, Hongtao Lu,
and Xian-Sheng Hua. Spatio-temporal autoencoder for video
anomaly detection. In Proceedings of the 2017 ACM on Mul-
timedia Conference, pages 1933–1941. ACM, 2017. 2.1

[28] Arthur Zimek, Erich Schubert, and Hans-Peter Kriegel. A
survey on unsupervised outlier detection in high-dimensional
numerical data. Statistical Analysis and Data Mining: The
ASA Data Science Journal, 5(5):363–387, 2012. 1

12004

