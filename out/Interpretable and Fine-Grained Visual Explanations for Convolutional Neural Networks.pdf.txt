Interpretable and Fine-Grained Visual Explanations for

Convolutional Neural Networks

J¨org Wagner1,2

Jan Mathias K¨ohler1

Jakob Thadd¨aus Wiedemer1, ∗

Tobias Gindele1, ∗
Sven Behnke2

Leon Hetzel1, ∗

1Bosch Center for Artiﬁcial Intelligence (BCAI), Germany

2University of Bonn, Germany

Joerg.Wagner3@de.bosch.com; behnke@cs.uni-bonn.de

Abstract

To verify and validate networks, it is essential to gain
insight into their decisions, limitations as well as possible
shortcomings of training data.
In this work, we propose
a post-hoc, optimization based visual explanation method,
which highlights the evidence in the input image for a spe-
ciﬁc prediction. Our approach is based on a novel technique
to defend against adversarial evidence (i.e. faulty evidence
due to artefacts) by ﬁltering gradients during optimization.
The defense does not depend on human-tuned parameters.
It enables explanations which are both ﬁne-grained and
preserve the characteristics of images, such as edges and
colors. The explanations are interpretable, suited for visu-
alizing detailed evidence and can be tested as they are valid
model inputs. We qualitatively and quantitatively evaluate
our approach on a multitude of models and datasets.

1. Introduction

Convolutional Neural Networks (CNNs) have proven
to produce state-of-the-art results on a multitude of vi-
sion benchmarks, such as ImageNet [34], Caltech [12] or
Cityscapes [9] which led to CNNs being used in numerous
real-world systems (e.g. autonomous vehicles) and services
(e.g. translation services). Though, the use of CNNs in
safety-critical domains presents engineers with challenges
resulting from their black-box character. A better under-
standing of the inner workings of a model provides hints for
improving it, understanding failure cases and it may reveal
shortcomings of the training data. Additionally, users gen-
erally trust a model more when they understand its decision
process and are able to anticipate or verify outputs [30].

To overcome the interpretation and transparency disad-
vantage of black-box models, post-hoc explanation meth-

∗contributed while working at BCAI. We additionally thank Volker

Fischer, Michael Herman, Anna Khoreva for discussions and feedback.

Figure 1: Fine-grained explanations computed by remov-
ing irrelevant pixels. a) Input image with softmax score
p(cml) of the most-likely class. Our method tries to ﬁnd
a sparse mask (c) with irrelevant pixels set to zero. The re-
sulting explanation (b), i.e.: ’image × mask’, is optimized
in the image space and, thus, can directly be used as model
input. The parameter λ is optimized to produce an explana-
tion with a softmax score comparable to the image.

ods have been introduced [53, 35, 42, 49, 32, 17, 11]. These
methods provide explanations for individual predictions and
thus help to understand on which evidence a model bases its
decisions. The most common form of explanations are vi-
sual, image-like representations, which depict the important
pixels or image regions in a human interpretable manner.

In general, an explanation should be easily interpretable
(Sec. 4.1). Additionally, a visual explanation should be
class discriminative and ﬁne-grained [35] (Sec. 4.2). The
latter property is particularly important for classiﬁcation
tasks in the medical [20, 18] domain, where ﬁne structures
(e.g. capillary hemorrhages) have a major inﬂuence on the
classiﬁcation result (Sec. 5.2). Besides, the importance of
different color channels should be captured, e.g. to uncover

9097

a color bias in the training data (Sec. 4.3).

Moreover, explanations should be faithful, meaning they
accurately explain the function of the black-box model [35].
To evaluate the faithfulness (Sec. 5.1), recent work [35, 32,
7] introduce metrics which are based on model predictions
of explanations. To be able to compute such metrics without
having to rely on proxy measures [35], it is beneﬁcial to
employ explanation methods which directly generate valid
model inputs (e.g. a perturbed version of the image).

A major concern of optimization based visual explana-
tion methods is adversarial evidence, i.e. faulty evidence
generated by artefacts introduced in the computation of the
explanation. Therefore, additional constraints or regulariza-
tions are used to prevent such faulty evidence [17, 11, 14].
A drawback of these defenses are added hyperparameters
and the necessity of either a reduced resolution of the ex-
planation or a smoothed explanation (Sec. 3.2), thus, they
are not well suited for displaying ﬁne-grained evidence.

Our main contribution is a new adversarial defense tech-
nique which selectively ﬁlters gradients in the optimiza-
tion which would lead to adversarial evidence otherwise
(Sec. 3.2). Using this defense, we extend the work of [17]
and propose a new ﬁne-grained visual explanation method
(FGVis). The proposed defense is not dependend on hyper-
parameters and is the key to produce ﬁne-grained explana-
tions (Fig. 1) as no smoothing or regularizations are nec-
essary. Like other optimization-based approaches, FGVis
computes a perturbed version of the original image,
in
which either all irrelevant or the most relevant pixels are re-
moved. The resulting explanations (Fig 1 b) are valid model
inputs and their faithfulness can, thus, be directly veriﬁed
(as in methods from [17, 14, 6, 11]). Moreover, they are ad-
ditionally ﬁne-grained (as in methods from [35, 38, 48, 42]).
To the best of our knowledge, this is the ﬁrst method to be
able to produce ﬁne-grained explanations directly in the im-
age space. We evaluate our defense (Sec. 3.2) and FGVis
(Sec. 4 and 5) qualitatively and quantitatively.

2. Related Work

Various methods to create explanations have been intro-
duced. Thang et al. [50] and DU et al. [13] provide a survey
of these. In this section, we give an overview of explanation
methods which generate visual, image-like explanations.
Backpropagation Based Methods (BBM). These methods
generate an importance measure for each pixel by back-
propagating an error signal to the image. Simonyan et
al. [38], which build on work of Baehrens et al. [5], use
the derivative of a class score with respect to the image
as an importance measure. Similar methods have been in-
troduced in Zeiler et al. [48] and Springenberg et al. [42],
which additionally manipulate the gradient when backprop-
agating through ReLU nonlinearities.
Integrated Gradi-
ents [43] additionally accumulates gradients along a path

from a base image to the input image. SmoothGrad [40]
and VarGrad [1] visually sharpen explanations by com-
bining multiple explanations of noisy copies of the im-
age. Other BBMs such as Layer-wise Relevance Prop-
agation [4], DeepLift [37] or Excitation Backprop [49]
utilize top-down relevancy propagation rules. BBMs are
usually fast to compute and produce ﬁne-grained impor-
tance/relevancy maps. However, these maps are generally
of low quality [11, 14] and are less interpretable. To verify
their faithfulness it is necessary to apply proxy measures or
use pre-processing steps, which may falsify the result.

Activation Based Methods (ABM). These approaches use
a linear combination of activations from convolutional lay-
ers to form an explanation. Prominent methods of this cate-
gory are CAM (Class Activation Mapping) [53] and its gen-
eralizations Grad-CAM [35] and Grad-CAM++ [7]. These
methods mainly differ in how they calculate the weights of
the linear combination and what restrictions they impose on
the CNN. Extensions of such approaches have been pro-
posed in Selvaraju et al. [35] and Du et al. [14], which
combine ABMs with backpropagation or perturbation based
approaches. ABMs generate easy to interpret heat-maps
which can be overlaid on the image. However, they are gen-
erally not well suited to visualize ﬁne-grained evidence or
color dependencies. Additionally, it is not guaranteed that
the resulting explanations are faithful and reﬂect the deci-
sion making process of the model [14, 35].

Perturbation Based Methods (PBM). Such approaches
perturb the input and monitor the prediction of the model.
Zeiler et al. [48] slide a grey square over the image and
use the change in class probability as a measure of im-
portance. Several approaches are based on this idea, but
use other importance measures or occlusion strategies. Pet-
siuk et al. [32] use randomly sampled occlusion masks and
deﬁne importance based on the expected model score over
masks. LIME [33] uses a super-pixel based occlusion strat-
egy and a surrogate model to compute importance scores.
Further super-pixel or segment based methods are intro-
duced in Seo et al. [36] and Zhou et al. [52]. The so far
mentioned approaches do not need access to the internal
state or structure of the model. Though, they are often quite
time consuming and only generate coarse explanations.

Other PBMs generate an explanation by optimizing for
a perturbed version of the image [11, 17, 14, 6]. The per-
turbed image e is deﬁned by e = m · x + (1 − m) · r, where
m is a mask, x the input image, and r a reference image
containing little information (Sec. 3.1). To avoid adver-
sarial evidence, these approaches need additional regular-
izations [17], constrain the explanation (e.g. optimize for a
coarse mask [6, 17, 14]), introduce stochasticity [17], or uti-
lize regularizing surrogate models [11]. These approaches
generate easy to interpret explanations in the image space,
which are valid model inputs and faithful (i.e. a faithfulness

9098

measure is incorporated in the optimization).

Our method also optimizes for a perturbed version of the
input. Compared to existing approaches we propose a new
adversarial defense technique which ﬁlters gradients during
optimization. This defense does not need hyperparameters
which have to be ﬁne-tuned. Besides, we optimize each
pixel individually, thus, the resulting explanations have no
limitations on the resolution and are ﬁne-grained.

3. Explaining Model Predictions

Explanations provide insights into the decision-making
process of a model. The most universal form of ex-
planations are global ones which characterize the overall
model behavior. Global explanations specify for all pos-
sible model inputs the corresponding output in an intu-
itive manner. A decision boundary plot of a classiﬁer in
a low-dimensional vector space, for example, represents a
global explanation. For high-dimensional data and com-
plex models, it is practically impossible to generate such
explanations. Current approaches therefore utilize local ex-
planations1, which focus on individual inputs. Given one
data point, these methods highlight the evidence on which
a model bases its decisions. As outlined in Sec. 2, the
deﬁnition of highlighting depends on the used explanation
method. In this work, we follow the paradigm introduced in
[17] and directly optimize for a perturbed version of the in-
put image. Such an approach has several advantages: 1) The
resulting explanations are interpretable due to their image-
like nature; 2) Explanations represent valid model inputs
and are thus testable; 3) Explanations are optimized to be
faithful. In Sec. 3.1 we brieﬂy review the general paradigm
of optimization based explanation methods before we intro-
duce our novel adversarial defense technique in Sec. 3.2.

3.1. Perturbation based Visual Explanations

Following the paradigm of optimization based explana-
tion methods, which compute a perturbed version of the im-
age [17, 14, 6, 11], an explanation can be deﬁned as:
Explanation by Preservation: The smallest region of the
image which must be retained to preserve the original model
output (i.e. minimal sufﬁcient evidence).
Explanation by Deletion: The smallest region of the image
which must be deleted to change the model output.

To formally derive an explanation method based on this
paradigm, we assume that a CNN fcnn is given which
maps an input image x ∈ R3×H×W to an output yx =
fcnn(x; θcnn). The ouput yx ∈ RC is a vector representing
the softmax scores yc
x of the different classes c. Given an
input image x, an explanation e∗
cT of a target class cT (e.g.
the most-likely class cT = cml) is computed by remov-
ing either relevant (deletion) or irrelevant, not supporting

1For the sake of brevity, we will use the term explanations as a syn-

onym for local explanations throughout this work.

cT , information (preservation) from the image. Since it is
not possible to remove information without replacing it, and
we do not have access to the image generating process, we
have to use an approximate removal operator [17]. A com-
mon approach is to use a mask based operator Φ, which
computes a weighted average between the image x and a
reference image r, using a mask mcT ∈ [0, 1]3×H×W :

ecT = Φ(x, mcT ) = x · mcT + (1 − mcT ) · r.

(1)

Common choices for the reference image are constant
values (e.g. zero), a blurred version of the original im-
age, Gaussian noise, or sampled references of a generative
model [17, 14, 6, 11].
In this work, we take a zero im-
age as reference. In our opinion, this reference produces
the most pleasing visual explanations, since irrelevant im-
age areas are set to zero2 (Fig. 1) and not replaced by other
structures. In addition, the zero image (and random image)
carry comparatively little information and lead to a model
prediction with a high entropy. Other references, such as a
blurred version of the image, usually result in lower predic-
tion entropies, as shown in Sec. A3.1. Due to the additional
computational effort, we have not considered model-based
references as proposed in Chang et al. [6].
In addition, a similarity metric ϕ(ycT

e ) is needed,
which measures the consistency of the model output gen-
erated by the explanation ycT
and the output of the image
e
ycT
x with respect to a target class cT . This similarity met-
ric should be small if the explanation preserves the output
of the target class and large if the explanation manages to
signiﬁcantly drop the probability of the target class [17].
Typical choices for the metric are the cross-entropy with
the class cT as a hard target [24] or the negative softmax
score of the target class cT . The similarity metric ensures
that the explanation remains faithful to the model and thus
accurately explains the function of the model, this property
is a major advantage of PBMs.

x , ycT

Using the mask based deﬁnition of an explanation with
a zero image as reference (r = 0) as well as the similarity
metric, a preserving explanation can be computed by:

cT = m∗
e∗
cT · x,
cT = arg min

m∗

{ϕ(ycT

x , ycT

e ) + λ · kmcT k1}.

(2)

mcT

We will refer to the optimization in Eq. 2 as the preserva-
tion game. Masks (Fig. 2 / b2)3 generated by this game are
sparse (i.e. many pixels are zero / appear black; enforced by
minimizing kmcT k1) and only contain large values at most
important pixels. The corresponding explanation is com-
puted by multiplying the mask with the image (Fig. 2 / c2).

2Tensors x, e, r are assumed to be normalized according to the train-
ing of the CNN. A value of zero for these thus corresponds to a grey color
(i.e. the color of the data mean).

3Fig. 2 / b2: Figure 2, column b, 2nd row

9099

Figure 2: Visualization types calculated for VGG using deletion / preservation game. For the repression / generation game the
same characteristics hold. Subscript cT ommited to ease readability. a) Input image. b) Mask obtained by the optimization.
Colors in a deletion mask are complementary to the image colors. c) Explanation directly obtained by the optimization.
d) Complementary mask with a true-color representation for the deletion game. e) Explanation highlighting the important
evidence for the deletion game. f) Mean mask: mask / comp. mask averaged over colors. — To underline important evidence,
we use e for the explanation of the preservation / generation game and ˜e for the deletion / repression game.

Alternatively, we can compute a deleting explanation using:

e∗
cT = m∗
cT · x,
cT = arg max

m∗

{ϕ(ycT

x , ycT

e ) + λ · kmcT k1}.

(3)

mcT

cT = (1 − m∗

This optimization will be called deletion game hencefor-
ward. Masks (Fig. 2 / b1) generated by this game contain
mainly ones (i.e. appear white; enforced by maximizing
kmcT k1 in Eq. 3) and only small entries at pixels, which
provide the most prominent evidence for the target class.
The colors in a mask of the deletion game are comple-
mentary to the image colors. To obtain a true-color rep-
resentation analogous to the preservation game, one can al-
ternatively visualize the complementary mask (Fig. 2 / d1):
cT ). A resulting explanation of the deletion
˜m∗
game, as deﬁned in Eq. 3, is visualized in Fig. 2 / c1. This
explanation is visually very similar to the original image as
only a few pixels need to be deleted to change the model
output. In the remaining of the paper for better visualiza-
tion, we depict a modiﬁed version of the explanation for the
cT ). This explanation has
deletion game: ˜e∗
the same properties as the one of the preservation game, i.e.
it only highlights the important evidence. We observe that
the deletion game generally produces sparser explanations
compared to the preservation game, as less pixels have to
be removed to delete evidence for a class than to maintain
evidence by preserving pixels.

cT = x · (1 − m∗

To solve the optimization in Eq. 2 and Eq. 3, we uti-
lize Stochastic Gradient Descent and start with an expla-
nation e0
cT = 1 · x identical to the original image (i.e. a
mask initialized with ones). As an alternative initialization
of the masks, we additionally explore a zero initialization
m0
cT = 0. In this setting the initial explanation contains

no evidence towards any class and the optimization itera-
tively has to add relevant (generation game) or irrelevant,
not supporting the class cT , information (repression game).
The visualizations of the generation game are equivalent to
those of the preservation game, the same holds for the dele-
tion and repression game. In our experiments the deletion
game produces the most ﬁne-grained and visually pleasing
explanations. Compared to the other games it usually needs
the least amount of optimization iterations since we start
with m0
cT = 1 and comparatively few mask values have to
be changed to delete the evidence for the target class. A
comparison and additional characteristics of the four opti-
mization settings (i.e. games) are included in Sec. A3.5.

3.2. Defending against Adversarial Evidence

CNNs have been proven susceptible to adversarial im-
ages [45, 19, 27], i.e. a perturbed version of a correctly
classiﬁed image crafted to fool a CNN. Due to the com-
putational similarity of adversarial methods and optimiza-
tion based visual explanation approaches, adversarial noise
is also a concern for the latter methods and one has to en-
sure that an explanation is based on true evidence present
in the image and not on false adversarial evidence intro-
duced during optimization. This is particularly true for the
generation/repression game as their optimization start with
m0

cT = 0 and iteratively adds information.
[17] and [11] showed the vulnerability of optimization
based explanation methods to adversarial noise. To avoid
adversarial evidence, explanation methods use stochastic
operations [17], additional regularizations [17, 11], opti-
mize on a low-resolution mask with upsampling of the com-
puted mask [17, 14, 6], or utilize a regularizing surrogate

9100

applied in network pruning [22]). To solve the optimiza-
tion with subject to Eq. 4, one could incorporate the con-
straints via a penalty function in the optimization loss. The
drawback is one additional hyperparameter. Alternatively,
one could add an additional layer ¯hl
i after each nonlinearity
which ensures the validity of Eq. 4:

¯hl
i(ecT ) = min(bu, max(bl, hl

i(ecT ))),

bu = max(0, hl
bl = min(0, hl

i(x)),
i(x)),

(5)

where hl
i(ecT ) is the actual activation of the original
nonlinearity-layer and ¯hl
i(ecT ) the adjusted activation af-
ter ensuring the bounds bu, bl of the original input. For
instance, for a ReLU nonlinearity, the upper bound bu is
equal to hl
i(x) and the lower bound bl is zero. We are not
applying this method as it changes the architecture of the
model which we try to explain. Instead, we clip gradients
in the backward pass of the optimization, which lead to a
violation of Eq. 4. This is equivalent to adding an addi-
tional clipping-layer after each nonlinearity which acts as
the identity in the forward pass and uses the gradient up-
date of Eq. 5 in the backward pass. When backpropagating
an error-signal ¯γl
i through the clipping-layer, the gradient
update rule for the resulting error γl

i is deﬁned by:

γl
i = ¯γl

i · [hl

i(ecT ) ≤ bu] · [hl

i(ecT ) ≥ bl],

(6)

where [ · ] is the indicator function and bl, bu the bounds
computed in Eq. 5. This clipping only affects the gradi-
ents of the similarity metric ϕ(· , ·) which are propagated
through the network. The proposed gradient clipping does
not add hyperparameters and keeps the original structure
of the model during the forward pass. Compared to other
adversarial defense techniques ([11], [17], [6]), it imposes
no constraint on the explanation (e.g. resolution/smoothness
constraints), enabling ﬁne-grained explanations.

Validating the Adversarial Defense. To evaluate the
performance of our defense, we compute an explanation for
a class cA for which there is no evidence in the image (i.e.
it is visually not present). We approximate cA with the
least-likely class cll considering only images which yield
very high predictive conﬁdence for the true class p(ctrue) ≥
0.995. Using cll as the target class, the resulting explanation
method without defense is similar to an adversarial attack
(the Iterative Least-Likely Class Method [27]).

A correct explanation for the adversarial class cA should
be “empty” (i.e. grey), as seen in Fig. 3 b, top row, when
using our adversarial defense.
If, on the other hand, the
explanation method is susceptible to adversarial noise, the
optimization procedure should be able to perfectly generate
an explanation for any class. This behavior can be seen in
Fig. 3 c, top row. The shown explanation for the adversarial

9101

Figure 3: Explanations computed for the adversarial class
limousine and the predicted class agama using the genera-
tion game and VGG16 with and without our adversarial de-
fense. An adversarial for class limousine can only be com-
puted without the defense. d) Mean mask enhanced by a
factor of 7 to show small adversarial structures.

model [11]. In general, these operations impede the gener-
ation of adversarial noise by obscuring the gradient direc-
tion in which the model is susceptible to false evidence, or
by constraining the search space for potential adversarials.
These techniques help to reduce adversarial evidence, but
also introduce new drawbacks: 1) Defense capabilities usu-
ally depend on human-tuned parameters; 2) Explanations
are limited to being low resolution and/or smooth, which
prevents ﬁne-grained evidence from being visualized.

A novel Adversarial Defense. To overcome these draw-
backs, we propose a novel adversarial defense which ﬁlters
gradients during backpropagation in a targeted way. The
basic idea of our approach is: A neuron within a CNN is
only allowed to be activated by the explanation ecT if the
same neuron was also activated by the original image x.
If we regard neurons as indicators for the existence of fea-
tures (e.g. edges, object parts, . . . ), the proposed constraint
enforces that the explanation ecT can only contain features
which exist at the same location in the original image x. By
ensuring that the allowed features in ecT are a subset of the
features in x it prevents the generation of new evidence.

This defense technique can be integrated in the intro-
duced explanation methods via an optimization constraint:

(0 ≤ hl

0 ≥ hl

i(ecT ) ≤ hl
i(ecT ) ≥ hl

i(x),
i(x),

i(x) ≥ 0,

if hl
otherwise,

(4)

where hl
i is the activation of the i-th neuron in the l-th layer
of the network after the nonlinearity. For brevity, the in-
dex i references one speciﬁc feature at one spatial position
in the activation map. This constraint is applied after all
nonlinearity-layers (e.g. ReLU-Layers) of the network, be-
sides the ﬁnal classiﬁcation layer. It ensures that the abso-
lute value of activations can only be reduced towards val-
ues representing lower information content (we assume that
zero activations have the lowest information as commonly

Model

No Defense Defended

VGG16 [39]
AlexNet [26]
ResNet50 [23]
GoogleNet [44]

100.0 %
100.0 %
100.0 %
100.0 %

0.2 %
0.0 %
0.0 %
0.0 %

Table 1: Ratio how often an adversarial class cA was gen-
erated, using the generation game with no sparsity loss on
VGG16 with and without our defense.

class (cA: limousine) contains primarily artiﬁcial structures
and is classiﬁed with a probability of 1 as limousine.

We also depict the explanation of the predicted class
(cpred: agama). The explanation with our defense results
in a meaningful representation of the agama (Fig. 3 b, bot-
tom row); without defense (Fig. 3 c / d, bottom row) it is
much more sparse. As there is no constraint to change pixel
values arbitrarily, we assume the algorithm introduces addi-
tional structures to produce a sparse explanation.

A quantitative evaluation of the proposed defense is re-
ported in Tab. 1. We generate explanations for 1000 ran-
dom ImageNet validation images and use a class cA as the
explanation target4. To ease the generation of adversarial
examples, we set the sparsity loss to zero and only use the
similarity metric which tries to maximize the probability of
the target class cA. Without an employed defense technique,
the optimization is able to generate an adversarial explana-
tion for 100% of the images. Applying our defense (Eq. 6),
the optimization nearly never was able to do so. The two
adverarial examples generated in VGG16 have a low conﬁ-
dence, so we assume that there has been some evidence for
the chosen class cA in the image. Our proposed technique
is thus well suited to defend against adversarial evidence.

4. Qualitative Results

Implementation details are stated in Sec. A2.

4.1. Interpretability

Comparison of methods. Using the deletion game we
compute mean explanation masks for GoogleNet and com-
pare these in Fig. 5 with state-of-the-art methods. Our
method delivers the most ﬁne-grained explanation by delet-
ing important pixels of the target object. Especially expla-
nations b), f), and g) are coarser and, therefore, tend to in-
clude background information not necessary to be deleted
to change the original prediction. The majority of pixels
highlighted by FGVis form edges of the object. This cannot
be seen in other methods. The explanations from c) and d)
are most similar to ours. However, our masks are computed
to directly produce explanations which are viable network

4For cA we used the least-likely class, as described before. We use the
second least-likely class, if the least-likely class coincidentally matches the
predicted class for the zero image.

inputs and are, therefore, veriﬁable — The deletion of the
highlighted pixels prevents the model from correctly pre-
dicting the object. This statement does not necessarily hold
for explanations calculated with methods c) and d).

Architectural insights. As ﬁrst noted in [31] explana-
tions using backpropagation based approaches show a grid-
like pattern for ResNet. In general, [31] demonstrate that
the network structure inﬂuences the visualization and as-
sume that for ResNet the skip connections play an impor-
tant role in their explanation behavior. As shown in Fig 6
this pattern is also visible in our explanations to an even
ﬁner degree. Interestingly, the grid pattern is also visible to
a lesser extent outside the object. A detailed investigation
of this phenomenon is left for future research. See A3.4 for
a comparison of explanations between models.

4.2. Class Discriminative / Fine Grained

Visual explanation methods should be able to produce
class discriminative (i.e. focus on one object) and ﬁne-
grained explanations [35]. To test FGVis with respect to
these properties, we generate explanations for images con-
taining two objects. The objects are chosen from highly
different categories to ensure little overlapping evidence. In
Fig. 4, we visualize explanations of three such images, com-
puted using the deletion game and GoogleNet. Additional
results can be found in Sec. A3.2.

FGVis is able to generate class discriminative explana-
tions and only highlights pixels of the chosen target class.
Even partially overlapping objects, as the elkhound and ball
in Fig. 4, ﬁrst row, or the bridge and schooner in Fig. 4,

Figure 4: Explanation masks for images with multiple ob-
jects computed using the deletion game and GoogleNet.
FGVis produces class discriminating explanations, even
when objects partially overlap. Additionally, FGVis is able
to visualize ﬁne-grained details down to the pixel level.

9102

Figure 5: Comparison of mean explanation masks: a) Image, b) BBMP [17], c) Gradient [38], d) Guided Backprop [42] ,
e) Contrastive Excitation Backprop [49], f) Grad-CAM [35], g) Occlusion [48], h) FGVis (ours). The masks of all reference
methods are based on work by [17]. Due to our detailed and sparse masks, we plot them in a larger size.

Figure 6: Visual explanations computed using the deletion
game for ResNet50. The masks (b, d) show a grid-like pat-
tern, as also observed in [31] for ResNet50.

third row, are correctly discriminated. One major advantage
of FGVis is its ability to visualize ﬁne-grained details. This
property is especially visible in Fig 4, second row, which
shows an explanation for the target class fence. Despite the
ﬁne structure of the fence, FGVis is able to compute a pre-
cise explanation which mainly contains fence pixels.

4.3. Investigating Biases of Training Data

An application of explanation methods is to identify a
bias in the training data. Especially for safety-critical, high-
risk domains (e.g. autonomous driving), such a bias can lead
to failures if the model does not generalize to the real world.
Learned objects. One common bias is the coexistence
of objects in images which can be depicted using FGVis. In
Sec. A3.3, we describe such a bias in ImageNet for sports
equipment appearing in combination with players.

Learned color. Objects are often biased towards spe-
ciﬁc colors. FGVis can give a ﬁrst visual indication for the
importance of different color channels. We investigate if a
VGG16 model trained on ImageNet shows such a bias us-
ing the preservation game. We focus on images of school

buses and minivans and compare explanations (Fig. 7; all
correctly predicted images in Fig. A6 and A8). Explana-
tions of minivans focus on edges, not consistently preserv-
ing the color compared to school buses with yellow domi-
nating those explanations. This is a ﬁrst indication for the
importance of color for the prediction of school buses.

To verify the qualitative ﬁnding, we quantitatively give
an estimation of the color bias. As an evaluation we swap
each of the three color channels BGR to either RBG or GRB
and calculate the ratio of maintained true classiﬁcations on
the validation data after the swap. For minivans 83.3% (av-
eraged over RBG and GRB) of the 21 correctly classiﬁed im-
ages keep their class label, for school buses it is only 8.3%
of 42 images. For 80 ImageNet classes at least 75% of im-
ages are no longer truly classiﬁed after the color swap. We
show the results for the most and least affected 19 classes
and minivan / school bus in Tab. A3.
To the best of our knowledge, FGVis is the ﬁrst method used
to highlight color channel importance.

5. Quantitative Results

5.1. Faithfulness of Explanations

The faithfulness of generated visual explanations to the
underlying neural network is an important property of ex-
planation methods [35]. To quantitatively compare the
faithfulness of methods, Petsiuk et al. [32] proposed causal
metrics which do not depend on human labels. These met-
rics are not biased towards human perception and are thus
well suited to verify if an explanation correctly represents
the evidence on which a model bases its prediction.

We use the deletion metric [32] to evaluate the faith-

9103

Figure 7: Explanations computed using the preservation
game for VGG16. Explanations of the class minivan focus
on edges, hardly preserving the color, compared to the class
school bus, with yellow dominating the explanations.

fulnes of explanations generated by our method. This met-
ric measures how the removal of evidence effects the pre-
diction of the used model. The metric assumes that an im-
portance map is given, which ranks all image pixels with
respect to their evidence for the predicted class cml. By iter-
atively removing important pixels from the input image and
measuring the resulting probability of the class cml a dele-
tion curve can be generated, whose area under the curve
AUC is used as a measure of faithfulness (Sec. A4.1).

In Tab. 2, we report the deletion metric of FGVis, com-
puted on the validation split of ImageNet using different
models. We use the deletion game to generate masks mml,
which determine the importance of each pixel. A detailed
description of the experiment settings as well as additional
ﬁgures, can be found in Sec. A4.1. FGVis outperforms the
other explanation methods on both models by a large mar-
gin. This performance increase can be attributed to the abil-
ity of FGVis to visualize ﬁne-grained evidence. All other
approaches are limited to coarse explanations, either due
to computational constraints or due to the used measures
to avoid adversarial evidence. The difference between the
two model architectures can most likely be attributed to the
superior performance of ResNet50, resulting in on average
higher softmax scores over all validation images.

Method

ResNet50

Grad-Cam [35]

Sliding Window [48]

LIME[33]
RISE [32]

FGVis (ours)

0.1232
0.1421
0.1217
0.1076
0.0644

VGG16
0.1087
0.1158
0.1014
0.0980
0.0636

Table 2: Deletion metric computed on the ImageNet vali-
dation dataset (lower is better). The results for all reference
methods were taken from Petsiuk et al. [32].

5.2. Visual explanation for medical images

We evaluate FGVis on a real-world use case to identify
regions in eye fundus images which lead a CNN to classify

the image as being affected with referable diabetic retinopa-
thy (RDR). Using the deletion game we derive a weakly-
supervised approach to detect RDR lesions. The setup, used
network, as well as details on the disease and training data
are described in A4.2. To evaluate FGVis, the DiaretDB1
dataset [25] is used containing 89 fundus images with dif-
ferent lesion types, ground truth marked by four experts. To
quantitatively judge the performance, we compare in Tab. 3
the image level sensitivity of detecting if a certain lesion
type is present in an image. The methods [54, 28, 21, 29]
use supervised approaches on image level without reporting
a localization. [51] propose an unsupervised approach to
extract salient regions. [18] use a comparable setting to ours
applying CAM [53] in a weakly-supervised way to high-
light important regions. To decide if a lesion is detected,
[18] suggest an overlap of 50% between proposed regions
and ground truth. As our explanation masks are ﬁne-grained
and the ground truth is coarse, we compare using a 25%
overlap and for completeness report a 50% overlap.

It is remarkable that FGVis performs comparable or out-
performs fully supervised approaches which are designed
to detect the presence of one lesion type. The strength of
FGVis is especially visible in detecting RSD, as these small
lesions only cover some pixels in the image. In Fig. A21 we
show fundus images, ground truth and our predictions.

Method

Zhou et al.[54]
Liu et al.[28]
Haloi et al.[21]
Mane et al.[29]
Zhao et al. [51]
Gondal et al.[18]

Ours (25% Overlap)
Ours (50% Overlap)

H

94.4

-

-

98.1
97.2
100
90.5

HE

-

83.0
96.5

-
-

93.3
94.7
81.6

SE
-

83.0

-
-
-

81.8
90.0
80.0

RSD

-
-

96.4

50
88.4
86.0

Table 3: Image level sensitivity in % (higher is better) for
four different lesions H, HE, SE, RSD: Hemorrhages, Hard
Exudates, Soft Exudates and Red Small Dots.

6. Conclusion

We propose a method which generates ﬁne-grained vi-
sual explanations in the image space using on a novel tech-
nique to defend adversarial evidence. Our defense does not
introduce hyperparameters. We show the effectivity of the
defense on different models, compare our explanations to
other methods, and quantitatively evaluate the faithfulness.
Moreover, we underline the strength in producing class dis-
criminative visualizations and point to characteristics in ex-
planations of a ResNet50. Due to the ﬁne-grained nature of
our explanations, we achieve remarkable results on a medi-
cal dataset. Besides, we show the usability of our approach
to visually indicate a color bias in training data.

9104

References

[1] Julius Adebayo, Justin Gilmer, Ian Goodfellow, and Been
Kim. Local explanation methods for deep neural networks
lack sensitivity to parameter values. In Workshop at the In-
ternational Conference on Learning Representations (ICLR),
2018. 2

[2] Ankita Agrawal, Charul Bhatnagar, and Anand Singh Jalal.
A survey on automated microaneurysm detection in dia-
betic retinopathy retinal images. In International Conference
on Information Systems and Computer Networks (ISCON),
pages 24–29. IEEE, 2013. 10

[3] R. Arunkumar and P. Karthigaikumar. Multi-retinal dis-
ease classiﬁcation by reduced deep learning features. Neural
Computing and Applications, 28(2):329–334, 2017. 10

[4] Sebastian Bach, Alexander Binder, Gr´egoire Montavon,
Frederick Klauschen, Klaus-Robert M¨uller, and Wojciech
Samek. On pixel-wise explanations for non-linear classi-
ﬁer decisions by layer-wise relevance propagation. PloS one,
10(7):e0130140, 2015. 2

[5] David Baehrens, Timon Schroeter, Stefan Harmeling, Mo-
toaki Kawanabe, Katja Hansen, and Klaus-Robert M¨uller.
How to explain individual classiﬁcation decisions. Journal
of Machine Learning Research, 11(Jun):1803–1831, 2010. 2

[6] Chun-Hao Chang, Elliot Creager, Anna Goldenberg, and
David Duvenaud. Explaining image classiﬁers by counter-
factual generation. arXiv e-prints, page arXiv:1807.08024,
Jul 2018. 2, 3, 4, 5

[7] Aditya Chattopadhay, Anirban Sarkar, Prantik Howlader,
and Vineeth N. Balasubramanian. Grad-cam++: General-
ized gradient-based visual explanations for deep convolu-
tional networks.
In Winter Conference on Applications of
Computer Vision (WACV), pages 839–847, 2018. 2

[8] E. Colas, A. Besse, A. Orgogozo, B. Schmauch, N. Meric,
and E. Besse. Deep learning approach for diabetic retinopa-
thy screening. Acta Ophthalmologica, 94(S256), 2016. 10

[9] Marius Cordts, Mohamed Omran, Sebastian Ramos, Timo
Rehfeld, Markus Enzweiler, Rodrigo Benenson, Uwe
Franke, Stefan Roth, and Bernt Schiele. The cityscapes
dataset for semantic urban scene understanding. In Proceed-
ings of the IEEE Conference on Computer Vision and Pattern
Recognition (CVPR), pages 3213–3223, 2016. 1

[10] Jorge Cuadros and George Bresnick. EyePACS: an adapt-
able telemedicine system for diabetic retinopathy screening.
Journal of Diabetes Science and Technology, 3(3):509–516,
2009. 10

[11] Piotr Dabkowski and Yarin Gal. Real time image saliency
for black box classiﬁers. In Advances in Neural Information
Processing Systems (NIPS), pages 6967–6976, 2017. 1, 2, 3,
4, 5

[12] P. Doll´ar, C. Wojek, B. Schiele, and P. Perona. Pedestrian de-
tection: A benchmark. In Proceedings of the IEEE Confer-
ence on Computer Vision and Pattern Recognition (CVPR),
2009. 1

[13] Mengnan Du, Ninghao Liu, and Xia Hu.

Techniques
arXiv e-prints, page

for interpretable machine learning.
arXiv:1808.00033, Jul 2018. 2

[14] Mengnan Du, Ninghao Liu, Qingquan Song, and Xia Hu. To-
wards explanation of dnn-based prediction with guided fea-
ture inversion.
In Proceedings of the 24th ACM SIGKDD
International Conference on Knowledge Discovery & Data
Mining, pages 1358–1367, 2018. 2, 3, 4

[15] EyePACS. https://www.kaggle.com/c/diabetic-retinopathy-

detection. assessed on 2018-09-23, 2015. 10

[16] EyePACS. https://www.kaggle.com/c/diabetic-retinopathy-

detection/discussion/15617. assessed on 2018-09-23. 10

[17] Ruth C. Fong and Andrea Vedaldi. Interpretable explanations
of black boxes by meaningful perturbation. In Proceedings
of the IEEE International Conference on Computer Vision
(ICCV), pages 3429–3437, 2017. 1, 2, 3, 4, 5, 7

[18] Waleed M. Gondal, Jan M. K¨ohler, Ren´e Grzeszick, Ger-
not A. Fink, and Michael Hirsch. Weakly-supervised local-
ization of diabetic retinopathy lesions in retinal fundus im-
ages. In IEEE International Conference on Image Process-
ing (ICIP), pages 2069–2073, 2017. 1, 8, 10

[19] Ian Goodfellow, Jonathon Shlens, and Christian Szegedy.
Explaining and harnessing adversarial examples.
In Inter-
national Conference on Learning Representations (ICLR),
2015. 4

[20] Varun Gulshan, Lily Peng, Marc Coram, Martin C Stumpe,
Derek Wu, Arunachalam Narayanaswamy, Subhashini Venu-
gopalan, Kasumi Widner, Tom Madams, Jorge Cuadros,
et al. Development and validation of a deep learning algo-
rithm for detection of diabetic retinopathy in retinal fundus
photographs. Journal of the American Medical Association
(JAMA), 316(22):2402–2410, 2016. 1, 10

[21] Mrinal Haloi, Samarendra Dandapat, and Rohit Sinha. A
gaussian scale space approach for exudates detection, clas-
siﬁcation and severity prediction.
arXiv e-prints, page
arXiv:1505.00737, May 2015. 8

[22] Song Han, Jeff Pool, John Tran, and William Dally. Learning
both weights and connections for efﬁcient neural network. In
Advances in Neural Information Processing Systems (NIPS),
pages 1135–1143, 2015. 5

[23] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.
Deep residual learning for image recognition. In Proceed-
ings of the IEEE Conference on Computer Vision and Pattern
Recognition (CVPR), pages 770–778, 2016. 6

[24] Geoffrey Hinton, Oriol Vinyals, and Jeff Dean. Distilling
the knowledge in a neural network. arXiv e-prints, page
arXiv:1503.02531, Mar 2015. 3

[25] Tomi Kauppi, Valentina Kalesnykiene, Joni-Kristian Ka-
marainen, Lasse Lensu, Iiris Sorri, Asta Raninen, Raija
Voutilainen, Hannu Uusitalo, Heikki K¨alvi¨ainen, and Juhani
Pietil¨a. The DIARETDB1 diabetic retinopathy database and
evaluation protocol. In British Machine Vision Conference
(BMVC), pages 1–10, 2007. 8, 10

[26] Alex Krizhevsky, Ilya Sutskever, and Geoffrey E Hinton.
ImageNet classiﬁcation with deep convolutional neural net-
works. In Advances in Neural Information Processing Sys-
tems (NIPS), pages 1097–1105, 2012. 6, 1

[27] Alexey Kurakin, Ian Goodfellow, and Samy Bengio. Adver-
sarial examples in the physical world. arXiv e-prints, page
arXiv:1607.02533, Jul 2016. 4, 5

9105

[28] Qing Liu, Beiji Zou, Jie Chen, Wei Ke, Kejuan Yue, Zail-
iang Chen, and Guoying Zhao. A location-to-segmentation
strategy for automatic exudate segmentation in colour retinal
fundus images. Computerized Medical Imaging and Graph-
ics, 55:78–86, 2017. 8

[29] Vijay M Mane, Ramish B Kawadiwale, and DV Jadhav. De-
tection of red lesions in diabetic retinopathy affected fundus
images. In IEEE International Advance Computing Confer-
ence (IACC), pages 56–60, 2015. 8

[30] Rowan McAllister, Yarin Gal, Alex Kendall, Mark Van
Der Wilk, Amar Shah, Roberto Cipolla, and Adrian Vivian
Weller. Concrete problems for autonomous vehicle safety:
Advantages of Bayesian deep learning. In International Joint
Conferences on Artiﬁcial Intelligence (IJCAI), 2017. 1

[31] Weili Nie, Yang Zhang, and Ankit Patel. A theoretical ex-
planation for perplexing behaviors of backpropagation-based
visualizations. arXiv e-prints, page arXiv:1805.07039, May
2018. 6, 7

[32] Vitali Petsiuk, Abir Das, and Kate Saenko. Rise: Random-
ized input sampling for explanation of black-box models. In
British Machine Vision Conference (BMVC), 2018. 1, 2, 7,
8, 10

[33] Marco Tulio Ribeiro, Sameer Singh, and Carlos Guestrin.
Why should I trust you?: Explaining the predictions of any
classiﬁer.
In Proceedings of the 22nd ACM SIGKDD In-
ternational Conference on Knowledge Discovery and Data
Mining, pages 1135–1144, 2016. 2, 8

[34] Olga Russakovsky, Jia Deng, Hao Su, Jonathan Krause, San-
jeev Satheesh, Sean Ma, Zhiheng Huang, Andrej Karpathy,
Aditya Khosla, Michael Bernstein, Alexander C. Berg, and
ImageNet large scale visual recognition chal-
Li Fei-Fei.
lenge.
International Journal of Computer Vision (IJCV),
115(3):211–252, 2015. 1

[35] Ramprasaath R. Selvaraju, Michael Cogswell, Abhishek
Das, Ramakrishna Vedantam, Devi Parikh, and Dhruv Ba-
tra. Grad-CAM: Visual explanations from deep networks via
gradient-based localization. In Proceedings of the IEEE In-
ternational Conference on Computer Vision (ICCV), pages
618–626, 2017. 1, 2, 6, 7, 8

[36] Dasom Seo, Kanghan Oh, and Il-Seok Oh. Regional multi-
scale approach for visually pleasing explanations of deep
neural networks. arXiv e-prints, page arXiv:1807.11720, Jul
2018. 2

[37] Avanti Shrikumar, Peyton Greenside, and Anshul Kundaje.
Learning important features through propagating activation
differences. In Proceedings of the 34th International Confer-
ence on Machine Learning (ICML), pages 3145–3153, 2017.
2

[38] Karen Simonyan, Andrea Vedaldi, and Andrew Zisserman.
Deep inside convolutional networks: Visualising image clas-
siﬁcation models and saliency maps. International Confer-
ence on Learning Representations (ICLR), 2014. 2, 7

[39] Karen Simonyan and Andrew Zisserman. Very deep convo-
lutional networks for large-scale image recognition. arXiv
e-prints, page arXiv:1409.1556, Sep 2014. 6

[40] Daniel Smilkov, Nikhil Thorat, Been Kim, Fernanda Vi´egas,
and Martin Wattenberg. Smoothgrad: removing noise by

adding noise. arXiv e-prints, page arXiv:1706.03825, Jun
2017. 2

[41] Sharon D. Solomon, Emily Chew, Elia J. Duh, Lucia Sobrin,
Jennifer K. Sun, Brian L. VanderBeek, Charles C. Wykoff,
and Thomas W. Gardner. Diabetic retinopathy: a position
statement by the American diabetes association. Diabetes
care, 40(3):412–418, 2017. 10, 16

[42] Jost Tobias Springenberg, Alexey Dosovitskiy, Thomas
Brox, and Martin Riedmiller. Striving for simplicity: The
all convolutional net. In International Conference on Learn-
ing Representations (ICLR), 2015. 1, 2, 7

[43] Mukund Sundararajan, Ankur Taly, and Qiqi Yan. Axiomatic
attribution for deep networks. In Proceedings of the 34th In-
ternational Conference on Machine Learning (ICML), pages
3319–3328, 2017. 2

[44] Christian Szegedy, Wei Liu, Yangqing Jia, Pierre Sermanet,
Scott Reed, Dragomir Anguelov, Dumitru Erhan, Vincent
Vanhoucke, and Andrew Rabinovich. Going deeper with
convolutions.
In Proceedings of the IEEE Conference on
Computer Vision and Pattern Recognition (CVPR), 2015. 6
[45] Christian Szegedy, Wojciech Zaremba, Ilya Sutskever, Joan
Bruna, Dumitru Erhan, Ian Goodfellow, and Rob Fergus. In-
triguing properties of neural networks. In International Con-
ference on Learning Representations (ICLR), 2014. 4

[46] Daniel Shu Wei Ting, Carol Yim-Lui Cheung, Gilbert Lim,
Gavin Siew Wei Tan, Nguyen D Quang, Alfred Gan, Haslina
Hamzah, Renata Garcia-Franco, Ian Yew San Yeo, Shu Yen
Lee, et al. Development and validation of a deep learn-
ing system for diabetic retinopathy and related eye diseases
using retinal images from multiethnic populations with dia-
betes. Jama, 318(22):2211–2223, 2017. 10

[47] Joanne WY Yau, Sophie L. Rogers, Ryo Kawasaki,
Ecosse L. Lamoureux, Jonathan W. Kowalski, Toke Bek,
Shih-Jen Chen, Jacqueline M. Dekker, Astrid Fletcher, Jakob
Grauslund, et al. Global prevalence and major risk factors of
diabetic retinopathy. Diabetes care, 35(3):556–564, 2012.
10

[48] Matthew D. Zeiler and Rob Fergus. Visualizing and under-
standing convolutional networks. In Proceedings of the Eu-
ropean Conference on Computer Vision (ECCV), pages 818–
833, 2014. 2, 7, 8

[49] Jianming Zhang, Zhe Lin, Jonathan Brandt, Xiaohui Shen,
and Stan Sclaroff. Top-down neural attention by excitation
backprop.
In Proceedings of the European Conference on
Computer Vision (ECCV), pages 543–559, 2016. 1, 2, 7

[50] Quan-shi Zhang and Song-Chun Zhu. Visual interpretability
for deep learning: A survey. Frontiers of Information Tech-
nology & Electronic Engineering, 19(1):27–39, 2018. 2

[51] Yitian Zhao, Yalin Zheng, Yifan Zhao, Yonghuai Liu, Zhili
Chen, Peng Liu, and Jiang Liu. Uniqueness-driven saliency
analysis for automated lesion detection with applications to
retinal diseases. In International Conference on Medical Im-
age Computing and Computer-Assisted Intervention, pages
109–118. Springer, 2018. 8

[52] Bolei Zhou, Aditya Khosla, Agata Lapedriza, Aude Oliva,
and Antonio Torralba. Object Detectors Emerge in Deep
Scene CNNs. arXiv e-prints, page arXiv:1412.6856, Dec
2014. 2

9106

[53] Bolei Zhou, Aditya Khosla, Agata Lapedriza, Aude Oliva,
and Antonio Torralba. Learning deep features for discrimi-
native localization. In Proceedings of the IEEE Conference
on Computer Vision and Pattern Recognition (CVPR), pages
2921–2929, 2016. 1, 2, 8

[54] Lei Zhou, Penglin Li, Qi Yu, Yu Qiao, and Jie Yang. Au-
tomatic hemorrhage detection in color fundus images based
on gradual removal of vascular branches. In IEEE Interna-
tional Conference on Image Processing (ICIP), pages 399–
403, 2016. 8

9107

