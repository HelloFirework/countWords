Unsupervised Image Captioning

Yang Feng♯∗

Lin Ma♮†

Wei Liu♮

Jiebo Luo♯

♮Tencent AI Lab

♯University of Rochester

{yfeng23,jluo}@cs.rochester.edu

forest.linma@gmail.com

wl2223@columbia.edu

Abstract

Deep neural networks have achieved great successes on
the image captioning task. However, most of the existing
models depend heavily on paired image-sentence datasets,
which are very expensive to acquire. In this paper, we make
the ﬁrst attempt to train an image captioning model in an
unsupervised manner.
Instead of relying on manually la-
beled image-sentence pairs, our proposed model merely re-
quires an image set, a sentence corpus, and an existing vi-
sual concept detector. The sentence corpus is used to teach
the captioning model how to generate plausible sentences.
Meanwhile, the knowledge in the visual concept detector is
distilled into the captioning model to guide the model to rec-
ognize the visual concepts in an image. In order to further
encourage the generated captions to be semantically con-
sistent with the image, the image and caption are projected
into a common latent space so that they can reconstruct
each other. Given that the existing sentence corpora are
mainly designed for linguistic research and are thus with
little reference to image contents, we crawl a large-scale im-
age description corpus of two million natural sentences to
facilitate the unsupervised image captioning scenario. Ex-
perimental results show that our proposed model is able to
produce quite promising results without any caption anno-
tations.

1. Introduction

The research on image captioning has made an impres-
sive progress in the past few years. Most of the proposed
methods learn a deep neural network model to generate cap-
tions conditioned on an input image [7, 10, 13, 20, 21, 40,
41, 42]. These models are trained in a supervised learning
manner based on manually labeled image-sentence pairs, as
illustrated in Figure 1 (a). However, the acquisition of these
paired image-sentence data is a labor intensive process. The
scales of existing image captioning datasets, such as Mi-

∗This work was done while Yang Feng was a Research Intern with Ten-

cent AI Lab.

†Corresponding author.

(a)

(c)

(e)

(b)

visual
concept

images

captions

images

captions

(d)

images

captions

images

Chinese

Chinese

English

(f)

visual
concept
detector

images

captions

corpus

images

corpus

Figure 1. Conceptual differences between the existing captioning
methods: (a) supervised captioning [40], (b) novel object caption-
ing [2, 3], (c) cross-domain captioning [8, 43], (d) pivot caption-
ing [15], (e) semi-supervised captioning [9], and (f) our proposed
unsupervised captioning.

crosoft COCO [30], are relatively small compared with im-
age recognition datasets, such as ImageNet [34] and Open-
Images [25]. The image and sentence varieties within these
image captioning datasets are limited to be under 100 object
categories. As a result, it is difﬁcult for the captioning mod-
els trained on such paired image-sentence data to generalize
to images in the wild [37]. Therefore, how to relieve the de-
pendency on the paired captioning datasets and make use
of other available data annotations to well generalize image
captioning models is becoming increasingly important, and
thus warrants deep investigations.

Recently, there have been several attempts at relaxing the
reliance on paired image-sentence data for image caption-
ing training. As shown in Figure 1 (b), Hendricks et al. [3]
proposed to generate captions for novel objects, which are
not present in the paired image-caption training data but ex-
ist in image recognition datasets, e.g., ImageNet. As such,
novel object information can be introduced into the gener-

4125

ated captioning sentence without additional paired image-
sentence data. A thread of work [8, 43] proposed to trans-
fer and generalize the knowledge learned in existing paired
image-sentence datasets to a new domain, where only un-
paired data is available, as shown in Figure 1 (c). In this
way, no paired image-sentence data is needed for train-
ing a new image captioning model in the target domain.
Recently, as shown in Figure 1 (d), Gu et al. [15] pro-
posed to generate captions in a pivot language (Chinese)
and then translate the pivot language captions to the target
language (English), which requires no more paired data of
images and target language captions. Chen et al. [9] pro-
posed a semi-supervised framework for image captioning,
which uses an external text corpus, shown in Figure 1 (d),
to pre-train their image captioning model. Although these
methods have achieved improved results, a certain amount
of paired image-sentence data is indispensable for training
the image captioning models.

To the best of our knowledge, no work has explored un-
supervised image captioning, i.e., training an image cap-
tioning model without using any labeled image-sentence
pairs. Figure 1 (f) shows this new scenario, where only
one image set and one external sentence corpus are used in
an unsupervised training setting, which, if successful, can
dramatically reduce the labeling work required to create a
paired image-sentence dataset. However, it is very chal-
lenging to ﬁgure out how we can leverage the independent
image set and sentence corpus to train a reliable image cap-
tioning model.

Recently, several models, relying on only monolingual
corpora, have been proposed for unsupervised neural ma-
chine translation [4, 26]. The key idea of these methods
is to map the source and target languages into a common
space by a shared encoder with cross-lingual embeddings.
Compared with unsupervised machine translation, unsuper-
vised image captioning is even more challenging. The im-
ages and sentences reside in two modalities with signiﬁ-
cantly different characteristics. Convolutional neural net-
work (CNN) [28] usually acts as an image encoder, while
recurrent neural network (RNN) [18] is naturally suitable
for encoding sentences. Due to their different structures and
characteristics, the encoders of image and sentence cannot
be shared, as in unsupervised machine translation.

In this paper, we make the ﬁrst attempt to train im-
age captioning models without any labeled image-sentence
pairs. Speciﬁcally, three key objectives are proposed. First,
we train a language model on the sentence corpus using the
adversarial text generation method [12], which generates a
sentence conditioned on a given image feature. As illus-
trated in Figure 1 (f), we do not have the ground-truth cap-
tion of a training image in the unsupervised setting. There-
fore, we employ adversarial training [14] to generate sen-
tences such that they are indistinguishable from the sen-

tences within the corpus. Second, in order to ensure that the
generated captions contain the visual concepts in the image,
we distill [17] the knowledge provided by a visual concept
detector into the image captioning model. Speciﬁcally, a
reward will be given when a word, which corresponds to
the detected visual concepts in the image, appears in the
generated sentence. Third, to encourage the generated cap-
tions to be semantically consistent with the image, the im-
age and sentence are projected into a common latent space.
Given a projected image feature, we can decode a caption,
which can further be used to reconstruct the image feature.
Similarly, we can encode a sentence from the corpus to the
latent space feature and thereafter reconstruct the sentence.
By performing bi-directional reconstructions, the generated
sentence is forced to closely represent the semantic mean-
ing of the image, in turn improving the image captioning
model.

Moreover, we develop an image captioning model ini-
tialization pipeline to overcome the difﬁculties in training
from scratch. We ﬁrst take the concept words in a sen-
tence as input and train a concept-to-sentence model us-
ing the sentence corpus only. Next, we use the visual con-
cept detector to recognize the visual concepts present in an
image. Integrating these two components together, we are
able to generate a pseudo caption for each training image.
The pseudo image-sentence pairs are used to train a cap-
tion generation model in the standard supervised manner,
which then serves as an initialization for our image caption-
ing model.

In summary, our contributions are four-fold:
• We make the ﬁrst attempt to conduct unsupervised im-
age captioning without relying on any labeled image-
sentence pairs.

• We propose three objectives to train the image caption-

ing model.

• We propose a novel model initialization pipeline ex-
ploiting unlabeled data. By leveraging the visual con-
cept detector, we generate a pseudo caption for each
image and initialize the image captioning model using
the pseudo image-sentence pairs.

• We crawl a large-scale image description corpus con-
sisting of over two million sentences from the Web
for the unsupervised image captioning task. Our ex-
perimental results demonstrate the effectiveness of our
proposed model in producing quite promising image
captions.

2. Related Work

2.1. Image Captioning

Supervised image captioning has been extensively stud-
ied in the past few years. Most of the proposed models use
one CNN to encode an image and one RNN to generate

4126

r/f

L
S
T
M

sampled

r/f

L
S
T
M

words

r/f

L
S
T
M

a

r/f

L
S
T
M

girl

C
N
N

.
.
.

L
S
T
M

sampled
p1

L
S
T
M

<sos>

words
p2

L
S
T
M

sampled

r/f

L
S
T
M

<eos>

...

a
p3

L
S
T
M

words

.
.
.

...

girl
p4

L
S
T
M

a

adversarial

image reconstruction

Gradient Descent

adversarial
concept

image reconstruction

Policy Gradient

sentence reconstruction

Gradient Descent

Figure 2. The architecture of our unsupervised image captioning model, consisting of an image encoder, a sentence generator, and a
discriminator. A CNN encodes a given image into a feature representation, based on which the generator outputs a sentence to describe
the image. The discriminator is used to distinguish whether a caption is generated by the model or from the sentence corpus. Moreover,
the generator and discriminator are coupled in a different order to perform image and sentence reconstructions. The adversarial reward,
concept reward, and image reconstruction reward are jointly introduced to train the generator via policy gradient. Meanwhile, the generator
is also updated by gradient descent to minimize the sentence reconstruction loss. For the discriminator, its parameters are updated by the
adversarial loss and image reconstruction loss via gradient descent.

a sentence describing the image [40], respectively. These
models are trained to maximize the probability of generat-
ing the ground-truth caption conditioned on the input image.
As paired image-sentence data is expensive to collect, some
researchers tried to leverage other data available to improve
the performances of image captioning models. Anderson et
al. [2] trained an image caption model with partial super-
vision.
Incomplete training sequences are represented by
ﬁnite state automaton, which can be used to sample com-
plete sentences for training. Chen et al. [8] developed an
adversarial training procedure to leverage unpaired data in
the target domain. Although improved results have been
obtained, the novel object captioning or domain adaptation
methods still need paired image-sentence data for training.
Gu et al. [15] proposed to ﬁrst generate captions in a pivot
language and then translate the pivot language caption to
the target language. Although no image and target language
caption pairs are used, their method depends on image-pivot
pairs and a pivot-target parallel translation corpus. In con-
trast to the methods aforementioned, our proposed method
does not need any paired image-sentence data.

2.2. Unsupervised Machine Translation

Unsupervised image captioning is similar in spirit to un-
supervised machine translation, if we regard the image as
the source language.
In the unsupervised machine trans-
lation methods [4, 26, 27], the source language and target
language are mapped into a common latent space so that
the sentences of the same semantic meanings in different

languages can be well aligned and the following transla-
tion can thus be performed. However, the unsupervised im-
age captioning task is more challenging because images and
sentences reside in two modalities with signiﬁcantly differ-
ent characteristics.

3. Unsupervised Image Captioning

Unsupervised image captioning relies on a set of images
I = {I1, . . . , INi }, a set of sentences ˆS = { ˆS1, . . . , ˆSNs },
and an existing visual concept detector, where Ni and Ns
are the total numbers of images and sentences, respectively.
Please note that the sentences are obtained from an external
corpus, which is not related to the images. For simplicity,
we will omit the subscripts and use I and ˆS to represent
an image and a sentence, respectively.
In the following,
we ﬁrst describe the architecture of our image captioning
model. Afterwards, we will introduce how to perform the
training based on the given data.

3.1. The Model

As shown in Figure 2, our proposed image captioning
model consists of an image encoder, a sentence generator,
and a sentence discriminator.

Encoder. One image CNN encodes the input image into

one feature representation fim:

fim = CNN(I).

(1)

Common image encoders,

such as Inception-ResNet-

4127

v2 [36] and ResNet-50 [16], can be used here. In this paper,
we simply choose Inception-V4 [36] as the encoder.

Generator. Long short-term memory (LSTM), acting
as the generator, decodes the obtained image representation
into a natural sentence to describe the image content. At
each time-step, the LSTM outputs a probability distribution
over all the words in the vocabulary conditioned on the im-
age feature and previously generated words. The generated
word is sampled from the vocabulary according to the ob-
tained probability distribution:

x−1 = FC(fim),

xt = West, t ∈ {0 . . . n − 1},
t+1] = LSTMg(xt, hg

t ), t ∈ {−1 . . . n − 1},

[pt+1, hg

(2)

st ∼ pt, t ∈ {1 . . . n},

where FC and ∼ denote the fully-connected layer and sam-
pling operation, respectively. n is the length of the gener-
ated sentence with We denoting the word embedding ma-
trix. xt, st, hg
t , and pt are the LSTM input, a one-hot vec-
tor representation of the generated word, the LSTM hidden
state, and the probability over the dictionary at the t-th time
step, respectively. s0 and sn denote the start-of-sentence
(SOS) and end-of-sentence (EOS) tokens, respectively. hg
−1
is initialized with zero. For unsupervised image captioning,
the image is not accompanied by sentences describing its
content. Therefore, one key difference between our genera-
tor and the sentence generator in [40] is that st is sampled
from the probability distribution pt, while the LSTM in-
put word is from the ground-truth caption during training
in [40].

Discriminator. The discriminator is also implemented
as an LSTM, which tries to distinguish whether a partial
sentence is a real sentence from the corpus or is generated
by the model:

(cid:2)qt, hd

t(cid:3) = LSTMd(xt, hd

t−1), t ∈ {1 . . . n},

(3)

where hd
t is the hidden state of the LSTM. qt indicates
the probability that the generated partial sentence St =
[s1 . . . st] is regarded as real by the discriminator. Simi-
larly, given a real sentence ˆS from the corpus, the discrim-
inator outputs ˆqt, t ∈ {1, . . . , l}, where l is the length of ˆS.
ˆqt is the probability that the partial sentence with the ﬁrst t
words in ˆS is deemed as real by the discriminator.

3.2. Training

As we do not have any paired image-sentence data avail-
able, we cannot train our model in the supervised learning
manner. In this paper, we deﬁne three novel objectives to
make unsupervised image captioning possible.

3.2.1 Adversarial Caption Generation

The sentences generated by the image captioning model
need to be plausible to human readers. Such a goal is usu-
ally ensured by training a language model on a sentence
corpus. However, as discussed before, the supervised learn-
ing approaches cannot be used to train the language model
in our setting. Inspired by the recent success of the adver-
sarial text generation method [12], we employ the adversar-
ial training [14] to ensure the plausible sentence generation.
The generator takes an image feature as input and generates
one sentence conditioned on the image feature. The dis-
criminator distinguishes whether a sentence is generated by
the model or is a real sentence from the corpus. The gener-
ator tries to fool the discriminator by generating sentences
as real as possible. To achieve this goal, we give the gen-
erator a reward at each time-step and name this reward as
adversarial reward. The reward value for the t-th generated
word is the logarithm of the probability estimated by the
discriminator:

radv
t = log(qt).

(4)

By maximizing the adversarial reward, the generator gradu-
ally learns to generate plausible sentences. For the discrim-
inator, the corresponding adversarial loss is deﬁned as:

Ladv = −" 1

l

l

Xt=1

log(ˆqt) +

log(1 − qt)# .

1
n

n

Xt=1

(5)

3.2.2 Visual Concept Distillation

The adversarial reward only encourages the model to gen-
erate plausible sentences following grammar rules, which
may be irrelevant to the input image.
In order to gen-
erate relevant image captions, the captioning model must
learn to recognize the visual concepts in the image and in-
corporate such concepts in the generated sentence. There-
fore, we propose to distill the knowledge from an existing
visual concept detector into the image captioning model.
Speciﬁcally, when the image captioning model generates
a word whose corresponding visual concept is detected in
the input image, we give a reward to the generated word.
Such a reward is called a concept reward, with the reward
value indicated by the conﬁdence score of that visual con-
cept. For an image I, the visual concept detector out-
puts a set of concepts and corresponding conﬁdence scores:
C = {(c1, v1), . . . , (ci, vi), . . . , (cNc , vNc )}, where ci is the
i-th detected visual concept, vi is the corresponding conﬁ-
dence score, and Nc is the total number of detected visual
concepts. The concept reward assigned to the t-th generated
word st is given by:

rc
t =

Nc

Xi=1

I(st = ci) ∗ vi,

(6)

4128

.
.
.

L
S
T
M

sampled
p1

L
S
T
M

<sos>

words
p2

L
S
T
M

sampled

a
p3

L
S
T
M

words

girl
p4

L
S
T
M

a

...

L
S
T
M

sampled

L
S
T
M

words

L
S
T
M

a

L
S
T
M

girl

...

L
S
T
M

<eos>

.
.
.

MSE

(a)

(b)

L
S
T
M

a

L
S
T
M

man

L
S
T
M

plays

...

L
S
T
M

a

L
S
T
M

.

.
.
.

image 
feature

L
S
T
M

p1

L
S
T
M

<sos>

p2

L
S
T
M

a

p3

L
S
T
M

man

p4

L
S
T
M

plays

...

pl

L
S
T
M

.

cross entropy

Figure 3. The architectures for image reconstruction (a) and sentence reconstruction (b), respectively, with the generator and discriminator
coupled in a different order.

where I(·) is the indicator function.

3.2.3 Bi-directional Image-Sentence Reconstruction

With the adversarial training and concept reward, the cap-
tioning quality would be largely determined by the visual
concept detector because it is the only bridge between im-
ages and sentences. However, the existing visual concept
detectors can only reliably detect a limited number of object
concepts. The image captioning model should understand
more semantic concepts of the image for a better generaliza-
tion ability. To achieve this goal, we propose to project the
images and sentences into a common latent space such that
they can be used to reconstruct each other. Consequently,
the generated caption would be semantically consistent with
the image.

Image Reconstruction. The generator produces a sen-
tence conditioned on an image feature, as shown in Fig-
ure 3 (a). The sentence caption should contain the gist of
the image. Therefore, we can reconstruct the image from
the generated sentence, which can encourage the generated
captions to be semantically consistent with the image. How-
ever, one hurdle for doing so lies in that it is very difﬁcult to
generate images containing complex objects, e.g., people,
of high-resolution using current techniques [6, 23]. There-
fore, in this paper, we turn to reconstruct the image features
instead of the full image. As shown in Figure 3 (a), the
discriminator can be viewed as a sentence encoder. A fully-
connected layer is stacked on the discriminator to project
the last hidden state hd
n to the common latent space for im-
ages and sentences:

x′ = FC(hd

n),

(7)

where x′ can be further viewed as the reconstructed image
feature from the generated sentence. Therefore, we deﬁne
an additional image reconstruction loss for training the dis-
criminator:

Lim = kx−1 − x′k2
2.

(8)

It can also be observed that the generator together with the
discriminator constitutes the image reconstruction process.
Therefore, an image reconstruction reward for the genera-
tor, which is proportional to the negative reconstruction er-
ror, can be deﬁned as:

rim
t = −Lim.

(9)

Sentence Reconstruction. Similarly, as shown in Fig-
ure 3 (b), the discriminator can encode one sentence and
project it into the common latent space, which can be
viewed as one image representation related to the given sen-
tence. The generator can reconstruct the sentence based on
the obtained representation. Such a sentence reconstruction
process could also be viewed as a sentence denoising auto-
encoder [39]. Besides aligning the images and sentences in
the latent space, it also learns how to decode a sentence from
an image representation in the common space. In order to
make a reliable and robust sentence reconstruction, we add
noises to the input sentences by following [26]. The objec-
tive of the sentence reconstruction is deﬁned as the cross-
entropy loss:

Lsen = −

l

Xt=1

log(cid:0)p(st = ˆst|ˆs1, . . . , ˆst−1)(cid:1),

(10)

where ˆst is the t-th word in sentence ˆS.

3.2.4

Integration

The three objectives are jointly considered to train our im-
age captioning model. For the generator, as the word sam-
pling operation is not differentiable, we train the genera-
tor using policy gradient [35], which estimates the gradi-
ents with respect to trainable parameters given the joint re-
ward. More speciﬁcally, the joint reward consists of ad-
versarial reward, concept reward, and image reconstruction
reward. Besides the gradients estimated by policy gradient,
the sentence reconstruction loss also provides gradients for

4129

the generator via back-propagation. These two types of gra-
dients are both employed to update the generator. Let θ de-
note the trainable parameters in the generator. The gradient
with respect to θ is given by:

∇θ log(s⊤

+ λsen∇θLsen(θ)

sentence

reconstruction

{z

}

∇θL(θ) = −E


+ λimrim

s

image reconstruction

| {z }

n

n


Xt=1
Xs=t

−bt


γs( radv

s

+ λcrc
s

)

adversarial

concept

|{z}
t pt)


|{z}
|

(11)
where γ is a decay factor, and bt is the baseline reward esti-
mated using self-critic [33]. λc, λim and λsen are the hyper-
parameters controlling the weights of different terms.

For the discriminator, the adversarial and image recon-
struction losses are combined to update the parameters via
gradient descent:

LD = Ladv + λimLim.

(12)

During our training process, the generator and discriminator
are updated alternatively.

3.3. Initialization

It is challenging to adequately train our image caption-
ing model from scratch with the given unlabeled data, even
with the proposed three objectives. Therefore, we propose
an initialization pipeline to pre-train the generator and dis-
criminator.

Regarding the generator, we would like to generate a
pseudo caption for each training image, and then use the
pseudo image-caption pairs to initialize an image caption-
ing model.
Speciﬁcally, we ﬁrst build a concept dic-
tionary consisting of the object classes in the OpenIm-
ages dataset [25]. Second, we train a concept-to-sentence
(con2sen) model using the sentence corpus only. Given
a sentence, we use a one-layer LSTM to encode the con-
cept words within the sentence into a feature representation,
and use another one-layer LSTM to decode the represen-
tation into the whole sentence. Third, we detect the con-
cepts of each image by the existing visual concept detec-
tor. With the detected concepts and the concept-to-sentence
model, we are able to generate a pseudo caption for each im-
age. Fourth, we train the generator with the pseudo image-
caption pairs using the standard supervised learning method
as in [40]. Such an image captioner is named as feature-to-
sentence (feat2sen) and used to initialize the generator.

Regarding the discriminator, parameters are initialized
by training an adversarial sentence generation model on the
sentence corpus.

Cropped image of handsome young man

with labrador outdoors.

Man on a green grass with dog. Cynologist

British Shorthair cat isolated on white. Smiling 

expression, happy

Figure 4. Two images and their accompanying descriptions from
Shutterstock.

,

4. Experiments

In this section, we evaluate the effectiveness of our pro-
posed method. To quantitatively evaluate our unsupervised
captioning method, we use the images in the MSCOCO
dataset [30] as the image set (excluding the captions). The
sentence corpus is collected by crawling the image descrip-
tions from Shutterstock1. The object detection model [19]
trained on OpenImages [25] is used as the visual concept
detector. We ﬁrst introduce sentence corpus crawling and
experimental settings. Next, we present the performance
comparisons as well as the ablation studies.

4.1. Shutterstock Image Description Corpus

We collect a sentence corpus by crawling the image de-
scriptions from Shutterstock for the unsupervised image
captioning research. Shutterstock is an online stock pho-
tography website, which provides hundreds of millions of
royalty-free stock images. Each image is uploaded with a
description written by the image composer. Some images
and description samples are shown in Figure 4. We hope
the crawled image descriptions to be somewhat related to
the training images. Therefore, we directly use the name
of the eighty object categories in the MSCOCO dataset as
the search keywords. For each keyword, we download the
search results of the top one thousand pages. If the number
of pages available is less than one thousand, we will down-
load all the results. There are roughly a hundred images in
one page, resulting in 100, 000 descriptions for each object
category. After removing the sentences with less than eight
words, we collect 2, 322, 628 distinct image descriptions in
total.

4.2. Experimental Settings

Following [22], we split the MSCOCO dataset, with
113,287 images for training, 5,000 images for validation,
and the remaining 5,000 images for testing. Please note that
the training images are used to build the image set, with the
corresponding captions left unused for any training. All the
descriptions in the Shutterstock image description corpus
are tokenized by the NLTK toolbox [5]. We build a vocab-
ulary by counting all the tokenized words and removing the

1https://www.shutterstock.com

4130

bookcase, clothing, desk, person, table
back to school concept . back to school concept . back to school . back to school concept
back view of a man in a clothing and a laptop . rear view people collection . backside
young woman working on laptop in office .
young woman working on laptop at desk in cafe

concepts
con2sen
feat2sen
adv
adv + con
adv + con + im young man working on laptop at home with laptop and drink
Ours w/o init young woman working on laptop computer at home
Ours
concepts
con2sen
feat2sen
adv
adv + con
adv + con + im a small fishing boat in the middle of the sea
Ours w/o init small fishing boat tied to a tree in the sea
Ours

young man working on laptop at home office
vehicle
bangkok , thailand - june <UNK> : vehicle on the road in bangkok , thailand .
beautiful landscape with tree in the forest .
young woman sitting on a bench in park on sunny day
two wooden boat in the sea at sunset .

a boat on the coast of the sea

bowl, cat, plate, tableware
concepts
a cat in a white plate with a bowl of tableware
con2sen
the cat is sleeping on the floor .
feat2sen
white wine glass isolated on white background with clipping path
adv
adv + con
white wine in a glass on dark background
adv + con + im a plate of red wine on a dark background
Ours w/o init
Ours
concepts
con2sen
feat2sen
adv
adv + con
adv + con + im composition of fresh carrot on a plate , food
Ours w/o init
Ours

the cat is sleeping in the garden .
a black and white cat on a wooden background
bowl, food, hat
food in a bowl with a hat on a white background
portrait of a happy young couple in santa hat
happy young mother and her daughter sleeping in bed
fresh orange juice in a wicker basket on a white background

fresh organic vegetable on wooden background . healthy food
top view of a bowl of healthy food

Figure 5. The qualitative results by the unsupervised captioning methods trained with different objectives. Best viewed by zooming in.

Table 1. Performance comparisons of unsupervised captioning
methods on the test split [22] of the MSCOCO dataset.

Method

B1

B2

B3

B4 M

R

C

Ours w/o init
Ours

38.2
41.0

37.2
con2sen
feat2sen
38.7
adv
34.0
37.9
adv + con
adv + con + im 37.8

20.6
22.5

20.0
21.3
15.6
19.8
19.9

9.9
11.2

9.6
10.3
6.5
9.4
9.5

4.8
5.6

4.7
5.0
2.9
4.6
4.6

11.2
12.4

12.3
12.4
8.7
11.4
11.9

27.5
28.7

27.3
28.3
24.2
26.5
26.8

22.9
28.6

22.5
23.5
11.8
24.1
25.5

S

6.6
8.1

8.2
8.0
3.8
7.3
7.5

words with frequency lower than 40. The object category
names of the used object detection model are then merged
into the vocabulary. Finally, there are 18, 667 words in our
vocabulary, including special SOS, EOS, and an Unkown
token. We perform a further ﬁltering process by removing
the sentences containing more than 15% Unknown token.
After ﬁltering, we retain 2, 282, 444 sentences.

The LSTM hidden dimension and the shared latent
space dimension are ﬁxed to 512. The weighting hyper-
parameters are chosen to make different rewards roughly at
the same scale. Speciﬁcally, λc, λim, λsen are set to be 10,
0.2, and 1, respectively. γ is set to be 0.9. We train our
model using the Adam optimizer [24] with a learning rate
of 0.0001. During the initialization process, we minimize
the cross-entropy loss using Adam with the learning rate
0.001. When generating the captions in the test phase, we
use beam search with a beam size of 3.

We report the BLEU [31], METEOR [11], ROUGE [29],
CIDEr [38], and SPICE [1] scores computed with the coco-
caption code 2. The ground-truth captions of the images in
the test split are used for computing the evaluation metrics.

4.3. Experimental Results and Analysis

The top region of Table 1 illustrates the unsupervised
image captioning results on the test split of the MSCOCO
dataset. The captioning model obtained with the proposed
unsupervised training method achieves promising results,
with CIDEr as 28.6%. Moreover, we also report the results
of training our model from scratch (“Ours w/o init”) to ver-
ify the effect of our proposed initialization pipeline. With-

2https://github.com/tylin/coco-caption

out initialization, the CIDEr value drops to 22.9%, which
shows that the initialization pipeline can beneﬁt the model
training and thus boost image captioning performances.

Ablation Studies. The results of the ablation studies are
illustrated in the bottom region of Table 1. It can be ob-
served that “con2sen” and “feat2sen” generate reasonable
results with CIDEr as 22.5% and 23.5%, respectively. As
such, “con2sen” can be used to generate pseudo image-
caption pairs for training “feat2sen”. And “feat2sen” can
make a meaningful initialization of the generator of our cap-
tioning model.

When only the adversarial objective is introduced to train
the captioning model, “adv” alone leads to much worse re-
sults. One cause for this is due to the linguistic character-
istics of the crawled image descriptions from Shutterstock,
which is signiﬁcantly different from that of the COCO cap-
tion. Another cause is that the adversarial objective only
enforces genuine sentence generation but does not ensure
its semantic correlation with the image content. Because
of the linguistic characteristic difference, most metrics also
drop even after introducing the concept objective in “adv +
con” and further incorporating image reconstruction objec-
tive in “adv + con + im”. Although the generated sentences
of these two baselines may look plausible, the evaluation
results with respect to the COCO captions are not satisfac-
tory. However, by considering all the objectives together,
our proposed method substantially improves the captioning
performances.

Qualitative Results. Figure 5 shows some qualitative
results of unsupervised image captioning.
In the top-left
image, the object detector fails to detect the “laptop”.
So “con2sen” model says nothing about the laptop. On
the contrary, the other models successfully recognize lap-
tops and incorporate such concepts into the generated cap-
tion.
In the top-right image, only a small region of the
cat is visible. With such a small region, our full caption-
ing model recognizes that it is “a black and white
cat”. The object detector cannot provide any informa-
tion about color attribute. We are pleased to see that the
bi-directional reconstruction objective is able to guide the
captioning model to recognize and express such visual at-
tributes in the generated description sentence. In the bottom

4131

adv
adv + con
adv + con + im
Ours w/o init
Ours

s
t
p
e
c
n
o
c
 
d
e
t
a
r
e
n
e
g
 
y
l
t
c
e
r
r
o
c
 
f
o
 
r
e
b
m
u
n

1.2

1.0

0.8

0.6

0.4

0.2

0.0

0

1000

2000

3000

4000

iterations

5000

6000

7000

8000

Figure 6. The averaged number of correct concept words in each
sentence generated during the training process.

two images, “vehicle” and “hat” are detected by error,
which severely affects the results of “con2sen”. On the con-
trary, after training the captioning model with the proposed
objectives, the captioning model is able to correct such er-
rors and generate plausible captions.

Effect of Concept Reward. Figure 6 shows the av-
eraged number of correct concept words in each sentence
generated during the training process. It can be observed
that the number of “adv” drops quickly in the beginning.
The reason is that the adversarial objective is not related to
the visual concepts in the image. “Ours w/o init” continu-
ously increases from zero to about 0.6. The concept reward
consistently improves the ability of the captioning model to
recognize visual concepts. For “adv + con”, “adv + con +
im”, and “Ours”, the number is about 0.8. One reason is
that the initialization pipeline gives a good starting point.
Another possible reason is that the concept reward prevents
the captioning model from drifting towards degradation.

4.4. Performance Comparisons under the Unpaired

Captioning Setting

The performance of unsupervised captioning model may
seem unsatisfactory in terms of the evaluation metrics on the
COCO test split. This is mainly due to the different linguis-
tic characteristics between COCO captions and crawled im-
age descriptions. To further demonstrate the effectiveness
of the proposed three objectives, we compare with [15] un-
der the same unpaired captioning setting, where the COCO
captions of the training images are used but in an unpaired
manner. Speciﬁcally, we replace the crawled sentence cor-
pus with the COCO captions of the training images. All the
other settings are kept the same as the unsupervised cap-
tioning settings. A new vocabulary with 11, 311 words is
created by counting all the words in the training captions
and removing the words with frequency less than 4.

The results of unpaired image captioning are shown in
Table 2. It can be observed that the captioning model can
be consistently improved based on the unpaired data, by
including the three proposed objectives step by step. Due
to exposure bias [32], some of the captions generated by

Table 2. Performance comparisons on the test split [22] of the
MSCOCO dataset under the unpaired setting.

Method

B1

B2

B3

B4

M

Pivoting [15]
Ours w/o init
Ours

46.2
53.8
58.9

50.6
con2sen
feat2sen
51.3
55.6
adv
56.2
adv + con
adv + con + im 56.4

24.0
35.5
40.3

30.8
31.3
35.5
37.2
37.5

11.2
23.1
27.0

18.2
18.7
23.1
24.2
24.5

5.4
15.6
18.6

11.3
11.8
15.7
16.2
16.5

13.2
16.6
17.9

15.7
15.3
17.0
17.3
17.4

R

-

39.9
43.1

37.9
38.1
40.8
41.5
41.6

C

17.7
46.7
54.9

33.9
35.4
45.8
48.8
49.0

S

-

9.6
11.1

9.1
8.8
10.1
10.5
10.5

“feat2sen” are poor sentences. The adversarial objective en-
courages these generated sentences to appear genuine, re-
sulting in improved performances. With only adversarial
training, the model tends to generate sentences unrelated
to the image. This problem is mitigated by the concept
reward and thus “adv + con” leads to an even better per-
formance. By only including the image reconstruction ob-
jective, “adv + con + im” provides a minor improvement.
However, if we include the sentence reconstruction objec-
tive, our full captioning model achieves another signiﬁcant
improvement, with CIDEr value increasing from 49% to
54.9%. The reason is that the bi-directional image and sen-
tence reconstruction can further leverage the unpaired data
to encourage the generated caption to be semantically con-
sistent with the image. The proposed method obtains signif-
icantly better results than [15], which may be because that
the information in the COCO captions is more adequately
exploited in our proposed method.

5. Conclusions

In this paper, we proposed a novel method to train an
image captioning model in an unsupervised manner with-
out using any paired image-sentence data. As far as we
know, this is the ﬁrst attempt to investigate this problem.
To achieve this goal, we presented three training objectives,
which encourage that 1) the generated captions are indistin-
guishable from sentences in the corpus, 2) the image cap-
tioning model conveys the object information in the image,
and 3) the image and sentence features are aligned in the
common latent space and perform bi-directional reconstruc-
tions from each other. A large-scale image description cor-
pus consisting of over two million sentences was further
collected from Shutterstock to facilitate the unsupervised
image captioning method. The experimental results demon-
strate that the proposed method can produce quite promis-
ing results without using any labeled image-sentence pairs.
In the future, we will conduct human evaluations for unsu-
pervised image captioning.

Acknowledgement

This work is partially supported by NSF awards

1704309, 1722847, and 1813709.

4132

References

[1] Peter Anderson, Basura Fernando, Mark Johnson, and
Stephen Gould. Spice: Semantic propositional image cap-
tion evaluation. In ECCV, 2016.

[2] Peter Anderson, Stephen Gould,

and Mark Johnson.

Partially-supervised image captioning. In NeurIPS, 2018.

[3] Lisa Anne Hendricks, Subhashini Venugopalan, Marcus
Rohrbach, Raymond Mooney, Kate Saenko, Trevor Dar-
rell, Junhua Mao, Jonathan Huang, Alexander Toshev, Oana
Camburu, et al. Deep compositional captioning: Describ-
ing novel object categories without paired training data. In
CVPR, 2016.

[4] Mikel Artetxe, Gorka Labaka, Eneko Agirre,

and
Unsupervised neural machine trans-

Kyunghyun Cho.
lation. In ICLR, 2018.

[5] Steven Bird, Ewan Klein, and Edward Loper. Natural lan-
guage processing with Python: analyzing text with the natu-
ral language toolkit. O’Reilly Media, Inc., 2009.

[6] Andrew Brock, Jeff Donahue, and Karen Simonyan. Large
scale gan training for high ﬁdelity natural image synthesis.
arXiv preprint arXiv:1809.11096, 2018.

[7] Long Chen, Hanwang Zhang, Jun Xiao, Liqiang Nie, Jian
Shao, Wei Liu, and Tat-Seng Chua. Sca-cnn: Spatial and
channel-wise attention in convolutional networks for image
captioning. In CVPR, 2017.

[8] Tseng-Hung Chen, Yuan-Hong Liao, Ching-Yao Chuang,
Wan-Ting Hsu, Jianlong Fu, and Min Sun. Show, adapt and
tell: Adversarial training of cross-domain image captioner.
In ICCV, 2017.

[9] Wenhu Chen, Aurelien Lucchi, and Thomas Hofmann. A
arXiv

semi-supervised framework for image captioning.
preprint arXiv:1611.05321, 2016.

[10] Xinpeng Chen, Lin Ma, Wenhao Jiang, Jian Yao, and Wei
Liu. Regularizing rnns for caption generation by reconstruct-
ing the past with the present. In CVPR, 2018.

[11] Michael Denkowski and Alon Lavie. Meteor universal: Lan-
guage speciﬁc translation evaluation for any target language.
In Proceedings of the ninth workshop on statistical machine
translation, 2014.

[12] William Fedus,

Ian Goodfellow, and Andrew M Dai.
Maskgan: Better text generation via ﬁlling in the . In ICLR,
2018.

[13] Zhe Gan, Chuang Gan, Xiaodong He, Yunchen Pu, Kenneth
Tran, Jianfeng Gao, Lawrence Carin, and Li Deng. Seman-
tic compositional networks for visual captioning. In CVPR,
2017.

[14] Ian Goodfellow, Jean Pouget-Abadie, Mehdi Mirza, Bing
Xu, David Warde-Farley, Sherjil Ozair, Aaron Courville, and
Yoshua Bengio. Generative adversarial nets. In NIPS, 2014.

[15] Jiuxiang Gu, Shaﬁq Joty, Jianfei Cai, and Gang Wang. Un-
In ECCV,

paired image captioning by language pivoting.
2018.

[17] Geoffrey Hinton, Oriol Vinyals, and Jeff Dean. Distill-
arXiv preprint

ing the knowledge in a neural network.
arXiv:1503.02531, 2015.

[18] Sepp Hochreiter and J¨urgen Schmidhuber. Long short-term

memory. Neural computation, 1997.

[19] Jonathan Huang, Vivek Rathod, Chen Sun, Menglong Zhu,
Anoop Korattikara, Alireza Fathi, Ian Fischer, Zbigniew Wo-
jna, Yang Song, Sergio Guadarrama, et al. Speed/accuracy
trade-offs for modern convolutional object detectors.
In
CVPR, 2017.

[20] Wenhao Jiang, Lin Ma, Xinpeng Chen, Hanwang Zhang, and
Wei Liu. Learning to guide decoding for image captioning.
In AAAI, 2018.

[21] Wenhao Jiang, Lin Ma, Yu-Gang Jiang, Wei Liu, and Tong
Zhang. Recurrent fusion network for image captioning. In
ECCV, 2018.

[22] Andrej Karpathy and Li Fei-Fei. Deep visual-semantic align-

ments for generating image descriptions. In CVPR, 2015.

[23] Tero Karras, Timo Aila, Samuli Laine, and Jaakko Lehtinen.
Progressive growing of gans for improved quality, stability,
and variation. In ICLR, 2018.

[24] Diederik P Kingma and Jimmy Ba. Adam: A method for
arXiv preprint arXiv:1412.6980,

stochastic optimization.
2014.

[25] Ivan Krasin, Tom Duerig, Neil Alldrin, Vittorio Ferrari,
Sami Abu-El-Haija, Alina Kuznetsova, Hassan Rom, Jasper
Uijlings, Stefan Popov, Shahab Kamali, Matteo Malloci,
Jordi Pont-Tuset, Andreas Veit, Serge Belongie, Victor
Gomes, Abhinav Gupta, Chen Sun, Gal Chechik, David Cai,
Zheyun Feng, Dhyanesh Narayanan, and Kevin Murphy.
Openimages: A public dataset for large-scale multi-label
and multi-class image classiﬁcation. Dataset available from
https://storage.googleapis.com/openimages/web/index.html,
2017.

[26] Guillaume Lample, Ludovic Denoyer, and Marc’Aurelio
Ranzato. Unsupervised machine translation using monolin-
gual corpora only. In ICLR, 2018.

[27] Guillaume Lample, Myle Ott, Alexis Conneau, Ludovic De-
noyer, and Marc’Aurelio Ranzato. Phrase-based & neural
unsupervised machine translation. In EMNLP, 2018.

[28] Yann LeCun, L´eon Bottou, Yoshua Bengio, and Patrick
Haffner. Gradient-based learning applied to document recog-
nition. Proceedings of the IEEE, 1998.

[29] Chin-Yew Lin. Rouge: A package for automatic evaluation

of summaries. Text Summarization Branches Out, 2004.

[30] Tsung-Yi Lin, Michael Maire, Serge Belongie, James Hays,
Pietro Perona, Deva Ramanan, Piotr Doll´ar, and C Lawrence
Zitnick. Microsoft coco: Common objects in context.
In
ECCV, 2014.

[31] Kishore Papineni, Salim Roukos, Todd Ward, and Wei-Jing
Zhu. Bleu: a method for automatic evaluation of machine
translation. In ACL, 2002.

[32] Marc’Aurelio Ranzato, Sumit Chopra, Michael Auli, and
Wojciech Zaremba. Sequence level training with recurrent
neural networks. In ICLR, 2016.

[16] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.
In CVPR,

Deep residual learning for image recognition.
2016.

[33] Steven J Rennie, Etienne Marcheret, Youssef Mroueh, Jarret
Ross, and Vaibhava Goel. Self-critical sequence training for
image captioning. In CVPR, 2017.

4133

[34] Olga Russakovsky, Jia Deng, Hao Su, Jonathan Krause, San-
jeev Satheesh, Sean Ma, Zhiheng Huang, Andrej Karpathy,
Aditya Khosla, Michael Bernstein, Alexander C. Berg, and
Li Fei-Fei. Imagenet large scale visual recognition challenge.
IJCV, 2015.

[35] Richard S Sutton, David A McAllester, Satinder P Singh, and
Yishay Mansour. Policy gradient methods for reinforcement
learning with function approximation. In NIPS, 2000.

[36] Christian Szegedy, Sergey Ioffe, Vincent Vanhoucke, and
Alexander A Alemi. Inception-v4, inception-resnet and the
impact of residual connections on learning. In AAAI, 2017.

[37] Kenneth Tran, Xiaodong He, Lei Zhang, Jian Sun, Cor-
nelia Carapcea, Chris Thrasher, Chris Buehler, and Chris
Sienkiewicz. Rich image captioning in the wild. In CVPR
Workshops, 2016.

[38] Ramakrishna Vedantam, C Lawrence Zitnick, and Devi
Parikh. Cider: Consensus-based image description evalua-
tion. In CVPR, 2015.

[39] Pascal Vincent, Hugo Larochelle, Yoshua Bengio, and
Pierre-Antoine Manzagol. Extracting and composing robust
features with denoising autoencoders. In ICML, 2008.

[40] Oriol Vinyals, Alexander Toshev, Samy Bengio, and Du-
mitru Erhan. Show and tell: A neural image caption gen-
erator. In CVPR, 2015.

[41] Ting Yao, Yingwei Pan, Yehao Li, Zhaofan Qiu, and Tao
Mei. Boosting image captioning with attributes. In ICCV,
2017.

[42] Quanzeng You, Hailin Jin, Zhaowen Wang, Chen Fang, and
In

Image captioning with semantic attention.

Jiebo Luo.
CVPR, 2016.

[43] Wei Zhao, Wei Xu, Min Yang, Jianbo Ye, Zhou Zhao, Yabing
Feng, and Yu Qiao. Dual learning for cross-domain image
captioning. In CIKM, 2017.

4134

