Good News, Everyone! Context driven entity-aware captioning for news images

Ali Furkan Biten, Lluis Gomez, Marc¸al Rusi˜nol, Dimosthenis Karatzas

Computer Vision Center, UAB, Spain

{abiten, lgomez, marcal, dimos}@cvc.uab.es

Abstract

Current image captioning systems perform at a merely
descriptive level, essentially enumerating the objects in the
scene and their relations. Humans, on the contrary, inter-
pret images by integrating several sources of prior knowl-
edge of the world. In this work, we aim to take a step closer
to producing captions that offer a plausible interpretation of
the scene, by integrating such contextual information into
the captioning pipeline. For this we focus on the caption-
ing of images used to illustrate news articles. We propose a
novel captioning method that is able to leverage contextual
information provided by the text of news articles associated
with an image. Our model is able to selectively draw in-
formation from the article guided by visual cues, and to dy-
namically extend the output dictionary to out-of-vocabulary
named entities that appear in the context source. Further-
more we introduce “GoodNews”, the largest news image
captioning dataset in the literature and demonstrate state-
of-the-art results.

1. Introduction

People understand scenes by building causal models and
employing them to compose stories that explain their per-
ceptual observations [19]. This capacity of humans is asso-
ciated with intelligent behaviour. One of the cognitive tasks
in the Binet-Simon intelligence test [34] is to describe an
image. Three performance levels are deﬁned, going from
enumeration of objects in the scene, to basic description of
contents and ﬁnally interpretation, where contextual infor-
mation is drawn upon to compose an explanation of the de-
picted events.

Current image captioning systems [37, 2, 16, 31, 23, 11]
can at best perform at the description level, if not restricted
at the enumeration part, while failing to integrate any prior
world knowledge in the produced caption. Prior world
knowledge might come in the form of social, political, ge-
ographic or temporal context, behavioural cues, or previ-

Ground Truth: JoAnn Falletta leading a performance of the
Buffalo Philharmonic Orchestra at Kleinhans Music Hall.

Show & Tell [37]: A group of people standing around a table.

Ours: JoAnn Falletta performing at the Buffalo Philharmonic
Orchestra.

Figure 1: Standard approaches to image captioning cannot
properly take any contextual information into account. Our
model is capable of producing captions that include out-of-
vocabulary named entities by leveraging information from
available context knowledge.

ously built knowledge about entities such as people, places
or landmarks. In this work, we aim to take a step closer
to producing captions that offer a plausible interpretation of
the scene, by integrating such contextual information into
the captioning pipeline.

This introduces numerous new challenges. On one hand,
the context source needs to be encoded and information se-
lectively drawn from it, guided by the visual scene content.
On the other hand, explicit contextual information, typi-
cally found in the form of named entities such as proper
names, prices, locations, dates, etc, which are typically out-
of-dictionary terms or at best underrepresented in the statis-
tics of the dictionary used, need to be properly injected in
the produced natural language output.

Currently available image captioning datasets are not

112466

ﬁt for developing captioning models with the aforemen-
tioned characteristics, as they provide generic, dry, repeti-
tive and non-contextualized captions, while at the same time
there is no contextual information available for each im-
age. For the task at hand, we considered instead other image
sources, such as historical archive images or images illus-
trating newspaper articles, for which captions (i.e. descrip-
tions provided by archivists, captions provided by journal-
ists) and certain contextual information (i.e. history texts,
news articles) is readily available or can be collected with
reasonable effort.

In this work, we focus on the captioning of images used
to illustrate news articles. Newspapers are an excellent do-
main for moving towards human-like captions, as they pro-
vide readily available contextual information that can be
modelled and exploited. In this case contextual information
is provided by the text of the associated news article, along
with other metadata such as titles and keywords. At the
same time, there is readily available ground truth in the form
of the existing caption written by domain experts (journal-
ists), which is invaluable in itself. Finally, data is freely
available at a large scale online. To this end, we have put
together GoodNews the biggest news-captioning dataset in
the literature with more than 466,000 images and their re-
spective captions and associated articles.

To the best of our knowledge, generative news im-
age captioning has been scarcely explored in the litera-
ture [12, 33, 30]. Similarly to [30] we draw contextual infor-
mation about the image from the associated article. Unlike
[30] which uses world-level encoding, we encode the arti-
cle at the sentence level, as semantic similarity is easier to
establish at this granularity. In addition, we introduce an at-
tention mechanism in order to selectively draw information
from the article guided by the visual content of the image.

News articles and their respective news image cap-
tions, unlike common image captioning datasets such as
MSCOCO [21], or Flickr [29], contain a signiﬁcant amount
of named entities. Named entities1 pose serious problems to
current captioning systems that have no mechanism to deal
with out-of-vocabulary (OOV) words. This includes [30]
where named entity usage is implicitly restricted to the ones
that appear in adequate statistics in the training set. Unlike
existing approaches, we propose here an end-to-end, two-
stage process, where ﬁrst template captions are produced
in which named entities placeholders are indicated along
with their respective tags. These are subsequently substi-
tuted by selecting the best matching entities from the ar-
ticle, allowing our model to produce captions that include
out-of-vocabulary words.

The contributions of this work are as follows:
• We propose a novel captioning method, able to lever-

1Named entities are the objects that can be denoted with a proper name

such as persons, organizations, places, dates, percentages, etc. [26]

age contextual information to produce image captions
at the scene interpretation level.

• We propose a two-stage, end-to-end architecture, that
allows us to dynamically extend the output dictionary
to out-of-vocabulary named entities that appear in the
context source.

• We introduce GoodNews, the largest news image cap-
tioning dataset in the literature, comprising 466,000
image-caption pairs, along with metadata.

We compare the performance of our proposed method
against existing methods and demonstrate state-of-the-art
results. Comparative studies demonstrate the importance of
properly treating named entities, and the beneﬁts of consid-
ering contextual information. Finally, comparisons against
human performance highlight the difﬁculty of the task and
limitations of current evaluation metrics.

2. Related Work

Automatic image captioning has received increased at-
tention lately as a result of advances in both computer vision
and natural language processing stemming from deep learn-
ing [4, 5]. Latest state-of-the-art models [39, 23, 31, 2] usu-
ally follow an attention guided encoder-decoder strategy, in
which visual information is extracted from images by deep
CNNs and then natural language descriptions are generated
with RNNs. Despite the good results current state-of-the-
art models start to yield according to standard performance
evaluation metrics, automatic image captioning is still a
challenging problem. Present-day methods tend to produce
repetitive, simple sentences [9] written in a consistent style,
generally limited on enumerating or describing visual con-
tents, and not offering any deeper semantic interpretation.

The latest attempts of producing richer human-like sen-
tences, are centered in gathering new datasets that might
be representative of different writing styles. For exam-
ple, using crowd-sourcing tools to collect different styles
of captions (negative/positive, romantic, humorous, etc.)
as in [25, 13], or leveraging the usage of romance novels
to change the style of captions to story-like sentences like
in [24]. Even though gathering annotations with heteroge-
neous styles helps mitigating the repetitiveness of the out-
puts’ tone, content-wise captions remain detailed descrip-
tions of the visual content. Automatic captioning still suf-
fers from a huge semantic gap referring to the lack of cor-
relation between images and semantic concepts [33].

The particular domain of news image captioning, has
been explored in the past towards incorporating contextual
information to the produced captions. In [12] 3K news ar-
ticles were gathered from BBC News. Image captions were
then produced by either choosing the closest sentence in the
article or using a template-based linguistic method. In [33],
100K images were collected from TIME magazine, and re-
ﬁned the captioning strategy proposed by Feng et. al. [12].

212467

Closer to our work, Ramisa et. al. [30] (BreakingNews)
used pre-trained word2vec representations of the news arti-
cles concatenated with CNN visual features to feed the gen-
erative LSTM. A clear indicator of whether contextual in-
formation is correctly incorporated in such cases, is to check
to what extent the produced image captions include the cor-
rect named entities given the context. This is a challenging
task, as in most of the cases such named entities are only be-
coming available at test time. Although this is particularly
important in the case of news image captioning, to the best
of our knowledge none of the existing methods addresses
named entity inclusion, employing instead closed dictionar-
ies.

Nevertheless, the problem of dealing with named enti-
ties has been explored in generic (not context-driven) image
captioning. In [35] after gathering Instagram data, a CNN is
used to recognize celebrities and landmarks as well as visual
concepts such as water, mountain, boat, etc. Afterwards, a
conﬁdence model is used to choose whether or not to pro-
duce captions with proper names or with visual concepts.
In [22] template captions were created using named entity
tags, that were later ﬁlled by the usage of a knowledge-base
graph. The aforementioned methods require a predeﬁned
set of named entities. Unlike these methods, our approach
looks in the text while producing a caption and “attends” to
different sentences for entity extraction, which makes our
model consider the context in which the named entities ap-
pear to incorporate new, out-of-vocabulary named entities
in the produced captions.

3. The GoodNews Dataset

To assemble the GoodNews dataset, we have used the
New York Times API to retrieve the URLs of news articles
ranging from 2010 to 2018. We will provide the URLs of
the articles and the script to download images and related
metadata, also the released scripts can be used to obtain 167
years worth of news. However, for image captioning pur-
poses, we have restricted our collection to the last 8 years of
data, mainly because it covers a period when images were
widely used to illustrate news articles.
In total, we have
gathered 466, 000 images with captions, headlines and text
articles, randomly split into 424, 000 for training, 18, 000
for validation and 23, 000 for testing.

GoodNews exhibits important differences to current
benchmark datasets for generic captioning like MSCOCO,
while it is similar in nature, but about ﬁve times larger than
BreakingNews, the largest currently available dataset for
news image captioning. Key aspects are summarized in Ta-
ble 1. The GoodNews dataset, similarly to BreakingNews,
exhibits longer average caption lengths than generic cap-
tioning datasets like MSCOCO, indicating that news cap-
tions tend to be more descriptive.

GoodNews only includes a single ground truth cap-

tion per image, while MSCOCO offers 5 different ground
truth captions per image. However, GoodNews captions
were written by expert journalists, instead of being crowd-
sourced, which has implications to the style and richness of
the text.

Table 1: Comparison of captioning datasets.

MSCOCO

BreakingNews

GoodNews

Number of Samples
Average Caption Length (words)
Named Entities(Word)
Named Entities (Sentence)
Nouns
Adjectives
Verbs
Pronouns

120k
11.30
0%
0%
33.45%
27.23%
10.72%
1.23%

110k
28.09
15.66%
90.79%
55.59%
7.21%
12.57%
1.36%

466k
18.21
19.59%
95.51%
46.70%
5%
11.22%
2.54%

Named entities represent 20% of the words in the cap-
tions of GoodNews, while named entities are by design
completely absent from the captions of MSCOCO. At the
level of sentences, 95% of caption sentences and 73% of
article sentences in GoodNews contain at least one named
entity. Moreover, we observe that GoodNews has more
named entities than BreakingNews at both token level and
sentence level. Analyzing the part of speech tags, we ob-
serve that both GoodNews and BreakingNews have less
amount of adjectives but a higher amount of verbs and
signiﬁcantly higher amount of pronouns and nouns than
MSCOCO. Given the nature of news image captions, this
is expected, since they do not describe scene objects, but
rather offer a contextualized interpretation of the scene.

A key difference between our dataset and Break-
ingNews, apart from the fact that GoodNews has ﬁve times
more samples, is that our dataset includes a wider range
of events and stories since GoodNews spans a much longer
time period. On the other hand, we must point out that
BreakingNews offers a wider range of metadata as it aims
to more tasks than news image captioning.

4. Model

As illustrated in Figure 2 our model for context driven
entity-aware captioning consists of two consecutive stages.
In the ﬁrst stage, given an image and the text of the corre-
sponding news article, our model generates a template cap-
tion where placeholders are introduced to indicate the posi-
tions of named entities. In a subsequent stage our model se-
lects the right named entities to ﬁll those placeholders with
the help of an attention mechanism over the text of the news
article.

We have used SpaCy’s named entity recognizer [15] to
recognize named entities in both captions and articles of the
GoodNews dataset. We create template captions by replac-
ing the named entities with their respective tags. At the
article level, we store the named entities to be used later in

312468

Input image

CNN feature extraction

(14 × 14 × 256)

Input text

Sentence-level Global Vectors

n
o
i
t

n
e
t
t

A
h

t
i

w
N
N
R

(GloV e dim × # sentences)

Named Entity Insertion

Visual

Attention

Sentence
Attention

Figure 2: Overview of our model where we combine the visual and textual features to generate ﬁrst the template captions.
Afterwards, we ﬁll these templates with the attention values obtained over the input text. (Best viewed in color)

the named entity insertion stage (see subsection 4.3). As
an example, the caption “Albert Einstein taught in Prince-
ton University in 1921” is converted into the following tem-
plate caption: “PERSON taught in ORGANIZATION in
DATE ”. The template captions created this way comprise
the training set ground truth we use to train our models.
Our model is designed as a two-stream architecture, that
combines a visual input (the image) and a textual input (the
encoding of the news article).

Our model’s main novelty comes from the fact that it en-
codes the text article associated with each input image and
uses it as a second input stream, while employing an atten-
tion mechanism over the textual features. For encoding the
input text articles we have used the Global Vectors (GloVe)
word embedding [28] and an aggregation technique to ob-
tain the article sentence level features. The attention mecha-
nism provides our model with the ability to focus on distinct
parts (sentences) of the article at each timestep. Besides, it
makes our model end-to-end, capable of inserting the cor-
rect named entity in the template caption at each timestep
using attention, see Figure 2.

wt+1 = sof tmax(Wieot),

L = −

N

X

t=0

log(wt+1)

(1)

where We, Wie are learnable parameters, At denotes at-
tended article features, and It the attended image features.
The attended image features at timestep t are obtained as
a function of the hidden state of previous timestep and the
image features extracted using a Deep CNN model:

If = CN N (I),
It = Att(ht−1, If )

(2)

where ht−1 is the hidden state at time t − 1, I is the input
image, and If are features of the input image extracted from
a ResNet [14] network pretrained on ImageNet [32].

In the next section we describe three different article en-
coding techniques that we have used to obtain a ﬁxed size
matrix Af with the sentence level features of the input ar-
ticle. Later, we will explain in detail how we calculate the
attended article features, At, at every timestep t.

4.1. Template Caption Generation

4.2. Article Encoding Methods

For the template caption generation stage we follow
the same formulation as in state-of-the-art captioning sys-
tems [39, 23, 2] which is to produce a word at each timestep
given the previously produced word and the attended im-
age features in each step, trained with cross entropy. More
formally, we produce a sentence si := {w0, w1, ..., wN },
where wi is a one-hot vector for the ith word, as follows:

xt = We ∗ wt, where t ∈ {0, 1, ..., N − 1},

ot = LST M (concat(xt, It, At)),

Inspired by the state of the art on semantic textual sim-
ilarity tasks [3], we use a sentence level encoding to repre-
sent the news articles in our model, as domain, purpose and
context are better preserved at the sentence level.

By using a sentence level encoding, we overcome two
shortcomings associated with word level encodings. First,
encoding the article at the word granularity requires a higher
dimensional matrix which makes the models slower to train
and converge. Second, a word level encoding cannot encode
the ﬂow (or context) that sentences provide, e.g. “He gradu-
ated from Massachusetts” and “He is from Massachusetts”:

412469

With the holiday season soon upon us, you might want to order one of these coﬀee table books for a friend who loves New York:“New York: The Story of a Great City” (Andre Deutsch) taps the Museum of the City of New York’s vast archive of ephemera to capture rare views and replicas of forgotten artifacts, from instructions on what to do in an air raid to postcards and a brochure celebrating the groundbreaking for Lincoln Center.Sarah M. Henry, the museum’s deputy director and chief curator, edited this imaginatively designed volume. She embellishes the vivid photographs and other illustrations with enlightening text on topics ranging from New York in the Revolution to New York’s Finest and Bravest.As Susan Henshaw Jones, the museum’s director, wrote in the introduction, “New Yorkers continue to reinventtheir city in ways unimaginable a century ago, constantly renewing it as one of the most exciting places on earth.”  city before, this book reinvents your view of its 400-year history.And talk about reinvention! Founded in 1859, the Brooklyn Academy of Music bills itself as the oldest performing arts center in the United States. It showcased famous performers and avant garde newcomers and survived urban blight to re-emerge, originally under Harvey Lichtenstein, as the jewel in Brooklyn’s expanding cultural crown. Now, you can relive its history in “BAM: The Complete Works” (Quantuck Lane Press), edited bySteven Seraﬁn.Flanking the lavish photographs are insightful essays and proﬁles, including a history by Phillip Lopate that recalls plans for the Academy’s second home, on Lafayette Avenue: “The structure had to be massive and supple to satisfy the varied purposes envisioned for it: musical, educational, dramatic, and social.” The same could be said of the book.The exterior of the Brooklyn Academy of Music in New YorkTheexteriorofthe__ORG__in__PLACE__LSTMLSTMLSTMLSTMLSTMLSTMLSTMthe former is for MIT which is an organization while the
latter one is a state.

0 , sart

:= {sart

Formally, to obtain the sentence level features for the
ith article, Ai
=
{w0, w1, ..., wNj } is the jth sentence of article and wk is the
word vector obtained from the pre-trained GloVe model, we
have ﬁrst used a simple average of words for each sentence
of the article:

M }, where sart

1 , ..., sart

j

Aavg
fj

=

1
Nj

Nj
X

i=0

wi, where j = 0, 1, ..., M

(3)

As an alternative we have also considered the use of
a weighted average of word vectors according to their
smoothed inverse frequency because the simple average
of word vectors has huge components along semantically
meaningless directions [3]:

AwAvg

fj

=

1
Nj

Nj
X

i=0

p(wi) ∗ wi, p(w) =

a

a + tf (w)

(4)

Finally, we have explored the use of the tough-to-beat
baseline (TBB) [3], which consists in subtracting the ﬁrst
component of the PCA from the weighted average of the
article encoding since empirically the top singular vectors
of the datasets seem to roughly correspond to the syntactic
information or common words:

4.3. Named Entity Insertion

After generating the template captions, we insert named
entities according to their categories. If there are more than
one tag of PERSON, ORGANIZATION, LOCATION, etc.
in the top ranked sentence, we select the named entity in or-
der of appearance in the sentence. In order to compare our
method with standard image captioning models we came
up with there different insertion techniques, from which
two can be used with visual-only architectures (i.e. with-
out considering the article text features): Random Insertion
(RandIns) and Context-based Insertion (CtxIns). Whereas
the third one is based on an attention mechanism over the
article that guides the insertion (AttIns).

The random insertion (RandIns) offers a baseline for the
other insertion methods explored, and it consists of ran-
domly picking a named entity of the same category from the
article, for each named entity placeholder that is produced
in the template captions.

For the Context Insertion (CtxIns) we make use of a pre-
trained GloVe embedding to rank the sentences of articles
with cosine similarity according to the produced template
caption embedding and afterwards insert the named entities
on the basis of this ranking.

Finally, for our insertion by attention method (AttIns),
we use the article attention vector βt that is produced at
each timestep t of the template caption generation to insert
named entities without using any external insertion method.

AwAvg

fj

= U Γ V,

4.4. Implemention Details

X = U ∗ Γ∗ V ∗, where X is the 1st component
AT BB

fj = AwAvg

− X

f

(5)

Article Encoding with Attention: After obtaining the
article sentence level features, Af ∈ RM ×Dw , where M
is the ﬁxed sentence length and Dw is the dimension of the
word embedding, we have designed an attention mechanism
that works by multiplying the sentence level features with
an attention vector βt ∈ RM :

Af = GloV e(Ai),
At = βt ∗ Af

(6)

where given the previous timestep of the LSTM, ht−1 and
article features, Af , we learn the attention with a fully con-
nected layer:

θt = F C(ht−1, Af ),
βt = sof tmax(θt)

(7)

We coded our models in PyTorch. We have used the 5th
layer of ResNet-152 [14] for image attention and a single-
layer LSTM with dimension size 512. We re-sized each
image into 256 × 256 and then randomly cropped them to
224 × 224. We created our vocabulary by removing words
that occur less than 4 times, resulting in 35K words while
we also truncated long sentences to a maximum length of
31 words. For the article encoding, we used SpaCy’s pre-
trained GloVe embedding with dimension size of 300 and
set the maximum sentence length to 55.
In 95% of the
cases, articles have less than 55 sentences. In the case of
articles with more than 55 sentences, we encode the aver-
age representation of the rest of the sentences at the 55th
dimension. In all of our models, we used Adam [18] opti-
mizer with 0.002 learning rate with learning rate decay 0.8
after 10 epochs for every 8 epochs with dropout probability
set to 0.2. We have produced our captions with beam size
1. The code and dataset are available online2.

5. Experiments

As explained next, apart from improving the generation
of the template captions, the usage of attention enables us
to also to select the correct named entities to include on the
basis of the attention vector.

In this section we provide several experiments in order
to evaluate the quality of the image captions generated with

2https://github.com/furkanbiten/GoodNews

512470

Table 2: Results on the intermediate task of template caption generation for state-of-the-art captioning models without using
any Article Encoding (top) and for our method using different Article Encoding strategies (bottom).

Bleu-1

Bleu-2

Bleu-3

Bleu-4

Meteor

Rouge-L

CIDEr

Spice

Show Attend Tell [39]
Att2in2 [31]
Up-Down [2]
Adaptive Att [23]

Ours (Average)
Ours (Weighted Average)
Ours (TBB)

11.537%
10.536%
10.812%
7.916%

13.419%
11.898%
12.236%

5.757%
5.176%
5.201%
3.858%

6.530%
5.857%
5.817%

2.983%
2.716%
2.649%
1.941%

3.336%
3.012%
2.950%

1.711%
1.542%
1.463%
1.083%

1.869%
1.695%
1.662%

13.559%
12.962%
12.546%
12.576%

13.752%
13.645%
13.530%

20.468%
19.934%
19.424%
19.638%

20.468%
20.355%
20.353%

17.317%
16.511%
15.345%
15.928%

17.577%
17.132%
16.624%

22.864%
23.789%
23.112%
25.017%

22.699%
23.251%
22.766%

Table 3: Results on news image captioning. RandIns: Random Insertion; CtxIns: GloVe Insertion; AttIns: Insertion by
Attention; No-NE: without named entity insertion.

y
l

n
o

l
a
u
s
i
V

Show Attend Tell - No-NE
Show Attend Tell + RandIns
Att2in2 + RandIns
Up-Down + RandIns
Adaptive Att + RandIns
Show Attend Tell + CtxIns
Att2in2 + CtxIns
Up-Down + CtxIns
Adaptive Att + CtxIns

l BreakingNews* - No-NE [30]
a
u
t
x
e
T
&

Ours (Avg.) + CtxIns
Ours (Wavg.) + CtxIns
Ours (TBB) + CtxIns
Ours (Avg.) + AttIns
Ours (Wavg.) + AttIns
Ours (TBB) + AttIns

l
a
u
s
i
V

Bleu-1

Bleu-2

Bleu-3

Bleu-4

Meteor

Rouge

CIDEr

Spice

8.80%
7.37%
6.88%
6.92%
5.22%
7.63%
7.11%
7.21%
5.30%

5.06%
8.92%
7.99%
8.32%
8.63%
7.70%
8.04%

3.01%
2.94%
2.82%
2.77%
2.11%
3.03%
2.91%
2.87%
2.11%

1.70%
3.54%
3.22%
3.31%
3.45%
3.13%
3.23%

0.97%
1.34%
1.35%
1.29%
0.97%
1.39%
1.39%
1.34%
0.98%

0.60%
1.60%
1.50%
1.52%
1.57%
1.44%
1.47%

0.43%
0.70%
0.73%
0.67%
0.51%
0.73%
0.76%
0.71%
0.51%

0.31%
0.83%
0.79%
0.80%
0.81%
0.74%
0.76%

2.47%
3.77%
3.57%
3.40%
3.28%
4.14%
3.90%
3.74%
3.59%

1.66%
4.34%
4.21%
4.27%
4.23%
4.11%
4.17%

9.06%
11.15%
10.84%
10.38%
10.21%
11.88%
11.58%
11.06%
10.94%

6.38%
12.10%
11.86%
12.11%
11.72%
11.54%
11.81%

1.67%
10.03%
9.68%
8.94%
8.68%
12.15%
11.58%
11.02%
10.55%

1.28%
12.75%
12.37%
12.70%
12.70%
12.53%
12.79%

0.69%
3.48%
3.57%
3.60%
3.56%
4.03%
4.12%
3.91%
4.13%

0.49%
4.20%
4.25%
4.19%
4.20%
4.25%
4.19%

Human†- (Estimation)

14.24%

7.70%

4.76%

3.22%

10.03%

15.98%

39.58%

13.87%

*: Reported results are based on our own implementation.
†: Indicative performance, based on two subjects’ captions over a subset of 20 samples.

our model on the GoodNews dataset. First, we compare the
obtained results with the state of the art on image captioning
using standard metrics. Then we analyze the precision and
recall of our method for the speciﬁc task of named entity
insertion. Finally we provide a human evaluation study and
show some qualitative results.

As discussed extensively in the literature [8, 10, 17, 38,
6] standard evaluation metrics for image captioning have
several ﬂaws and in many cases they do not correlate with
human judgments. Although we present the results in Bleu
[27], METEOR [7], ROUGE [20], CIDEr [36] and SPICE
[1], we believe the most suitable metric for the speciﬁc sce-
nario of image captioning for news images is CIDEr. This
is because both METEOR and SPICE use synonym match-
ing and lemmatization, and named entities rarely have any
meaningful synonyms or lemmas. For Bleu and ROUGE,
every word alters the metric equally: e.g. missing a stop
word has the same impact as the lack of a named entity.
That is why we believe CIDEr, although it has its own draw-
backs, is the most informative metric to analyze our results
since it downplays the stop words and puts more importance
to the “unique” words by using a tf-idf weighting scheme.

5.1. News Image Captioning

Our pipeline for news image captioning operates at two
levels. First it produces template captions, before substitut-
ing the placeholders with named entities from the text.

Table 2 shows the results on the intermediate task of
template caption generation for state-of-the-art captioning
models without using any contextual information (“Visual
only”, i.e. ignoring the news articles), and compares them
with our method’s results using different Article Encod-
ing strategies (“Visual & Textual”). We appreciate that the
“Show, Attend and Tell” [39] model outperforms the rest of
the baselines [2, 31, 23] on the intermediate task of template
caption generation. This outcome differs from the results
obtained on other standard benchmarks for image caption-
ing like MSCOCO, where [2, 31, 23] are known to improve
over the “Show, Attend and Tell” model. We believe this
discrepancy can be explained because those architectures
are better at recognizing objects in the input image and their
relations, but when the image and its caption are loosely re-
lated at the object level, as is the case in the many of the
GoodNews samples, these models fail to capture the under-
lying semantic relationships between images and captions.

612471

(a)

(b)

(c)

(d)

GT: Sidney Crosby celebrated his goal in the second period that seemed to deﬂate Sweden.

V: Crosby of Vancouver won the Crosby in several seasons.

V+T: Crosby of Canada after scoring the winning goal in the second period.

GT: Ms Ford and her husband Erik Allen Ford in their cabin.

V: Leanne Ford and Ford in the kitchen.

V+T: Ford and Ford in their home in Echo Park.

GT: Ismail Haniya the leader of the Hamas government in Gaza in Gaza City last month.

V: Haniya left and Mahmoud Abbas in Gaza City.

V+T: Haniya the Hamas speaker leaving a meeting in Gaza City on Wednesday.

GT: Supreme Court nominee Robert Bork testifying before the Senate Judiciary Committee.

V: Bork left and the Bork Battle in GPE.

V+T: Bork the the Supreme Court director testifying before Senate on 1987.

Figure 3: Qualitative Result; V: Visual Only, V+T: Visual and Textual, GT: Ground Truth

Therefore, we have decided to use the architecture of
“Show Attend and Tell” as the basis for our own model
design. We build our two stream architecture, that com-
bines a visual input and a textual input. From Table 2, we
can see that encoding the article by simply averaging the
GloVe descriptors of its sentences achieves slightly better
scores on the intermediate task of template-based caption-
ing than the weighted average and tough-to-beat baseline
(TBB) approaches. Overall, the performance of our two-
stream (visual and textual) architecture is on par with the
baseline results in this task.

In Table 3, we produce the full ﬁnal captions for both ap-
proaches (visual only and visual+textual) by using different
strategies for the named entity insertion: random insertion
(RandIns), GloVe based context insertion (CtxIns), and in-
sertion by attention (AttIns). Our architecture consistently
outperforms the “Visual only” pipelines on every metric.
Moreover, without the two-stage formulation we introduced
(template-based and full captions), current captioning sys-
tems (see “Show Attend Tell - No-NE” in Table 3) as well
as BreakingNews [30] perform rather poorly.

Despite the fact that the proposed approach yields bet-
ter results than previous state of the art, and properly deals
with out-of-dictionary words (named entities), the overall
low results, compared with the typical results on simpler
datasets such as MSCOCO, are indicative of the complexity
of the problem and the limitations of current captioning ap-
proaches. To emphasize this aspect we provide in Table 3 an
estimation of human performance in the task of full caption
generation on the GoodNews dataset. The reported numbers
indicate the average performance of 2 subjects tasked with

creating captions for a small subset of 20 images and their
associated articles.

Finally, we provide in Figure 3 a qualitative comparison
for the best performing model of both “visual only” (Show,
Attend and Tell+CtxIns) and “visual+textual” (Avg+AttIns)
architectures. We appreciate that taking the textual content
into account results in more contextualized captions. We
also present some failure cases in which incorrect named
entities have been inserted.

5.2. Evaluation of Named Entity Insertion

Results of Table 2 represent a theoretical maximum,
since a perfect named entity insertion would give us those
same results for the full caption generation task. However,
from Table 2 results to Table 3 there is a signiﬁcant drop
ranging from 4 to 18 points in each metric. To further quan-
tify the differences between context insertion and insertion
by attention, we provide in Table 4 their precision and recall
for exact and partial match named entity insertion. In the
exact match evaluation, we only accept the insertion of the
names as true positive if they match the ground truth char-
acter by character, while on the partial match setting, we do
consider token level match as being correct (i.e. “Falletta”
is considered a true positive for the “JoAnn Falletta” entity).
In Table 4, we observe that the proposed insertion by at-
tention (“AttIns”) clearly outperforms the “CtxIns” strategy
at both exact and partial match evaluations. The use of the
proposed text attention mechanism allows us to deal with
named entity insertion in an end-to-end fashion, eliminat-
ing the need for any separate processing.

However, notice that this was not revealed by the anal-

712472

Table 4: Precision and Recall for named entity insertion.

Exact match
R

P

Partial match
P
R

Show Attend Tell + CtxIns

8.19

7.10

19.39

17.33

Ours (Avg.) + CtxIns
Ours (WAvg.) + CtxIns
Ours (TBB) + CtxIns
Ours (Avg.) + AttIns
Ours (WAvg.) + AttIns
Ours (TBB) + AttIns

8.17
7.80
7.84
9.19
8.88
9.09

7.23
6.68
6.64
8.21
7.74
7.81

19.53
19.14
19.60
21.17
21.11
21.71

17.88
17.08
17.11
19.48
19.00
19.19

ceived as better than “Show Attend and Tell + CtxIns” in
53% of the cases.
In Figure 5 we analyze the results as
a function of the degree of consensus of the evaluators for
each image. Our aim is to exclude from the analysis those
images in which there is no clear consensus about the bet-
ter caption between the evaluators. To do this we deﬁne the
degree of consensus C = 1 − min(votesv ,votesv+t)
max(votesv ,votesv+t) , where
votesv and votesv+t denote the evaluator votes for each
method. At each value of C We reject all images that have
smaller consensus. Then we report on how many samples
the majority vote was for the “visual” or “visual+textual”
method. As can be appreciated the results indicate a consis-
tent preference for the “visual+textual” variant.

Figure 4: Named entity insertion recall (blue) and number
of training samples (red) for each named entity category.

ysis of Table 3, where all insertion strategies seem to have
a similar effect. This is partly explained by the fact that
image captioning evaluation metrics fail to put any special
weight to named entities. Intuitively, humans would pre-
fer captions where the named entities are correctly inserted.
To further analyze the results of this experiment we provide
in Figure 4 the named entity insertion recall of our method
(Avg+AttIns) on each of the individual named entity tags.
We observe a correlation of the recall values with the num-
ber of training samples for each named entity category. This
suggests that the overall named entity insertion performance
can be potentially improved with more training data.

5.3. Human Evaluation

In order to provide a more fair evaluation we have con-
ducted a human evaluation study. We asked 20 human eval-
uators to compare the outputs of the best performing “visual
+ textual” model (Avg. + AttIns) with the ones of the best
performing “visual only” model (“Show Attend and Tell”
with Ctx named entity insertion) on a subset of 106 ran-
domly chosen images. Evaluators were presented an image,
its ground-truth caption, and the two captions generated by
those methods, and were asked to choose the one they con-
sidered most similar to the ground truth. In total we col-
lected 2, 101 responses.

The comparative study revealed that our model was per-

Figure 5: Comparison of “visual only” and “visual+textual”
models regarding human judgments.

6. Conclusion

In this paper we have presented a novel captioning
pipeline that aims to take a step closer to producing cap-
tions that offer a plausible interpretation of the scene, and
applied it to the particular case of news image captioning.
In addition, we presented GoodNews, a new dataset com-
prising 466K samples, the largest news-captioning dataset
to date. Our proposed pipeline integrates contextual infor-
mation, given here in the form of a news article, introduc-
ing an attention mechanism that permits the captioning sys-
tem to selectively draw information from the context source,
guided by the image. Furthermore, we proposed a two-
stage procedure implemented in an end-to-end fashion, to
incorporate named entities in the captions, speciﬁcally de-
signed to deal with out-of-dictionary entities that are only
made available at test time. Experimental results demon-
strate that the proposed method yields state-of-the-art per-
formance, while it satisfactorily incorporates named entity
information in the produced captions.

Acknowledgements

This work has been supported by projects TIN2017-89779-P,
Marie-Curie (712949 TECNIOspring PLUS), aBSINTHE (Fun-
daci´on BBVA 2017), the CERCA Programme / Generalitat de
Catalunya, NVIDIA Corporation and a UAB PhD scholarship.

812473

0.28PERSON0.11ORG0.06DATE0.14GPE0.01CARDINAL0.03NORP0.01FAC0.00LOC0.07ORDINAL0.01EVENT0.00TIME0.01PRODUCT0.00QUANTITY0.00PERCENT0.00MONEY0.00LANGUAGE410K231K206K201K79K55K39K23K22K16K14K11K4K2K2K7771.00.90.80.70.60.50.40.30.20.10.0Degree of consensus020406080100#images21313439414347485050024364044495156565656Show Attend Tell + CtxInsOurs (Avg.) + AttInsRejectedReferences

[1] Peter Anderson, Basura Fernando, Mark Johnson, and
Stephen Gould. Spice: Semantic propositional image cap-
tion evaluation.
In European Conference on Computer Vi-
sion, 2016.

[2] Peter Anderson, Xiaodong He, Chris Buehler, Damien
Teney, Mark Johnson, Stephen Gould, and Lei Zhang.
Bottom-up and top-down attention for image captioning and
VQA. arXiv preprint arXiv:1707.07998, 2017.

[3] Sanjeev Arora, Yingyu Liang, and Tengyu Ma. A simple but
tough-to-beat baseline for sentence embeddings. In Interna-
tional Conference on Learning Representations, 2017.

[4] Shuang Bai and Shan An. A survey on automatic image cap-

tion generation. Neurocomputing, 311:291–304, 2018.

[5] Raffaella Bernardi, Ruket Cakici, Desmond Elliott, Aykut
Erdem, Erkut Erdem, Nazli Ikizler-Cinbis, Frank Keller,
Adrian Muscat, and Barbara Plank. Automatic description
generation from images: A survey of models, datasets, and
evaluation measures. Journal of Artiﬁcial Intelligence Re-
search, 55:409–442, 2016.

[6] Yin Cui, Guandao Yang, Andreas Veit, Xun Huang, and
Serge Belongie. Learning to evaluate image captioning. In
IEEE Conference on Computer Vision and Pattern Recogni-
tion, 2018.

[7] Michael Denkowski and Alon Lavie. Meteor universal: Lan-
guage speciﬁc translation evaluation for any target language.
In Workshop on Statistical Machine Translation, 2014.

[8] Jacob Devlin, Hao Cheng, Hao Fang, Saurabh Gupta,
Li Deng, Xiaodong He, Geoffrey Zweig, and Margaret
Mitchell. Language models for image captioning: The quirks
and what works. arXiv preprint arXiv:1505.01809, 2015.

[9] Jacob Devlin, Saurabh Gupta, Ross Girshick, Margaret
Mitchell, and C Lawrence Zitnick.
Exploring nearest
neighbor approaches for image captioning. arXiv preprint
arXiv:1505.04467, 2015.

[10] Desmond Elliott and Frank Keller. Comparing automatic
evaluation measures for image description. In Annual Meet-
ing of the Association for Computational Linguistics, 2014.
[11] Hao Fang, Saurabh Gupta, Forrest Iandola, Rupesh K. Sri-
vastava, Li Deng, Piotr Doll´ar, Jianfeng Gao, Xiaodong He,
Margaret Mitchell, John C. Platt, C. Lawrence Zitnick, and
Geoffrey Zweig. From captions to visual concepts and back.
In IEEE Conference on Computer Vision and Pattern Recog-
nition, 2015.

[12] Yansong Feng and Mirella Lapata. Automatic caption gener-
ation for news images. IEEE Transactions on Pattern Anal-
ysis and Machine Intelligence, 35(4):797–812, 2013.

[13] Chuang Gan, Zhe Gan, Xiaodong He, Jianfeng Gao, and Li
Deng. Stylenet: Generating attractive visual captions with
styles. In IEEE Conference on Computer Vision and Pattern
Recognition, 2017.

[14] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.
Deep residual learning for image recognition. In IEEE Con-
ference on Computer Vision and Pattern Recognition, 2016.
[15] Matthew Honnibal and Ines Montani. SpaCy 2: Natural lan-
guage understanding with bloom embeddings, convolutional
neural networks and incremental parsing. 2017.

[16] Andrej Karpathy and Li Fei-Fei. Deep Visual-Semantic
Alignments for Generating Image Descriptions.
IEEE
Transactions on Pattern Analysis and Machine Intelligence,
39(4):664–676, 2017.

[17] Mert Kilickaya, Aykut Erdem, Nazli Ikizler-Cinbis, and
Erkut Erdem. Re-evaluating Automatic Metrics for Image
Captioning. 2016.

[18] Diederik P Kingma and Jimmy Ba. Adam: A method for
arXiv preprint arXiv:1412.6980,

stochastic optimization.
2014.

[19] Brenden M Lake, Tomer D Ullman, Joshua B Tenenbaum,
and Samuel J Gershman. Building machines that learn and
think like people. Behavioral and Brain Sciences, 40, 2017.
[20] Chin-Yew Lin. Rouge: A package for automatic evaluation
In ACL Workshop on Text Summarization,

of summaries.
2004.

[21] Tsung-Yi Lin, Michael Maire, Serge Belongie, James Hays,
Pietro Perona, Deva Ramanan, Piotr Doll´ar, and C Lawrence
Zitnick. Microsoft COCO: Common objects in context. In
European Conference on Computer Vision, 2014.

[22] Di Lu, Spencer Whitehead, Lifu Huang, Heng Ji, and Shih-
Fu Chang. Entity-aware image caption generation. arXiv
preprint arXiv:1804.07889, 2018.

[23] Jiasen Lu, Caiming Xiong, Devi Parikh, and Richard Socher.
Knowing when to look: Adaptive attention via a visual sen-
tinel for image captioning. In Conference on Computer Vi-
sion and Pattern Recognition, 2017.

[24] Alexander Mathews, Lexing Xie, and Xuming He. Semstyle:
Learning to generate stylised image captions using unaligned
text. In IEEE Conference on Computer Vision and Pattern
Recognition, 2018.

[25] Alexander Patrick Mathews, Lexing Xie, and Xuming He.
Senticap: Generating image descriptions with sentiments. In
Conference of the Association for the Advancement of Artiﬁ-
cial Intelligence, 2016.

[26] David Nadeau and Satoshi Sekine. A survey of named entity
recognition and classiﬁcation. Lingvisticae Investigationes,
30(1):3–26, 2007.

[27] Kishore Papineni, Salim Roukos, Todd Ward, and Wj Zhu.
BLEU: a method for automatic evaluation of machine trans-
lation. Annual Meeting on Association for Computational
Linguistics, 2002.

[28] Jeffrey Pennington, Richard Socher, and Christopher Man-
ning. Glove: Global vectors for word representation.
In
Conference on Empirical Methods in Natural Language Pro-
cessing, 2014.

[29] Bryan A Plummer, Liwei Wang, Chris M Cervantes,
Juan C Caicedo, Julia Hockenmaier, and Svetlana Lazeb-
nik. Flickr30k entities: Collecting region-to-phrase corre-
spondences for richer image-to-sentence models.
In IEEE
International Conference on Computer Vision, 2015.

[30] Arnau Ramisa, Fei Yan, Francesc Moreno-Noguer, and
Krystian Mikolajczyk. Breakingnews: Article annotation by
image and text processing.
IEEE Transactions on Pattern
Analysis and Machine Intelligence, 40(5):1072–1085, 2018.
[31] Steven J Rennie, Etienne Marcheret, Youssef Mroueh, Jarret
Ross, and Vaibhava Goel. Self-critical sequence training for

912474

image captioning.
Pattern Recognition, 2017.

In Conference on Computer Vision and

[32] Olga Russakovsky, Jia Deng, Hao Su, Jonathan Krause, San-
jeev Satheesh, Sean Ma, Zhiheng Huang, Andrej Karpathy,
Aditya Khosla, Michael Bernstein, et al.
Imagenet large
scale visual recognition challenge. International Journal of
Computer Vision, 115(3):211–252, 2015.

[33] Amara Tariq and Hassan Foroosh. A context-driven ex-
tractive framework for generating realistic image descrip-
tions. IEEE Transactions on Image Processing, 26(2):619–
632, 2017.

[34] Lewis Madison Terman. The measurement of intelligence:
An explanation of and a complete guide for the use of the
Stanford revision and extension of the Binet-Simon intelli-
gence scale. Houghton Mifﬂin, 1916.

[35] Kenneth Tran, Xiaodong He, Lei Zhang, Jian Sun, Cor-
nelia Carapcea, Chris Thrasher, Chris Buehler, and Chris
Sienkiewicz. Rich image captioning in the wild.
In IEEE
Conference on Computer Vision and Pattern Recognition
Workshops, 2016.

[36] Ramakrishna Vedantam, C Lawrence Zitnick, and Devi
Parikh. Cider: Consensus-based image description evalua-
tion. In IEEE Conference on Computer Vision and Pattern
Recognition, 2015.

[37] Oriol Vinyals, Alexander Toshev, Samy Bengio, and Du-
mitru Erhan. Show and tell: A neural image caption gen-
erator. In IEEE Conference on Computer Vision and Pattern
Recognition, 2015.

[38] Oriol Vinyals, Alexander Toshev, Samy Bengio, and Du-
mitru Erhan. Show and Tell: Lessons Learned from the 2015
MSCOCO Image Captioning Challenge. IEEE Transactions
on Pattern Analysis and Machine Intelligence, 39(4):652–
663, 2017.

[39] Kelvin Xu, Jimmy Ba, Ryan Kiros, Kyunghyun Cho,
Aaron Courville, Ruslan Salakhutdinov, Richard Zemel, and
Yoshua Bengio. Show, Attend and Tell: Neural Image Cap-
tion Generation with Visual Attention. In International Con-
ference on Machine Learning, 2015.

1012475

