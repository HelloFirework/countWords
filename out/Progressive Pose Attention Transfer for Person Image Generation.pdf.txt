Progressive Pose Attention Transfer for Person Image Generation

Zhen Zhu1∗, Tengteng Huang1∗, Baoguang Shi2, Miao Yu1, Bofei Wang3, Xiang Bai1†

1Huazhong Univ. Sci. and Tech., 2Microsoft, Redmond, 3ZTE Corporation

{zzhu, huangtengtng, xbai}@hust.edu.cn

shibaoguang@gmail.com, zealyu@qq.com, wang.bofei@zte.com.cn

Abstract

i.e.,

This paper proposes a new generative adversarial net-
work for pose transfer,
transferring the pose of a
given person to a target pose. The generator of the net-
work comprises a sequence of Pose-Attentional Transfer
Blocks that each transfers certain regions it attends to, gen-
erating the person image progressively. Compared with
those in previous works, our generated person images pos-
sess better appearance consistency and shape consistency
with the input images, thus signiﬁcantly more realistic-
looking. The efﬁcacy and efﬁciency of the proposed net-
work are validated both qualitatively and quantitatively
on Market-1501 and DeepFashion. Furthermore, the pro-
posed architecture can generate training images for per-
son re-identiﬁcation, alleviating data insufﬁciency. Codes
and models are available at: https://github.com/
tengteng95/Pose-Transfer.git.

1. Introduction

In this paper, we are interested in generating images of
non-rigid objects that often possess a large variation of de-
formation and articulation. Speciﬁcally, we focus on trans-
ferring a person from one pose to another as depicted in
Fig.1. The problem, ﬁrst introduced by [21] as pose trans-
fer, is valuable in many tasks such as video generation with
a sequence of poses [38] and data augmentation for person
re-identiﬁcation [47].

Pose transfer can be exceptionally challenging, particu-
larly when given only the partial observation of the person.
As exempliﬁed in Fig. 1, the generator needs to infer the
unobserved body parts in order to generate the target poses
and views. Adding to the challenge, images of different
poses under different views can be drastically different in
appearance. This inevitably demands the generator to cap-
ture the large variations possessed by the image distribution.

∗ Equal contribution
† Corresponding author

Condition  

image

Target poses

Generated images

Figure 1: Generated examples by our method based on different target
poses. Zoom in for better details.

Therefore, even with the strong learning capabilities of deep
neural networks, recent methods [21, 34, 22, 5] often fail to
produce robust results.

We start with the perspective that the images of all the
possible poses and views of a certain person constitute a
manifold, which is also suggested in previous works [4, 24].
To transfer pose is to go from point px on the manifold to
another point py, both indexed by their respective poses.
In this perspective, the aforementioned challenges can be
attributed to the complex structure of the manifold on the
global level. However, the structure manifold becomes sim-
pler on a local level. This transition happens when we re-
strict the variation of pose to a small range. For example, it
is hard to transfer pose from sitting to standing, but much
simpler to only raise a straight arm to a different angle.

This insight motivates us to take a progressive pose trans-
fer scheme.
In contrast to the one-step transfer scheme
adopted in many previous works [5, 34], we propose to
transfer a condition pose by transferring through a sequence
of intermediate pose representations before reaching the tar-
get. The transfer is carried out by a sequence of Pose-
Attentional Transfer Blocks (PATBs), implemented by neu-
ral networks. This scheme allows each transfer block to
perform a local transfer on the manifold, therefore avoid-
ing the challenge of capturing the complex structure of the
global manifold.

Each PATB performs the transfer in a pose-attentional

2347

F P

0

c
o
n
v

Pose-Attentional Transfer Network

F P

t−1

Block-

1

t
Block- 

F S

t−1

F P
t

F S
t

Block-

T

F P
T

d
e
c
o
n
v

Condition image Pc

Generated image

Pg

c
o
n

v F S

0

Target pose St

Condition pose Sc

F P

t−1

v
n
o
C

N
B

U
L
e
R

v
n
o
C

N
B

image pathway

·

convP

σ

F S

t−1

v
n
o
C

N
B

U
L
e
R

v
n
o
C

N
B

pose pathway

convS

F P
t

+

F S
t

k

Structure of Block-t

Figure 2: Generator architecture of the proposed method.

σ

·

+

||

Sigmoid

Element-wise multiply

Element-wise plus

Depth concatenation

manner. It takes as input the representation of both the im-
age and the pose. Inside the block, we create an attention
mechanism that infers the regions of interest based on the
human pose. As a person’s image and pose are registered,
this attention mechanism allows better selectivity in choos-
ing the image regions for transferring. The block outputs
the updated image and pose representations, so that such
blocks can be cascaded in sequence to form a PAT network
(PATN), as illustrated in Fig. 2.

The proposed network exhibits superior performance
both qualitatively and quantitatively on challenging bench-
marks, and substantially augments person dataset for person
re-identiﬁcation application. To summarize, the contribu-
tions of our paper are two folded:

1. We propose a progressive pose attention transfer net-
work to address the challenging task of pose transfer,
which is neat in design and efﬁcient in computation.

2. The proposed network leverages a novel cascaded
Pose-Attentional Transfer Blocks (PATBs) that can
effectively utilize pose and appearance features to
smoothly guide the pose transfer process.

2. Related work

Generative Adversarial Networks (GAN) [6], which are
basically composed of generator and discriminator that are
trained in an adversarial way, can usually generate sharp
images [6, 25, 30, 13, 17, 28, 12, 48, 20, 42]. Many real-
world applications demand that generated images satisfy
some condition constraints, e.g., generating images with
speciﬁc pose, viewpoint or other attributes. Conditional
generative adversarial networks (CGANs) [25] are built for
this purpose. CGANs have achieved remarkable success

in pixel-wise aligned image generation problems. Isola et
al. [12] demonstrated their good applicability for image-to-
image translation problems such as day-to-night and sketch-
to-image. However, pixel-wise alignment is not well suit-
able for pose transfer due to the deformation between the
condition and target pose.

For person image generation, Lassner et al.

[16] pre-
sented a model combining VAE [15] and GAN together to
generate images of a person with different clothes, given the
3D model of the person. Zhao et al. [44] adopted a coarse-
to-ﬁne method for generating multi-view cloth images from
[2] pre-
a single view cloth image. Balakrishnan et al.
sented a GAN network that decomposes the person image
generation task into foreground and background generation,
and then combines to form the ﬁnal image. Several works
[8, 39, 43, 31] were inspired by the virtually try-on appli-
cations and made good progress to change the clothes of a
given person while maintaining the person pose by warping
the clothes to ﬁt for the body topology of the given person.

Speciﬁcally for the pose transfer task, Ma et al. [21] pre-
sented a two-stage model to generate person images while
their coarse-to-ﬁne strategy requires relatively large com-
putational budget and complicated training procedures. Ma
et al. [22] further improved their previous work by disen-
tangling and encoding foreground, background and pose of
the input image into embedding features then decodes them
back to an image. Though the controllability of the genera-
tion process is improved, the quality of their generated im-
ages degrade. Likewise, Essner et al. [5] exploited to com-
bine VAE [15] and U-Net [12] to disentangle appearance
and pose. However, appearance features are difﬁcult to be
represented by a latent code with ﬁxed length, giving rise
to several appearance misalignments. Siarohin et al. [34]
introduced deformable skip connections that require exten-

2348

<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
k
k
7
E
R
L
z
n
0
6
0
P
H
u
z
L
Q
X
r
I
t
m
e
f
Z
C
M
=
"
>
A
A
A
B
6
n
i
c
b
Z
B
N
S
8
N
A
E
I
Y
n
9
a
v
W
r
6
h
H
L
4
t
F
6
K
k
k
X
v
R
Y
8
O
J
F
q
G
g
/
o
A
1
l
s
9
2
0
S
z
e
b
s
D
s
R
S
u
h
P
8
O
J
B
E
a
/
+
I
m
/
+
G
7
d
t
D
t
r
6
w
s
L
D
O
z
P
s
z
B
u
m
U
h
j
0
v
G
+
n
t
L
G
5
t
b
1
T
3
q
3
s
7
R
8
c
H
r
n
H
J
2
2
T
Z
J
r
x
F
k
t
k
o
r
s
h
N
V
w
K
x
V
s
o
U
P
J
u
q
j
m
N
Q
8
k
7
4
e
R
m
X
u
8
8
c
W
1
E
o
h
5
x
m
v
I
g
p
i
M
l
I
s
E
o
W
u
v
h
b
o
A
D
t
+
r
V
v
Y
X
I
O
v
g
F
V
K
F
Q
c
+
B
+
9
Y
c
J
y
2
K
u
k
E
l
q
T
M
/
3
U
g
x
y
q
l
E
w
y
W
e
V
f
m
Z
4
S
t
m
E
j
n
j
P
o
q
I
x
N
0
G
+
W
H
V
G
L
q
w
z
J
F
G
i
7
V
N
I
F
u
7
v
i
Z
z
G
x
k
z
j
0
H
b
G
F
M
d
m
t
T
Y
3
/
6
v
1
M
o
y
u
g
1
y
o
N
E
O
u
2
P
K
j
K
J
M
E
E
z
K
/
m
w
y
F
5
g
z
l
1
A
J
l
W
t
h
d
C
R
t
T
T
R
n
a
d
C
o
2
B
H
/
1
5
H
V
o
X
9
Z
9
y
/
d
e
t
V
E
r
4
i
j
D
G
Z
x
D
D
X
y
4
g
g
b
c
Q
h
N
a
w
G
A
E
z
/
A
K
b
4
5
0
X
p
x
3
5
2
P
Z
W
n
K
K
m
V
P
4
I
+
f
z
B
y
a
q
j
Z
o
=
<
/
l
a
t
e
x
i
t
>
sive afﬁne transformation computation to deal with pixel-to-
pixel misalignment caused by pose differences. And their
method is fragile to inaccurate pose disjoints, resulting in
poor performance for some rare poses. Pumarola et al. [29]
adopted a bidirectional strategy to generate person images
in a fully unsupervised manner that may induce some geo-
metric errors as pointed out in their paper.

Most of the previous pose transfer approaches adopted
keypoint-based pose representation. Besides, Neverova et
al. [27] adopted DensePose [7] as its pose representation,
which contains abundant information of depth and body
part segmentation, to produce more texture details. The ex-
pensive cost of acquiring the DensePose representation for
the target pose hinders its applicability, whereas keypoint-
based pose representation is much cheaper and more ﬂexi-
ble. Hence, we favor to keypoint-based pose representation.

3. Model

We begin with a few notations. nP j

i oj=1...M

i=1...Nj

denotes

the set of person images in a dataset, where j is person in-
dex, i is the image index of person j. M is the number of
persons, Nj is the number of images of person j. Sj
i is the
corresponding keypoint-based representation of P j
i , which
consists of a 18-channel heat map that encodes the loca-
tions of 18 joints of a human body. We adopt the Human
Pose Estimator (HPE) [3] used by [21, 22, 34] to estimate
the 18 joints for fair comparison. During training, the model
requires condition and target image (Pc, Pt) and their corre-
sponding condition and target pose heat map (Sc, St). The
generator outputs a person image, which is challenged by
the discriminators for its realness. The following describes
each in detail.

3.1.2 Pose-Attentional Transfer Network

At the core of the generator is the Pose-Attentional Trans-
fer Network (PATN), consisting of several cascaded Pose-
Attentional Transfer Blocks (PATBs). Starting from the ini-
tial image code F P
0 , PATN pro-
gressively updates these two codes through the sequence of
PATBs. At the output, the ﬁnal image code F P
T are taken
to decode the output image, while the ﬁnal pose code F S
T is
discarded.

0 and joint pose code F S

t−1 and F S

All PATBs have identical structure. A PATB carries out
one step of update. Consider the t-th block, whose inputs
are F P
t−1. As depicted in Fig. 2, the block com-
prises two pathways, called image pathway and pose path-
way respectively. With interactions, the two pathways up-
date F P

t , respectively.

t−1 and F S

t and F S

t−1 to F P

In the following, we describe the detailed update process

in three parts and justify their designs.

Pose Attention Masks. The pose transfer, at a basic level,
is about moving patches from the locations induced by the
condition pose to the locations induced by the target pose.
In this sense, the pose guides the transfer by hinting where
to sample condition patches and where to put target patches.
In our network, such hints are realized by the attention mask
denoted as Mt, which are values between 0 and 1 indicating
the importance of every element in the image code.

The attention masks Mt are computed from the pose
code F S
t−1, which incorporates both the condition and the
target pose. The pose code F S
t−1 ﬁrstly goes through two
convolutional layers (with a normalization layer [11, 37]
and ReLU [26] in between), before being mapped to the
range of (0, 1) by an element-wise sigmoid function. Math-
ematically:

Mt = σ(cid:0)convS (cid:0)F S

t−1(cid:1)(cid:1) .

(1)

3.1. Generator

3.1.1 Encoders

Image Code Update. Having computed Mt, the image
code F P
t

is updated by:

Fig. 2 shows the architecture of the generator, whose inputs
are the condition image Pc, the condition pose Sc and the
target pose St. The generator aims to transfer the pose of
the person in the condition image Pc from condition pose
Sc to target pose St, thus generates realistic-looking person
image Pg.

On the input side, the condition image is encoded by N
down-sampling convolutional layers (N = 2 in our case);
The condition pose Sc and target pose heat maps St are
stacked along their depth axes before being encoded, also
by N down-sampling convolutional layers. The encoding
process mixes the two poses, preserving their information
and capturing their dependencies. Although one can imag-
ine encoding the two poses separately and concatenate their
vectors in the end, our structure works effectively and re-
quires less computation.

F P

t = Mt ⊙ convP (cid:0)F P

t−1(cid:1) + F P

t−1,

(2)

where ⊙ denotes element-wise product. By multiplying the
transformed image codes with the attention masks Mt, im-
age code F P
t at certain locations are either preserved or sup-
pressed. The output of the element-wise product is added by
F P
t−1, constituting a residual connection [9]. The residual
connection helps preserve the original image code, which
is critical for the pose transfer. Having residual connection
also eases the training as observed in [9], particularly when
there are many PATBs.

Pose Code Update. As the image code gets updated
through the PATBs, the pose code should also be updated
to synchronize the change, i.e. update where to sample and
put patches given the new image code. Therefore, the pose
code update should incorporate the new image code.

2349

Speciﬁcally, the previous pose code F S

t−1 ﬁrstly goes
through two convolutional layers (with a normalization
layer and ReLU in between). Note when t > 1, the ﬁrst
convolutional layer will reduce the feature map depth to
half, making the feature map depths of subsequent layers
in the pose pathway equal to those in the image pathway.
Then, the transformed code is mixed with the updated im-
age code by concatenation. Mathematically, the update is
performed by

F S

t = convS (cid:0)F S

t−1(cid:1) kF P

t ,

LGAN =ESt∈PS ,(Pc,Pt)∈P {log[DA(Pc, Pt) · DS(St, Pt)]} +

E

St∈PS ,Pc∈P,Pg ∈ˆP {log[(1 − DA(Pc, Pg))
·(1 − DS(St, Pg))]} .

(5)

Note that P, ˆP and PS denotes the distribution of real per-
son images, fake person images and person poses, respec-
tively.

(3)

The combined L1 loss can be further written as:

where k denotes the concatenation of two maps along depth
axis.

3.1.3 Decoder

The updates in PATN result in the ﬁnal image code F P
T and
the ﬁnal pose code F S
T . We take the image code and dis-
card the ﬁnal pose code. Following the standard practice,
the decoder generates the output image Pg from F P
T via N
deconvolutional layers.

3.2. Discriminators

We design two discriminators called appearance dis-
criminator DA and shape discriminator DS, to judge how
likely Pg contains the same person in Pc (appearance con-
sistency) and how well Pg align with the target pose St
(shape consistency). The two discriminators have similar
structures, where Pg is concatenated with either Pc or St
along the depth axis, before being fed into a CNN (convo-
lutional neural network) for judgment. Their outputs are
respectively RA and RS, i.e.
the appearance consistency
score and the shape consistency score. The scores are the
probabilities output by the softmax layer of a CNN. The
ﬁnal score R is the production of the two scores: R =
RARS.

As the training proceeds, we observe that a discrimina-
tor with low capacity becomes insufﬁcient to differentiate
real and fake data. Therefore, we build the discriminators
by adding three residual blocks after two down-sampling
convolutions to enhance their capability.

3.3. Training

The full loss function is denoted as:

Lf ull = arg min
G

max

D

αLGAN + LcombL1,

(4)

where LGAN denotes the adversarial loss and LcombL1 de-
notes the combined L1 loss. α represents the weight of
LGAN that contributes to Lf ull. The total adversarial loss
is derived from DA and DS:

LcombL1 = λ1LL1 + λ2LperL1,

(6)

where LL1 denotes the pixel-wise L1 loss computed
image and LL1 =
between the generated and target
kPg − Ptk1.

In order to reduce pose distortions and make the pro-
duced images look more natural and smooth, we integrate
a perceptual L1 loss LperL1, which is effective in super-
resolution [17], style transfer [13] as well as the pose trans-
fer tasks [5, 34]. In formula,

LperL1 =

1

WρHρCρ

Wρ
X

Hρ
X

Cρ
X

x=1

y=1

z=1

kφρ(Pg)x,y,z − φρ(Pt)x,y,zk1

(7)
where φρ are the outputs of a layer, indexed by ρ, from
the VGG-19 model [35] pre-trained on ImageNet [32], and
Wρ,Hρ,Cρ are the spatial width, height and depth of φρ, re-
spectively. We found ρ = Conv1 2 leads to the best results
in our experiments.

Training procedures. Following the training procedures
of GAN, we alternatively train generator and two discrim-
inators. During training, the generator takes (Pc, Sc, St)
as input and outputs a transfered person image with target
pose Pg. More speciﬁcally, Pc is fed to the image pathway
and (Sc, St) are fed to the pose pathway. For the adver-
sarial training, (Pc, Pt) and (Pc, Pg) are fed to the appear-
ance discriminator DA chasing for appearance consistency.
(St, Pt) and (St, Pg) are fed to the shape discriminator DS
for shape consistency.

Implementation details. The implementation is built upon
the popular Pytorch framework. Adam optimizer [14] is
adopted to train the proposed model for around 90k itera-
tions with β1 = 0.5, β2 = 0.999. Learning rate is initially
set to 2 × 10−4, and linearly decay to 0 after 60k itera-
tions. We use 9 PATBs in the generator for both datasets.
(α, λ1, λ2) is set to (5, 1, 1) and instance normalization [37]
is applied for DeepFashion and batch normalization [11] is
used for Market-1501. Dropout [10] is only applied in the
PATBs, its rate set to 0.5. Leaky ReLU [23] is applied after
every convolution or normalization layers in the discrimina-
tors, and its negative slope coefﬁcient is set to 0.2.

2350

4. Experiments

In this section, we conduct extensive experiments to ver-
ify the efﬁcacy and efﬁciency of the proposed network. The
experiments not only show the superiority of our network
but also verify its design rationalities in both objective quan-
titative scores and subjective visual realness. 1

Datasets. We mainly carry out experiments on the chal-
lenging person re-identiﬁcation dataset Market-1501 [45]
and the In-shop Clothes Retrieval Benchmark DeepFashion
[19]. Performing pose transfer on Market-1501 is even chal-
lenging since the images are in low-resolution (128 × 64)
and vary enormously in the pose, viewpoint, background
and illumination, whereas the images in DeepFashion are
in high-resolution (256 × 256) and of clean backgrounds.
We adopt HPE [3] as pose joints detector and ﬁlter out im-
ages where no human body is detected. Consequently, we
collect 263,632 training pairs and 12,000 testing pairs for
Market-1501. And for DeepFashion, 101,966 pairs are ran-
domly selected for training and 8,570 pairs for testing. It’s
worth noting that the person identities of the training set do
not overlap with those of the testing set for better evaluating
the model’s generalization ability.

Metrics. It remains an open problem to effectively evalu-
ate the appearance and shape consistency of the generated
images. Ma et al. [21] used Structure Similarity (SSIM)
[40] and Inception score (IS) [33] as their evaluation met-
rics, then introduced their masked versions – mask-SSIM
and mask-IS, to reduce the background inﬂuence by mask-
ing it out. Siarohin et al. [34] further introduced Detection
Score (DS) to measure whether a detector [18] can correctly
detect the person in the image. We argue that all the met-
rics mentioned above cannot explicitly quantify the shape
consistency. More speciﬁcally: SSIM relies on global co-
variance and means of the images to assess the structure
similarity, which is inadequate for measuring shape consis-
tency; IS and DS use image classiﬁer and object detector
to assess generated image quality, which are unrelated to
shape consistency.

As all the metrics mentioned above are either insufﬁcient
or disable to quantify the shape consistency of the generated
images, we hereby introduce a new metric as a complement
to explicitly assess the shape consistency. To be speciﬁc,
person shape is simply represented by 18 pose joints ob-
tained from the Human Pose Estimator (HPE) [3]. Then the
shape consistency is approximated by pose joints alignment
which is evaluated from PCKh measure2 [1]. According
to the protocol of [1], PCKh score is the percentage of the
keypoints pairs whose offsets are below the half size of the

1Due to page limits, more visual results including a video are put in the

supplementary material for further reference.

2PCKh is the slightly modiﬁed version of Percentage of Correct Key-

points (PCK) [41]

head segment. The head is estimated by the bounding box
that tightly covers a set of keypoints related to head.

4.1. Comparison with previous work

4.1.1 Quantitative and qualitative comparison

Quantitative comparisons with previous works can be found
in Tab.1. Since the data split of previous works [21, 34]
are not given, we download their well-trained models and
re-evaluate their performance on our testing set. Although
the testing set inevitably includes some of their training im-
ages and thus giving an edge to their methods, our method
still outperforms them on most metrics, and the numeric
improvements are steady for both datasets. Notably, our
method ranks the highest on the PCKh metric which cap-
tures shape consistency. Although we achieve the same
highest PCKh score as [34] on Market-1501, we promote
the best PCKh performance of previous works by 2% on
DeepFashion, attaining to 0.96, which nearly hits the per-
formance ceiling.

Pc<

Pt

Pc<

Pt

DeepFashion

Market-1501

Figure 3: Qualitative comparisons on DeepFashion (Left) and Market-
1501 (Right) dataset. PG2, VUnet and Deform represent the results of
[21], [5] and [34], respectively.

Fig.3 (Left) gives some typical qualitative examples, all
of which are with large pose changes and/or scale variance,
on the high-resolution DeepFashion [19]. Overall, our pro-
posed method maintains the integrity of the person, espe-
cially on the wrist, and exhibits the most natural posture.
Meanwhile, our method captures the most detailed appear-
ance, especially the skin color in the ﬁrst row, whiskers in
the second row, hair in the third row and hat in the last row.
Besides, our method generates much more beautiful facial
details than other methods.

We also evaluate the performance of our method on
Market-1501, a dataset of poor image quality. Some ex-
amples are shown in Fig.3 (Right). Our method yields the
sharpest person images while the generated images of other
methods are blurred to some extent. Especially, our method
gives the correct leg layouts that correspond to the target
poses, even when the legs are crossed in the target pose (in
the second and third row), or the condition image is blurred

2351

<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
1
7
X
E
F
c
L
a
d
M
q
j
u
4
2
j
C
1
j
h
W
3
7
d
H
K
Y
=
"
>
A
A
A
B
9
H
i
c
b
V
D
L
S
g
M
x
F
L
3
j
s
9
Z
X
1
a
W
b
Y
B
F
c
l
R
k
R
d
F
l
w
4
8
4
K
9
g
H
t
U
D
J
p
p
g
1
N
M
m
M
e
h
T
L
0
O
9
y
4
U
M
S
t
H
+
P
O
v
z
H
T
z
k
J
b
D
w
Q
O
5
9
z
L
P
T
l
R
y
p
k
2
v
v
/
t
r
a
1
v
b
G
5
t
l
3
b
K
u
3
v
7
B
4
e
V
o
+
O
W
T
q
w
i
t
E
k
S
n
q
h
O
h
D
X
l
T
N
K
m
Y
Y
b
T
T
q
o
o
F
h
G
n
7
W
h
8
m
/
v
t
C
V
W
a
J
f
L
R
T
F
M
a
C
j
y
U
L
G
Y
E
G
y
e
F
P
Y
H
N
S
I
n
s
3
i
o
9
6
1
e
q
f
s
2
f
A
6
2
S
o
C
B
V
K
N
D
o
V
7
5
6
g
4
R
Y
Q
a
U
h
H
G
v
d
D
f
z
U
h
B
l
W
h
h
F
O
Z
+
W
e
1
T
T
F
Z
I
y
H
t
O
u
o
x
I
L
q
M
J
u
H
n
q
F
z
p
w
x
Q
n
C
j
3
p
E
F
z
9
f
d
G
h
o
X
W
U
x
G
5
y
T
y
k
X
v
Z
y
8
T
+
v
a
0
1
8
E
2
Z
M
p
t
Z
Q
S
R
a
H
Y
s
u
R
S
V
D
e
A
B
o
w
R
Y
n
h
U
0
c
w
U
c
x
l
R
W
S
E
F
S
b
G
9
V
R
2
J
Q
T
L
X
1
4
l
r
c
t
a
4
P
j
D
V
b
V
e
K
+
o
o
w
S
m
c
w
Q
U
E
c
A
1
1
u
I
M
G
N
I
H
A
E
z
z
D
K
7
x
5
E
+
/
F
e
/
c
+
F
q
N
r
X
r
F
z
A
n
/
g
f
f
4
A
Z
V
u
S
b
g
=
=
<
/
l
a
t
e
x
i
t
>
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
a
7
P
L
f
p
h
o
n
z
+
v
F
7
b
B
z
b
B
J
b
9
8
c
S
J
c
=
"
>
A
A
A
B
+
H
i
c
b
V
D
L
S
s
N
A
F
L
3
x
W
e
u
j
U
Z
d
u
B
o
v
g
q
i
Q
i
6
L
K
g
C
5
c
V
7
A
P
a
U
C
b
T
2
3
b
o
T
B
J
m
J
k
I
N
/
R
I
3
L
h
R
x
6
6
e
4
8
2
+
c
t
F
l
o
6
4
G
B
w
z
n
3
c
s
+
c
M
B
F
c
G
8
/
7
d
t
b
W
N
z
a
3
t
k
s
7
5
d
2
9
/
Y
O
K
e
3
j
U
0
n
G
q
G
D
Z
Z
L
G
L
V
C
a
l
G
w
S
N
s
G
m
4
E
d
h
K
F
V
I
Y
C
2
+
H
k
J
v
f
b
j
6
g
0
j
6
M
H
M
0
0
w
k
H
Q
U
8
S
F
n
1
F
i
p
7
1
Z
6
k
p
q
x
k
t
k
t
D
m
M
l
Z
3
2
3
6
t
W
8
O
c
g
q
8
Q
t
S
h
Q
K
N
v
v
v
V
G
8
Q
s
l
R
g
Z
J
q
j
W
X
d
9
L
T
J
B
R
Z
T
g
T
O
C
v
3
U
o
0
J
Z
R
M
6
w
q
6
l
E
Z
W
o
g
2
w
e
f
E
b
O
r
D
I
g
9
r
B
9
k
S
F
z
9
f
d
G
R
q
X
W
U
x
n
a
y
T
y
m
X
v
Z
y
8
T
+
v
m
5
r
h
d
Z
D
x
K
E
k
N
R
m
x
x
a
J
g
K
Y
m
K
S
t
0
A
G
X
C
E
z
Y
m
o
J
Z
Y
r
b
r
I
S
N
q
a
L
M
2
K
7
K
t
g
R
/
+
c
u
r
p
H
V
R
8
y
2
/
v
6
z
W
a
0
U
d
J
T
i
B
U
z
g
H
H
6
6
g
D
n
f
Q
g
C
Y
w
S
O
E
Z
X
u
H
N
e
X
J
e
n
H
f
n
Y
z
G
6
5
h
Q
7
x
/
A
H
z
u
c
P
Q
o
2
T
Z
w
=
=
<
/
l
a
t
e
x
i
t
>
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
s
l
C
i
t
i
i
j
C
U
d
/
c
c
7
S
J
n
N
9
h
n
e
n
E
x
A
=
"
>
A
A
A
B
9
X
i
c
b
V
B
N
S
8
N
A
F
H
z
x
s
9
a
v
q
k
c
v
i
0
X
w
V
B
I
R
9
F
j
w
4
k
k
q
m
L
b
Q
x
r
L
Z
b
t
u
l
m
0
3
Y
f
V
F
K
6
P
/
w
4
k
E
R
r
/
4
X
b
/
4
b
N
2
0
O
2
j
q
w
M
M
y
8
x
5
u
d
M
J
H
C
o
O
t
+
O
y
u
r
a
+
s
b
m
6
W
t
8
v
b
O
7
t
5
+
5
e
C
w
a
e
J
U
M
+
6
z
W
M
a
6
H
V
L
D
p
V
D
c
R
4
G
S
t
x
P
N
a
R
R
K
3
g
r
H
1
7
n
f
e
u
T
a
i
F
j
d
4
y
T
h
Q
U
S
H
S
g
w
E
o
2
i
l
h
2
5
E
c
a
S
j
r
O
n
f
c
p
z
2
K
l
W
3
5
s
5
A
l
o
l
X
k
C
o
U
a
P
Q
q
X
9
1
+
z
N
K
I
K
2
S
S
G
t
P
x
3
A
S
D
j
G
o
U
T
P
J
p
u
Z
s
a
n
l
A
2
p
k
P
e
s
V
T
R
i
J
s
g
m
6
W
e
k
l
O
r
9
M
k
g
1
v
Y
p
J
D
P
1
9
0
Z
G
I
2
M
m
U
W
g
n
8
5
R
m
0
c
v
F
/
7
x
O
i
o
O
r
I
B
M
q
S
Z
E
r
N
j
8
0
S
C
X
B
m
O
Q
V
k
L
7
Q
n
K
G
c
W
E
K
Z
F
j
Y
r
Y
S
O
q
K
U
N
b
V
N
m
W
4
C
1
+
e
Z
k
0
z
2
u
e
5
X
c
X
1
X
q
t
q
K
M
E
x
3
A
C
Z
+
D
B
J
d
T
h
B
h
r
g
A
w
M
N
z
/
A
K
b
8
6
T
8
+
K
8
O
x
/
z
0
R
W
n
2
D
m
C
P
3
A
+
f
w
D
N
E
5
K
h
<
/
l
a
t
e
x
i
t
>
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
b
5
a
2
v
C
5
B
j
b
u
U
n
F
i
a
7
R
U
8
u
e
k
F
U
b
Q
=
"
>
A
A
A
B
9
H
i
c
b
V
D
L
S
g
M
x
F
L
1
T
X
7
W
+
q
i
7
d
B
I
v
g
q
s
w
U
Q
Z
c
F
F
7
q
s
Y
B
/
Q
j
i
W
T
Z
t
r
Q
J
D
N
N
M
o
U
y
9
D
v
c
u
F
D
E
r
R
/
j
z
r
8
x
0
8
5
C
W
w
8
E
D
u
f
c
y
z
0
5
Q
c
y
Z
N
q
7
7
7
R
Q
2
N
r
e
2
d
4
q
7
p
b
3
9
g
8
O
j
8
v
F
J
S
0
e
J
I
r
R
J
I
h
6
p
T
o
A
1
5
U
z
S
p
m
G
G
0
0
6
s
K
B
Y
B
p
+
1
g
f
J
v
5
7
S
l
V
m
k
X
y
0
c
x
i
6
g
s
8
l
C
x
k
B
B
s
r
+
T
2
B
z
U
i
J
t
H
H
3
V
J
v
3
y
x
W
3
6
i
6
A
1
o
m
X
k
w
r
k
a
P
T
L
X
7
1
B
R
B
J
B
p
S
E
c
a
9
3
1
3
N
j
4
K
V
a
G
E
U
7
n
p
V
6
i
a
Y
z
J
G
A
9
p
1
1
K
J
B
d
V
+
u
g
g
9
R
x
d
W
G
a
A
w
U
v
Z
J
g
x
b
q
7
4
0
U
C
6
1
n
I
r
C
T
W
U
i
9
6
m
X
i
f
1
4
3
M
e
G
N
n
z
I
Z
J
4
Z
K
s
j
w
U
J
h
y
Z
C
G
U
N
o
A
F
T
l
B
g
+
s
w
Q
T
x
W
x
W
R
E
Z
Y
Y
W
J
s
T
y
V
b
g
r
f
6
5
X
X
S
q
l
U
9
y
x
+
u
K
v
V
q
X
k
c
R
z
u
A
c
L
s
G
D
a
6
j
D
P
T
S
g
C
Q
Q
m
8
A
y
v
8
O
Z
M
n
R
f
n
3
f
l
Y
j
h
a
c
f
O
c
U
/
s
D
5
/
A
G
f
V
Z
H
s
<
/
l
a
t
e
x
i
t
>
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
q
4
j
k
t
o
b
t
7
r
D
I
P
t
S
o
s
F
I
g
T
T
o
g
X
B
w
=
"
>
A
A
A
B
6
X
i
c
b
V
B
N
S
8
N
A
E
J
3
U
r
1
q
/
q
h
6
9
L
B
b
B
U
0
l
E
U
G
9
F
L
x
4
r
G
l
t
o
Q
9
l
s
N
+
3
S
z
S
b
s
T
o
Q
S
+
h
O
8
e
F
D
x
6
j
/
y
5
r
9
x
2
+
a
g
r
Q
8
G
H
u
/
N
M
D
M
v
T
K
U
w
6
L
r
f
T
m
l
l
d
W
1
9
o
7
x
Z
2
d
r
e
2
d
2
r
7
h
8
8
m
i
T
T
j
P
s
s
k
Y
l
u
h
9
R
w
K
R
T
3
U
a
D
k
7
V
R
z
G
o
e
S
t
8
L
R
z
d
R
v
P
X
F
t
R
K
I
e
c
J
z
y
I
K
Y
D
J
S
L
B
K
F
r
p
v
t
l
j
v
W
r
N
r
b
s
z
k
G
X
i
F
a
Q
G
B
Z
q
9
6
l
e
3
n
7
A
s
5
g
q
Z
p
M
Z
0
P
D
f
F
I
K
c
a
B
Z
N
8
U
u
l
m
h
q
e
U
j
e
i
A
d
y
x
V
N
O
Y
m
y
G
e
n
T
s
i
J
V
f
o
k
S
r
Q
t
h
W
S
m
/
p
7
I
a
W
z
M
O
A
5
t
Z
0
x
x
a
B
a
9
q
f
i
f
1
8
k
w
u
g
x
y
o
d
I
M
u
W
L
z
R
V
E
m
C
S
Z
k
+
j
f
p
C
8
0
Z
y
r
E
l
l
G
l
h
b
y
V
s
S
D
V
l
a
N
O
p
2
B
C
8
x
Z
e
X
i
X
9
W
v
6
p
7
d
+
e
1
x
n
W
R
R
h
m
O
4
B
h
O
w
Y
M
L
a
M
A
t
N
M
E
H
B
g
N
4
h
l
d
4
c
6
T
z
4
r
w
7
H
/
P
W
k
l
P
M
H
M
I
f
O
J
8
/
i
E
O
N
f
g
=
=
<
/
l
a
t
e
x
i
t
>
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
q
4
j
k
t
o
b
t
7
r
D
I
P
t
S
o
s
F
I
g
T
T
o
g
X
B
w
=
"
>
A
A
A
B
6
X
i
c
b
V
B
N
S
8
N
A
E
J
3
U
r
1
q
/
q
h
6
9
L
B
b
B
U
0
l
E
U
G
9
F
L
x
4
r
G
l
t
o
Q
9
l
s
N
+
3
S
z
S
b
s
T
o
Q
S
+
h
O
8
e
F
D
x
6
j
/
y
5
r
9
x
2
+
a
g
r
Q
8
G
H
u
/
N
M
D
M
v
T
K
U
w
6
L
r
f
T
m
l
l
d
W
1
9
o
7
x
Z
2
d
r
e
2
d
2
r
7
h
8
8
m
i
T
T
j
P
s
s
k
Y
l
u
h
9
R
w
K
R
T
3
U
a
D
k
7
V
R
z
G
o
e
S
t
8
L
R
z
d
R
v
P
X
F
t
R
K
I
e
c
J
z
y
I
K
Y
D
J
S
L
B
K
F
r
p
v
t
l
j
v
W
r
N
r
b
s
z
k
G
X
i
F
a
Q
G
B
Z
q
9
6
l
e
3
n
7
A
s
5
g
q
Z
p
M
Z
0
P
D
f
F
I
K
c
a
B
Z
N
8
U
u
l
m
h
q
e
U
j
e
i
A
d
y
x
V
N
O
Y
m
y
G
e
n
T
s
i
J
V
f
o
k
S
r
Q
t
h
W
S
m
/
p
7
I
a
W
z
M
O
A
5
t
Z
0
x
x
a
B
a
9
q
f
i
f
1
8
k
w
u
g
x
y
o
d
I
M
u
W
L
z
R
V
E
m
C
S
Z
k
+
j
f
p
C
8
0
Z
y
r
E
l
l
G
l
h
b
y
V
s
S
D
V
l
a
N
O
p
2
B
C
8
x
Z
e
X
i
X
9
W
v
6
p
7
d
+
e
1
x
n
W
R
R
h
m
O
4
B
h
O
w
Y
M
L
a
M
A
t
N
M
E
H
B
g
N
4
h
l
d
4
c
6
T
z
4
r
w
7
H
/
P
W
k
l
P
M
H
M
I
f
O
J
8
/
i
E
O
N
f
g
=
=
<
/
l
a
t
e
x
i
t
>
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
q
4
j
k
t
o
b
t
7
r
D
I
P
t
S
o
s
F
I
g
T
T
o
g
X
B
w
=
"
>
A
A
A
B
6
X
i
c
b
V
B
N
S
8
N
A
E
J
3
U
r
1
q
/
q
h
6
9
L
B
b
B
U
0
l
E
U
G
9
F
L
x
4
r
G
l
t
o
Q
9
l
s
N
+
3
S
z
S
b
s
T
o
Q
S
+
h
O
8
e
F
D
x
6
j
/
y
5
r
9
x
2
+
a
g
r
Q
8
G
H
u
/
N
M
D
M
v
T
K
U
w
6
L
r
f
T
m
l
l
d
W
1
9
o
7
x
Z
2
d
r
e
2
d
2
r
7
h
8
8
m
i
T
T
j
P
s
s
k
Y
l
u
h
9
R
w
K
R
T
3
U
a
D
k
7
V
R
z
G
o
e
S
t
8
L
R
z
d
R
v
P
X
F
t
R
K
I
e
c
J
z
y
I
K
Y
D
J
S
L
B
K
F
r
p
v
t
l
j
v
W
r
N
r
b
s
z
k
G
X
i
F
a
Q
G
B
Z
q
9
6
l
e
3
n
7
A
s
5
g
q
Z
p
M
Z
0
P
D
f
F
I
K
c
a
B
Z
N
8
U
u
l
m
h
q
e
U
j
e
i
A
d
y
x
V
N
O
Y
m
y
G
e
n
T
s
i
J
V
f
o
k
S
r
Q
t
h
W
S
m
/
p
7
I
a
W
z
M
O
A
5
t
Z
0
x
x
a
B
a
9
q
f
i
f
1
8
k
w
u
g
x
y
o
d
I
M
u
W
L
z
R
V
E
m
C
S
Z
k
+
j
f
p
C
8
0
Z
y
r
E
l
l
G
l
h
b
y
V
s
S
D
V
l
a
N
O
p
2
B
C
8
x
Z
e
X
i
X
9
W
v
6
p
7
d
+
e
1
x
n
W
R
R
h
m
O
4
B
h
O
w
Y
M
L
a
M
A
t
N
M
E
H
B
g
N
4
h
l
d
4
c
6
T
z
4
r
w
7
H
/
P
W
k
l
P
M
H
M
I
f
O
J
8
/
i
E
O
N
f
g
=
=
<
/
l
a
t
e
x
i
t
>
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
q
4
j
k
t
o
b
t
7
r
D
I
P
t
S
o
s
F
I
g
T
T
o
g
X
B
w
=
"
>
A
A
A
B
6
X
i
c
b
V
B
N
S
8
N
A
E
J
3
U
r
1
q
/
q
h
6
9
L
B
b
B
U
0
l
E
U
G
9
F
L
x
4
r
G
l
t
o
Q
9
l
s
N
+
3
S
z
S
b
s
T
o
Q
S
+
h
O
8
e
F
D
x
6
j
/
y
5
r
9
x
2
+
a
g
r
Q
8
G
H
u
/
N
M
D
M
v
T
K
U
w
6
L
r
f
T
m
l
l
d
W
1
9
o
7
x
Z
2
d
r
e
2
d
2
r
7
h
8
8
m
i
T
T
j
P
s
s
k
Y
l
u
h
9
R
w
K
R
T
3
U
a
D
k
7
V
R
z
G
o
e
S
t
8
L
R
z
d
R
v
P
X
F
t
R
K
I
e
c
J
z
y
I
K
Y
D
J
S
L
B
K
F
r
p
v
t
l
j
v
W
r
N
r
b
s
z
k
G
X
i
F
a
Q
G
B
Z
q
9
6
l
e
3
n
7
A
s
5
g
q
Z
p
M
Z
0
P
D
f
F
I
K
c
a
B
Z
N
8
U
u
l
m
h
q
e
U
j
e
i
A
d
y
x
V
N
O
Y
m
y
G
e
n
T
s
i
J
V
f
o
k
S
r
Q
t
h
W
S
m
/
p
7
I
a
W
z
M
O
A
5
t
Z
0
x
x
a
B
a
9
q
f
i
f
1
8
k
w
u
g
x
y
o
d
I
M
u
W
L
z
R
V
E
m
C
S
Z
k
+
j
f
p
C
8
0
Z
y
r
E
l
l
G
l
h
b
y
V
s
S
D
V
l
a
N
O
p
2
B
C
8
x
Z
e
X
i
X
9
W
v
6
p
7
d
+
e
1
x
n
W
R
R
h
m
O
4
B
h
O
w
Y
M
L
a
M
A
t
N
M
E
H
B
g
N
4
h
l
d
4
c
6
T
z
4
r
w
7
H
/
P
W
k
l
P
M
H
M
I
f
O
J
8
/
i
E
O
N
f
g
=
=
<
/
l
a
t
e
x
i
t
>
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
W
T
t
9
I
1
+
D
U
K
5
c
S
2
Y
t
S
8
o
/
H
j
I
M
l
W
E
=
"
>
A
A
A
B
6
X
i
c
b
V
B
N
S
8
N
A
E
J
3
U
r
1
q
/
q
h
6
9
L
B
b
B
U
0
l
E
U
G
9
F
L
x
4
r
G
l
t
o
Q
9
l
s
N
+
3
S
z
S
b
s
T
o
Q
S
+
h
O
8
e
F
D
x
6
j
/
y
5
r
9
x
2
+
a
g
r
Q
8
G
H
u
/
N
M
D
M
v
T
K
U
w
6
L
r
f
T
m
l
l
d
W
1
9
o
7
x
Z
2
d
r
e
2
d
2
r
7
h
8
8
m
i
T
T
j
P
s
s
k
Y
l
u
h
9
R
w
K
R
T
3
U
a
D
k
7
V
R
z
G
o
e
S
t
8
L
R
z
d
R
v
P
X
F
t
R
K
I
e
c
J
z
y
I
K
Y
D
J
S
L
B
K
F
r
p
v
t
n
D
X
r
X
m
1
t
0
Z
y
D
L
x
C
l
K
D
A
s
1
e
9
a
v
b
T
1
g
W
c
4
V
M
U
m
M
6
n
p
t
i
k
F
O
N
g
k
k
+
q
X
Q
z
w
1
P
K
R
n
T
A
O
5
Y
q
G
n
M
T
5
L
N
T
J
+
T
E
K
n
0
S
J
d
q
W
Q
j
J
T
f
0
/
k
N
D
Z
m
H
I
e
2
M
6
Y
4
N
I
v
e
V
P
z
P
6
2
Q
Y
X
Q
a
5
U
G
m
G
X
L
H
5
o
i
i
T
B
B
M
y
/
Z
v
0
h
e
Y
M
5
d
g
S
y
r
S
w
t
x
I
2
p
J
o
y
t
O
l
U
b
A
j
e
4
s
v
L
x
D
+
r
X
9
W
9
u
/
N
a
4
7
p
I
o
w
x
H
c
A
y
n
4
M
E
F
N
O
A
W
m
u
A
D
g
w
E
8
w
y
u
8
O
d
J
5
c
d
6
d
j
3
l
r
y
S
l
m
D
u
E
P
n
M
8
f
o
f
a
N
j
w
=
=
<
/
l
a
t
e
x
i
t
>
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
W
T
t
9
I
1
+
D
U
K
5
c
S
2
Y
t
S
8
o
/
H
j
I
M
l
W
E
=
"
>
A
A
A
B
6
X
i
c
b
V
B
N
S
8
N
A
E
J
3
U
r
1
q
/
q
h
6
9
L
B
b
B
U
0
l
E
U
G
9
F
L
x
4
r
G
l
t
o
Q
9
l
s
N
+
3
S
z
S
b
s
T
o
Q
S
+
h
O
8
e
F
D
x
6
j
/
y
5
r
9
x
2
+
a
g
r
Q
8
G
H
u
/
N
M
D
M
v
T
K
U
w
6
L
r
f
T
m
l
l
d
W
1
9
o
7
x
Z
2
d
r
e
2
d
2
r
7
h
8
8
m
i
T
T
j
P
s
s
k
Y
l
u
h
9
R
w
K
R
T
3
U
a
D
k
7
V
R
z
G
o
e
S
t
8
L
R
z
d
R
v
P
X
F
t
R
K
I
e
c
J
z
y
I
K
Y
D
J
S
L
B
K
F
r
p
v
t
n
D
X
r
X
m
1
t
0
Z
y
D
L
x
C
l
K
D
A
s
1
e
9
a
v
b
T
1
g
W
c
4
V
M
U
m
M
6
n
p
t
i
k
F
O
N
g
k
k
+
q
X
Q
z
w
1
P
K
R
n
T
A
O
5
Y
q
G
n
M
T
5
L
N
T
J
+
T
E
K
n
0
S
J
d
q
W
Q
j
J
T
f
0
/
k
N
D
Z
m
H
I
e
2
M
6
Y
4
N
I
v
e
V
P
z
P
6
2
Q
Y
X
Q
a
5
U
G
m
G
X
L
H
5
o
i
i
T
B
B
M
y
/
Z
v
0
h
e
Y
M
5
d
g
S
y
r
S
w
t
x
I
2
p
J
o
y
t
O
l
U
b
A
j
e
4
s
v
L
x
D
+
r
X
9
W
9
u
/
N
a
4
7
p
I
o
w
x
H
c
A
y
n
4
M
E
F
N
O
A
W
m
u
A
D
g
w
E
8
w
y
u
8
O
d
J
5
c
d
6
d
j
3
l
r
y
S
l
m
D
u
E
P
n
M
8
f
o
f
a
N
j
w
=
=
<
/
l
a
t
e
x
i
t
>
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
W
T
t
9
I
1
+
D
U
K
5
c
S
2
Y
t
S
8
o
/
H
j
I
M
l
W
E
=
"
>
A
A
A
B
6
X
i
c
b
V
B
N
S
8
N
A
E
J
3
U
r
1
q
/
q
h
6
9
L
B
b
B
U
0
l
E
U
G
9
F
L
x
4
r
G
l
t
o
Q
9
l
s
N
+
3
S
z
S
b
s
T
o
Q
S
+
h
O
8
e
F
D
x
6
j
/
y
5
r
9
x
2
+
a
g
r
Q
8
G
H
u
/
N
M
D
M
v
T
K
U
w
6
L
r
f
T
m
l
l
d
W
1
9
o
7
x
Z
2
d
r
e
2
d
2
r
7
h
8
8
m
i
T
T
j
P
s
s
k
Y
l
u
h
9
R
w
K
R
T
3
U
a
D
k
7
V
R
z
G
o
e
S
t
8
L
R
z
d
R
v
P
X
F
t
R
K
I
e
c
J
z
y
I
K
Y
D
J
S
L
B
K
F
r
p
v
t
n
D
X
r
X
m
1
t
0
Z
y
D
L
x
C
l
K
D
A
s
1
e
9
a
v
b
T
1
g
W
c
4
V
M
U
m
M
6
n
p
t
i
k
F
O
N
g
k
k
+
q
X
Q
z
w
1
P
K
R
n
T
A
O
5
Y
q
G
n
M
T
5
L
N
T
J
+
T
E
K
n
0
S
J
d
q
W
Q
j
J
T
f
0
/
k
N
D
Z
m
H
I
e
2
M
6
Y
4
N
I
v
e
V
P
z
P
6
2
Q
Y
X
Q
a
5
U
G
m
G
X
L
H
5
o
i
i
T
B
B
M
y
/
Z
v
0
h
e
Y
M
5
d
g
S
y
r
S
w
t
x
I
2
p
J
o
y
t
O
l
U
b
A
j
e
4
s
v
L
x
D
+
r
X
9
W
9
u
/
N
a
4
7
p
I
o
w
x
H
c
A
y
n
4
M
E
F
N
O
A
W
m
u
A
D
g
w
E
8
w
y
u
8
O
d
J
5
c
d
6
d
j
3
l
r
y
S
l
m
D
u
E
P
n
M
8
f
o
f
a
N
j
w
=
=
<
/
l
a
t
e
x
i
t
>
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
W
T
t
9
I
1
+
D
U
K
5
c
S
2
Y
t
S
8
o
/
H
j
I
M
l
W
E
=
"
>
A
A
A
B
6
X
i
c
b
V
B
N
S
8
N
A
E
J
3
U
r
1
q
/
q
h
6
9
L
B
b
B
U
0
l
E
U
G
9
F
L
x
4
r
G
l
t
o
Q
9
l
s
N
+
3
S
z
S
b
s
T
o
Q
S
+
h
O
8
e
F
D
x
6
j
/
y
5
r
9
x
2
+
a
g
r
Q
8
G
H
u
/
N
M
D
M
v
T
K
U
w
6
L
r
f
T
m
l
l
d
W
1
9
o
7
x
Z
2
d
r
e
2
d
2
r
7
h
8
8
m
i
T
T
j
P
s
s
k
Y
l
u
h
9
R
w
K
R
T
3
U
a
D
k
7
V
R
z
G
o
e
S
t
8
L
R
z
d
R
v
P
X
F
t
R
K
I
e
c
J
z
y
I
K
Y
D
J
S
L
B
K
F
r
p
v
t
n
D
X
r
X
m
1
t
0
Z
y
D
L
x
C
l
K
D
A
s
1
e
9
a
v
b
T
1
g
W
c
4
V
M
U
m
M
6
n
p
t
i
k
F
O
N
g
k
k
+
q
X
Q
z
w
1
P
K
R
n
T
A
O
5
Y
q
G
n
M
T
5
L
N
T
J
+
T
E
K
n
0
S
J
d
q
W
Q
j
J
T
f
0
/
k
N
D
Z
m
H
I
e
2
M
6
Y
4
N
I
v
e
V
P
z
P
6
2
Q
Y
X
Q
a
5
U
G
m
G
X
L
H
5
o
i
i
T
B
B
M
y
/
Z
v
0
h
e
Y
M
5
d
g
S
y
r
S
w
t
x
I
2
p
J
o
y
t
O
l
U
b
A
j
e
4
s
v
L
x
D
+
r
X
9
W
9
u
/
N
a
4
7
p
I
o
w
x
H
c
A
y
n
4
M
E
F
N
O
A
W
m
u
A
D
g
w
E
8
w
y
u
8
O
d
J
5
c
d
6
d
j
3
l
r
y
S
l
m
D
u
E
P
n
M
8
f
o
f
a
N
j
w
=
=
<
/
l
a
t
e
x
i
t
>
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
q
4
j
k
t
o
b
t
7
r
D
I
P
t
S
o
s
F
I
g
T
T
o
g
X
B
w
=
"
>
A
A
A
B
6
X
i
c
b
V
B
N
S
8
N
A
E
J
3
U
r
1
q
/
q
h
6
9
L
B
b
B
U
0
l
E
U
G
9
F
L
x
4
r
G
l
t
o
Q
9
l
s
N
+
3
S
z
S
b
s
T
o
Q
S
+
h
O
8
e
F
D
x
6
j
/
y
5
r
9
x
2
+
a
g
r
Q
8
G
H
u
/
N
M
D
M
v
T
K
U
w
6
L
r
f
T
m
l
l
d
W
1
9
o
7
x
Z
2
d
r
e
2
d
2
r
7
h
8
8
m
i
T
T
j
P
s
s
k
Y
l
u
h
9
R
w
K
R
T
3
U
a
D
k
7
V
R
z
G
o
e
S
t
8
L
R
z
d
R
v
P
X
F
t
R
K
I
e
c
J
z
y
I
K
Y
D
J
S
L
B
K
F
r
p
v
t
l
j
v
W
r
N
r
b
s
z
k
G
X
i
F
a
Q
G
B
Z
q
9
6
l
e
3
n
7
A
s
5
g
q
Z
p
M
Z
0
P
D
f
F
I
K
c
a
B
Z
N
8
U
u
l
m
h
q
e
U
j
e
i
A
d
y
x
V
N
O
Y
m
y
G
e
n
T
s
i
J
V
f
o
k
S
r
Q
t
h
W
S
m
/
p
7
I
a
W
z
M
O
A
5
t
Z
0
x
x
a
B
a
9
q
f
i
f
1
8
k
w
u
g
x
y
o
d
I
M
u
W
L
z
R
V
E
m
C
S
Z
k
+
j
f
p
C
8
0
Z
y
r
E
l
l
G
l
h
b
y
V
s
S
D
V
l
a
N
O
p
2
B
C
8
x
Z
e
X
i
X
9
W
v
6
p
7
d
+
e
1
x
n
W
R
R
h
m
O
4
B
h
O
w
Y
M
L
a
M
A
t
N
M
E
H
B
g
N
4
h
l
d
4
c
6
T
z
4
r
w
7
H
/
P
W
k
l
P
M
H
M
I
f
O
J
8
/
i
E
O
N
f
g
=
=
<
/
l
a
t
e
x
i
t
>
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
q
4
j
k
t
o
b
t
7
r
D
I
P
t
S
o
s
F
I
g
T
T
o
g
X
B
w
=
"
>
A
A
A
B
6
X
i
c
b
V
B
N
S
8
N
A
E
J
3
U
r
1
q
/
q
h
6
9
L
B
b
B
U
0
l
E
U
G
9
F
L
x
4
r
G
l
t
o
Q
9
l
s
N
+
3
S
z
S
b
s
T
o
Q
S
+
h
O
8
e
F
D
x
6
j
/
y
5
r
9
x
2
+
a
g
r
Q
8
G
H
u
/
N
M
D
M
v
T
K
U
w
6
L
r
f
T
m
l
l
d
W
1
9
o
7
x
Z
2
d
r
e
2
d
2
r
7
h
8
8
m
i
T
T
j
P
s
s
k
Y
l
u
h
9
R
w
K
R
T
3
U
a
D
k
7
V
R
z
G
o
e
S
t
8
L
R
z
d
R
v
P
X
F
t
R
K
I
e
c
J
z
y
I
K
Y
D
J
S
L
B
K
F
r
p
v
t
l
j
v
W
r
N
r
b
s
z
k
G
X
i
F
a
Q
G
B
Z
q
9
6
l
e
3
n
7
A
s
5
g
q
Z
p
M
Z
0
P
D
f
F
I
K
c
a
B
Z
N
8
U
u
l
m
h
q
e
U
j
e
i
A
d
y
x
V
N
O
Y
m
y
G
e
n
T
s
i
J
V
f
o
k
S
r
Q
t
h
W
S
m
/
p
7
I
a
W
z
M
O
A
5
t
Z
0
x
x
a
B
a
9
q
f
i
f
1
8
k
w
u
g
x
y
o
d
I
M
u
W
L
z
R
V
E
m
C
S
Z
k
+
j
f
p
C
8
0
Z
y
r
E
l
l
G
l
h
b
y
V
s
S
D
V
l
a
N
O
p
2
B
C
8
x
Z
e
X
i
X
9
W
v
6
p
7
d
+
e
1
x
n
W
R
R
h
m
O
4
B
h
O
w
Y
M
L
a
M
A
t
N
M
E
H
B
g
N
4
h
l
d
4
c
6
T
z
4
r
w
7
H
/
P
W
k
l
P
M
H
M
I
f
O
J
8
/
i
E
O
N
f
g
=
=
<
/
l
a
t
e
x
i
t
>
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
q
4
j
k
t
o
b
t
7
r
D
I
P
t
S
o
s
F
I
g
T
T
o
g
X
B
w
=
"
>
A
A
A
B
6
X
i
c
b
V
B
N
S
8
N
A
E
J
3
U
r
1
q
/
q
h
6
9
L
B
b
B
U
0
l
E
U
G
9
F
L
x
4
r
G
l
t
o
Q
9
l
s
N
+
3
S
z
S
b
s
T
o
Q
S
+
h
O
8
e
F
D
x
6
j
/
y
5
r
9
x
2
+
a
g
r
Q
8
G
H
u
/
N
M
D
M
v
T
K
U
w
6
L
r
f
T
m
l
l
d
W
1
9
o
7
x
Z
2
d
r
e
2
d
2
r
7
h
8
8
m
i
T
T
j
P
s
s
k
Y
l
u
h
9
R
w
K
R
T
3
U
a
D
k
7
V
R
z
G
o
e
S
t
8
L
R
z
d
R
v
P
X
F
t
R
K
I
e
c
J
z
y
I
K
Y
D
J
S
L
B
K
F
r
p
v
t
l
j
v
W
r
N
r
b
s
z
k
G
X
i
F
a
Q
G
B
Z
q
9
6
l
e
3
n
7
A
s
5
g
q
Z
p
M
Z
0
P
D
f
F
I
K
c
a
B
Z
N
8
U
u
l
m
h
q
e
U
j
e
i
A
d
y
x
V
N
O
Y
m
y
G
e
n
T
s
i
J
V
f
o
k
S
r
Q
t
h
W
S
m
/
p
7
I
a
W
z
M
O
A
5
t
Z
0
x
x
a
B
a
9
q
f
i
f
1
8
k
w
u
g
x
y
o
d
I
M
u
W
L
z
R
V
E
m
C
S
Z
k
+
j
f
p
C
8
0
Z
y
r
E
l
l
G
l
h
b
y
V
s
S
D
V
l
a
N
O
p
2
B
C
8
x
Z
e
X
i
X
9
W
v
6
p
7
d
+
e
1
x
n
W
R
R
h
m
O
4
B
h
O
w
Y
M
L
a
M
A
t
N
M
E
H
B
g
N
4
h
l
d
4
c
6
T
z
4
r
w
7
H
/
P
W
k
l
P
M
H
M
I
f
O
J
8
/
i
E
O
N
f
g
=
=
<
/
l
a
t
e
x
i
t
>
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
q
4
j
k
t
o
b
t
7
r
D
I
P
t
S
o
s
F
I
g
T
T
o
g
X
B
w
=
"
>
A
A
A
B
6
X
i
c
b
V
B
N
S
8
N
A
E
J
3
U
r
1
q
/
q
h
6
9
L
B
b
B
U
0
l
E
U
G
9
F
L
x
4
r
G
l
t
o
Q
9
l
s
N
+
3
S
z
S
b
s
T
o
Q
S
+
h
O
8
e
F
D
x
6
j
/
y
5
r
9
x
2
+
a
g
r
Q
8
G
H
u
/
N
M
D
M
v
T
K
U
w
6
L
r
f
T
m
l
l
d
W
1
9
o
7
x
Z
2
d
r
e
2
d
2
r
7
h
8
8
m
i
T
T
j
P
s
s
k
Y
l
u
h
9
R
w
K
R
T
3
U
a
D
k
7
V
R
z
G
o
e
S
t
8
L
R
z
d
R
v
P
X
F
t
R
K
I
e
c
J
z
y
I
K
Y
D
J
S
L
B
K
F
r
p
v
t
l
j
v
W
r
N
r
b
s
z
k
G
X
i
F
a
Q
G
B
Z
q
9
6
l
e
3
n
7
A
s
5
g
q
Z
p
M
Z
0
P
D
f
F
I
K
c
a
B
Z
N
8
U
u
l
m
h
q
e
U
j
e
i
A
d
y
x
V
N
O
Y
m
y
G
e
n
T
s
i
J
V
f
o
k
S
r
Q
t
h
W
S
m
/
p
7
I
a
W
z
M
O
A
5
t
Z
0
x
x
a
B
a
9
q
f
i
f
1
8
k
w
u
g
x
y
o
d
I
M
u
W
L
z
R
V
E
m
C
S
Z
k
+
j
f
p
C
8
0
Z
y
r
E
l
l
G
l
h
b
y
V
s
S
D
V
l
a
N
O
p
2
B
C
8
x
Z
e
X
i
X
9
W
v
6
p
7
d
+
e
1
x
n
W
R
R
h
m
O
4
B
h
O
w
Y
M
L
a
M
A
t
N
M
E
H
B
g
N
4
h
l
d
4
c
6
T
z
4
r
w
7
H
/
P
W
k
l
P
M
H
M
I
f
O
J
8
/
i
E
O
N
f
g
=
=
<
/
l
a
t
e
x
i
t
>
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
W
T
t
9
I
1
+
D
U
K
5
c
S
2
Y
t
S
8
o
/
H
j
I
M
l
W
E
=
"
>
A
A
A
B
6
X
i
c
b
V
B
N
S
8
N
A
E
J
3
U
r
1
q
/
q
h
6
9
L
B
b
B
U
0
l
E
U
G
9
F
L
x
4
r
G
l
t
o
Q
9
l
s
N
+
3
S
z
S
b
s
T
o
Q
S
+
h
O
8
e
F
D
x
6
j
/
y
5
r
9
x
2
+
a
g
r
Q
8
G
H
u
/
N
M
D
M
v
T
K
U
w
6
L
r
f
T
m
l
l
d
W
1
9
o
7
x
Z
2
d
r
e
2
d
2
r
7
h
8
8
m
i
T
T
j
P
s
s
k
Y
l
u
h
9
R
w
K
R
T
3
U
a
D
k
7
V
R
z
G
o
e
S
t
8
L
R
z
d
R
v
P
X
F
t
R
K
I
e
c
J
z
y
I
K
Y
D
J
S
L
B
K
F
r
p
v
t
n
D
X
r
X
m
1
t
0
Z
y
D
L
x
C
l
K
D
A
s
1
e
9
a
v
b
T
1
g
W
c
4
V
M
U
m
M
6
n
p
t
i
k
F
O
N
g
k
k
+
q
X
Q
z
w
1
P
K
R
n
T
A
O
5
Y
q
G
n
M
T
5
L
N
T
J
+
T
E
K
n
0
S
J
d
q
W
Q
j
J
T
f
0
/
k
N
D
Z
m
H
I
e
2
M
6
Y
4
N
I
v
e
V
P
z
P
6
2
Q
Y
X
Q
a
5
U
G
m
G
X
L
H
5
o
i
i
T
B
B
M
y
/
Z
v
0
h
e
Y
M
5
d
g
S
y
r
S
w
t
x
I
2
p
J
o
y
t
O
l
U
b
A
j
e
4
s
v
L
x
D
+
r
X
9
W
9
u
/
N
a
4
7
p
I
o
w
x
H
c
A
y
n
4
M
E
F
N
O
A
W
m
u
A
D
g
w
E
8
w
y
u
8
O
d
J
5
c
d
6
d
j
3
l
r
y
S
l
m
D
u
E
P
n
M
8
f
o
f
a
N
j
w
=
=
<
/
l
a
t
e
x
i
t
>
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
W
T
t
9
I
1
+
D
U
K
5
c
S
2
Y
t
S
8
o
/
H
j
I
M
l
W
E
=
"
>
A
A
A
B
6
X
i
c
b
V
B
N
S
8
N
A
E
J
3
U
r
1
q
/
q
h
6
9
L
B
b
B
U
0
l
E
U
G
9
F
L
x
4
r
G
l
t
o
Q
9
l
s
N
+
3
S
z
S
b
s
T
o
Q
S
+
h
O
8
e
F
D
x
6
j
/
y
5
r
9
x
2
+
a
g
r
Q
8
G
H
u
/
N
M
D
M
v
T
K
U
w
6
L
r
f
T
m
l
l
d
W
1
9
o
7
x
Z
2
d
r
e
2
d
2
r
7
h
8
8
m
i
T
T
j
P
s
s
k
Y
l
u
h
9
R
w
K
R
T
3
U
a
D
k
7
V
R
z
G
o
e
S
t
8
L
R
z
d
R
v
P
X
F
t
R
K
I
e
c
J
z
y
I
K
Y
D
J
S
L
B
K
F
r
p
v
t
n
D
X
r
X
m
1
t
0
Z
y
D
L
x
C
l
K
D
A
s
1
e
9
a
v
b
T
1
g
W
c
4
V
M
U
m
M
6
n
p
t
i
k
F
O
N
g
k
k
+
q
X
Q
z
w
1
P
K
R
n
T
A
O
5
Y
q
G
n
M
T
5
L
N
T
J
+
T
E
K
n
0
S
J
d
q
W
Q
j
J
T
f
0
/
k
N
D
Z
m
H
I
e
2
M
6
Y
4
N
I
v
e
V
P
z
P
6
2
Q
Y
X
Q
a
5
U
G
m
G
X
L
H
5
o
i
i
T
B
B
M
y
/
Z
v
0
h
e
Y
M
5
d
g
S
y
r
S
w
t
x
I
2
p
J
o
y
t
O
l
U
b
A
j
e
4
s
v
L
x
D
+
r
X
9
W
9
u
/
N
a
4
7
p
I
o
w
x
H
c
A
y
n
4
M
E
F
N
O
A
W
m
u
A
D
g
w
E
8
w
y
u
8
O
d
J
5
c
d
6
d
j
3
l
r
y
S
l
m
D
u
E
P
n
M
8
f
o
f
a
N
j
w
=
=
<
/
l
a
t
e
x
i
t
>
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
W
T
t
9
I
1
+
D
U
K
5
c
S
2
Y
t
S
8
o
/
H
j
I
M
l
W
E
=
"
>
A
A
A
B
6
X
i
c
b
V
B
N
S
8
N
A
E
J
3
U
r
1
q
/
q
h
6
9
L
B
b
B
U
0
l
E
U
G
9
F
L
x
4
r
G
l
t
o
Q
9
l
s
N
+
3
S
z
S
b
s
T
o
Q
S
+
h
O
8
e
F
D
x
6
j
/
y
5
r
9
x
2
+
a
g
r
Q
8
G
H
u
/
N
M
D
M
v
T
K
U
w
6
L
r
f
T
m
l
l
d
W
1
9
o
7
x
Z
2
d
r
e
2
d
2
r
7
h
8
8
m
i
T
T
j
P
s
s
k
Y
l
u
h
9
R
w
K
R
T
3
U
a
D
k
7
V
R
z
G
o
e
S
t
8
L
R
z
d
R
v
P
X
F
t
R
K
I
e
c
J
z
y
I
K
Y
D
J
S
L
B
K
F
r
p
v
t
n
D
X
r
X
m
1
t
0
Z
y
D
L
x
C
l
K
D
A
s
1
e
9
a
v
b
T
1
g
W
c
4
V
M
U
m
M
6
n
p
t
i
k
F
O
N
g
k
k
+
q
X
Q
z
w
1
P
K
R
n
T
A
O
5
Y
q
G
n
M
T
5
L
N
T
J
+
T
E
K
n
0
S
J
d
q
W
Q
j
J
T
f
0
/
k
N
D
Z
m
H
I
e
2
M
6
Y
4
N
I
v
e
V
P
z
P
6
2
Q
Y
X
Q
a
5
U
G
m
G
X
L
H
5
o
i
i
T
B
B
M
y
/
Z
v
0
h
e
Y
M
5
d
g
S
y
r
S
w
t
x
I
2
p
J
o
y
t
O
l
U
b
A
j
e
4
s
v
L
x
D
+
r
X
9
W
9
u
/
N
a
4
7
p
I
o
w
x
H
c
A
y
n
4
M
E
F
N
O
A
W
m
u
A
D
g
w
E
8
w
y
u
8
O
d
J
5
c
d
6
d
j
3
l
r
y
S
l
m
D
u
E
P
n
M
8
f
o
f
a
N
j
w
=
=
<
/
l
a
t
e
x
i
t
>
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
W
T
t
9
I
1
+
D
U
K
5
c
S
2
Y
t
S
8
o
/
H
j
I
M
l
W
E
=
"
>
A
A
A
B
6
X
i
c
b
V
B
N
S
8
N
A
E
J
3
U
r
1
q
/
q
h
6
9
L
B
b
B
U
0
l
E
U
G
9
F
L
x
4
r
G
l
t
o
Q
9
l
s
N
+
3
S
z
S
b
s
T
o
Q
S
+
h
O
8
e
F
D
x
6
j
/
y
5
r
9
x
2
+
a
g
r
Q
8
G
H
u
/
N
M
D
M
v
T
K
U
w
6
L
r
f
T
m
l
l
d
W
1
9
o
7
x
Z
2
d
r
e
2
d
2
r
7
h
8
8
m
i
T
T
j
P
s
s
k
Y
l
u
h
9
R
w
K
R
T
3
U
a
D
k
7
V
R
z
G
o
e
S
t
8
L
R
z
d
R
v
P
X
F
t
R
K
I
e
c
J
z
y
I
K
Y
D
J
S
L
B
K
F
r
p
v
t
n
D
X
r
X
m
1
t
0
Z
y
D
L
x
C
l
K
D
A
s
1
e
9
a
v
b
T
1
g
W
c
4
V
M
U
m
M
6
n
p
t
i
k
F
O
N
g
k
k
+
q
X
Q
z
w
1
P
K
R
n
T
A
O
5
Y
q
G
n
M
T
5
L
N
T
J
+
T
E
K
n
0
S
J
d
q
W
Q
j
J
T
f
0
/
k
N
D
Z
m
H
I
e
2
M
6
Y
4
N
I
v
e
V
P
z
P
6
2
Q
Y
X
Q
a
5
U
G
m
G
X
L
H
5
o
i
i
T
B
B
M
y
/
Z
v
0
h
e
Y
M
5
d
g
S
y
r
S
w
t
x
I
2
p
J
o
y
t
O
l
U
b
A
j
e
4
s
v
L
x
D
+
r
X
9
W
9
u
/
N
a
4
7
p
I
o
w
x
H
c
A
y
n
4
M
E
F
N
O
A
W
m
u
A
D
g
w
E
8
w
y
u
8
O
d
J
5
c
d
6
d
j
3
l
r
y
S
l
m
D
u
E
P
n
M
8
f
o
f
a
N
j
w
=
=
<
/
l
a
t
e
x
i
t
>
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
b
5
a
2
v
C
5
B
j
b
u
U
n
F
i
a
7
R
U
8
u
e
k
F
U
b
Q
=
"
>
A
A
A
B
9
H
i
c
b
V
D
L
S
g
M
x
F
L
1
T
X
7
W
+
q
i
7
d
B
I
v
g
q
s
w
U
Q
Z
c
F
F
7
q
s
Y
B
/
Q
j
i
W
T
Z
t
r
Q
J
D
N
N
M
o
U
y
9
D
v
c
u
F
D
E
r
R
/
j
z
r
8
x
0
8
5
C
W
w
8
E
D
u
f
c
y
z
0
5
Q
c
y
Z
N
q
7
7
7
R
Q
2
N
r
e
2
d
4
q
7
p
b
3
9
g
8
O
j
8
v
F
J
S
0
e
J
I
r
R
J
I
h
6
p
T
o
A
1
5
U
z
S
p
m
G
G
0
0
6
s
K
B
Y
B
p
+
1
g
f
J
v
5
7
S
l
V
m
k
X
y
0
c
x
i
6
g
s
8
l
C
x
k
B
B
s
r
+
T
2
B
z
U
i
J
t
H
H
3
V
J
v
3
y
x
W
3
6
i
6
A
1
o
m
X
k
w
r
k
a
P
T
L
X
7
1
B
R
B
J
B
p
S
E
c
a
9
3
1
3
N
j
4
K
V
a
G
E
U
7
n
p
V
6
i
a
Y
z
J
G
A
9
p
1
1
K
J
B
d
V
+
u
g
g
9
R
x
d
W
G
a
A
w
U
v
Z
J
g
x
b
q
7
4
0
U
C
6
1
n
I
r
C
T
W
U
i
9
6
m
X
i
f
1
4
3
M
e
G
N
n
z
I
Z
J
4
Z
K
s
j
w
U
J
h
y
Z
C
G
U
N
o
A
F
T
l
B
g
+
s
w
Q
T
x
W
x
W
R
E
Z
Y
Y
W
J
s
T
y
V
b
g
r
f
6
5
X
X
S
q
l
U
9
y
x
+
u
K
v
V
q
X
k
c
R
z
u
A
c
L
s
G
D
a
6
j
D
P
T
S
g
C
Q
Q
m
8
A
y
v
8
O
Z
M
n
R
f
n
3
f
l
Y
j
h
a
c
f
O
c
U
/
s
D
5
/
A
G
f
V
Z
H
s
<
/
l
a
t
e
x
i
t
>
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
s
l
C
i
t
i
i
j
C
U
d
/
c
c
7
S
J
n
N
9
h
n
e
n
E
x
A
=
"
>
A
A
A
B
9
X
i
c
b
V
B
N
S
8
N
A
F
H
z
x
s
9
a
v
q
k
c
v
i
0
X
w
V
B
I
R
9
F
j
w
4
k
k
q
m
L
b
Q
x
r
L
Z
b
t
u
l
m
0
3
Y
f
V
F
K
6
P
/
w
4
k
E
R
r
/
4
X
b
/
4
b
N
2
0
O
2
j
q
w
M
M
y
8
x
5
u
d
M
J
H
C
o
O
t
+
O
y
u
r
a
+
s
b
m
6
W
t
8
v
b
O
7
t
5
+
5
e
C
w
a
e
J
U
M
+
6
z
W
M
a
6
H
V
L
D
p
V
D
c
R
4
G
S
t
x
P
N
a
R
R
K
3
g
r
H
1
7
n
f
e
u
T
a
i
F
j
d
4
y
T
h
Q
U
S
H
S
g
w
E
o
2
i
l
h
2
5
E
c
a
S
j
r
O
n
f
c
p
z
2
K
l
W
3
5
s
5
A
l
o
l
X
k
C
o
U
a
P
Q
q
X
9
1
+
z
N
K
I
K
2
S
S
G
t
P
x
3
A
S
D
j
G
o
U
T
P
J
p
u
Z
s
a
n
l
A
2
p
k
P
e
s
V
T
R
i
J
s
g
m
6
W
e
k
l
O
r
9
M
k
g
1
v
Y
p
J
D
P
1
9
0
Z
G
I
2
M
m
U
W
g
n
8
5
R
m
0
c
v
F
/
7
x
O
i
o
O
r
I
B
M
q
S
Z
E
r
N
j
8
0
S
C
X
B
m
O
Q
V
k
L
7
Q
n
K
G
c
W
E
K
Z
F
j
Y
r
Y
S
O
q
K
U
N
b
V
N
m
W
4
C
1
+
e
Z
k
0
z
2
u
e
5
X
c
X
1
X
q
t
q
K
M
E
x
3
A
C
Z
+
D
B
J
d
T
h
B
h
r
g
A
w
M
N
z
/
A
K
b
8
6
T
8
+
K
8
O
x
/
z
0
R
W
n
2
D
m
C
P
3
A
+
f
w
D
N
E
5
K
h
<
/
l
a
t
e
x
i
t
>
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
1
7
X
E
F
c
L
a
d
M
q
j
u
4
2
j
C
1
j
h
W
3
7
d
H
K
Y
=
"
>
A
A
A
B
9
H
i
c
b
V
D
L
S
g
M
x
F
L
3
j
s
9
Z
X
1
a
W
b
Y
B
F
c
l
R
k
R
d
F
l
w
4
8
4
K
9
g
H
t
U
D
J
p
p
g
1
N
M
m
M
e
h
T
L
0
O
9
y
4
U
M
S
t
H
+
P
O
v
z
H
T
z
k
J
b
D
w
Q
O
5
9
z
L
P
T
l
R
y
p
k
2
v
v
/
t
r
a
1
v
b
G
5
t
l
3
b
K
u
3
v
7
B
4
e
V
o
+
O
W
T
q
w
i
t
E
k
S
n
q
h
O
h
D
X
l
T
N
K
m
Y
Y
b
T
T
q
o
o
F
h
G
n
7
W
h
8
m
/
v
t
C
V
W
a
J
f
L
R
T
F
M
a
C
j
y
U
L
G
Y
E
G
y
e
F
P
Y
H
N
S
I
n
s
3
i
o
9
6
1
e
q
f
s
2
f
A
6
2
S
o
C
B
V
K
N
D
o
V
7
5
6
g
4
R
Y
Q
a
U
h
H
G
v
d
D
f
z
U
h
B
l
W
h
h
F
O
Z
+
W
e
1
T
T
F
Z
I
y
H
t
O
u
o
x
I
L
q
M
J
u
H
n
q
F
z
p
w
x
Q
n
C
j
3
p
E
F
z
9
f
d
G
h
o
X
W
U
x
G
5
y
T
y
k
X
v
Z
y
8
T
+
v
a
0
1
8
E
2
Z
M
p
t
Z
Q
S
R
a
H
Y
s
u
R
S
V
D
e
A
B
o
w
R
Y
n
h
U
0
c
w
U
c
x
l
R
W
S
E
F
S
b
G
9
V
R
2
J
Q
T
L
X
1
4
l
r
c
t
a
4
P
j
D
V
b
V
e
K
+
o
o
w
S
m
c
w
Q
U
E
c
A
1
1
u
I
M
G
N
I
H
A
E
z
z
D
K
7
x
5
E
+
/
F
e
/
c
+
F
q
N
r
X
r
F
z
A
n
/
g
f
f
4
A
Z
V
u
S
b
g
=
=
<
/
l
a
t
e
x
i
t
>
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
a
7
P
L
f
p
h
o
n
z
+
v
F
7
b
B
z
b
B
J
b
9
8
c
S
J
c
=
"
>
A
A
A
B
+
H
i
c
b
V
D
L
S
s
N
A
F
L
3
x
W
e
u
j
U
Z
d
u
B
o
v
g
q
i
Q
i
6
L
K
g
C
5
c
V
7
A
P
a
U
C
b
T
2
3
b
o
T
B
J
m
J
k
I
N
/
R
I
3
L
h
R
x
6
6
e
4
8
2
+
c
t
F
l
o
6
4
G
B
w
z
n
3
c
s
+
c
M
B
F
c
G
8
/
7
d
t
b
W
N
z
a
3
t
k
s
7
5
d
2
9
/
Y
O
K
e
3
j
U
0
n
G
q
G
D
Z
Z
L
G
L
V
C
a
l
G
w
S
N
s
G
m
4
E
d
h
K
F
V
I
Y
C
2
+
H
k
J
v
f
b
j
6
g
0
j
6
M
H
M
0
0
w
k
H
Q
U
8
S
F
n
1
F
i
p
7
1
Z
6
k
p
q
x
k
t
k
t
D
m
M
l
Z
3
2
3
6
t
W
8
O
c
g
q
8
Q
t
S
h
Q
K
N
v
v
v
V
G
8
Q
s
l
R
g
Z
J
q
j
W
X
d
9
L
T
J
B
R
Z
T
g
T
O
C
v
3
U
o
0
J
Z
R
M
6
w
q
6
l
E
Z
W
o
g
2
w
e
f
E
b
O
r
D
I
g
9
r
B
9
k
S
F
z
9
f
d
G
R
q
X
W
U
x
n
a
y
T
y
m
X
v
Z
y
8
T
+
v
m
5
r
h
d
Z
D
x
K
E
k
N
R
m
x
x
a
J
g
K
Y
m
K
S
t
0
A
G
X
C
E
z
Y
m
o
J
Z
Y
r
b
r
I
S
N
q
a
L
M
2
K
7
K
t
g
R
/
+
c
u
r
p
H
V
R
8
y
2
/
v
6
z
W
a
0
U
d
J
T
i
B
U
z
g
H
H
6
6
g
D
n
f
Q
g
C
Y
w
S
O
E
Z
X
u
H
N
e
X
J
e
n
H
f
n
Y
z
G
6
5
h
Q
7
x
/
A
H
z
u
c
P
Q
o
2
T
Z
w
=
=
<
/
l
a
t
e
x
i
t
>
Model

Ma et al. [21]
Ma et al. [22]

Siarohin et al. [34]

Ma et al. * [21]

Siarohin et al. * [34]

Esser et al. * [5]

Ours

Real Data

SSIM
0.253
0.099
0.290
0.261
0.291
0.266
0.311
1.000

IS

3.460
3.483
3.185
3.495
3.230
2.965
3.323
3.890

Market-1501

mask-SSIM

mask-IS

DS

PCKh

0.792
0.614
0.805
0.782
0.807
0.793
0.811
1.000

3.435
3.491
3.502
3.367
3.502
3.549
3.773
3.706

-
-

0.72
0.39
0.72
0.72
0.74
0.74

-
-
-

0.73
0.94
0.92
0.94
1.00

SSIM
0.762
0.614
0.756
0.773
0.760
0.763
0.773
1.000

DeepFashion
IS
DS

3.090
3.228
3.439
3.163
3.362
3.440
3.209
4.053

-
-

0.96
0.951
0.967
0.972
0.976
0.968

PCKh

-
-
-

0.89
0.94
0.93
0.96
1.00

Table 1: Comparison with state-of-the-art on Market-1501 and DeepFashion. * denotes the results tested on our test set.

(in the last row). Moreover, we achieved the best appear-
ance consistency, e.g., the bag is presented in our result
while lost by other methods (in the ﬁrst row).

condition images of poor quality, where 63.47% of our gen-
erated images are regarded as real by volunteers, reﬂected
as the “G2R” measure in Tab.3.

4.1.2 Model and computation complexity comparison

Tab.2 gives the model and computation complexity of all
the three methods. These methods are tested under one
NVIDIA Titan Xp graphics card in the same workstation.
Only GPU time is taken into account when generating all
the testing pairs of DeepFashion to compute the speed. No-
tably, our method signiﬁcantly outperforms other methods
in both the number of parameters and the computation com-
plexity, owing to the simple and neat structure of the build-
ing blocks (PATBs) of our network. In contrast, the two-
stage strategy of Ma et al.
[21] brings a huge increase
in parameters and computational burden. Although Siaro-
[34] switched to one stage model by introduc-
hin et al.
ing the deformable skip connections (DSCs) leading to a
decreased model size, the computation-intensive body part
afﬁne transformations required by DSCs make the decrease
of computation complexity only marginal.

Method

Params

Speed

Ma et al. [21]

Siarohin et al. [34]

Esser et al. [5]
Ours (9 PATBs)

437.09 M 10.36 fps
82.08 M
17.74 fps
139.36 M 29.37 fps
41.36 M
60.61 fps

Table 2: Comparison of model size and testing speed on DeepFashion
dataset. “M” denotes millions and “fps” denotes Frames Per Second.

4.1.3 User study

Generally, it is more appropriate to judge the realness of
the generated images by human. We recruit 30 volunteers
to give an instant judgment (real/fake) about each image
within a second. Following the protocol of [21, 34], 55
real and 55 generated images are randomly selected and
shufﬂed, the ﬁrst 10 of them are used for practice then the
remaining 100 images are used as the evaluation set. Our
method makes considerable improvements over [21, 34] on
all measurements, as shown in Tab.3, further validating that
our generated images are more realistic, natural and sharp.
It’s worth noticing that our method quite excels at handling

Model

Ma et al. [21]
Siarohin et al. [34]
Ours

Market-1501

DeepFashion

R2G
11.2
22.67
32.23

G2R
5.5

50.24
63.47

R2G
9.2

12.42
19.14

G2R
14.9
24.61
31.78

Table 3: User study (%). R2G means the percentage of real images rated
as generated w.r.t. all real images. G2R means the percentage of gener-
ated images rated as real w.r.t. all generated images. The results of other
methods are drawn from their papers.

4.2. Ablation study and result analysis

Resnet Generator

PATN Generator

5-blocks 9-blocks 13-blocks 5-blocks 9-blocks 13-blocks

PATN Generator

w/o add w/o cat w/o resD

Figure 4: Qualitative results of the ablation study on Market-1501 and
DeepFashion dataset. The images with pink border are generated by
Resnet generator [13, 12] containing 5, 9, 13 residual blocks [9] from left
to right respectively. And the images with blue borders are generated by
our PATN generator containing 5, 9, 13 PATBs. The images with orange
borders are generated by discarding a certain part of the whole model.

Efﬁcacy of the main contributions. The generator of our
network – PATN has two important design characteristics:
one is the carefully designed building block – PATB which
aims to optimize appearance and pose simultaneously us-
ing the attention mechanism, and the other is the cascade of
building blocks which aims to guide the deformable transfer
process progressively. Therefore, we carry out two compar-
ison experiments, one is to explore the advantage of PATB
by replacing it with vanilla residual block [13] that results
in a generator named Resnet generator, and the other is to
exhibit the advantage of the progressive manner by varying
the number of PATBs.

2352

<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
O
k
K
x
L
Z
h
g
H
y
W
d
t
n
/
n
m
w
1
B
z
I
u
J
U
B
g
=
"
>
A
A
A
B
6
n
i
c
b
Z
B
N
S
w
M
x
E
I
Z
n
/
a
z
1
q
+
r
R
S
7
A
I
P
Z
V
d
L
3
o
s
e
P
F
Y
0
X
5
A
u
5
R
s
m
m
1
D
k
+
y
S
z
A
p
l
6
U
/
w
4
k
E
R
r
/
4
i
b
/
4
b
0
3
Y
P
2
v
p
C
4
O
G
d
G
T
L
z
R
q
k
U
F
n
3
/
2
9
v
Y
3
N
r
e
2
S
3
t
l
f
c
P
D
o
+
O
K
y
e
n
b
Z
t
k
h
v
E
W
S
2
R
i
u
h
G
1
X
A
r
N
W
y
h
Q
8
m
5
q
O
F
W
R
5
J
1
o
c
j
u
v
d
5
6
4
s
S
L
R
j
z
h
N
e
a
j
o
S
I
t
Y
M
I
r
O
e
m
g
O
2
K
B
S
9
e
v
+
Q
m
Q
d
g
g
K
q
U
K
g
5
q
H
z
1
h
w
n
L
F
N
f
I
J
L
W
2
F
/
g
p
h
j
k
1
K
J
j
k
s
3
I
/
s
z
y
l
b
E
J
H
v
O
d
Q
U
8
V
t
m
C
9
W
n
Z
F
L
5
w
x
J
n
B
j
3
N
J
K
F
+
3
s
i
p
8
r
a
q
Y
p
c
p
6
I
4
t
q
u
1
u
f
l
f
r
Z
d
h
f
B
P
m
Q
q
c
Z
c
s
2
W
H
8
W
Z
J
J
i
Q
+
d
1
k
K
A
x
n
K
K
c
O
K
D
P
C
7
U
r
Y
m
B
r
K
0
K
V
T
d
i
E
E
q
y
e
v
Q
/
u
q
H
j
i
+
9
6
u
N
W
h
F
H
C
c
7
h
A
m
o
Q
w
D
U
0
4
A
6
a
0
A
I
G
I
3
i
G
V
3
j
z
p
P
f
i
v
X
s
f
y
9
Y
N
r
5
g
5
g
z
/
y
P
n
8
A
E
X
i
N
j
A
=
=
<
/
l
a
t
e
x
i
t
>
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
e
h
L
F
W
f
J
5
e
D
p
o
g
j
g
T
v
3
H
8
9
x
r
w
J
z
Y
=
"
>
A
A
A
B
6
n
i
c
b
Z
B
N
S
w
M
x
E
I
Z
n
/
a
z
1
q
+
r
R
S
7
A
I
P
Z
V
d
L
3
o
s
e
P
F
Y
0
X
5
A
u
5
R
s
m
m
1
D
k
+
y
S
z
A
p
l
6
U
/
w
4
k
E
R
r
/
4
i
b
/
4
b
0
3
Y
P
2
v
p
C
4
O
G
d
G
T
L
z
R
q
k
U
F
n
3
/
2
9
v
Y
3
N
r
e
2
S
3
t
l
f
c
P
D
o
+
O
K
y
e
n
b
Z
t
k
h
v
E
W
S
2
R
i
u
h
G
1
X
A
r
N
W
y
h
Q
8
m
5
q
O
F
W
R
5
J
1
o
c
j
u
v
d
5
6
4
s
S
L
R
j
z
h
N
e
a
j
o
S
I
t
Y
M
I
r
O
e
m
g
O
c
F
C
p
+
n
V
/
I
b
I
O
Q
Q
F
V
K
N
Q
c
V
L
7
6
w
4
R
l
i
m
t
k
k
l
r
b
C
/
w
U
w
5
w
a
F
E
z
y
W
b
m
f
W
Z
5
S
N
q
E
j
3
n
O
o
q
e
I
2
z
B
e
r
z
s
i
l
c
4
Y
k
T
o
x
7
G
s
n
C
/
T
2
R
U
2
X
t
V
E
W
u
U
1
E
c
2
9
X
a
3
P
y
v
1
s
s
w
v
g
l
z
o
d
M
M
u
W
b
L
j
+
J
M
E
k
z
I
/
G
4
y
F
I
Y
z
l
F
M
H
l
B
n
h
d
i
V
s
T
A
1
l
6
N
I
p
u
x
C
C
1
Z
P
X
o
X
1
V
D
x
z
f
+
9
V
G
r
Y
i
j
B
O
d
w
A
T
U
I
4
B
o
a
c
A
d
N
a
A
G
D
E
T
z
D
K
7
x
5
0
n
v
x
3
r
2
P
Z
e
u
G
V
8
y
c
w
R
9
5
n
z
8
r
P
I
2
d
<
/
l
a
t
e
x
i
t
>
Qualitative comparison results are shown in Fig.4. Com-
paring the images yield by Resnet generator and those yield
by our PATN generator with the same number of building
blocks, it is evident that PATN generator can always gener-
ate images demonstrating much more consistent shape and
appearance with its target image.

Moreover, the Resnet generator is prone to ignore some
indistinguishable but representative appearance information
which usually occupies a small portion of the image, and
fails to generate correct foreground shape when the target
pose is relatively rare. For instance, Resnet generator is
likely to ignore the bottom red ring of the sweater in the
ﬁrst row, the white cap in the third row and mislead the T-
shirt color as black in the fourth row since a black backpack
occludes a large portion of the T-shirt. Besides, the shapes
of the sitting girls produced by Resnet generator in the sec-
ond row are somewhat incomplete as this pose is quite rare
in DeepFashion [19].

As a contrast, our PATN generator with only 5 PATBs
could do better than the Resnet generator with 13 residual
blocks. We assume this should be attributed to the pose
attention mechanism which enhances model’s abilities in
capturing useful features and leveraging them. And our
PATN can produce much ﬁner and more pleasant person
images with 9 PATBs. Further increasing the number of
PATBs to 13 can marginally boost the performance. This
phenomenon reﬂects that increasing the number of PATBs
will ease the transfer process and give results with less arti-
facts. For a tradeoff, we chose 9 PATBs as default for better
efﬁciency. More qualitative results are given in the supple-
mentary materials for further reference.

Under almost all the quantitative measures shown in
Tab.4, our PATN generator with only 5 PATBs outperforms
Resnet generator with all its number of residual blocks con-
ﬁgurations. These results clearly demonstrate the advan-
tages of our PATN generator.

Dissection of the PATB operations and the discrimina-
tor modiﬁcations. Besides, to investigate the effect of each
part of PATB, we conduct experiments by removing the ad-
dition (w/o add) and concatenation (w/o cat) operation in
every PATB inside the PATN generator (9 blocks). To dis-
cuss how many improvements obtained from the modiﬁed
discriminators, we further added an experiment by discard-
ing the residual blocks in discriminators (w/o resD). The
qualitative and quantitative results are also given in Fig.4
and Tab.4. It’s shown that by removing any parts of PATB
would lead to a performance drop, visually exhibiting a cer-
tain degree of color distortion and implausible details. Dis-
carding residual blocks in the discriminators also reduces
local details and inﬂuences the integrity of the person body.

Visualization of the attention masks in PATBs. To get an
intuitive understanding on how the PATBs work during the

pose transfer process, we visualize the attention masks of all
the nine cascaded PATBs in Fig.5. The pose attention trans-
fer process is clear and interpretable, where the attention
masks always attend to the regions needed to be adjusted in
a progressive manner. The initial several masks (ﬁrst three
columns of masks) are some sort of blending of condition
pose and target pose. As the condition pose is transferred
towards the target pose, the regions needed to be adjusted
are shrunk and scattered, reﬂected in the middle four mask
columns. Eventually, the last two mask columns show that
the attention is turned from foreground to background for
reﬁnement.

Condition 

image

PAT1

PAT2

PAT3

PAT4

PAT5

PAT6

PAT7

PAT8

PAT9

Generated

 image

Target
 image

1

0.5

0

Figure 5: Visualization of the attention masks in PATBs. “PAT1” denotes
the attention mask of the ﬁrst PATB and “PAT2∼9” likewise.

5. Application to person re-identiﬁcation

A good person pose transfer method can generate
realistic-looking person images to augment the datasets of
person-related vision tasks, which might result in better per-
formance especially in the situation of insufﬁcient training
data. As person re-identiﬁcation (re-ID) [46] is increasingly
promising in real-world applications and has great research
signiﬁcance, we choose to evaluate the performance of our
method in augmenting the person re-ID dataset. Speciﬁ-
cally, we use the mainstream person re-ID dataset Market-
1501 [45] and two advanced backbone network, ResNet-50
[9] and Inception-v2 [36], as our test bed.

We ﬁrst randomly select a portion p of the real Market-
1501 dataset as the reduced training set, denoted as MR
p ,
where at least one image per identity is preserved in MR
p for
better person identity variety. Each unselected training im-

randomly chosen image with the same identity in MR

age eIi is replaced by a generated image that transfers from a
pose of eIi. Consequently, an augmented training set MA

p to the
p is
formed from all these generated images and MR
p . The se-
lected portion p varies from 10% to 90% at intervals of 10%.
We follow the training and testing protocols of the Open-
Reid Framework3 to train the ResNet-50 and Inception-v2
on each of the nine reduced training set MR
p and the nine
augmented training set MA

p respectively.

We argue that our experiment scheme is well-suited for
assessing the usefulness of our image generation method
in boosting the performance of re-ID via data augmentation
due to the following two reasons: 1) the original training set

3https://github.com/Cysu/open-reid

2353

Model

Resnet generator (5 blocks)
Resnet generator (9 blocks)
Resnet generator (13 blocks)

PATN generator (5 blocks)
PATN generator (9 blocks)
PATN generator (13 blocks)

PATN generator w/o add
PATN generator w/o cat
PATN generator w/o resD

SSIM
0.297
0.301
0.300

0.309
0.311
0.314

0.305
0.306
0.308

IS

3.236
3.077
3.134

3.273
3.323
3.274

3.650
3.373
3.536

Market-1501

mask-SSIM

mask-IS

0.802
0.802
0.797

0.809
0.811
0.808

0.805
0.807
0.809

3.807
3.862
3.731

3.870
3.773
3.797

3.899
3.915
3.606

DS
0.67
0.69
0.67

0.69
0.74
0.75

0.73
0.71
0.73

PCKh
0.84
0.87
0.88

0.91
0.94
0.93

0.92
0.92
0.93

SSIM
0.764
0.767
0.766

0.771
0.773
0.776

0.769
0.767
0.773

DeepFashion
IS
DS
0.900
0.941
0.943

2.952
3.157
3.107

3.108
3.209
3.440

3.265
3.200
3.442

0.958
0.976
0.970

0.970
0.968
0.978

PCKh
0.89
0.90
0.89

0.93
0.96
0.96

0.93
0.95
0.94

Table 4: Quantitative comparison of the ablation study.

Aug. Model

None (Inc)

Ours

None (Res)
VUNet[5]
Deform[34]

Ours
Ours*

0.1
5.7
42.3
9.2
49.8
51.9
52.6
53.3

0.2
16.6
43.6
27.6
51.7
53.9
54.5
55.9

0.3
26.0
45.7
41.5
53.7
55.4
56.5
56.0

Portion p of the real images
0.7
0.4
46.5
33.5
49.1
46.7
50.3
61.2
59.4
54.5
60.5
56.1
62.1
56.6
57.3
60.7

0.5
39.2
48.0
56.2
56.6
57.6
60.3
58.8

0.6
42.2
48.5
58.8
58.4
59.4
60.9
60.4

0.8
49.0
50.7
62.7
61.3
62.2
63.3
63.1

0.9
49.5
51.6
63.8
62.9
63.5
64.8
64.5

1.0
52.7
52.7
65.3
65.3
65.3
65.3
65.3

Aug. ratio
3
2
-
-

56.6

-

63.9
64.2
65.3
65.1

57.1

-

64.1
64.6
65.7
65.4

Table 5: The ReID results on Inception-v2 (denoted by Inc) and ResNet-
50 (denoted by Res) using images generated by different methods. None
means no generative model is employed. * denotes the results when we
randomly select target poses from M R

p for data augmentation.

reduction leads to a degree of data insufﬁciency, offering an
opportunity to boost the performance via data augmentation
and giving the performance lower bound; 2) the reference
results utilize all the real images including all the ground
truth of the generated images, thus could give the theoretical
performance upper bound. Besides, the gaps between the
upper and lower bounds could measure the maximum po-
tential of data augmentation in boosting re-ID performance.
Tab.5 shows that whenever there’s a performance gap,
there is undoubtedly a performance boost owing to our data
augmentation. And the performance gain is much more sig-
niﬁcant if the performance gap is relatively large. A natu-
ral question is, what the performance would be when fur-
ther augmenting the whole real training set. To investigate,
we augment the training dataset of Market-1501 by generat-
ing one/two samples per image, whose target poses are ran-
domly selected from the whole dataset, thus doubles/triples
the size of the original training set. The results on these two
augmented datasets are added to Tab.5 (the right part). In
a nutshell, the trends of performance gain by adding more
generated images are roughly in accordance with those by
adding more real images. It can be seen that the real data
augmentation for Inception-v2 model could get nearly lin-
ear improvements even in cases of near sizes of the whole
real data set. Therefore, doubling or tripling the training set
continuously improves the performance considerably. On
the other hand, real data augmentation for ResNet-50 model
tends to saturate in cases of near sizes of the whole real data
set, hence doubling or tripling the size fails to improve the
performance further.

We further compare our method to several existing per-
son image generators [5, 34] under the same setting for
re-ID data augmentation. As shown in Tab.5, our method

achieve consistent improvements over previous works for
different portion p of the real images, suggesting the pro-
posed method can generate more realistic human images
and be more effective for the re-ID task. We also present the
re-ID performance by randomly selecting the target poses
from the whole dataset, which can better suit the practi-
cal applications. As shown in Tab.5, there is not an obvi-
ous performance difference between the two settings, fur-
ther demonstrating that the proposed framework is robust to
various poses.

6. Conclusion

In this paper, we propose a progressive pose attention
transfer network to deal with the challenging pose trans-
fer. The network cascades several Pose Attentional Transfer
Blocks (PATBs), each is capable of optimizing appearance
and pose simultaneously using the attention mechanism,
thus guides the deformable transfer process progressively.
Compared to previous works, our network exhibits superior
performance in both subjective visual realness and objec-
tive quantitative scores while at the same time improves the
computational efﬁciency and reduces the model complexity
signiﬁcantly. Moreover, the proposed network can be used
to alleviate the insufﬁcient training data problem for person
re-identiﬁcation substantially. Additionally, our progressive
pose-attentional transfer process can be easily visualized by
its attention masks, making our network more interpretable.
Moreover, the design of our network has been experimen-
tally veriﬁed through the ablation studies.

Our progressive pose-attentional transfer network is not
only speciﬁc to generating person images but also can be
potentially adapted to generate other non-rigid objects. Fur-
thermore, we assume the idea behind our progressive at-
tention transfer approach may be beneﬁcial to other GAN-
based image generation approaches as well.

Acknowledgement

This work was supported by NSFC 61573160, to Dr. Xi-
ang Bai by the National Program for Support of Top-notch
Young Professionals and the Program for HUST Academic
Frontier Youth Team.

2354

References

[1] Mykhaylo Andriluka, Leonid Pishchulin, Peter Gehler, and
Bernt Schiele. 2d human pose estimation: New benchmark
and state of the art analysis. In Proc. CVPR, 2014.

[2] Guha Balakrishnan, Amy Zhao, Adrian V. Dalca, Fr´edo Du-
rand, and John V. Guttag. Synthesizing images of humans in
unseen poses. CoRR, abs/1804.07739, 2018.

[3] Zhe Cao, Tomas Simon, Shih-En Wei, and Yaser Sheikh.
Realtime multi-person 2d pose estimation using part afﬁnity
ﬁelds. In Proc. CVPR, pages 1302–1310, 2017.

[4] Ahmed M. Elgammal and Chan-Su Lee. Inferring 3d body
In

pose from silhouettes using activity manifold learning.
Proc. CVPR, pages 681–688, 2004.

[5] Patrick Esser, Ekaterina Sutter, and Bj¨orn Ommer. A varia-
tional u-net for conditional appearance and shape generation.
CoRR, abs/1804.04694, 2018.

[6] Ian Goodfellow, Jean Pouget-Abadie, Mehdi Mirza, Bing
Xu, David Warde-Farley, Sherjil Ozair, Aaron Courville, and
Yoshua Bengio. Generative adversarial nets. In Proc. NIPS,
pages 2672–2680, 2014.

[7] Rıza Alp G¨uler, Natalia Neverova, and Iasonas Kokkinos.
Densepose: Dense human pose estimation in the wild. arXiv
preprint arXiv:1802.00434, 2018.

[8] Xintong Han, Zuxuan Wu, Zhe Wu, Ruichi Yu, and Larry S.
Davis. VITON: an image-based virtual try-on network.
CoRR, abs/1711.08447, 2017.

[9] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.
In Proc.

Deep residual learning for image recognition.
CVPR, pages 770–778, 2016.

[10] Geoffrey E. Hinton, Nitish Srivastava, Alex Krizhevsky, Ilya
Improving neural
Sutskever, and Ruslan Salakhutdinov.
networks by preventing co-adaptation of feature detectors.
CoRR, abs/1207.0580, 2012.

[11] Sergey Ioffe and Christian Szegedy. Batch normalization:
Accelerating deep network training by reducing internal co-
variate shift. In Proc. ICML, pages 448–456, 2015.

[12] Phillip Isola, Jun-Yan Zhu, Tinghui Zhou, and Alexei A
Image-to-image translation with conditional adver-

Efros.
sarial networks. In Proc. CVPR 2017, 2017.

[13] Justin Johnson, Alexandre Alahi, and Li Fei-Fei. Perceptual
In

losses for real-time style transfer and super-resolution.
Proc. ECCV, pages 694–711, 2016.

[14] Diederik P. Kingma and Jimmy Ba. Adam: A method for

stochastic optimization. CoRR, abs/1412.6980, 2014.

[15] Diederik P. Kingma and Max Welling. Auto-encoding vari-

ational bayes. CoRR, abs/1312.6114, 2013.

[16] Christoph Lassner, Gerard Pons-Moll, and Peter V. Gehler.
In Proc. ICCV,

A generative model of people in clothing.
pages 853–862, 2017.

[17] Christian Ledig, Lucas Theis, Ferenc Huszar, Jose Caballero,
Andrew Cunningham, Alejandro Acosta, Andrew P. Aitken,
Alykhan Tejani, Johannes Totz, Zehan Wang, and Wenzhe
Shi. Photo-realistic single image super-resolution using a
generative adversarial network. In Proc. CVPR, pages 105–
114, 2017.

[18] Wei Liu, Dragomir Anguelov, Dumitru Erhan, Christian
Szegedy, Scott E. Reed, Cheng-Yang Fu, and Alexander C.
Berg. SSD: single shot multibox detector. In Proc. ECCV,
pages 21–37, 2016.

[19] Ziwei Liu, Ping Luo, Shi Qiu, Xiaogang Wang, and Xiaoou
Tang. Deepfashion: Powering robust clothes recognition and
retrieval with rich annotations. In Proc. CVPR, 2016.

[20] Liqian Ma, Xu Jia, Stamatios Georgoulis, Tinne Tuytelaars,
and Luc Van Gool. Exemplar guided unsupervised image-to-
image translation. arXiv preprint arXiv:1805.11145, 2018.

[21] Liqian Ma, Xu Jia, Qianru Sun, Bernt Schiele, Tinne Tuyte-
laars, and Luc Van Gool. Pose guided person image genera-
tion. In Proc. NIPS, pages 405–415, 2017.

[22] Liqian Ma, Qianru Sun, Stamatios Georgoulis, Luc Van
Gool, Bernt Schiele, and Mario Fritz. Disentangled person
image generation. CoRR, abs/1712.02621, 2017.

[23] Andrew L Maas, Awni Y Hannun, and Andrew Y Ng. Recti-
ﬁer nonlinearities improve neural network acoustic models.
In Proc. ICML, volume 30, page 3, 2013.

[24] Liang Mei, Jingen Liu, Alfred O. Hero III, and Silvio
Savarese. Robust object pose estimation via statistical mani-
fold modeling. In Proc. ICCV, pages 967–974, 2011.

[25] Mehdi Mirza and Simon Osindero. Conditional generative

adversarial nets. CoRR, abs/1411.1784, 2014.

[26] Vinod Nair and Geoffrey E. Hinton. Rectiﬁed linear units im-
prove restricted boltzmann machines. In Proc. ICML, pages
807–814, 2010.

[27] Natalia Neverova, Riza Alp Guler, and Iasonas Kokkinos.
Dense pose transfer. arXiv preprint arXiv:1809.01995, 2018.
[28] Augustus Odena, Christopher Olah, and Jonathon Shlens.
Conditional image synthesis with auxiliary classiﬁer gans.
In Proc. ICML, pages 2642–2651, 2017.

[29] Albert Pumarola, Antonio Agudo, Alberto Sanfeliu, and
Francesc Moreno-Noguer. Unsupervised person image syn-
thesis in arbitrary poses. In Proc. CVPR, pages 8620–8628,
2018.

[30] Alec Radford, Luke Metz, and Soumith Chintala. Un-
supervised representation learning with deep convolu-
tional generative adversarial networks.
arXiv preprint
arXiv:1511.06434, 2015.

[31] Amit Raj, Patsorn Sangkloy, Huiwen Chang, James Hays,
Duygu Ceylan, and Jingwan Lu. Swapnet: Image based gar-
ment transfer. In Proc. ECCV, pages 679–695, 2018.

[32] Olga Russakovsky, Jia Deng, Hao Su, Jonathan Krause, San-
jeev Satheesh, Sean Ma, Zhiheng Huang, Andrej Karpa-
thy, Aditya Khosla, Michael S. Bernstein, Alexander C.
Berg, and Fei-Fei Li. Imagenet large scale visual recogni-
tion challenge.
International Journal of Computer Vision,
115(3):211–252, 2015.

[33] Tim Salimans, Ian J. Goodfellow, Wojciech Zaremba, Vicki
Cheung, Alec Radford, and Xi Chen. Improved techniques
for training gans. In Proc. NIPS, pages 2226–2234, 2016.

[34] Aliaksandr Siarohin, Enver Sangineto, St´ephane Lathuili`ere,
and Nicu Sebe. Deformable gans for pose-based human im-
age generation. CoRR, abs/1801.00055, 2018.

[35] Karen Simonyan and Andrew Zisserman. Very deep convo-
lutional networks for large-scale image recognition. CoRR,
abs/1409.1556, 2014.

2355

[36] Christian Szegedy, Vincent Vanhoucke, Sergey Ioffe,
Jonathon Shlens, and Zbigniew Wojna. Rethinking the in-
ception architecture for computer vision.
In Proc. CVPR,
pages 2818–2826, 2016.

[37] Dmitry Ulyanov, Andrea Vedaldi, and Victor S. Lempitsky.
Instance normalization: The missing ingredient for fast styl-
ization. CoRR, abs/1607.08022, 2016.

[38] Jacob Walker, Kenneth Marino, Abhinav Gupta, and Martial
Hebert. The pose knows: Video forecasting by generating
pose futures. In Proc. ICCV, pages 3352–3361, 2017.

[39] Bochao Wang, Huabin Zheng, Xiaodan Liang, Yimin
Chen, Liang Lin, and Meng Yang. Toward characteristic-
preserving image-based virtual try-on network.
In Proc.
ECCV, pages 607–623, 2018.

[40] Zhou Wang, Alan C. Bovik, Hamid R. Sheikh, and Eero P.
Simoncelli.
Image quality assessment: from error visibil-
ity to structural similarity. IEEE Trans. Image Processing,
13(4):600–612, 2004.

[41] Yi Yang and Deva Ramanan. Articulated human detection
IEEE Trans. Pattern Anal.

with ﬂexible mixtures of parts.
Mach. Intell., 35(12):2878–2890, 2013.

[42] Jiahui Yu, Zhe Lin, Jimei Yang, Xiaohui Shen, Xin Lu, and
Thomas S Huang. Free-form image inpainting with gated
convolution. arXiv preprint arXiv:1806.03589, 2018.

[43] Mihai Zanﬁr, Alin-Ionut Popa, Andrei Zanﬁr, and Cristian
Sminchisescu. Human appearance transfer. In Proc. CVPR,
pages 5391–5399, 2018.

[44] Bo Zhao, Xiao Wu, Zhi-Qi Cheng, Hao Liu, and Jiashi Feng.
Multi-view image generation from a single-view. CoRR,
abs/1704.04886, 2017.

[45] Liang Zheng, Liyue Shen, Lu Tian, Shengjin Wang, Jing-
dong Wang, and Qi Tian. Scalable person re-identiﬁcation:
A benchmark. In Proc. ICCV, pages 1116–1124, 2015.

[46] Liang Zheng, Yi Yang, and Alexander G. Hauptmann. Per-
CoRR,

son re-identiﬁcation: Past, present and future.
abs/1610.02984, 2016.

[47] Zhedong Zheng, Liang Zheng, and Yi Yang. Unlabeled sam-
ples generated by GAN improve the person re-identiﬁcation
baseline in vitro. In Proc. ICCV, pages 3774–3782, 2017.

[48] Jun-Yan Zhu, Taesung Park, Phillip Isola, and Alexei A.
Efros. Unpaired image-to-image translation using cycle-
consistent adversarial networks. In Proc. ICCV, pages 2242–
2251, 2017.

2356

