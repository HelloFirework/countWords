Joint Discriminative and Generative Learning for Person Re-identiﬁcation

Zhedong Zheng1

,

2 ∗ Xiaodong Yang1

Zhiding Yu1

Liang Zheng3 Yi Yang2

Jan Kautz1

1NVIDIA 2CAI, University of Technology Sydney 3Australian National University

Abstract

Person re-identiﬁcation (re-id) remains challenging due
to signiﬁcant intra-class variations across different cam-
eras. Recently, there has been a growing interest in using
generative models to augment training data and enhance
the invariance to input changes. The generative pipelines
in existing methods, however, stay relatively separate from
the discriminative re-id learning stages. Accordingly, re-id
models are often trained in a straightforward manner on the
generated data. In this paper, we seek to improve learned
re-id embeddings by better leveraging the generated data.
To this end, we propose a joint learning framework that
couples re-id learning and data generation end-to-end. Our
model involves a generative module that separately encodes
each person into an appearance code and a structure code,
and a discriminative module that shares the appearance en-
coder with the generative module. By switching the appear-
ance or structure codes, the generative module is able to
generate high-quality cross-id composed images, which are
online fed back to the appearance encoder and used to im-
prove the discriminative module. The proposed joint learn-
ing framework renders signiﬁcant improvement over the
baseline without using generated data, leading to the state-
of-the-art performance on several benchmark datasets.

1. Introduction

Person re-identiﬁcation (re-id) aims to establish iden-
It is often
tity correspondences across different cameras.
approached as a metric learning problem [52], where one
seeks to retrieve images containing the person of interest
from non-overlapping cameras given a query image. This
is challenging in the sense that images captured by differ-
ent cameras often contain signiﬁcant intra-class variations
caused by the changes in background, viewpoint, human
pose, etc. As a result, designing or learning representations
that are robust against intra-class variations as much as pos-
sible has been one of the major targets in person re-id.

∗Work done during an internship at NVIDIA Research.

Figure 1: Examples of generated images on Market-1501
by switching appearance or structure codes. Each row and
column corresponds to different appearance and structure.

Convolutional neural networks (CNNs) have recently
become increasingly predominant choices in person re-id
thanks to their strong representation power and the ability
to learn invariant deep embeddings. Current state-of-the-
art re-id methods widely formulate the tasks as deep met-
ric learning problems [12, 53], or use classiﬁcation losses
as the proxy targets to learn deep embeddings [22, 38, 40,
47, 52, 55]. To further reduce the inﬂuence from intra-class
variations, a number of existing methods adopt part-based
matching or ensemble to explicitly align and compensate
the variations [34, 36, 45, 50, 55].

12138

Appearance Space
clothing/shoes color,

texture and style,

Structure Space

body size, hair, carrying,

pose, background,

other id-related cues, etc.

position, viewpoint, etc.

Table 1: Description of the information encoded in the la-
tent appearance and structure spaces.

Another possibility to enhance robustness against input
variations is to let the re-id model potentially “see” these
variations (particularly intra-class variations) during train-
ing. With recent progress in the generative adversarial net-
works (GANs) [10], generative models have become ap-
pealing choices to introduce additional augmented data for
free [54]. Despite the different forms, the general consid-
erations behind these methods are “realism”: generated im-
ages should possess good qualities to close the domain gap
between synthesized scenarios and real ones; and “diver-
sity”: generated images should contain sufﬁcient diversity
to adequately cover unseen variations. Within this context,
some prior works have explored unconditional GANs and
human pose conditioned GANs [9, 16, 26, 30, 54] to gener-
ate pedestrian images to improve re-id learning. However,
a common issue behind these methods is that their genera-
tive pipelines are typically presented as standalone models,
which are relatively separate from the discriminative re-id
models. Therefore, the optimization target of a generative
module may not be well aligned with the re-id task, limiting
the gain from generated data.

In light of the above observation, we propose a learn-
ing framework that jointly couples discriminative and gen-
erative learning in a uniﬁed network called DG-Net. Our
strategy towards achieving this goal is to introduce a gen-
erative module, of which encoders decompose each pedes-
trian image into two latent spaces: an appearance space
that mostly encodes appearance and other identity related
semantics; and a structure space that encloses geometry
and position related structural information as well as other
additional variations. We refer to the encoded features in the
space as “codes”. The properties captured by the two latent
spaces are summarized in Table 1. The appearance space
encoder is also shared with the discriminative module, serv-
ing as a re-id learning backbone. This design leads to a sin-
gle uniﬁed framework that subsumes these interactions be-
tween generative and discriminative modules: (1) the gen-
erative module produces synthesized images that are taken
to reﬁne the appearance encoder online; (2) the encoder, in
turn, inﬂuences the generative module with improved ap-
pearance encoding; and (3) both modules are jointly opti-
mized, given the shared appearance encoder.

We formulate the image generation as switching the ap-
pearance or structure codes between two images. Given
any pairwise images with the same/different identities, one

is able to generate realistic and diverse intra/cross-id com-
posed images by manipulating the codes. An example of
such composed image generation on Market-1501 [51] is
shown in Figure 1. Our design of the generative pipeline not
only leads to high-ﬁdelity generation, but also yields sub-
stantial diversity given the combinatorial compositions of
existing identities. Unlike the unconditional GANs [16,54],
our method allows more controllable generation with better
quality. Unlike the pose-guided generations [9, 26, 30], our
method does not require any additional auxiliary data, but
takes the advantage of existing intra-dataset pose variations
as well as other diversities beyond pose.

This generative module design speciﬁcally serves for our
discriminative module to better make use of the generated
data. For one pedestrian image, by keeping its appearance
code and combining with different structure codes, we can
generate multiple images that remain clothing and shoes but
change pose, viewpoint, background, etc. As demonstrated
in each row of Figure 1, these images correspond to the
same clothing dressed on different people. To better capture
such composed cross-id information, we introduce the “pri-
mary feature learning” via a dynamic soft labeling strategy.
Alternatively, we can keep one structure code and combine
with different appearance codes to produce various images,
which maintain the pose, background and some identity re-
lated ﬁne details but alter clothes and shoes. As shown in
each column of Figure 1, these images form an interesting
simulation of the same person wearing different clothes and
shoes. This creates an opportunity for further mining the
subtle identity attributes that are independent of clothing,
such as carrying, hair, body size, etc. Thus, we propose the
complementary “ﬁne-grained feature mining” to learn addi-
tional subtle identity properties.

To our knowledge, this work provides the ﬁrst frame-
work that is able to end-to-end integrate discriminative and
generative learning in a single uniﬁed network for person
re-id. Extensive qualitative and quantitative experiments
show that our image generation compares favorably against
the existing ones, and more importantly, our re-id accuracy
consistently outperforms the competing algorithms by large
margins on several benchmarks.

2. Related Work

A large family of person re-id research focuses on met-
ric learning loss. Some methods combine identiﬁcation loss
with veriﬁcation loss [46, 53], others apply triplet loss with
hard sample mining [5, 12, 32]. Several recent works em-
ploy pedestrian attributes to enforce more supervisions and
perform multi-task learning [25, 35, 42]. Alternatives har-
ness pedestrian alignment and part matching to leverage on
the human structure prior. One of the common practice is
to split input images or feature maps horizontally to take
advantage of local spatial cues [22, 38, 48].
In a similar

2139

Figure 2: A schematic overview of DG-Net. (a) Our discriminative re-id learning module is embedded in the generative
module by sharing appearance encoder Ea. A dash black line denotes the input image to structure encoder Es is converted
to gray. The red line indicates the generated images are online fed back to Ea. Two objectives are enforced in the generative
module: (b) self-identity generation by the same input identity and (c) cross-identity generation by different input identities.
(d) To better leverage generated data, the re-id learning involves primary feature learning and ﬁne-grained feature mining.

manner, pose estimation is incorporated into learning local
features [34,36,45,50,55]. Apart from pose, human parsing
is used in [18] to enhance spatial matching. In comparison,
our DG-Net relies only on simple identiﬁcation loss for re-
id learning and requires no extra auxiliary information such
as pose or human parsing for image generation.

Another active research line is to utilize GANs to aug-
ment training data. In [54], Zheng et al. ﬁrst introduce to use
unconditional GAN to generate images from random vec-
tors. Huang et al. proceed with this direction with WGAN
[1] and assign pseudo labels to generated images [16]. Li et
al. propose to share weights between re-id model and dis-
criminator of GAN [24]. In addition, some recent methods
make use of pose estimation to conduct pose-conditioned
image generation. A two-stage generation pipeline is devel-
oped in [27] based on pose to reﬁne generated images. Sim-
ilarly, pose is also used in [9, 26, 30] to generate images of a
pedestrian in different poses to make learned features more
robust to pose variances. Siarohin et al. achieve better pose-
conditioned image generation by using a nearest neighbor
loss to replace the traditional ℓ1 or ℓ2 loss [33]. All the
methods set image generation and re-id learning as two dis-
jointed steps, while our DG-Net end-to-end integrates the
two tasks into a uniﬁed network.

Meanwhile, some recent studies also exploit synthetic
data for style transfer of pedestrian images to compensate
for the disparity between the source and target domains. Cy-
cleGAN [58] is applied in [8, 57] to transfer pedestrian im-
age style from one dataset to another. StarGAN [6] is used
in [56] to generate pedestrian images with different camera
styles. Bak et al. [3] employ a game engine to render pedes-
trians using various illumination conditions. Wei et al. [44]
take semantic segmentation to extract foreground mask in
assisting style transfer. In contrast to the global style trans-
fer, we aim for manipulating appearance and structure de-
tails to facilitate more robust re-id learning.

3. Method

As illustrated in Figure 2, DG-Net tightly couples the
generative module for image generation and the discrim-
inative module for re-id learning. We introduce two im-
age mappings: self-identity generation and cross-identity
generation to synthesize high-quality images that are online
fed into re-id learning. Our discriminative module involves
primary feature learning and ﬁne-grained feature mining,
which are co-designed with the generative module to better
leverage the generated data.

2140

3.1. Generative Module

i=1 and Y = {yi}N

Formulation. We denote the real images and identity
labels as X = {xi}N
i=1, where N is the
number of images, yi ∈ [1, K] and K indicates the number
of classes or identities in the dataset. Given two real images
xi and xj in the training set, our generative module gener-
ates a new pedestrian image by swapping the appearance or
structure codes of the two images. As shown in Figure 2,
the generative module consists of an appearance encoder
Ea : xi → ai, a structure encoder Es : xj → sj , a decoder
G : (ai, sj) → xi
j , and a discriminator D to distinguish be-
tween generated images and real ones. In the case i = j,
the generator can be viewed as an auto-encoder, so xi
i ≈ xi.
Note: for generated images, we use superscript to denote
the real image providing appearance code and subscript to
indicate the one offering structure code, while real images
only have subscript as image index. Compared to the ap-
pearance code ai, the structure code sj maintains more spa-
tial resolution to preserve geometric and positional proper-
ties. However, this may result in a trivial solution for G to
only use sj but ignore ai in image generation since decoders
tend to rely on the feature with more spatial information. In
practice, we convert input images of Es into gray-scale to
drive G to leverage both ai and sj . We enforce the two ob-
jectives for the generative module: (1) self-identity genera-
tion to regularize the generator and (2) cross-identity gener-
ation to make generated images controllable and match real
data distribution.

Self-identity generation. As illustrated in Figure 2(b),
given an image xi, the generative module ﬁrst learns how to
reconstruct xi from itself. This simple self-reconstruction
task serves as an important regularization role to the whole
generation. We reconstruct the image using the pixel-wise
ℓ1 loss:

Limg1

recon = E[kxi − G(ai, si)k1].

(1)

Based on the assumption that the appearance codes of the
same person in different images are close, we further pro-
pose another reconstruction task between any two images
of the same identity. In other words, the generator should
be able to reconstruct xi through an image xt with the same
identity yi = yt:

Limg2

recon = E[kxi − G(at, si)k1].

(2)

This same-identity but cross-image reconstruction loss en-
courages the appearance encoder to pull appearance codes
of the same identity together so that intra-class feature vari-
ations are reduced. In the meantime, to force the appearance
codes of different images to stay apart, we use identiﬁcation
loss to distinguish different identities:

Ls

id = E[− log(p(yi|xi))],

(3)

where p(yi|xi) is the predicted probability that xi belongs
to the ground-truth class yi based on its appearance code.

Cross-identity generation. Different from self-identity
generation that works with image reconstruction using the
same identity, cross-identity generation focuses on image
generation with different identities.
In this case, there is
no pixel-level ground-truth supervision. Instead, we intro-
duce the latent code reconstruction based on appearance and
structure codes to control such image generation. As shown
in Figure 2(c), given two images xi and xj of different iden-
tities yi 6= yj , the generated image xi
j = G(ai, sj) is re-
quired to retain the information of appearance code ai from
xi and structure code sj from xj , respectively. We should
then be able to reconstruct the two latent codes after encod-
ing the generated image:

Lcode1
Lcode2

recon = E[kai − Ea(G(ai, sj))k1],
recon = E[ksj − Es(G(ai, sj))k1].

(4)

(5)

Similar for self-identity generation, we also enforce identi-
ﬁcation loss on the generated image based on its appearance
code to keep the identity consistency:

Lc

id = E[− log(p(yi|xi

j))],

(6)

j) is the predicted probability of xi

where p(yi|xi
j belonging
to the ground-truth class yi of xi, the image that provides
appearance code in generating xi
j . Additionally, we employ
adversarial loss to match the distribution of generated im-
ages to the real data distribution:

Ladv = E[log D(xi) + log(1 − D(G(ai, sj))].

(7)

Discussion. By using the proposed generation mecha-
nism, we enable the generative module to learn appearance
and structure codes with explicit and complementary mean-
ings and generate high-quality pedestrian images based on
the latent codes. This largely eases the generation complex-
ity. In contrast, the previous methods [9, 16, 26, 30, 54] have
to learn image generation either from random noise or man-
aging the pose factor only, which is hard to manipulate the
outputs and inevitably introduces artifacts. Moreover, due
to using the latent codes, the variants in our generated im-
ages are explainable and constrained in the existing contents
of real images, which also ensures the generation realism.
In theory, we can generate O(N × N ) different images by
sampling various image pairs, resulting in a much larger
online generated training sample pool than the ones with
O(2 × N ) images ofﬂine generated in [16, 30, 54].

3.2. Discriminative Module

Our discriminative module is embedded in the generative
module by sharing the appearance encoder as the backbone
for re-id learning. In accordance with the images generated
by switching either appearance or structure codes, we pro-
pose the primary feature learning and ﬁne-grained feature

2141

mining to better take advantage of the online generated im-
ages. Since the two tasks focus on different aspects of gen-
erated images, we branch out two lightweight headers on
top of the appearance encoder for the two types of feature
learning, as illustrated in Figure 2(d).

Primary feature learning.

It is possible to treat the
generated images as training samples similar to the exist-
ing work [16, 30, 54]. But the inter-class variations in the
cross-id composed images motivate us to adopt a teacher-
student type supervision with dynamic soft labeling. We use
a teacher model to dynamically assign a soft label to xi
j , de-
pending on its compound appearance and structure from xi
and xj . The teacher model is simply a baseline CNN trained
with identiﬁcation loss on the original training set. To train
the discriminative module for primary feature learning, we
minimize the KL divergence between the probability distri-
bution p(xi
j) predicted by the discriminative module and the
probability distribution q(xi

j) predicted by the teacher:

Lprim = E[−

K

X

k=1

q(k|xi

j) log(

p(k|xi
j)
q(k|xi
j)

)],

(8)

where K is the number of identities. In comparison with the
ﬁxed one-hot label [30, 59] or static smoothing label [54],
this dynamic soft labeling ﬁts better in our case, as each syn-
thetic image is formed by the visual contents from two real
images. In the experiments, we show that a simple baseline
CNN serving as the teacher model is reliable to provide the
dynamic labels and improve the performance.

Fine-grained feature mining. Beyond the direct usage
of generated data for learning primary features, an inter-
esting alternative, made possible by our speciﬁc genera-
tion pipeline, is to simulate the change of clothing for the
same person, as shown in each column of Figure 1. When
training on images organized in this manner, the discrimi-
native module is forced to learn the ﬁne-grained id-related
attributes (such as hair, hat, bag, body size, and so on) that
are independent to clothing. We view the images gener-
ated by one structure code combining with different appear-
ance codes as the same class as the real image providing
the structure code. To train the discriminative module for
ﬁne-grained feature mining, we enforce identiﬁcation loss
on this particular categorizing:

Lﬁne = E[− log(p(yj|xi

j))].

(9)

This loss imposes additional identity supervision to the dis-
criminative module in a multi-tasking way. Moreover, un-
like the previous works using manually labeled pedestrian
attributes [25, 35, 42], our approach performs automatic
ﬁne-grained attribute mining by leveraging on the synthetic
images. Furthermore, compared to the hard sampling policy
applied in [12, 32], there is no need to explicitly search for
the hard training samples that usually possess ﬁne-grained

details, since our discriminative module learns to attention
on the subtle identity properties through this ﬁne-grained
feature mining.

Discussion. We argue that our high-quality synthetic im-
ages, in nature, can be viewed as “inliers” (contrary to “out-
liers”), as our generated images maintain and recompose
the visual contents from real data. Via the above two fea-
ture learning tasks, our discriminative module makes spe-
ciﬁc use of the generated data in line with the way how we
manipulate the appearance and structure codes. Instead of
using a single supervision as in almost all previous meth-
ods [16, 30, 54], we treat the generated images in two differ-
ent perspectives through the primary feature learning and
ﬁne-grained feature mining, where the former focuses on
the structure-invariant clothing information and the latter at-
tentions to the appearance-invariant structural cues.

3.3. Optimization.

We jointly train the appearance and structure encoders,
decoder, and discriminator to optimize the total objective,
which is a weighted sum of the following losses:

Ltotal(Ea, Es, G, D) = λimgLimg
Ls

id + λidLc

id + Ladv + λprimLprim + λﬁneLﬁne,

recon + Lcode

recon +

(10)

recon + Limg2

recon = Limg1

recon + Lcode2

recon = Lcode1

where Limg
recon is the image reconstruction
loss in self-identity generation, Lcode
recon is
the latent code reconstruction loss in cross-identity genera-
tion, λimg, λid, λprim, and λﬁne are weights to control the
importance of related loss terms. Following the common
practice in image-to-image translations [15, 20, 58], we use
a large weight λimg = 5 for the image reconstruction loss.
Since the quality of cross-id generated images is not great
at the beginning, the identiﬁcation loss Lc
id may make the
training unstable, so we set a small weight λid = 0.5. We
ﬁx the two weights during the whole training process in all
experiments. We do not involve the discriminative feature
learning losses Lprim and Lﬁne until the generation qual-
ity is stable. As an example, we add in the two losses after
30K iterations on Market-1501, then linearly increase λprim
from 0 to 2 in 4K iterations and set λﬁne = 0.2λprim. See
more details on how to determine the weights in Section 4.3.
Similar to the alternative updating policy for GANs, in the
cross-identity generation as shown in Figure 2(a), we alter-
natively train Ea, Es and G before the generated image and
Ea, Es and D after the generated image.

4. Experiments

We evaluate the proposed approach following standard
protocols on three benchmark datasets: Market-1501 [51],
DukeMTMC-reID [31], and MSMT17 [44]. We qualita-
tively and quantitatively compare DG-Net with state-of-the-
art methods on both generative and discriminative results.

2142

Figure 3: Comparison of the generated and real images on Market-1501 across the different methods including LSGAN [28],
PG2-GAN [27], FD-GAN [9], PN-GAN [30], and our approach. This ﬁgure is best viewed when zoom in. Please attention
to both foreground and background of the images.

Figure 4: Comparison of the generated images by our full
model, removing online feeding (w/o feed), and further re-
moving identity supervision (w/o id).

Extensive experiments demonstrate that DG-Net produces
more realistic and diverse images, and meanwhile, consis-
tently outperforms the most recent competing algorithms by
large margins on re-id accuracy across all benchmarks.

4.1. Implementation Details

Our network is implemented in PyTorch. In the follow-
ing, we use channel×height×width to indicate the size of
feature maps. (i) Ea is based on ResNet50 [11] pre-trained
on ImageNet [7], and we remove its global average pool-
ing layer and fully-connected layer then append an adap-
tive max pooling layer to output the appearance code a in
2048×4×1. It is mapped to primary feature fprim and ﬁne-
grained feature fﬁne, both are 512-dim vectors, through two
fully-connected layers. (ii) Es is a shallow network that out-
puts the structure code s in 128×64×32. It consists of four
convolutional layers followed by four residual blocks [11].
(iii) G processes s by four residual blocks and four con-
volutional layers. As in [15] every residual block contains
two adaptive instance normalization layers [14], which in-
tegrate in a as scale and bias parameters. (iv) D follows the
popular multi-scale PatchGAN [17]. We employ discrimi-
nators on the three different input image scales: 64 × 32,
128 × 64, and 256 × 128. We also apply the gradient pun-

Figure 5: Example of image generation by linear interpola-
tion between two appearance codes.

ishment [29] when updating D to stabilize training. (v) For
training, all input images are resized to 256 × 128. Similar
to the previous deep re-id models [52], SGD is used to train
Ea with learning rate 0.002 and momentum 0.9. We apply
Adam [19] to optimize Es, G and D, and set learning rate
to 0.0001, and (β1, β2) = (0, 0.999). (vi) At test time, our
re-id model only involves Ea (along with two lightweight
headers), which is of a comparable network size to most
methods using ResNet50 as the backbone. We concatenate
fprim and fﬁne into a 1024-dim vector as the ﬁnal pedes-
trian representation. More architecture details can be found
in the supplementary material.

4.2. Generative Evaluations

Qualitative evaluations. We ﬁrst qualitatively compare
DG-Net with its two variants that ablate online feeding and
identity supervision. As shown in Figure 4, without online
feeding generated images to appearance encoder, the model
suffers from blurry edges and undesired textures. If further
removing identity supervision, the image quality is unsat-
isfying as the model fails to produce the accurate clothing
color or style. This clearly shows that our joint discrimina-
tive learning is beneﬁcial to the image generation.

Next we compare our full model with other genera-
tive approaches, including one unconditional GAN (LS-
GAN [28]) and three open-source conditional GANs (PG2-
GAN [27], PN-GAN [30] and FD-GAN [9]). As compared
in Figure 3, the images generated by LSGAN have severe
artifacts and duplicated patterns. FD-GAN are prone to gen-
erate very blurry images, which largely deteriorate the real-

2143

Figure 6: Examples of our generated images by swapping appearance or structure codes on the three datasets. All images are
sampled from the test sets.

Methods

Real
LSGAN [28]
PG2-GAN [27]
PN-GAN [30]
FD-GAN [9]
Ours

Realism

(FID)
7.22

136.26
151.16
54.23
257.00
18.24

Diversity
(SSIM)
0.350

-
-

0.335
0.247
0.360

Table 2: Comparison of FID (lower is better) and SSIM
(higher is better) to evaluate realism and diversity of the
real and generated images on Market-1501.

ism. PG2-GAN and PN-GAN, both conditioned on pose,
generate relatively good visual results, but still contain visi-
ble blurs and artifacts especially in background. In compar-
ison, our generated images are more realistic and close to
the real in both foreground and background.

To better understand the learned appearance space,
which is the foundation for our pedestrian representations,
we perform a linear interpolation between two appearance
codes and generate the corresponding images as shown in
Figure 5. These interpolation results verify the continuity
in the appearance space, and show that our model is able to
generalize in the space instead of simply memorizing trivial
visual information. As a complementary study, we also gen-
erate images by linearly interpolating between two structure
codes while keeping the appearance code intact. See more
discussions regarding this study in the supplementary ma-
terial. We then demonstrate our generation results on the
three benchmarks in Figure 6, where DG-Net is found to
be able to consistently generate realistic and diverse images
across the different datasets.

Quantitative evaluations. Our qualitative observations
above are conﬁrmed by the quantitative evaluations. We
use two metrics: Fr´echet Inception Distance (FID) [13] and

Figure 7: Comparison of success and failure cases in our
image generation. In the failure case, the logo on t-shirt of
the original image is missed in the synthetic image.

Structural SIMilarity (SSIM) [43] to measure realism and
diversity of generated images, respectively. FID measures
how close the distribution of generated images is to the real.
It is sensitive to visual artifacts and thus indicates the real-
ism of generated images. For the identity conditioned gen-
eration, we apply SSIM to compute intra-class similarity,
which can be used to reﬂect the generation diversity. As
shown in Table 2, our approach signiﬁcantly outperforms
other methods on both realism and diversity, suggesting the
high quality of our generated images. Remarkably, we ob-
tain a higher SSIM than the original training set thanks to
the various poses, carryings, backgrounds, etc. introduced
by switching structure codes.

Limitation. We notice that due to data bias in the orig-
inal training set, our generative module tends to learn the
regular textures (e.g., stripes and dots) but ignores some rare
patterns (e.g., logos on shirts), as shown in Figure 7.

4.3. Discriminative Evaluations

Ablation studies. We ﬁrst study the contributions of pri-
mary feature and ﬁne-grained feature in Table 3. We train
ResNet50 with identiﬁcation loss on each original training
set as the baseline. It also serves as the teacher model in
primary feature learning to perform dynamic soft labeling
on the generated images. Our primary feature is found to
largely improve over the baseline. Notably, the ﬁne-grained

2144

Methods

Baseline
fprim
fﬁne
fprim, fﬁne

Market-1501 DukeMTMC-reID MSMT17
Rank@1 mAP Rank@1 mAP Rank@1 mAP
36.2
49.7
43.5
52.3

74.5
84.4
75.3
86.0

82.0
85.6
78.7
86.6

65.3
72.7
61.2
74.8

68.8
76.0
71.5
77.2

89.6
94.0
91.6
94.8

Table 3: Comparison of baseline, primary feature, ﬁne-
grained feature, and their combination on the three datasets.

Figure 8: Analysis of the re-id learning related hyper-
parameters α and β to balance primary and ﬁne-grained fea-
tures in training (left) and testing (right).

feature without using important appearance information but
only considering subtle id-related cues already achieves im-
pressive accuracy. By combining the two features, we can
further improve the performance, which substantially out-
performs the baseline by 6.1% for Rank@1 and 12.4% for
mAP on average of the three datasets. We then evaluate the
two features independently learned after our synthetic im-
ages are ofﬂine generated. This results in an 84.4% mAP
on Market-1501, inferior to the 86.0% mAP of the end-to-
end training, suggesting that our joint generative training is
beneﬁcial to the re-id learning.

Inﬂuence of hyper-parameters. Here we show how to
set the re-id learning related weights: one is α, the ratio
between λﬁne and λprim to control the importance of Lﬁne
and Lprim in training; the other is β to weight fﬁne when
combined with fprim as the ﬁnal pedestrian representation
in testing. We search the two hyper-parameters on a vali-
dation set split out from the original training set of Market-
1501 (ﬁrst 651 classes for training and rest 100 classes for
validation). Based on the valiation results in Figure 8, we
choose α = 0.2 and β = 0.5 in all experiments.

Comparison with state-of-the-art methods. Finally
we report the performance of our approach with other state-
of-the-art results in Tables 4 and 5. Note that we do
not apply any post processing such as re-ranking [49] or
multi-query fusion [51]. On each dataset, our approach
attains the best performance. Comparing with the meth-
ods using separately generated images, DG-Net achieves
clear gains of 8.3% and 10.3% for mAP on Market-1501
and DukeMTMC-reID, indicating the advantage of the pro-
posed joint learning. Moreover, our framework is more
training efﬁcient: we use only one training phase for joint
image generation and re-id learning, while others require

Methods

Verif-Identif [53]
DCF [21]
SSM [2]
SVDNet [37]
PAN [55]
GLAD [45]
HA-CNN [23]
MLFN [4]
Part-aligned [36]
PCB [38]
Mancs [41]
DeformGAN [33]
LSRO [54]
Multi-pseudo [16]
PT [26]
PN-GAN [30]
FD-GAN [9]
Ours

Market-1501

Rank@1 mAP Rank@1

DukeMTMC-reID
mAP
49.3

68.9

79.5
80.3
82.2
82.3
82.8
89.9
91.2
90.0
91.7
93.8
93.1
80.6
84.0
85.8
87.7
89.4
90.5
94.8

59.9
57.5
68.8
62.1
63.4
73.9
75.7
74.3
79.6
81.6
82.3
61.3
66.1
67.5
68.9
72.6
77.7
86.0

-
-

76.7
71.6

-

80.5
81.0
84.4
83.3
84.9

-

67.7
76.8
78.5
73.6
80.0
86.6

-
-

56.8
51.5

-

63.8
62.8
69.3
69.2
71.8

-

47.1
58.6
56.9
53.2
64.5
74.8

Table 4: Comparison with the state-of-the-art methods on
the Market-1501 and DukeMTMC-reID datasets. Group 1:
the methods not using generated data. Group 2: the methods
using separately generated images.

Methods
Deep [39]
PDC [34]
Verif-Identif [53]
GLAD [45]
PCB [38]
Ours

Rank@1 Rank@5 Rank@10 mAP
23.0
29.7
31.6
34.0
40.4
52.3

47.6
58.0
60.5
61.4
68.2
77.2

65.0
73.6
76.2
76.8
81.2
87.4

71.8
79.4
81.6
81.6
85.5
90.5

Table 5: Comparison with the state-of-the-art methods on
the MSMT17 dataset.

two training phases to sequentially train generative mod-
els and re-id models. DG-Net also outperforms other non-
generative methods by large margins on the two datasets.
As for the recent released large-scale dataset MSMT17,
DG-Net performs signiﬁcantly better than the second best
method by 9.0% for Rank@1 and 11.9% for mAP.

5. Conclusion

In this paper, we have proposed a joint learning frame-
work that end-to-end couples re-id learning and image gen-
eration in a uniﬁed network. There exists an online inter-
active loop between the discriminative and generative mod-
ules to mutually beneﬁt the two tasks. Our two modules
are co-designed to let the re-id learning better leverage the
generated data, rather than simply training on them. Exper-
iments on three benchmarks demonstrate that our approach
consistently brings substantial improvements to both image
generation quality and re-id accuracy.

2145

References

[1] Martin Arjovsky, Soumith Chintala, and L´eon Bottou. Wasserstein

GAN. In ICML, 2017. 3

[2] Song Bai, Xiang Bai, and Qi Tian. Scalable person re-identiﬁcation

on supervised smoothed manifold. In CVPR, 2017. 8

[3] Slawomir Bak, Peter Carr, and Jean-Francois Lalonde. Domain adap-
tation through synthesis for unsupervised person re-identiﬁcation. In
ECCV, 2018. 3

[4] Xiaobin Chang, Timothy Hospedales, and Tao Xiang. Multi-level

factorisation net for person re-identiﬁcation. In CVPR, 2018. 8

[5] De Cheng, Yihong Gong, Sanping Zhou, Jinjun Wang, and Nanning
Zheng. Person re-identiﬁcation by multi-channel parts-based CNN
with improved triplet loss function. In CVPR, 2016. 2

[6] Yunjey Choi, Minje Choi, Munyoung Kim, Jung-Woo Ha, Sunghun
Kim, and Jaegul Choo. StarGAN: Uniﬁed generative adversarial net-
works for multi-domain image-to-image translation. In CVPR, 2018.
3

[7] Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-
Fei. Imagenet: A large-scale hierarchical image database. In CVPR,
2009. 6

[8] Weijian Deng, Liang Zheng, Guoliang Kang, Yi Yang, Qixiang Ye,
and Jianbin Jiao.
Image-image domain adaptation with preserved
self-similarity and domain-dissimilarity for person reidentiﬁcation.
In CVPR, 2018. 3

[9] Yixiao Ge, Zhuowan Li, Haiyu Zhao, Guojun Yin, Xiaogang Wang,
and Hongsheng Li. FD-GAN: Pose-guided feature distilling GAN
for robust person re-identiﬁcation. In NeurIPS, 2018. 2, 3, 4, 6, 7, 8
[10] Ian Goodfellow, Jean Pouget-Abadie, Mehdi Mirza, Bing Xu, David
Warde-Farley, Sherjil Ozair, Aaron Courville, and Yoshua Bengio.
Generative adversarial nets. In NeurIPS, 2014. 2

[11] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun. Deep

residual learning for image recognition. In CVPR, 2016. 6

[12] Alexander Hermans, Lucas Beyer, and Bastian Leibe. In defense of
the triplet loss for person re-identiﬁcation. arXiv:1703.07737, 2017.
1, 2, 5

[13] Martin Heusel, Hubert Ramsauer, Thomas Unterthiner, Bernhard
Nessler, and Sepp Hochreiter. GANs trained by a two time-scale
update rule converge to a local Nash equilibrium. In NeurIPS, 2017.
7

[14] Xun Huang and Serge Belongie. Arbitrary style transfer in real-time

with adaptive instance normalization. In ICCV, 2017. 6

[15] Xun Huang, Ming-Yu Liu, Serge Belongie, and Jan Kautz. Multi-
modal unsupervised image-to-image translation. In ECCV, 2018. 5,
6

[16] Yan Huang, Jinsong Xu, Qiang Wu, Zhedong Zheng, Zhaoxiang
Zhang, and Jian Zhang. Multi-pseudo regularized label for gener-
ated samples in person re-identiﬁcation. TIP, 2018. 2, 3, 4, 5, 8

[17] Phillip Isola, Jun-Yan Zhu, Tinghui Zhou, and Alexei Efros. Image-
to-image translation with conditional adversarial networks. In CVPR,
2017. 6

[18] Mahdi Kalayeh, Emrah Basaran, Muhittin G¨okmen, Mustafa Ka-
masak, and Mubarak Shah. Human semantic parsing for person re-
identiﬁcation. In CVPR, 2018. 3

[19] Diederik Kingma and Jimmy Ba. Adam: A method for stochastic

optimization. In ICLR, 2015. 6

[23] Wei Li, Xiatian Zhu, and Shaogang Gong. Harmonious attention

network for person re-identiﬁcation. In CVPR, 2018. 8

[24] Xiang Li, Ancong Wu, and Wei-Shi Zheng. Adversarial open-world

person re-identiﬁcation. In ECCV, 2018. 3

[25] Yutian Lin, Liang Zheng, Zhedong Zheng, Yu Wu, and Yi Yang.
Improving person re-identiﬁcation by attribute and identity learning.
arXiv:1703.07220, 2017. 2, 5

[26] Jinxian Liu, Bingbing Ni, Yichao Yan, Peng Zhou, Shuo Cheng, and
Jianguo Hu. Pose transferrable person re-identiﬁcation. In CVPR,
2018. 2, 3, 4, 8

[27] Liqian Ma, Xu Jia, Qianru Sun, Bernt Schiele, Tinne Tuytelaars, and
Luc Van Gool. Pose guided person image generation. In NeurIPS,
2017. 3, 6, 7

[28] Xudong Mao, Qing Li, Haoran Xie, Raymond Lau, Zhen Wang, and
Stephen Smolley. Least squares generative adversarial networks. In
ICCV, 2017. 6, 7

[29] Lars Mescheder, Sebastian Nowozin, and Andreas Geiger. Which
training methods for GANs do actually converge? In ICML, 2018. 6
[30] Xuelin Qian, Yanwei Fu, Tao Xiang, Wenxuan Wang, Jie Qiu, Yang
Wu, Yu-Gang Jiang, and Xiangyang Xue. Pose-normalized image
generation for person re-identiﬁcation. In ECCV, 2018. 2, 3, 4, 5, 6,
7, 8

[31] Ergys Ristani, Francesco Solera, Roger Zou, Rita Cucchiara, and
Carlo Tomasi. Performance measures and a data set for multi-target,
multi-camera tracking. In ECCVW, 2016. 5

[32] Ergys Ristani and Carlo Tomasi. Features for multi-target multi-

camera tracking and re-identiﬁcation. In CVPR, 2018. 2, 5

[33] Aliaksandr Siarohin, Enver Sangineto, St´ephane Lathuili`ere, and
Nicu Sebe. Deformable GANs for pose-based human image gen-
eration. In CVPR, 2018. 3, 8

[34] Chi Su, Jianing Li, Shiliang Zhang, Junliang Xing, Wen Gao, and
Pose-driven deep convolutional model for person re-

Qi Tian.
identiﬁcation. In ICCV, 2017. 1, 3, 8

[35] Chi Su, Shiliang Zhang, Junliang Xing, Wen Gao, and Qi Tian. Deep
In ECCV,

attributes driven multi-camera person re-identiﬁcation.
2016. 2, 5

[36] Yumin Suh, Jingdong Wang, Siyu Tang, Tao Mei, and Ky-
oung Mu Lee. Part-aligned bilinear representations for person re-
identiﬁcation. In ECCV, 2018. 1, 3, 8

[37] Yifan Sun, Liang Zheng, Weijian Deng, and Shengjin Wang. SVD-

Net for pedestrian retrieval. In ICCV, 2017. 8

[38] Yifan Sun, Liang Zheng, Yi Yang, Qi Tian, and Shengjin Wang. Be-
In

yond part models: Person retrieval with reﬁned part pooling.
ECCV, 2018. 1, 2, 8

[39] Christian Szegedy, Wei Liu, Yangqing Jia, Pierre Sermanet, Scott
Reed, Dragomir Anguelov, Dumitru Erhan, Vincent Vanhoucke, and
Andrew Rabinovich. Going deeper with convolutions.
In CVPR,
2015. 8

[40] Zheng Tang, Milind Naphade, Ming-Yu Liu, Xiaodong Yang, Stan
Birchﬁeld, Shuo Wang, Ratnesh Kumar, David Anastasiu, and Jenq-
Neng Hwang. CityFlow: A city-scale benchmark for multi-target
multi-camera vehicle tracking and re-identiﬁcation. In CVPR, 2019.
1

[41] Cheng Wang, Qian Zhang, Chang Huang, Wenyu Liu, and Xinggang
Wang. Mancs: A multi-task attentional network with curriculum
sampling for person re-identiﬁcation. In ECCV, 2018. 8

[20] Hsin-Ying Lee, Hung-Yu Tseng, Jia-Bin Huang, Maneesh Singh, and
Ming-Hsuan Yang. Diverse image-to-image translation via disentan-
gled representations. In ECCV, 2018. 5

[42] Jingya Wang, Xiatian Zhu, Shaogang Gong, and Wei Li. Transfer-
able joint attribute-identity deep learning for unsupervised person re-
identiﬁcation. In CVPR, 2018. 2, 5

[21] Dangwei Li, Xiaotang Chen, Zhang Zhang, and Kaiqi Huang. Learn-
ing deep context-aware features over body and latent parts for person
re-identiﬁcation. In CVPR, 2017. 8

[43] Zhou Wang, Alan Bovik, Hamid Sheikh, and Eero Simoncelli. Image
quality assessment: from error visibility to structural similarity. TIP,
2004. 7

[22] Wei Li, Xiatian Zhu, and Shaogang Gong. Person re-identiﬁcation
by deep joint learning of multi-loss classiﬁcation. In IJCAI, 2017. 1,
2

[44] Longhui Wei, Shiliang Zhang, Wen Gao, and Qi Tian. Person transfer
GAN to bridge domain gap for person re-identiﬁcation. In CVPR,
2018. 3, 5

2146

[45] Longhui Wei, Shiliang Zhang, Hantao Yao, Wen Gao, and Qi Tian.
Glad: global-local-alignment descriptor for pedestrian retrieval. In
ACM MM, 2017. 1, 3, 8

[46] Lin Wu, Yang Wang, Junbin Gao, and Xue Li. Where-and-when to
look: Deep siamese attention networks for video-based person re-
identiﬁcation. TMM, 2018. 2

[47] Yu Wu, Yutian Lin, Xuanyi Dong, Yan Yan, Wei Bian, and Yi Yang.
Progressive learning for person re-identiﬁcation with one example.
TIP, 2019. 1

[48] Dong Yi, Zhen Lei, Shengcai Liao, and Stan Li. Deep metric learning

for person re-identiﬁcation. In ICPR, 2014. 2

[49] Rui Yu, Zhichao Zhou, Song Bai, and Xiang Bai. Divide and fuse: A
re-ranking approach for person re-identiﬁcation. In BMVC, 2017. 8
[50] Haiyu Zhao, Maoqing Tian, Shuyang Sun, Jing Shao, Junjie Yan,
Shuai Yi, Xiaogang Wang, and Xiaoou Tang. Spindle net: Person re-
identiﬁcation with human body region guided feature decomposition
and fusion. In CVPR, 2017. 1, 3

[51] Liang Zheng, Liyue Shen, Lu Tian, Shengjin Wang, Jingdong Wang,
In

and Qi Tian. Scalable person re-identiﬁcation: A benchmark.
ICCV, 2015. 2, 5, 8

[52] Liang Zheng, Yi Yang, and Alexander Hauptmann. Person re-
identiﬁcation: Past, present and future. arXiv:1610.02984, 2016. 1,
6

[53] Zhedong Zheng, Liang Zheng, and Yi Yang. A discriminatively
learned CNN embedding for person reidentiﬁcation. TOMM, 2017.
1, 2, 8

[54] Zhedong Zheng, Liang Zheng, and Yi Yang. Unlabeled samples gen-
erated by GAN improve the person re-identiﬁcation baseline in vitro.
In ICCV, 2017. 2, 3, 4, 5, 8

[55] Zhedong Zheng, Liang Zheng, and Yi Yang. Pedestrian alignment
network for large-scale person re-identiﬁcation. TCSVT, 2018. 1, 3,
8

[56] Zhun Zhong, Liang Zheng, Shaozi Li, and Yi Yang. Generalizing a
person retrieval model hetero-and homogeneously. In ECCV, 2018.
3

[57] Zhun Zhong, Liang Zheng, Zhiming Luo, Shaozi Li, and Yi Yang.
Invariance matters: Exemplar memory for domain adaptive person
re-identication. In CVPR, 2019. 3

[58] Jun-Yan Zhu, Taesung Park, Phillip Isola, and Alexei Efros. Un-
paired image-to-image translation using cycle-consistent adversarial
networkss. In ICCV, 2017. 3, 5

[59] Yang Zou, Zhiding Yu, Vijaya Kumar, and Jinsong Wang. Un-
supervised domain adaptation for semantic segmentation via class-
balanced self-training. In ECCV, 2018. 5

2147

