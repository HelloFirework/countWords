An End-to-End Network for Generating Social Relationship Graphs

Arushi Goel1, Keng Teck Ma1

,

2, and Cheston Tan2

1A*STAR Artiﬁcial Intelligence Initiative, Singapore, 2Institute for Infocomm Research, A*STAR, Singapore

goela@ihpc.a-star.edu.sg, ma ken teck@scei.a-star.edu.sg, cheston-tan@i2r.a-star.edu.sg

Abstract

Socially-intelligent agents are of growing interest in ar-
tiﬁcial intelligence. To this end, we need systems that can
understand social relationships in diverse social contexts.
Inferring the social context in a given visual scene not only
involves recognizing objects, but also demands a more in-
depth understanding of the relationships and attributes of
the people involved. To achieve this, one computational ap-
proach for representing human relationships and attributes
is to use an explicit knowledge graph, which allows for
high-level reasoning. We introduce a novel end-to-end-
trainable neural network that is capable of generating a So-
cial Relationship Graph – a structured, uniﬁed representa-
tion of social relationships and attributes – from a given in-
put image. Our Social Relationship Graph Generation Net-
work (SRG-GN) is the ﬁrst to use memory cells like Gated
Recurrent Units (GRUs) to iteratively update the social re-
lationship states in a graph using scene and attribute con-
text. The neural network exploits the recurrent connections
among the GRUs to implement message passing between
nodes and edges in the graph, and results in signiﬁcant
improvement over previous methods for social relationship
recognition.

1. Introduction

The understanding of human relationships in computer
vision research is in its nascent stage. In comparison, sig-
niﬁcant efforts have been made by social psychologists and
other researchers to study social relationships in humans
[8, 12]. The pioneering work of Sun et al. [24] proposes
a social relationship framework based on Bugental’s Social
Domain Theory [3] to classify social relationships and do-
mains. In this paper, we take a step further in understanding
social relationships from images by generating a Social Re-
lationship Graph (SRG), as illustrated in Figure 1.

In recent computer vision research, predicting relation-
ships of the “subject-predicate-object” kind have gained
major research attention. These can be used for multiple
high-level tasks like image retrieval, image captioning, and

Image grounded with people and social 

relationships 

person_1

lovers

person_2

mother-child

father-child

person

Social Relationship 

young_adult

Graph

male

male

child

person_2

young_adult

lovers

female

father-child

person

mother-child

person_1

Figure 1: For a given scene, our network generates a structured
representation – a Social Relationship Graph. Graph representa-
tions have shown good results on a variety of high-level vision
tasks, e.g. image retrieval and visual Q&A.

visual question answering [10, 25, 2]. The recent work for
the generation of scene graphs using an end-to-end model
[28, 13, 29] gives the best results on the Visual Genome
Dataset [11]. Since such graphs are human-interpretable,
we propose to build a Social Relationship Graph, which
encodes relationship and attribute information and captures
the rich semantic structure of a scene.

The task of understanding human relationships is a chal-
lenging problem given the wide variations that humans pose
in their environments. There is unobservable, latent infor-
mation in images which we as humans ﬁnd easy to inter-
pret. For developing human-level understanding in such sit-
uations, computational models are based on the theories of
social and cognitive psychology [23]. Based on the social
psychology theories of Bugental [3], we focus on human
attributes and environments for social relationships.

Scene and global contextual cues have the best results for
social relationships [12]. Furthermore, the activity that peo-

11186

ple are partaking in provides crucial features for social re-
lationship classiﬁcation [24]. In social psychology research
[3], it has been shown that appearance cues such as age,
gender and clothing are useful in understanding social rela-
tionships. We thus use scene context, activity and appear-
ance features for social relationship graph inference.

We formulate our problem as graph inference that en-
codes the interactions between nodes and edges in a graph.
Our problem is more challenging than scene graph genera-
tion [28, 13, 29] as our work requires understanding of high-
level semantic features (e.g. social context) and low-level
visual features (e.g. spatial arrangement of objects).

We devise a novel end-to-end model for predicting social
relationships using a Social Relationship Graph Genera-
tion Network (SRG-GN) that combines inputs from a Multi-
Network Convolutional Neural Network (MN-CNN) to iter-
atively update the hidden states of the nodes (persons) and
edges (relationships) in a Social Relationship Graph Infer-
ence Network (SRG-IN) by passing messages between two
types of Gated Recurrent Units (GRUs) [5].

The Rship GRUs (edges) have the scene and activity fea-
tures as the input, while the PPair GRUs (nodes) have the
human attribute features as input. The hidden state for each
edge gets updated by combining the updated node state and
updated edge state. Thus, the relationship (edge) state gets
updated by the ﬁne-grained attribute features of the adjacent
nodes and the scene and activity context from nearby edges.
The main contributions of this paper are: 1) a novel
structured representation (Social Relationship Graph) for
social understanding in visual scenes; 2) a novel end-to-
end-trainable neural network architecture using GRUs and
semantic attributes for graph-generation; 3) new state-of-
the art results for social relationship recognition on the
PIPA-relation [24] and PISC [12] datasets. This is the ﬁrst
architecture that builds on social relationships and attributes
using memory cells, and our results demonstrate the impor-
tance of message passing and scene context.

2. Related Work

2.1. Social Relationship Recognition

The area of social relationships is of growing interest to
the community, as social chatbots and personal assistants
need to understand social interactions. Many researchers
have tried to understand social relationships, roles and in-
teractions. Zhang et al. [30] have studied interpersonal re-
lationships using facial expressions with a Siamese-like ar-
chitecture. There are studies on Kinship recognition [20]
and Kinship veriﬁcation [6]. Wang et al. [26] studies fam-
ily relationships in personal image collections. Jinna et al.
[16] introduced a video dataset for coarse-grained social re-
lationships between humans. Li et al. [12] predicts social
relationships in images using an Attentive-RCNN model

for 6-relationship categorization. Ramanathan et al. [19]
recognize social roles played by people in various events.
Chakraborty et al. [4] classify photos into classes such as
‘couple, family, group, or crowd’. Sun et al. [24] predict
social relationships for ﬁne-grained relationships between
humans in everyday images. Many of the above-mentioned
works have used physical appearance or cues like activity,
proximity, emotion, expression, context etc. Our work dif-
fers by combining the essential attribute features with mem-
ory cells providing a richer framework for our problem.

2.2. Graph-Based Representations

There is a lot of recent interest in using structured graph
representations for visual grounding of images. Knowledge
graphs are being widely used for object detection and image
classiﬁcation [7, 17]. Johnson et al. [10] introduced ground-
truth annotated scene graphs for the task of image retrieval
using object relationships and attributes. Since then, the
task of generating scene graphs directly from images by us-
ing intrinsic graph properties and surrounding context has
gained attention [28, 13, 29, 9]. The use of vision and
language modules together has also been explored by re-
searchers for identifying relationships between objects [15].
Graph Neural Networks [21, 14] have gained a lot of atten-
tion for learning structured knowledge in graphs. Wang et
al. [27] exploit the knowledge of surrounding objects with
graph neural networks for updating social relationships. In
our work, we present a novel framework for generating
graphs, focusing on social relationships and attributes of
people involved in a scene, unlike the focus on pair-wise
relationships or object relationships in existing work.

3. Model Deﬁnition

In this section, we provide an overview of our method for
generating Social Relationship Graphs from images using
our Social Relationship Graph Generation Network (SRG-
GN). The framework in Figure 2 gives a more detailed de-
scription of our two modules: A Multi-Network Convo-
lutional Neural Network (MN-CNN) module for Attribute
and Relationship representations followed by a Social Re-
lationship Graph Inference Network (SRG-IN) module for
generating a structured graph representation. The model is
trained end-to-end to predict relationships, domains and at-
tributes as part of a scene in the form of a structured seman-
tic directed graph representation.

3.1. Multi-Network Convolutional Neural Network

(MN-CNN) for Relationships and Attributes

We have an input image I and a set of bounding box an-
notations Bi for the people in image I where i = 1,2,...,N.
These annotations are cropped for a single-body image of a
person, Ii and resized into 227x227 pixels. For every anno-
tated relationship between two people, we deﬁne a “context

11187

MN-CNN Module

Multi-task Loss

SN1

PPairAtt

∑

MTL 
Framework

Single-Body Image
     I1                        I2

Age Convnet

Gender Convnet

Image I

227X227

227X227

Clothing Convnet

224X224

SN2

Scene Convnet

Context Image Ic

Activity 
Convnet

fc_age

fc_gender

fc_clothing

fc_scene

fc_activity

Age

Gender

Relation

Domain

hn

t-1

SRG-IN Module

hn
t

xn

 PPair 
GRU

 PPair 
GRU

Fc concatenate
RshipAtt

xe

 Rship 
GRU

he

t-1

 Rship 
GRU

hmpe

t

Fc concatenate

T=0

T=1

T=2

Figure 2: SRG-GN: Our proposed end-to-end network for Social Relationship Graph generation. We take the single body images, I1
and I2, and the “context image” (smallest image that contains both single-body images), Ic as input to the SN1 and SN2 sub-modules
of the MN-CNN module and ﬁne-tune the fully-connected layers of all the attributes. These fully-connected layers are concatenated
and fed as input to the SRG-IN module and the hidden edge state gets iteratively updated by mean-pooling the edge (relation) and node
(person/attribute) hidden states. The ﬁnal updated edge state is used for predicting social relationships in the given image. For the multi-
task learning framework, age and gender attributes from the fully-connected layers of the MN-CNN module also contribute to the joint
optimization of the individual cross-entropy losses. The symbol P denotes summation and L denotes mean-pooling.

image” (smallest image that contains both single-body im-
ages) Ic, resized into 224x224 pixels.

The MN-CNN module has two sub-modules (SN1 and
SN2) with the inputs Ii and Ic respectively. Ii is passed
through the sub-module, SN1, which is an Attribute Con-
vNet architecture with 5 conv layers and 2 fully-connected
layers (fc6 and fc7), each for the 3 attributes – age, gen-
der and clothing. The weights for these 3 ConvNet layers
are the pre-trained weights as discussed later in Section 4.3.
We ﬁne-tune the fully-connected layers for each attribute
and then the features from the fc7 layers are concatenated
into a single feature vector, which we assign to PPairAtt.

P P airAtt = [fcage|4096d, fcgender|4096d, fcclothing|4096d]
(1)
The sub-module SN2 is a network of pairwise-relationship
ConvNet architectures. There are two VGG-16 architec-
tures [22] to compute activity and scene features from the
context images of people. Activity has an important corre-
lation to identifying relationships between people, say, two
people “marrying” are more likely to be lovers. Scene con-
text information can also be leveraged for improving the
model efﬁcacy to predict relationships. As humans too, we
understand images by looking at the whole image scene and
not only the objects under consideration. This gives more
coarse-grained information to comprehend the given task.
We ﬁne-tune the fully-connected layers for both of these

sub-architectures, then concatenate the fc7 layers to form a
high-dimensional vector, which we assign to RshipAtt.

RshipAtt = [fcactivity|1024d, fcscene|4096d]

(2)

3.2. Social Relationship Graph Inference Network

(SRG-IN)

We formulate the task of classifying social relationships
between people in the form of a social graph inference prob-
lem, where we predict the relationships in an image by con-
sidering relationship triplets <person1, relation, person2>.
Consider a pair of people in the given image I with some
social relationship between them. In our network, each rela-
tionship in an image gets information from its nearby nodes
(person attributes) and also its nearby edges (relationships).
This is achieved by using Gated Recurrent Units (GRUs)
to aggregate messages from the adjacent nodes and rela-
tionships and iteratively update those messages to improve
the predicted edge states (relationships) between the given
nodes (persons). Thus, we are able to exploit the informa-
tion in the scene context and the individual attributes to im-
prove the relationships in the Social Relationship Graph.

3.2.1 Inference using GRUs and Message Passing

Scheme

Mathematically, we formulate our inference task as a proba-
bility function: given an input image I, bounding box values

11188

Bi and x as the representation of the SRG:

x = {xage

i

, xgender

i

, xrelation

i−>j

, I|i = 1, 2, ...N, j = 1, 2, ...N }

i

where xage

(3)
and xgender
are the age and gender attributes
of the person and xrelation
is the social relationship between
the persons i and j, and N is the total number of people in
an image. We have to ﬁnd an optimal value of x,

i−>j

i

x∗ = argmaxxP r(x|I, Bi)

(4)

where,

N

N

P r(x|I, Bi) =

Y

Y

P r(xage

i

, xgender

i

, xrelation

i−>j

|I, Bi)

i=1

j=1

(5)
We perform this inference using an end-to-end network of
Social Relationship Graph Generation where the MN-CNN
module provides the initial inputs for the nodes and the
edges in the SRG-IN module.

Gated Recurrent Units (GRUs) are the most reliable and
lightweight RNN memory units. The GRUs operate using
a reset gate and an update gate and have the ability to keep
memory from previous activations allowing them to remem-
ber features for a long time. Let us brieﬂy revisit the func-
tioning of a single GRU cell. The reset gate r is deﬁned
as

rt = σ(Wr.[ht−1, xt])

(6)

where σ is the sigmoid function, Wr is the learnable weight
matrix, ht−1 is the previous hidden state, xt is the input to
the GRU cell and [,] denotes concatenation. The update gate
z is given by

zt = σ(Wz.[ht−1, xt])

The actual activation in the memory unit is given by

ht = (1 − zt) ∗ ht−1 + zt ∗ ˜ht

where,

˜ht = tanh(W xt + U (rt ∗ ht−1))

(7)

(8)

(9)

W and U are weight matrices that are learned and * is the
element-wise multiplication. As empirically evaluated [5],
the reset gate r sits between the previous activation and the
next candidate activation to forget the previous state, and the
update gate z decides how much of the candidate activation
to use in updating the cell state.

Our network has two sets of GRUs (Relationship(Rship)
and Person-Pair(PPair)). The initial state of the GRUs can
be set to zero or some random vector, and the input to the
unit is a sequence of features or symbols. To compute ac-
tivations from the PPair GRU, we take the feature vector,
PPairAtt, from the SN1 sub-module of the MN-CNN mod-
ule as the initial state and input to the PPair GRU. We con-
catenate the features from the two nodes (persons) with a

relationship and take this integrated message as input. To
compute activations from the Rship GRU, we take the fea-
ture vector, RshipAtt, from the SN2 sub-module of the MN-
CNN as the initial state and input to the Rship GRU. When
the state of the PPair GRU is updated, we update the state of
the Rship GRU by including the node state information into
the edge state information to provide context to the edges
from its adjacent nodes.

Each of the two GRUs receives incoming messages and
we concatenate these messages using a standard pooling op-
eration, mean pooling. Mean pooling aggregates messages
in a more meaningful representation as shown in Section
5.2. The PPair GRU receives [fi,fj ] as input, xn where,
fi and fj are the attribute features (PPairAtt) of the nodes
i and j respectively and [,] denotes concatenation. The pre-
vious node state hn
t−1 is also initialized using [fi,fj ] and
updates the node state to hn
t using xn as input. The Rship
GRU receives fi−>j as input, xe where, fi−>j are the rela-
tionship features from the MN-CNN module. The previous
edge state he
t−1 is initialized using fi−>j and the edge state
is updated to the ”mean-pooled” edge state, hmpe
, given by:

t

hmpe
t =

he
t + hn
t

2

(10)

This includes the semantic node information into the
edge context for updating the edge state with meaningful
information from the adjacent nodes and edges. In the next
iteration of the GRU, the input to the GRUs are messages
from the previous time step. The updated edge representa-
tions are used to predict the relationships between nodes.

3.3. Multi-Task Learning (MTL) Framework

In Multi-Task Learning, we simultaneously learn mul-
tiple tasks with some shared layers except for one task-
speciﬁc layer. This can be achieved if the same dataset
has multiple labels for learning. For our problem, we have
four task labels (age, gender, domain and relationship) that
can be learned using the same network. We jointly op-
timize the loss function by combining the individual loss
functions for all these four tasks. We learn the domain la-
bels together with the relationship labels, so that the net-
work can share some relevant information between these
two tasks to improve the overall loss function. For instance,
the “Reciprocity Domain” refers to relationships that have a
reciprocal nature, such as, “friends”, “siblings” and “class-
mates”. The output from the Rship GRUs are used to predict
the domain and relationship labels, whereas the fcage and
the fcgender feature vectors from the MN-CNN module are
used to predict the age and gender attribute labels respec-
tively using a cross-entropy loss function. We only consider
age and gender attribute predictions because the dataset is
limited to only these two attributes. Figure 2 shows how we
incorporate the MTL framework in our SRG-GN model.

11189

4. Empirical Evaluation

4.1. Dataset Preparation

The PIPA-relation dataset [24] has 16 ﬁne-grained rela-
tionship categories 1. We extend their dataset to a PIPA-
relation graph dataset. We expand the ground-truth anno-
tations for faces in PIPA into full human body annotations
by following the body proportion measurements; 3 x face
width and 6 x face height. This gives us ground-truth an-
notations for single-body images. The context images are
cropped from the full images using bounding box values
of the people with relationship annotations. We construct
our PIPA-relation graph dataset using two attributes (age
and gender) from the attribute annotations published on the
PIPA dataset [18]. The train/val/test set has 6289 images
with 13,672 relationships and 16,145 attributes, 270 images
with 706 relationships and 753 attributes, 2649 images with
5075 relationships and 6655 attributes.

We further validate the performance of our model on
the large–scale People in Social Context (PISC) dataset re-
leased by Li et al. [12]. The PISC dataset has 22,670 images
where the person pairs are annotated for 3 coarse-grained
relationships (intimate, not-intimate and no relation) and
6 ﬁne-grained relationships (commercial, couple, family,
friends, professional and no-relation). The train/val/test set
consist of 16,828 images with 55,400 relationship instances,
500 images and 1,505 instances, 1,250 images and 3,961 in-
stances, respectively.

4.2. Baselines

Comparison models for PIPA-relation dataset: Our
baselines are the two end-to-end models trained on the
PIPA-relation dataset by Sun et al. [24] and the end-to-end
model for Scene Graph Generation by Xu et al. [28] as be-
low:

Double-Stream (DS) CaffeNet: Trained from scratch on
the entire dataset using a two stream network for each single
body of a person to predict relationships between them.

Finetuned model from pre-trained on Imagenet: Uses
ﬁxed weights of the conv layers from the Imagenet pre-
trained weights and ﬁne-tuned the fully-connected layers on
the PIPA-relation dataset.

Primal-Dual graph model: Trained the primal-dual

graph model [28] on the PIPA-relation graph dataset.

Comparison models for PISC dataset: We compare
our models with the models proposed by Li et al. [12]. An
overview of the baseline models by [12] is given below:

Pair–CNN+BBox: Two CNNs for each cropped person

image with geometry bounding box features.

1father-child, mother-child, grandpa-grandchild, grandma-grandchild,
friends, siblings, classmates, lovers/spouses, presenter-audience, teacher-
student, trainer-trainee, leader-subordinate, band members, dance team
members, sport team members and colleagues

MODEL

Accuracy

Double-Stream Caffenet

Primal-Dual model (Our trained)

Fine-tuned pre-trained on Imagenet

Our MN-CNN module only
Our SRG-GN without Scene
Our SRG-GN (ﬁnal model)

34.40%
44.91%
46.20%
49.75%
51.79%
53.56%

Table 1: Accuracy for the task of Social Relationship Recognition
(SRRec on PIPA-relation graph dataset). Chance-level accuracy is
6.25% (1 in 16).

Pair–CNN+BBox+Union: Pair–CNN+BBox with a sin-

gle CNN for union region of interest features.

Pair–CNN+BBox+Global: Pair–CNN+BBox with the

whole image as context.

Pair–CNN+BBox+Scene: Pair–CNN+BBox with scene

features as context.

Dual-Glance: Combines Pair–CNN+BBox+Union with
attention from contextual information to reﬁne predictions.

4.3. Implementation Details

The pre-trained weights for age, gender, clothing and ac-
tivity models are publicly available [24]. The pre-trained
weights for the Scene ConvNet architecture are from the
models published by Zhou et al. [31]. We freeze the weights
for all the layers and only ﬁne-tune the fully-connected lay-
ers of the MN-CNN module, and the GRUs. The output of
both the GRUs have a dimension of 512. A softmax layer
computes the ﬁnal scores for age and gender attributes, do-
mains and relationship labels. In case of PISC dataset, we
only get scores for domain and relationships as there are
no labels for attributes. We sum all the losses and jointly
optimize the total weighted loss, as part of the MTL frame-
work. A learning rate of 10−6 and 2 time-steps for the GRU
are used to train the model. To prevent over-ﬁtting, meth-
ods like early-stopping, dropout and regularization are em-
ployed. Our model is implemented using Tensorﬂow [1].

4.4. Results

We evaluate the performance of our model on the PIPA-
relation graph dataset and the PISC dataset. The PIPA-
relation graph dataset additionally has 6 age labels (infant,
child, young adult, middle age, senior and unknown) and 2
gender labels (male and female).

4.4.1 Quantitative Results

We evaluate our model for two setups:

Social Relationship Recognition (SRRec): To evalu-
ate this, we only consider the triplet predictions of person-
relationship-person and calculate the accuracy score for so-
cial relationship recognition.

Social Relationship Graph Generation (SRGGen):
We consider two triplet predictions (person-relationship-

11190

person_3

Image 

annotated 

with 

predicted 
relationships

friendsperson_2

friends

person

friends

friends

person_1

person

sports-team

person_1

person_1

mother-child

person

Ground-

Truth Social 
Relationship

Graph

Social 

Relationship 
Graph from 
our SRG-GN 

Figure 3: Example Social Relationship Graph generation results from our ﬁnal model on PIPA-relation graph dataset, and comparison
with ground-truth social relationship graphs. Each person (blue ovals) has related age and gender attributes (green ovals) with social
relationships between each pair of persons (orange ovals). We only visualize relationships that have the corresponding ground–truth.

person; person-age-gender) to measure the accuracy of
generating a full SRG with correct age and gender nodes
and relationship edges. The directed edges of the graph de-
pends on the direction of the relationship, say, from father
to child. For bi-directional relationships like colleagues, we
show only one edge for better visualization.

We report results for different variations of our model
and compare with the baselines. Our MN-CNN module
only, is a variation of our model without the GRUs by using
concatenated PPairAtt and RshipAtt as input to the relation-
ship and domain prediction task speciﬁc layers and fcage
and fcgender to the age and gender prediction task layers
respectively. Our SRG-GN without scene, is our ﬁnal model
without the scene context features fcscene, in the RshipAtt.
Our SRG-GN, is the ﬁnal model as shown in Figure 2.

Results on PIPA-relation dataset: In Table 1, we pro-
vide the accuracy for our ﬁrst setup, SRRec. Our MN-CNN
module improves on the Fine-tuned model by 3.5% for the
task of social relationship recognition. This clearly indi-
cates the importance of using the semantic attributes, scene
and activity features over the visual features pre-trained on
Imagenet. Our ﬁnal model, SRG-GN, outperforms only
MN-CNN by 3.81%, which explains the capability of our
message passing scheme for generating social relationship
graphs. This technique helps to retain signiﬁcant informa-
tion from the nearby nodes and edges in a social relationship

graph and thus gives better results. SRG-GN performs bet-
ter than the primal-dual graph baseline as the latter localizes
objects using visual cues with an exchange of information
between multiple classes of objects unlike our problem.

Table 3 shows the performance of our model on the
second setup of Social Relationship Graph Generation,
SRGGen. We achieve an accuracy of 27.64% using our ﬁnal
model. The accuracy for the Our SRG-GN without scene is
7.4% lower than Our SRG-GN, which empirically proves
that context information plays a major role in generating a
coherent social relationship graph.

Results on PISC dataset: Table 4 compares the mean-
average precision evaluated on the PISC dataset for Social
Relationship Recognition (SRRec). Our ﬁnal model with
mean pooling and 2 time steps notably outperforms the
state-of-the-art model on PISC dataset by ∼8.5%. Our ﬁnal
model improves only slightly in precision over our SRG-
GN model without scene. One possible reason is that the
scene context in PISC dataset has similar contextual infor-
mation for relationships unlike in the PIPA-relation dataset.
We report the precision of each of the 6 relationship la-
bels in Table 2. Our SRG-GN model improves in precision
over the MN-CNN-only model for the classes couple and
commercial. The class friends has lower precision, indicat-
ing that other classes are sometimes wrongly classiﬁed as
“friends”. Due to imbalance in the training dataset, we in-

11191

MODEL

mAP

Family Couple Commercial No-Relation

Professional

Friends

Our MN-CNN module only
Our SRG-GN without Scene
Our SRG-GN (ﬁnal model)

60.2
69.2
71.6

75.0
80.0
80.0

57.1
77.7
100.0

62.5
88.8
83.3

59.9
61.7
62.5

80.6
81.8
78.4

26.0
24.5
25.2

Table 2: Detection results for 6-relationship labels on PISC dataset.

MODEL

Accuracy

Our SRG-GN without Scene
Our SRG-GN (ﬁnal model)

20.24%
27.64%

Table 3: Accuracy for the task of Social Relationship Graph Gen-
eration (SRGGen) on PIPA-relation graph dataset. Chance- level
accuracy is 0.52% = (1/16 * 1/6 * 1/2)

person

friends

professional

person

person

no-relation

commercial

p r o f e s s i o n a l

person

person

no-relation

person

friends

person

friends

friends

family

person

person

i o n

n o - r e l a t

professional

person

Figure 4: Wrong relationship predictions from the SRG-GN model
on the PISC dataset. The relationships in yellow are the ground-
truth, the relationships in red are the incorrect predictions. Only
the relationships marked as red in an image are incorrectly pre-
dicted by our model.

troduce a weighted cross entropy loss to penalize the classes
with few samples; this improves performance signiﬁcantly.

4.4.2 Qualitative Results

The Social Relationship graph (SRG) is a rich semantic
graph with attribute and relationship information for the
people in a given scene. Our SRG contains ground-truth
information about the class and bounding-box labels of the
objects in the image. Through our SRG-GN, we predict the
social relationships, age and gender attributes of the people
in a given scene.

Figure 3 shows qualitative results on PIPA-relation graph
dataset to compare the SRG generated from our model and
the ground truth.
In the ﬁrst example, the SRG-GN cor-
rectly predicts the relationships between the given people.
As shown in the graph, all nodes (persons) have “friends”
relationship between them which are correctly predicted

MODEL

Pair–CNN+BBox

Pair–CNN+BBox+Union
Pair–CNN+BBox+Global
Pair–CNN+BBox+Scene

Dual-Glance

Our MN–CNN module only
Our SRG–GN without Scene
Our SRG–GN (ﬁnal model)

mAP

54.3%
56.9%
54.6%
51.7%
63.2%
60.2%
69.2%
71.6%

Table 4: Mean–Average Precision (mAP) for the task of Social
Relationship Recognition (SRRec) on PISC dataset.

by our model. Gender attributes also correspond to the
ground-truth, but the age attributes are incorrectly predicted
as “middle-age” instead of “young-adult”. The model cor-
rectly predicts more complex relationships like “sports-
team members” which has a lot more contextual infor-
mation than other relationships like “grandma-grandchild”
which it falsely predicts as “mother-child” due to ambiguity
in such relationships.

Figure 5 gives examples of the correct predictions on
PISC dataset. Our model predicts multiple relationship in-
stances in an image, such as a group of players are correctly
labeled as “professional”. Figure 4 shows examples for
misclassiﬁed relationships. For instance, the model falsely
detects the relationship in bottom-left image as “family”,
when they are more likely to be friends due to information
from adjacent nodes and edges. There is ambiguity between
“professional” and “commercial” in some cases due to sim-
ilar global and scene context for these classes.

5. Ablative Analysis

In this section, we examine the performance of our SRG-

GN model variations on the PIPA-Relation graph dataset.

5.1. Model Variations

We evaluate the importance of scene context in predict-
ing relationships in our ﬁnal graph inference framework.
As shown in Section 4.4, adding scene context signiﬁ-
cantly improves the performance on both tasks of SRRec
and SRGGen. Intuitively, we can infer that scene informa-
tion can be important in many different situations. For in-
stance, given a party scene, the group of people are more
likely to be friends than colleagues, and a group of athletes
running on a track are much more likely to be sports team
members than band members. In Figure 6(a), we present

11192

friends

person

person

person

person

professional

person

professional

professional

professional

commercial

person

person

person

person

family

family

family

person

no-relation

no-relation

personprofessional

person

person

Figure 5: Correct predictions from our ﬁnal model on the PISC dataset.

(a).  SRG results from the SRG-GN model and SRG-GN model without scene

person

colleagues

person

sports-team

person

person

(b). SRG results from the SRG-GN model and only MN-CNN model

person

band-memb

band-memb

person

band-memb

person

person

colleagues

band-memb

person

band-memb

person

Figure 6: Qualitative analysis of our model variations on PIPA-
Relation. The left results are from our ﬁnal model, SRG-GN. The
top-right result is from SRG-GN without Scene, while the bottom-
right result is from the only MN-CNN model.

an example to highlight the importance of using whole im-
age scene context for accurate predictions. Our SRG-GN
without scene incorrectly predicts the two people as sports
team members, but if we look at the whole scene together
it increases the chances of them being colleagues and not
related to sports. Without scene context, identifying the re-
lationships between two people can be sometimes ambigu-
ous. This clearly explains the motivation behind using scene
context as an important feature in the SRG-IN module.

We also examine how predicting relationships in isola-
tion from the only MN-CNN module has lower accuracy
than the combined model with the SRG-IN module. For
example, a group of people performing on the stage should
all very likely be band members, and our model exploits
this information for overall inference, whereas the only MN-
CNN module predicts the triplets in the social relationship
graph independently. In Figure 6(b), our ﬁnal model cor-
rectly predicts the relationships as band-members due to the
message information from the adjacent group of relation-
ships in an image. Without this message passing network,
the MN-CNN module only considers information from the
pair of people between whom relationship has to be pre-

Pooling

# time steps Accuracy

max
max
max
mean
mean
mean

1
2
3
1
2
3

50.41%
52.16%
51.27%
50.89%
53.56%
52.08%

Table 5: Ablation study for different time–steps and pooling tech-
niques on the PIPA-relation graph dataset.

dicted. Thus, the SRG-IN module uses contextual informa-
tion from the nearby nodes and edges in a graph to improve
individual predictions.

5.2. Pooling and Time–Step variations

We evaluate our SRG-GN model on the PIPA-relation
with different number of time steps and pooling techniques.
From Table 5, it can be observed that mean-pooling is
more effective in passing useful information between hid-
den states than max-pooling. Also, there is a ∼1.5% de-
crease in accuracy on increasing the time steps as it starts
passing noisy information between states with more false
detections in the social relationship graph.

6. Conclusion

We introduced a novel end-to-end-trainable network for
generating social relationship graphs from images using
GRUs. Previous work on generating graphs dealt with re-
lationships between objects, whereas our work tackles the
more challenging problem of inferring social relationships.
Experimental results show the importance of using attribute
and contextual features with message passing in a graph.
Our model outperforms the state-of-the-art for recognizing
social relationships, and performs well for generating social
relationship graphs. This work can be extended for more
complex tasks, such as predicting social intentions.

Acknowledgements

This work was supported by NRF grant no. NRF2015-NRF-
ISF001-2541 (KTM and CT) and A*STAR SERC SSF grant no.
A1718g0048 (AG and KTM).

11193

References

[1] Mart´ın Abadi, Paul Barham, Jianmin Chen, Zhifeng Chen,
Andy Davis, Jeffrey Dean, Matthieu Devin, Sanjay Ghe-
mawat, Geoffrey Irving, Michael Isard, et al. Tensorﬂow:
a system for large-scale machine learning.
In OSDI, vol-
ume 16, pages 265–283, 2016.

[2] Peter Anderson, Basura Fernando, Mark Johnson, and
Stephen Gould. Spice: Semantic propositional image cap-
tion evaluation. In ECCV, pages 382–398, 2016.

[3] Daphne Blunt Bugental. Acquisition of the algorithms of so-
cial life: A domain-based approach. Psychological Bulletin,
126(2):187–219, 2000.

[4] Ishani Chakraborty, Hui Cheng, and Omar Javed. 3d vi-
sual proxemics: Recognizing human interactions in 3d from
a single image.
In Proceedings of the IEEE Conference
on Computer Vision and Pattern Recognition, pages 3406–
3413, 2013.

[5] Junyoung Chung, Caglar Gulcehre, Kyunghyun Cho, and
Yoshua Bengio. Empirical evaluation of gated recurrent neu-
ral networks on sequence modeling. In NIPS 2014 Workshop
on Deep Learning, December 2014, 2014.

[6] Ruogu Fang, Kevin D Tang, Noah Snavely, and Tsuhan
Chen. Towards computational models of kinship veriﬁcation.
In 17th IEEE International Conference on Image Processing
(ICIP), 2010, pages 1577–1580. IEEE, 2010.

[7] Yuan Fang, Kingsley Kuan, Jie Lin, Cheston Tan, and Vijay
Chandrasekhar. Object detection meets knowledge graphs.
In Proceedings of the 26th International Joint Conference on
Artiﬁcial Intelligence, pages 1661–1667. AAAI Press, 2017.
[8] Chris Frith. Role of facial expressions in social interactions.
Philosophical transactions of the royal society of London B:
Biological sciences, 364(1535):3453–3458, 2009.

[9] Roei Herzig, Moshiko Raboh, Gal Chechik, Jonathan Be-
rant, and Amir Globerson. Mapping images to scene graphs
with permutation-invariant structured prediction. In S. Ben-
gio, H. Wallach, H. Larochelle, K. Grauman, N. Cesa-
Bianchi, and R. Garnett, editors, Advances in Neural Infor-
mation Processing Systems 31, pages 7211–7221, 2018.

[10] Justin Johnson, Ranjay Krishna, Michael Stark, Li-Jia Li,
David Shamma, Michael Bernstein, and Li Fei-Fei.
Im-
age retrieval using scene graphs. In The IEEE Conference
on Computer Vision and Pattern Recognition (CVPR), pages
3668–3678, June 2015.

[11] Ranjay Krishna, Yuke Zhu, Oliver Groth, Justin Johnson,
Kenji Hata, Joshua Kravitz, Stephanie Chen, Yannis Kalan-
tidis, Li-Jia Li, David A Shamma, et al. Visual genome:
Connecting language and vision using crowdsourced dense
image annotations.
International Journal of Computer Vi-
sion, 123(1):32–73, 2017.

[12] Junnan Li, Yongkang Wong, Qi Zhao, and Mohan S Kankan-
halli. Dual-glance model for deciphering social relation-
ships. In Proceedings of the IEEE conference on computer
vision and pattern recognition, pages 2650–2659, 2017.

[13] Yikang Li, Wanli Ouyang, Bolei Zhou, Kun Wang, and Xi-
aogang Wang. Scene graph generation from objects, phrases
and region captions. 2017 IEEE International Conference on
Computer Vision (ICCV), pages 1270–1279, 2017.

[14] Yujia Li, Richard Zemel, Marc Brockschmidt, and Daniel
Tarlow. Gated graph sequence neural networks.
Inter-
national Conference on Learning Representations (ICLR),
2016.

[15] Cewu Lu, Ranjay Krishna, Michael Bernstein, and Li Fei-
Fei. Visual relationship detection with language priors. In
European Conference on Computer Vision, pages 852–869.
Springer, 2016.

[16] Jinna Lv, Wu Liu, Lili Zhou, Bin Wu, and Huadong Ma.
Multi-stream fusion model for social relation recognition
from videos.
In Klaus Schoeffmann, Thanarat H. Chalid-
abhongse, Chong Wah Ngo, Supavadee Aramvith, Noel E.
O’Connor, Yo-Sung Ho, Moncef Gabbouj, and Ahmed El-
gammal, editors, MultiMedia Modeling, pages 355–368,
Cham, 2018. Springer International Publishing.

[17] Kenneth Marino, Ruslan Salakhutdinov, and Abhinav Gupta.
The more you know: Using knowledge graphs for image
classiﬁcation.
In 2017 IEEE Conference on Computer Vi-
sion and Pattern Recognition (CVPR), pages 20–28. IEEE,
2017.

[18] Seong Joon Oh, Rodrigo Benenson, Mario Fritz, and Bernt
Schiele. Person recognition in personal photo collections.
2015 IEEE International Conference on Computer Vision
(ICCV), pages 3862–3870, 2015.

[19] Vignesh Ramanathan, Bangpeng Yao, and Li Fei-Fei. So-
cial role discovery in human events. In Proceedings of the
IEEE conference on computer vision and pattern recogni-
tion, pages 2475–2482, 2013.

[20] Joseph Peter Robinson, Ming Shao, Yue Wu, Hongfu Liu,
Timothy Gillis, and Yun Fu. Visual kinship recognition of
families in the wild. IEEE Transactions on Pattern Analysis
and Machine Intelligence, pages 2624–2637, 2018.

[21] Franco Scarselli, Marco Gori, Ah Chung Tsoi, Markus Ha-
genbuchner, and Gabriele Monfardini. The graph neural
network model.
IEEE Transactions on Neural Networks,
20(1):61–80, 2009.

[22] Karen Simonyan and Andrew Zisserman. Very deep convo-
lutional networks for large-scale image recognition. ICLR,
2015.

[23] Eliot R Smith and Jamie DeCoster. Dual-process models in
social and cognitive psychology: Conceptual integration and
links to underlying memory systems. Personality and social
psychology review, 4(2):108–131, 2000.

[24] Qianru Sun, Bernt Schiele, and Mario Fritz. A domain based
approach to social relation recognition. 2017 IEEE Confer-
ence on Computer Vision and Pattern Recognition (CVPR),
pages 435–444, 2017.

[25] Damien Teney, Lingqiao Liu, and Anton van den Hengel.
Graph-structured representations for visual question answer-
ing. In 2017 IEEE Conference on Computer Vision and Pat-
tern Recognition (CVPR), pages 3233–3241. IEEE, 2017.

[26] Gang Wang, Andrew Gallagher, Jiebo Luo, and David
Forsyth. Seeing people in social context: Recognizing peo-
ple and social relationships. In European conference on com-
puter vision, pages 169–182. Springer, 2010.

[27] Zhouxia Wang, Tianshui Chen, Jimmy Ren, Weihao Yu, Hui
Cheng, and Liang Lin. Deep reasoning with knowledge

11194

graph for social relationship understanding. In Proceedings
of the 27th International Joint Conference on Artiﬁcial Intel-
ligence, pages 1021–1028. AAAI Press, 2018.

[28] Danfei Xu, Yuke Zhu, Christopher Bongsoo Choy, and Li
Fei-Fei. Scene graph generation by iterative message pass-
ing. pages 3097–3106, 2017.

[29] Rowan Zellers, Mark Yatskar, Sam Thomson, and Yejin
Choi. Neural motifs: Scene graph parsing with global con-
text. In Proceedings of the IEEE Conference on Computer
Vision and Pattern Recognition, pages 5831–5840, 2018.

[30] Zhanpeng Zhang, Ping Luo, Chen-Change Loy, and Xiaoou
Tang. Learning social relation traits from face images. In
Proceedings of the IEEE International Conference on Com-
puter Vision, pages 3631–3639, 2015.

[31] Bolei Zhou, Agata Lapedriza, Jianxiong Xiao, Antonio Tor-
ralba, and Aude Oliva. Learning deep features for scene
recognition using places database.
In Advances in neural
information processing systems, pages 487–495, 2014.

11195

