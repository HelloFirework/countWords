Dense Relational Captioning:

Triple-Stream Networks for Relationship-Based Captioning

Dong-Jin Kim1

Jinsoo Choi1 Tae-Hyun Oh 2

In So Kweon1

1KAIST, South Korea. 2 MIT CSAIL, Cambridge, MA.

1{djnjusa,jinsc37,iskweon77}@kaist.ac.kr 2taehyun@csail.mit.edu

Abstract

Our goal in this work is to train an image captioning
model that generates more dense and informative captions.
We introduce “relational captioning,” a novel image cap-
tioning task which aims to generate multiple captions with
respect to relational information between objects in an im-
age. Relational captioning is a framework that is advan-
tageous in both diversity and amount of information, lead-
ing to image understanding based on relationships. Part-of-
speech (POS, i.e. subject-object-predicate categories) tags
can be assigned to every English word. We leverage the
POS as a prior to guide the correct sequence of words in a
caption. To this end, we propose a multi-task triple-stream
network (MTTSNet) which consists of three recurrent units
for the respective POS and jointly performs POS prediction
and captioning. We demonstrate more diverse and richer
representations generated by the proposed model against
several baselines and competing methods.

1. Introduction

Human visual system has the capability to effectively
and instantly collect a holistic understanding of contextual
associations among objects in a scene [16, 23] by densely
and adaptively skimming the visual scene through the eyes,
i.e. the saccadic movements. Such instantly extracted rich
and dense information allows humans to have the superior
capability of object-centric visual understanding. Motivated
by this, in this work, we present a new concept of scene
understanding, called dense relational captioning, that pro-
vides dense but selective, expressive, and relational repre-
sentation in a human interpretable way, i.e., via captions.

Richer representation of an image often leads to numer-
ous potential applications or performance improvements of
subsequent computer vision algorithms [22, 23]. In order
to achieve richer object-centric understanding, Johnson et
al. [12] proposed a framework called DenseCap that gener-
ates captions for each of the densely sampled local image
regions. These regional descriptions facilitate both rich and

Figure 1: Overall description of the proposed relational cap-
tioning framework. Compared to traditional frameworks,
our framework is advantageous in both interaction under-
standing and high-level interpretation.

dense semantic understanding of a scene in a form of inter-
pretable language. However, the information in the image
that we want to acquire includes not only the information of
the object itself but also the interaction with other objects
or the environment.

As an alternative way of representing an image, we fo-
cus on dense relationships between objects. In the context
of human cognition, there has been a general consensus that
objects and particular environments near the target object
affect search and recognition efﬁciency. Understanding the
relationships between objects clearly reveal object interac-
tions and object-attribute combinations [11, 14, 20].

Interestingly, we observe that the annotations done by
humans on computer vision datasets predominantly con-
in Visual Genome [15] and MS
tain relational forms;
COCO [19] caption datasets, most of the labels take the
format of subject-predicate-object more so than subject-
predicate. Moreover, UCF101 [31] action recognition
dataset contains 85 actions out of 101 (84.2%) that are de-
scribed in terms of human interactions with other objects or
surroundings. These aspects tell us that understanding inter-
action and relationships between objects facilitate a major

6271

Small dog sitting on a motorcycle.The man riding a red motorcycle.The dog sitting behind the person.Old man in the front of brown dog.Relational CaptioningSingle boxRelationshipsInputmotorcyclepersondogmotorcycleperson‘riding’dogmotorcycle‘on’persondog‘behind’The motorcycle is red in color.The man is wearing a black shirt.The dog is brown and black.Simple labelSentenceOutputObject DetectionDense CaptioningRelationship Detectiondogperson‘in front of’component in visual understanding of object-centric events.
In this regard, we introduce a novel captioning frame-
work relational captioning that can provide diverse and
dense representations from an image. In this task, we ﬁrst
exploit the relational context between two objects as a rep-
resentation unit. This allows generating a combinatorial
number of localized regional information. Secondly, we
make use of captioning and its ability to express signiﬁ-
cantly richer concepts beyond the limited label space of ob-
ject classes used in object detection tasks. Due to these as-
pects, our relational captioning expands the regime further
along the label space both in terms of density and complex-
ity, and provides richer representation for an image.

Our main contributions are summarized as follows. (1)
We introduce relational captioning, a new captioning task
that generates captions with respect to relational informa-
tion between objects in an image.
(2) In order to efﬁ-
ciently train the relational caption information, we propose
the multi-task triple-stream network (MTTSNet) that con-
sists of three recurrent units trained via multi-task learning.
(3) We show that our proposed method is able to generate
denser and more diverse captions by evaluating on our re-
lational captioning dataset augmented from Visual Genome
(VG) [15] dataset. (4) We introduce several applications of
our framework, including “caption graph” generation which
contains richer and more diverse information than conven-
tional scene graphs.

2. Related Work

Our work relates to two topics:

image captioning and
In this section, we categorize and

relationship detection.
review related work on these topics.
Image captioning. By virtue of deep learning and the
use of recurrent neural network (e.g. LSTM [9]) based de-
coders, image captioning [24] techniques have been exten-
sively explored [1, 7, 10, 13, 21, 28, 33, 37, 39, 41]. One
of the research issues in captioning is the generation of
diverse and informative captions. Thus, learning to gen-
erated diverse captions has been extensively studied re-
cently [2, 4, 5, 29, 32, 34]. As one of the solutions, the
dense captioning (DenseCap) task [12] was proposed which
uses diverse region proposals to generate localized descrip-
tions, extending the conventional holistic image captioning
to diverse captioning that can describe local contexts. More-
over, our relational captioning is able to generate even more
diverse caption proposals than dense captioning by consid-
ering relations between objects.

Yang et al. [38] improves the DenseCap model by incor-
porating a global image feature as context cue as well as a
region feature of the desired objects with a late fusion. Mo-
tivated by this, in order to implicitly learn dependencies of
subject, object and union representations, we incorporate a
triple-stream LSTM for our captioning module.

Visual relationship detection (VRD). Understanding vi-
sual relationships between objects have been an impor-
tant concept in various tasks. Conventional VRD usually
deals with predicting the subject-predicate-object (in short,
subj-pred-obj). A pioneering work by Lu et al. [20]
formalizes the VRD task and provides a dataset, while ad-
dressing the subject (or object) and predicate classiﬁcation
models separately. On the other hand, similar to VRD task,
scene graph generation (a task to generate a structured graph
that contains the context of a scene) has also started to be
explored [18, 35, 36, 43].

Although the VRD dataset is larger (100 object classes
and 70 predicates) than Visual Phrases, it is still inadequate
to handle the real world scale. The Visual Genome (VG)
dataset [15] for relationship detection consists of 31k predi-
cate types and 64k object types giving the number of possi-
ble combinations of relationship triplets too diverse for the
state-of-the-art VRD based models. This is because the la-
bels consist of the various combinations of words (e.g. ‘little
boy,’ ‘small boy,’ etc.) As a result, only the simpliﬁed ver-
sion of VG relationship dataset has been studied. On the
contrary, our method is able to generate relational captions
by tokenizing the whole relational expressions into words,
and learning from them.

While the recent state-of-the-art VRD [17, 20, 26, 42,
40] or scene graph generation works [18, 35, 36, 43] mostly
use language priors to detect relationships, we directly learn
the relationship as a descriptive language model. In addi-
tion, the expressions of traditional scene graph generation
or VRD task are restricted to subj-pred-obj triplets,
whereas the relational captioning is able to provide addi-
tional information such as attributes or noun modiﬁers by
adopting free-form natural language expressions.

In summary, dense captioning facilitates a natural lan-
guage interpretation of regions in an image, while VRD can
obtain relational information between objects. Our work
combines both axes, resulting in much denser and diverse
captions than DenseCap. That is, given B region propos-
als in an image, we can obtain B(B−1) relational captions,
whereas DenseCap returns only B captions.

3. Multi-task Triple-Stream Networks

Our relational captioning is deﬁned as follows. Given
an input image, a bounding box detector generates various
object proposals and a captioning module predicts combina-
torial captions with POS labels describing each pair of ob-
jects. Figure 2 shows the overall framework of the proposed
relational captioning model, which is mainly composed of
a localization module based on the region proposal network
(RPN) [27], and a triple-stream RNN (LSTM [9]) module
for captioning. Our network supports end-to-end training
with a single optimization step that allows joint localiza-
tion, combination, and description with natural language.

6272

Figure 2: Overall architecture of the proposed multi-task triple-stream networks. Three region features (Union, Subject, Ob-
ject) come from the same shared branch (Region Proposal Network), and for subject and object features, the ﬁrst intermediate
FC layer share weights (depicted in the same color).

Given an image, RPN generates object proposals. Then,
the combination layer takes a pair consisting of a subject
and an object at a time. To take the surrounding context
information into account, we utilize the union region of the
subject and object regions, in a way similar to using the
global image region as side information by Yang et al. [38].
This feature of triplets (subject, object, union) are fed to
the triple-stream LSTMs, where each stream takes its own
purpose, i.e. subject, object, and union. Given this triplet
feature, the triple-stream LSTMs collaboratively generate a
caption and POS classes of each word. We describe these
processes as follows.

3.1. Region Proposal Networks

Our network uses fully convolutional layers of VGG-
16 [30] up to the ﬁnal pooling layer (i.e. conv5 3) for
extracting the spatial features via the bilinear ROI pool-
ing [12]. The object proposals are generated by localization
layers. It takes the feature tensor, and proposes B regions
(user parameter) of interest. Each proposed region has its
conﬁdence score, region feature of shape 512×7×7, and
coordinates b=(x, y, w, h) of the bounding box with center
(x, y), width w and height h. We process it into vectorized
features (of shape D=512) using two fully-connected (FC)
layers. This encodes the appearance of each region into a
feature, called region code. Once the region codes are ex-
tracted, they are reused for the following processes.

To generate relational proposals, we build pairwise com-
binations of B region proposals, where in turn we get
B(B−1) possible region pairs. We call this layer the com-
bination layer. A distinctive point of our model with the
previous dense captioning works [12, 38], is that while the
works regard each region proposal as an independent tar-
get to describe and produce B number of captions, we con-
sider their pairwise combinations B(B−1), which are much

denser and explicitly expressible in term of relationships.
Also, we can asymmetrically use each entry of a pair by
assigning the roles of the regions, i.e. (subject, object).

Furthermore, motivated by Yang et al., where the global
context of an image improves the captioning performance,
we leverage an additional region, the union region bu of
(subject, object). In addition, to provide relative spatial in-
formation, we append a geometric feature for the subject
and object box pair, i.e. (bs, bo) to the union feature before
the FC layers. Given two bounding boxes bs and bo, the
geometric feature r is deﬁned similarly to [25] as

r = (cid:20) xo−xs

√wshs

, yo−ys
√wshs

,q woho

wshs

, ws
hs

, wo
ho

bs S bo(cid:21) ∈ R6. (1)
, bs T bo

By concatenating the union feature with r which is passed
through an additional FC layer, the shape of this feature is
D+64. Then, the dimension of the union region code is
reduced by the following FC layers. This stream of oper-
ations is illustrated in Fig. 2. The three features extracted
from the subject, object, and union regions are fed to each
LSTM described in the following sections.

3.2. Relational Captioning Networks

Relational caption generation takes the relational infor-
mation of the object pairs into account. However, express-
ing the relationship in a sentence has been barely studied.
Therefore, we design a new network that deals with rela-
tional captions, called the multi-task triple-stream network.
From the region proposal network, a triplet of region
codes are fed as input to LSTM cells, so that a sequence
of words (caption) is generated. In the proposed relational
region proposal, a distinctive facet is to provide a triplet
of region codes consisting of subject, object, and union re-
gions, which virtually corresponds to the POS of a sentence
(subj-pred-obj). This correspondence between regions

6273

Multi-taskModuleRegion Proposals512D512D512DBilinearROI poolingBilinearROI poolingBilinearROI poolingUnion RegionSubject RegionObject RegionFully ConnectedFully ConnectedFully ConnectedPREDLSTMSUBJLSTMOBJLSTM“word”512D512DFully ConnectedFully ConnectedFully Connected64Dgeometric512DUnion FeatureSubject FeatureObject FeatureCombinationLayerObjectDetectorSVORecurrentSubject
feature

Predicate
feature

Object
feature

SUBJ
LSTM

PRED
LSTM

OBJ
LSTM

SUBJ
LSTM

PRED
LSTM

OBJ
LSTM

SUBJ
LSTM

PRED
LSTM

OBJ
LSTM

SUBJ
LSTM

PRED
LSTM

OBJ
LSTM

SUBJ
LSTM

PRED
LSTM

OBJ
LSTM

SUBJ
LSTM

PRED
LSTM

OBJ
LSTM

Multi-task Module

Concatenate

FC

FC

Embedding

LUT

“horse”

“police”

“officer”

“riding”

“a”

“horse”

<EOS>

Figure 3: An illustration of the unrolled triple-stream LSTM. Our model consists of two major parts: triple-stream LSTM and
a multi-task module. The multi-task module jointly predicts a caption word and its POS class (subj-pred-obj, illustrated
as three cells colored according to the POS class), as well as the input vector for the next time step.

in a triplet and POS information leads to the following ad-
vantages: 1) input features can be adaptively merged de-
pending on its POS and fed to the caption generation mod-
ule, and 2) the POS prior on predicting a word can be effec-
tively applied to caption generation. However, leveraging
and processing these input cues are non-trivial.

For the ﬁrst advantage, in order to derive POS aware
inference, we propose triple-stream networks, which are
three separate LSTMs respectively corresponding to subj-
pred-obj. The outcomes of LSTMs are combined via
concatenation. For the second advantage, during a word
prediction, we jointly infer its POS class via multi-task in-
ference. This POS class prediction acts as a prior for the
word prediction of a caption during the learning phase.

Triple-Stream LSTMs.
Intuitively, the region codes of
subject and object would be closely related to the subject
and object related words in a caption, while the union and
geometric features may contribute to the predicate. In our
relational captioning framework, the LSTM modules must
adaptively take input features into account according to
which POS decoding stage it is for a caption.

As shown in Fig. 2, the proposed triple-stream LSTM
module consists of three separate LSTMs, each of which
is in charge of the subject, object and union region codes
respectively. At each step, the triple-stream LSTMs gener-
ate three embedded representations separately, and a single
word is predicted by consolidating the three processed rep-
resentations. The embedding of the predicted word is dis-
tributed into all three LSTMs as inputs and is used to run
the next step in a recursive manner. Thus in each step, each
entry of the triplet input is used differently, which allows
more ﬂexibility than a single LSTM as used in traditional
captioning models [12, 33]. In other words, the weights of
the input cue features change at every recursive step accord-
ing to which POS the word being generated belongs to.

Multi-task with POS Classiﬁcation. On top of this con-
catenation, we utilize the POS information to more effec-
tively train the relational captioning model. Relational cap-

tioning generates a sequence of words in subj-pred-obj
order, i.e. the order of POS. For each word prediction, in a
multi-task module in Fig. 3, we also classify the POS class
of the predicted word, so that it encourages the caption gen-
eration to follow the word order in the POS order.

When three representations for each POS are to be con-
solidated, one option can be to consolidate them in an early
step, called early fusion. This results in a single LSTM with
the fusion of the three region codes (e.g. concatenation of
three codes). However, as reported by Yang et al. [38], this
early fusion approach also shows lower performance than
that of late fusion methods. In this regard, we adopt a late
fusion for a multi-task module. The layer basically con-
catenates the representation outputs from the triple-stream
LSTMs, but due to the recurrent multi-task modules, it is
able to generate sophisticated representations.

We empirically observe that this multi-task learning with
POS helps not only the shared representation to become
richer but also guides the word predictions, and thus helps
to improve the captioning performance overall. We hypoth-
esize that the POS task provides distinctive information that
may help learn proper representations from the triple-stream
LSTMs. Since each POS class prediction tightly relies
on respective representations from each LSTM, e.g. pred-
LSTM closely related to pred of POS, the gradients gener-
ated from the POS classiﬁcation would be back-propagated
through the indices of the concatenated representation ac-
cording to the class. By virtue of this, the multi-task triple-
stream LSTMs are able to learn the representation in such
a way that it can predict plausible words for each time step.
Therefore, our model can generate appropriate words ac-
cording to the POS at a given time step.
Loss functions. Training our relational captioning model
can be mainly divided into captioning loss and detection
loss. Speciﬁcally, the proposed model is trained to mini-
mize the following loss function:

L = Lcap + αLP OS + βLdet + γLbox,

(2)

6274

where Lcap, LP OS, Ldet, and Lbox denote captioning loss,
POS classiﬁcation loss, detection loss, and bounding box
regression loss respectively. α, β, and γ are the balance
parameters (we set them to 0.1 for all experiments).

The ﬁrst two terms are for captioning and the next two
terms are for the region proposal. Lcap and LP OS are cross-
entropy losses at every time step for each word and POS
classiﬁcation respectively. For each time step, LP OS mea-
sures a 3-class cross entropy loss. Ldet is a binary logis-
tic loss for foreground/background regions, while Lbox is a
smoothed L1 loss [27].

4. Experiments

In this section, we provide the experimental setups, com-
peting methods and performance evaluation of relational
captioning with both quantitative and qualitative results.

4.1. Relational Captioning Dataset

Since there is no existing dataset for the relational cap-
tioning task, we construct a dataset by utilizing VG rela-
tionship dataset version 1.2 [15] which consists of 85200
images with 75456/4871/4873 splits for train/validation/test
sets respectively. We tokenize the relational expressions to
form natural language expressions, and for each word, we
assign the POS class from the triplet association.

However, VG relationship datasets show limited diver-
sity in the words used. Therefore, by only using relational
expressions to construct data, the captions generated from
a model tends to be simple (e.g. “building-has-window”).
Even though our model may enable richer concepts and ex-
pressions, if the training data does not contain such concepts
and expressions, there is no way to actually see this. In or-
der to validate the diversity of our relational captioner, we
need to make our relational captioning dataset to have more
natural sentences with rich expressions.

Through observation, we noticed that the relationship
dataset labels lack attributes describing the subject and ob-
ject, which are perhaps what enriches the sentences the
most. Therefore, we utilize the attribute labels of VG
data to augment existing relationship expressions. More
speciﬁcally, we simply ﬁnd the attribute that matches the
subject/object of the relationship label and attach it to the
subj/obj caption label. In particular, if an attribute label de-
scribes the same subject/object for a relationship label while
associated bounding box overlaps enough, the label is con-
sidered to be matched to the subject/object in the relation-
ship label. After this process, we obtain 15595 vocabular-
ies for our relational captioning dataset (11447 vocabularies
before this process). We train our caption model with this
data, and report its result in this section. In addition, we pro-
vide a holistic image captioning performance and various
analysis such as comparison with scene graph generation.

mAP (%)

Img-Lv. Recall METEOR

Direct Union
Union
Union+Coord.
Subj+Obj
Subj+Obj+Coord.
Subj+Obj+Union
TSNet (Ours)
Union (w/MTL)
Subj+Obj+Coord (w/MTL)
Subj+Obj+Union (w/MTL)
MTTSNet (Ours)

Neural Motifs [43]

–

0.57
0.56
0.51
0.57
0.59
0.61
0.61
0.63
0.64
0.88

0.25

17.32
25.61
27.14
28.53
30.53
30.48
32.36
26.97
31.15
31.63
34.27

29.90

11.02
12.28
13.71
13.32
14.85
15.21
16.09
12.75
15.31
16.63
18.73

15.34

Table 1: Ablation study for relational dense captioning task
on relational captioning dataset.

4.2. Relational Dense Captioning: Ablation Study

Baselines. Since no direct work for relational captioning
exists, we implement several baselines by modifying the
most relevant methods, which facilitate our ablation study.

• Direct Union has the same architecture with Dense-
Cap [12], but of which RPN is trained to directly predict
union regions. The union region is used to generate cap-
tions by one LSTM.

• Union also resembles DenseCap [12] and Direct
union, but its RPN predicts individual object regions. The
object regions are paired as (subject, object), and then a
union region from each pair is fed to a single LSTM for
captioning. Also, we implement two additional variants:
Union (w/MTL) additionally predicts the POS classiﬁ-
cation task, and Union+Coord. appends the geometric
feature to the region code of the union.

• Subj+Obj and Subj+Obj+Union models use the
(subject, object) and
concatenated region features of
(subject, object, union)
them
through a single LSTM (early fusion approach). Also,
Subj+Obj+Coord. uses the geometric feature instead
of the region code of the union. Moreover, we evaluate the
baselines, Subj+Obj+{Union,Coord} with POS clas-
siﬁcation (MTL loss).

respectively and pass

• TSNet denotes the proposed triple-stream LSTM based
model without a branch for POS classiﬁer. Each stream
takes the region codes of (subject, object, union + coord.)
separately. MTTSNet denotes our ﬁnal model, multi-task
triple-stream network with POS classiﬁer.

Evaluation metrics. Motivated by the evaluation metric
suggested for dense captioning task [12], we suggest a new
evaluation metric for relational dense captioning. We re-
port the mean Average Precision (mAP) which measures
both localization and language accuracy. As suggested by
Johnson et al., we use METEOR score [6] with thresholds
{0, 0.05, 0.10.15, 0.2, 0.25} for language, and IOU thresh-
olds {0.2, 0.3, 0.4, 0.5, 0.6} for localization. The AP values

6275

Figure 4: Example captions and region generated by the proposed model. We compare our result with the image cap-
tioner [33] and the dense captioner [12] in order to contrast the amount of information and diversity.

Recall METEOR

#Caption Caption/Box

Image Captioner (Show&Tell) [33]
Image Captioner (SCST) [28]
Dense Captioner (DenseCap) [12]
Relational Captioner (Union)
Relational Captioner (MTTSNet)

23.55
24.04
42.63
38.88
46.78

8.66
14.00
19.57
18.22
21.87

1
1

9.16
85.84
89.32

1
1
1

9.18
9.36

Table 2: Comparisons of the holistic level image captioning. We compare the results of the relational captioners with that of
two image captioners [28, 33] and a dense captioner [12].

obtained by all the pairwise combinations of language and
localization thresholds are averaged to get the ﬁnal mAP
score. The major difference of our metric is that, for the
localization AP, we measure for both the subject and ob-
ject bounding boxes with respective ground truths. In par-
ticular, we only consider the samples with IOUs of both the
subject and object bounding boxes greater than the localiza-
tion threshold. For all cases, we use percentage as the unit
of metric.
In addition, we suggest another metric, called
“image-level (Img-Lv.) recall.” This measures the caption
quality at the holistic image level by considering the bag
of all captions generated from an image as a single predic-
tion. Given only the aforementioned language thresholds
for METEOR i.e. without box IOU threshold, we measure
the recall of the predicted captions. The metric evaluates
the diversity of the produced representations by the model
for a given image. Also, we measure the average METEOR
score for predicted captions to evaluate the caption quality.

Results. Table 1 shows the performance of the relational
dense captioning task on relational captioning dataset. The
second and third row sections (2-7 and 8-11th rows) show
the comparison of the baselines with and without POS clas-
siﬁcation (w/MTL). In the last row, we show the perfor-
mance of the state-of-the-art scene graph generator, Neural
Motifs [43]. Due to the different output structure, we com-
pare with Neural Motifs trained with the supervision for re-
lationship detection. Similar to the setup in DenseCap [12],
we ﬁx the number of region proposals before NMS to 50 for
all methods for a fair comparison.

Among the results in the second row section (2-7th rows)

of Table 1, our TSNet shows the best result suggesting that
the triple-stream component alone is a sufﬁciently strong
baseline over the others. On top of TSNet, applying the
MTL loss (i.e., MTTSNet) improves overall performance,
and especially improves mAP, where the detection accuracy
seems to be dominantly improved compared to the improve-
ment of the other metrics. This shows that triple-stream
LSTM is the key module that most leverages the MTL loss
across other early fusion approaches (see the third row sec-
tion of the table). As another factor, we can see from Table 1
that the relative spatial information (Coord.) and union
feature information (Union) improves the results. This is
because the union feature itself preserves the spatial infor-
mation to some extent from the 7 × 7 grid form of its ac-
tivation. For Neural Motifs, other relational captioner
baselines including our TSNet and MTTSNet perform fa-
vorably against Neural Motifs in all metrics. This is
worth noting because handling free-form language genera-
tion which we aim to achieve is more challenging than the
simple triplet prediction of scene graph generation.

4.3. Holistic Image Captioning Comparison

We also compare our approach with other image cap-
tioning frameworks, Image Captioner (Show&Tell [33] and
SCST [28]), and Dense Captioner (DenseCap [12]), in a
holistic image description perspective.
In order to mea-
sure the performance of holistic image-level captioning for
dense captioning methods, we use Img-Lv. Recall met-
ric deﬁned in the previous section (Recall). We compare
them with two relational dense captioning methods, Union

6276

Image Captioner: ■A man flying through the air.Dense Captioner: ■Snowboarder in the air.■Red jacket on man. ■A snowboard is white.■Red and white snow board.Relational Captioner(Ours):■→■Green trees in background.■→■The snow on ground.■→■White clouds in blue sky.■→■The man on white snow.■→■The man wearing black pants.■→■White snow on top of pole.■→■The man on white surfboard.⋮Image Captioner: ■A man riding a motorcycle.Dense Captioner: ■Person wearing red and black jacket.■A cloud in blue sky.■The helmet is black.■Front wheel of motorcycle.Relational Captioner(Ours):■→■The man on a black motorcycle.■→■The man in blue sky.■→■Red motorcycle has a black wheel.■→■The man wearing black helmet.■→■Black wheel on a motorcycle.■→■The head of man.■→■Blue sky has white clouds.⋮(a)

(c)

(b)

(d)

Figure 5: Results of generating “caption graph” from our relational captioniner. In order to compare the diversity of the
outputs, we also show the result of the scene graph generator, Neural Motifs [43].

and MTTSNet, denoted as Relational Captioner. For a fair
comparison, for Dense and Relational Captioner, we adjust
the number of region proposals after NMS to be similar,
which is different from the setting in the previous section
which ﬁxed the number of proposals before NMS.

Table 2 shows the image-level recall, METEOR, and ad-
ditional quantities for comparison. #Caption denotes the
average number of captions generated from an input image
and Caption/Box denotes the average ratio of the number of
captions generated and the number of boxes remaining af-
ter NMS. Therefore, Caption/Box demonstrates how many
captions can be generated given the same number of boxes
generated after NMS. By virtue of multiple captions per im-
age from multiple boxes, the Dense Captioner is able to
achieve higher performance than both of the Image Cap-
tioners. Compared with the Dense Captioner, MTTSNet
as a Relational Captioner can generate an even larger num-
ber of captions given the same number of boxes. Hence,
as a result of learning to generate diverse captions, the
MTTSNet achieves higher recall and METEOR. From the
performance of Union, we can see that it is difﬁcult to ob-
tain better captions than Dense Captioner by only learning
to use the union of subject and object boxes, despite having
a larger number of captions.

We show example predictions of our relational caption-
ing model in Fig. 4. Our model is able to generate rich and
diverse captions for an image. We also show a compari-
son with the traditional frameworks, image captioner [33]
and dense captioner [12]. While the dense captioner is able
to generate diverse descriptions than an image captioner by
virtue of various regions, our model can generate an even
greater number of captions from the combination of the
bounding boxes.

4.4. Comparison with Scene Graph

Motivated by scene graph, which is derived from the
VRD task, we extend to a new type of a scene graph, which
we call “caption graph.” Figure 5 shows the caption graphs
generated from our MTTSNet as well as the scene graphs
from Neural Motifs [43]. For caption graph, we follow the
same procedure as Neural Motifs but replace the relation-
ship detection network into our MTTSNet. In both meth-
ods, we use ground truth bounding boxes to generate scene
(and caption) graphs for fair comparison.

By virtue of being free form, our caption graph can
have richer expression and information including attributes,
whereas the traditional scene graph is limited to a closed set
of the subj-pred-obj triplet. For example, in Fig. 5-
(b,d), given the same object ‘person,’ our model is able to
distinguish the ﬁne-grained category (i.e. man vs boy and
man vs woman). In addition, our model can provide more
status information about the object (e.g. standing, black), by
virtue of the attribute contained in our relational captioning
data. Most importantly, the scene graph can contain unnat-
ural relationships (e.g. tree-on-tree in Fig. 5-(c)), because
prior relationship detection methods, e.g. [43], predict ob-
ject classes individually. In contrast, by predicting the full
sentence for every object pair, relational captioner can as-
sign a more appropriate word for an object by considering
the relations, e.g. “Green leaf on a tree.”

Lastly, our model is able to assign different words for the
same object by considering the context (the man vs baseball
player in Fig. 5-(d)), whereas the scene graph generator can
only assign one most likely class (man). Thus, our rela-
tional captioning framework enables more diverse interpre-
tation of the objects compared to the traditional scene graph
generation models.

6277

Relational Captioning1-2. The roof on yellow train.5-2. Black wheel on a yellow train.7-2. The window on a train.9-2. Off light on yellow train.2-4. Yellow train on old track.SceneGraph1-2. building-on-train5-2. wheel-on-train7-2. window-on-train9-2. light-on-train2-4. train-on-trackRelational Captioning5-6. Old man wearing blue hat.7-3. Red pants on young man.3-4. Standing boy wearing red hat.1-2. The man wearing purple hat.SceneGraph5-6. man-wearing-hat7-3. pant-on-man3-4. man-wearing-hat1-2. man-wearing-hatRelational Captioning3-4 Green leaf on a tree.1-2 White cap on standing man.2-6 The man wearing blue pants.2-8 Standing man wearing black shirt.2-10 The man wearing white hat.SceneGraph3-4 tree-on-tree1-2 hat-on-man2-6 man-wearing-short2-8 man-wearing-shirt2-10 man-has-helmetRelationalCaptioning7-8. The man wearing black helmet.5-6. Sitting woman behind the stand.1-2. Baseball player wearing helmet1-4. The man wearing white pants.SceneGraph7-8. man-wearing-helmet5-6. man-behind-stand1-2. man-wearing-helmet1-4. man-wearing-pantwords/img words/box

R@1 R@5 R@10 Med

Image Cap. [33]
Scene Graph [43]
Dense Cap. [12]
Relational Cap. (MTTSNet)

4.16
7.66
18.41
20.45

-

3.29
4.59
15.31

Full Image RNN[13]
Region RNN [8]
DenseCap [12]
RelCap (MTTSNet)

0.10
0.18
0.27
0.29

0.30
0.43
0.53
0.60

0.43
0.59
0.67
0.73

13
7
5
4

Table 3: Diversity comparison between image captioning,
scene graph generation, dense captioning, and relational
captioning. We measure the number of different words per
image (words/img) and the number of words per bounding
box (words/box).

4.5. Additional Analysis

to Relational Cap.

Vocabulary Statistics. In addition, we measure the vocab-
ulary statistics and compare them among the frameworks.
The types of statistics measured are as follows: 1) an aver-
age number of unique words that have been used to describe
an image, and 2) an average number of words to describe
each box. More speciﬁcally, we count the number of unique
words in all the predicted sentences and present the average
number per image or box. Thus, the metric measures the
amount of information we can obtain given an image or a
ﬁxed number of boxes. The comparison is depicted in Ta-
ble 3. These statistics increase from Image Cap. to Scene
Graph to Dense Cap.
In conclusion,
the proposed relational captioning is advantageous in diver-
sity and amount of information, compared to both of the
traditional object-centric scene understanding frameworks,
scene graph generation and dense captioning.
Sentence-based Image and Region-pair Retrieval. Since
our relational captioning framework produces richer image
representations than other frameworks, it may have bene-
ﬁts on the sentence based image or region-pair retrieval,
which cannot be performed by scene graph generation or
VRD models. To evaluate on the retrieval task, we follow
the same procedure as in Johnson et al. [12] with our rela-
tional captioning data. We randomly choose 1000 images
from the test set, and from these chosen images, we col-
lect 100 query sentences by sampling four random captions
from 25 randomly chosen images. The task is to retrieve
the correct image for each query by matching it with the
generated captions.

We compute the ratio of the number of queries, of which
the retrieved image ranked within top k ∈ {1, 5, 10}, and
the total number of queries (denoted as R@K). We also
report the median rank of the correctly retrieved images
across all 1000 test images (The random chance perfor-
mance is 0.001, 0.005, and 0.01 for R@1, R@5, and R@10
respectively). The retrieval results compared with several
baselines are shown in Table 4. For baseline models Full
Image RNN, Region RNN, and DenseCap, we display the
performance measured from Johnson et al. [12]. To be com-
patible, we followed the same procedure of running through
random test sets 3 times to report the average results. Our

Table 4: Sentence based image retrieval performance com-
pared to previous frameworks. We evaluate ranking using
recall at k (R@K, higher is better) and the median rank of
the target image (Med, lower is better).

matching score is computed as follows. For every test im-
age, we generate 100 region proposals from the RPN fol-
lowed by NMS. In order to produce a matching score be-
tween a query and a region pair in the image, we compute
the probability that the query text may occur from the re-
gion pair. Among all the scores for the region pairs from
the image, we take the maximum matching score value as a
representative score of the image. This score is used as the
matching score between the query text and the image, and
thus the images are sorted by rank based on these computed
matching scores. As shown in Table 4, the proposed rela-
tional captioner outperforms all baseline frameworks. This
is meaningful because region pair based method is more
challenging than a single region based approaches.

5. Conclusion

We introduce relational captioning, a new notion which
requires a model
to localize regions of an image and
describe each of the relational region pairs with a caption.
To this end, we propose the MTTSNet, which facilitates
POS aware relational captioning. In several sub-tasks, we
empirically demonstrate the effectiveness of our framework
over scene graph generation and the traditional captioning
frameworks. As a way to represent imagery, the relational
captioning can provide diverse, abundant, high-level and
interpretable representations in caption form. In this regard,
our work may open interesting applications, e.g., natural
language based video summarization [3] may be beneﬁted
by our rich representation.

Acknowledgements. This work was supported by Insti-
tute for Information & communications Technology Plan-
ning & Evaluation(IITP) grant funded by the Korea govern-
ment(MSIT) (No.2017-0-01780, The technology develop-
ment for event recognition/relational reasoning and learning
knowledge based system for video understanding)

References

[1] Peter Anderson, Xiaodong He, Chris Buehler, Damien
Teney, Mark Johnson, Stephen Gould, and Lei Zhang.
Bottom-up and top-down attention for image captioning and
visual question answering. In IEEE Conference on Computer
Vision and Pattern Recognition (CVPR), 2018. 2

6278

[2] Fuhai Chen, Rongrong Ji, Xiaoshuai Sun, Yongjian Wu,
and Jinsong Su. Groupcap: Group-based image caption-
ing with structured relevance and diversity constraints.
In
IEEE Conference on Computer Vision and Pattern Recogni-
tion (CVPR), 2018. 2

[3] Jinsoo Choi, Tae-Hyun Oh, and In So Kweon. Contextu-
ally customized video summaries via natural language.
In
IEEE Winter Conference on Applications of Computer Vision
(WACV). IEEE, 2018. 8

[4] Bo Dai, Sanja Fidler, Raquel Urtasun, and Dahua Lin. To-
wards diverse and natural image descriptions via a condi-
tional gan. In IEEE International Conference on Computer
Vision (ICCV). IEEE, 2017. 2

[5] Bo Dai and Dahua Lin. Contrastive learning for image cap-
tioning. In Advances in Neural Information Processing Sys-
tems (NIPS), 2017. 2

[6] Michael Denkowski and Alon Lavie. Meteor universal: Lan-
guage speciﬁc translation evaluation for any target language.
In The workshop on statistical machine translation, 2014. 5
[7] Jeffrey Donahue, Lisa Anne Hendricks, Sergio Guadarrama,
Marcus Rohrbach, Subhashini Venugopalan, Kate Saenko,
and Trevor Darrell. Long-term recurrent convolutional net-
works for visual recognition and description.
In IEEE
Conference on Computer Vision and Pattern Recognition
(CVPR), 2015. 2

[8] Ross Girshick. Fast R-CNN. In IEEE International Confer-

ence on Computer Vision (ICCV), 2015. 8

[9] Sepp Hochreiter and J¨urgen Schmidhuber. Long short-term

memory. Neural computation, 9(8):1735–1780, 1997. 2

[10] Wenhao Jiang, Lin Ma, Yu-Gang Jiang, Wei Liu, and Tong
Zhang. Recurrent fusion network for image captioning. In
European Conference on Computer Vision (ECCV), 2018. 2
[11] Justin Johnson, Bharath Hariharan, Laurens van der Maaten,
Judy Hoffman, Li Fei-Fei, C. Lawrence Zitnick, and Ross
Girshick. Inferring and executing programs for visual rea-
soning. In IEEE International Conference on Computer Vi-
sion (ICCV), 2017. 1

[12] Justin Johnson, Andrej Karpathy, and Li Fei-Fei. Densecap:
Fully convolutional localization networks for dense caption-
ing.
In IEEE Conference on Computer Vision and Pattern
Recognition (CVPR), 2016. 1, 2, 3, 4, 5, 6, 7, 8

[13] Andrej Karpathy and Li Fei-Fei. Deep visual-semantic align-
ments for generating image descriptions. In IEEE Confer-
ence on Computer Vision and Pattern Recognition (CVPR),
2015. 2, 8

[14] Dong-Jin Kim, Jinsoo Choi, Tae-Hyun Oh, Youngjin Yoon,
and In So Kweon. Disjoint multi-task learning between het-
erogeneous human-centric tasks. In IEEE Winter Conference
on Applications of Computer Vision (WACV), 2018. 1

[15] Ranjay Krishna, Yuke Zhu, Oliver Groth, Justin Johnson,
Kenji Hata, Joshua Kravitz, Stephanie Chen, Yannis Kalan-
tidis, Li-Jia Li, David A Shamma, et al. Visual genome:
Connecting language and vision using crowdsourced dense
image annotations.
International Journal of Computer Vi-
sion (IJCV), 123(1):32–73, 2017. 1, 2, 5

[16] Michael F Land, Sophie M Furneaux, and Iain D Gilchrist.
The organization of visually mediated actions in a subject
without eye movements. Neurocase, 8(1):80–87, 2002. 1

[17] Yikang Li, Wanli Ouyang, and Xiaogang Wang. VIP-CNN:
A visual phrase reasoning convolutional neural network for
visual relationship detection. In IEEE Conference on Com-
puter Vision and Pattern Recognition (CVPR), 2017. 2

[18] Yikang Li, Wanli Ouyang, Bolei Zhou, Kun Wang, and Xi-
aogang Wang. Scene graph generation from objects, phrases
and region captions. In IEEE International Conference on
Computer Vision (ICCV), 2017. 2

[19] Tsung-Yi Lin, Michael Maire, Serge Belongie, James Hays,
Pietro Perona, Deva Ramanan, Piotr Doll´ar, and C Lawrence
Zitnick. Microsoft coco: Common objects in context. In Eu-
ropean Conference on Computer Vision (ECCV). Springer,
2014. 1

[20] Cewu Lu, Ranjay Krishna, Michael Bernstein, and Li
Fei-Fei. Visual relationship detection with language pri-
ors. In European Conference on Computer Vision (ECCV).
Springer, 2016. 1, 2

[21] Jiasen Lu, Caiming Xiong, Devi Parikh, and Richard Socher.
Knowing when to look: Adaptive attention via a visual sen-
tinel for image captioning. IEEE Conference on Computer
Vision and Pattern Recognition (CVPR), 2017. 2

[22] Roozbeh Mottaghi, Xianjie Chen, Xiaobai Liu, Nam-Gyu
Cho, Seong-Whan Lee, Sanja Fidler, Raquel Urtasun, and
Alan Yuille. The role of context for object detection and
semantic segmentation in the wild. In IEEE Conference on
Computer Vision and Pattern Recognition (CVPR), 2014. 1
[23] Aude Oliva and Antonio Torralba. The role of context in
object recognition. Trends in cognitive sciences, 11(12):520–
527, 2007. 1

[24] Vicente Ordonez, Girish Kulkarni, and Tamara L Berg.
Im2text: Describing images using 1 million captioned pho-
tographs. In Advances in Neural Information Processing Sys-
tems (NIPS), 2011. 2

[25] Julia Peyre, Ivan Laptev, Cordelia Schmid, and Josef Sivic.
Weakly-supervised learning of visual relations. IEEE Inter-
national Conference on Computer Vision (ICCV), 2017. 3

[26] Bryan A Plummer, Arun Mallya, Christopher M Cervantes,
Julia Hockenmaier, and Svetlana Lazebnik. Phrase local-
ization and visual relationship detection with comprehensive
linguistic cues. IEEE International Conference on Computer
Vision (ICCV), 2017. 2

[27] Shaoqing Ren, Kaiming He, Ross Girshick, and Jian Sun.
Faster R-CNN: Towards real-time object detection with re-
gion proposal networks. In Advances in Neural Information
Processing Systems (NIPS), 2015. 2, 5

[28] Steven J Rennie, Etienne Marcheret, Youssef Mroueh, Jarret
Ross, and Vaibhava Goel. Self-critical sequence training for
image captioning. In IEEE Conference on Computer Vision
and Pattern Recognition (CVPR), 2017. 2, 6

[29] Rakshith Shetty, Marcus Rohrbach, Lisa Anne Hendricks,
Mario Fritz, and Bernt Schiele. Speaking the same language:
Matching machine to human captions by adversarial train-
ing. In IEEE International Conference on Computer Vision
(ICCV), 2017. 2

[30] Karen Simonyan and Andrew Zisserman. Very deep con-
volutional networks for large-scale image recognition. In In-
ternational Conference on Learning Representations (ICLR),
2015. 3

6279

[31] Khurram Soomro, Amir Roshan Zamir, and Mubarak Shah.
UCF101: A dataset of 101 human actions classes from
videos in the wild. arXiv preprint arXiv:1212.0402, 2012.
1

[32] Subhashini Venugopalan, Lisa Anne Hendricks, Marcus
Rohrbach, Raymond J Mooney, Trevor Darrell, and Kate
Saenko. Captioning images with diverse objects. In IEEE
Conference on Computer Vision and Pattern Recognition
(CVPR), 2017. 2

[33] Oriol Vinyals, Alexander Toshev, Samy Bengio, and Du-
mitru Erhan. Show and tell: A neural image caption gen-
erator. In IEEE Conference on Computer Vision and Pattern
Recognition (CVPR), 2015. 2, 4, 6, 7, 8

[34] Liwei Wang, Alexander Schwing, and Svetlana Lazebnik.
Diverse and accurate image description using a variational
auto-encoder with an additive gaussian encoding space. In
Advances in Neural Information Processing Systems (NIPS),
2017. 2

[35] Sanghyun Woo, Dahun Kim, Donghyeon Cho, and In So
Kweon. Linknet: Relational embedding for scene graph. In
Advances in Neural Information Processing Systems (NIPS),
2018. 2

[36] Danfei Xu, Yuke Zhu, Christopher B Choy, and Li Fei-Fei.
Scene graph generation by iterative message passing.
In
IEEE International Conference on Computer Vision (ICCV),
2017. 2

[37] Kelvin Xu, Jimmy Ba, Ryan Kiros, Kyunghyun Cho, Aaron
Courville, Ruslan Salakhudinov, Rich Zemel, and Yoshua
Bengio. Show, attend and tell: Neural image caption gen-
eration with visual attention. In International Conference on
Machine Learning (ICML), 2015. 2

[38] Linjie Yang, Kevin Tang, Jianchao Yang, and Li-Jia Li.
Dense captioning with joint inference and visual context. In
IEEE Conference on Computer Vision and Pattern Recogni-
tion (CVPR), 2017. 2, 3, 4

[39] Ting Yao, Yingwei Pan, Yehao Li, and Tao Mei. Exploring
visual relationship for image captioning. In European Con-
ference on Computer Vision (ECCV), 2018. 2

[40] Guojun Yin, Lu Sheng, Bin Liu, Nenghai Yu, Xiaogang
Wang, Jing Shao, and Chen Change Loy. Zoom-net: Mining
deep feature interactions for visual relationship recognition.
In European Conference on Computer Vision (ECCV), 2018.
2

[41] Quanzeng You, Hailin Jin, Zhaowen Wang, Chen Fang, and
Jiebo Luo.
In
IEEE Conference on Computer Vision and Pattern Recogni-
tion (CVPR), 2016. 2

Image captioning with semantic attention.

[42] Ruichi Yu, Ang Li, Vlad I Morariu, and Larry S Davis. Vi-
sual relationship detection with internal and external linguis-
tic knowledge distillation. In IEEE International Conference
on Computer Vision (ICCV), 2017. 2

[43] Rowan Zellers, Mark Yatskar, Sam Thomson, and Yejin
Choi. Neural motifs: Scene graph parsing with global con-
text. In IEEE Conference on Computer Vision and Pattern
Recognition (CVPR), 2018. 2, 5, 6, 7, 8

6280

