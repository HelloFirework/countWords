MirrorGAN: Learning Text-to-image Generation by Redescription

Tingting Qiao1,3, Jing Zhang2,3,*, Duanqing Xu1,*, and Dacheng Tao3

1College of Computer Science and Technology, Zhejiang University, China

2School of Automation, Hangzhou Dianzi University, China

3UBTECH Sydney AI Centre, School of Computer Science, FEIT, The University of Sydney, Australia

qiaott@zju.edu.cn, jing.zhang@uts.edu.au, xdq@zju.edu.cn, dacheng.tao@sydney.edu.au

Abstract

Generating an image from a given text description has
two goals: visual realism and semantic consistency. Al-
though signiﬁcant progress has been made in generating
high-quality and visually realistic images using genera-
tive adversarial networks, guaranteeing semantic consis-
tency between the text description and visual content re-
mains very challenging.
In this paper, we address this
problem by proposing a novel global-local attentive and
semantic-preserving text-to-image-to-text framework called
MirrorGAN. MirrorGAN exploits the idea of learning text-
to-image generation by redescription and consists of three
modules: a semantic text embedding module (STEM), a
global-local collaborative attentive module for cascaded
image generation (GLAM), and a semantic text regener-
ation and alignment module (STREAM). STEM generates
word- and sentence-level embeddings. GLAM has a cas-
caded architecture for generating target images from coarse
to ﬁne scales, leveraging both local word attention and
global sentence attention to progressively enhance the di-
versity and semantic consistency of the generated images.
STREAM seeks to regenerate the text description from the
generated image, which semantically aligns with the given
text description.
Thorough experiments on two public
benchmark datasets demonstrate the superiority of Mirror-
GAN over other representative state-of-the-art methods.

1. Introduction

Text-to-image (T2I) generation refers to generating a vi-
sually realistic image that matches a given text descrip-

1.The work was performed when Tingting Qiao was a visiting student
at UBTECH Sydney AI Centre in the School of Computer Science, FEIT,
in the University of Sydney

2.*corresponding author

Figure 1: (a) Illustration of the mirror structure that em-
bodies the idea of learning text-to-image generation by re-
description. (b)-(c) Semantically inconsistent and consis-
tent images/redescriptions generated by [35] and the pro-
posed MirrorGAN, respectively.

tion. Due to its signiﬁcant potential in a number of applica-
tions but its challenging nature, T2I generation has become
an active research area in both natural language process-
ing and computer vision communities. Although signiﬁcant
progress has been made in generating visually realistic im-
ages using generative adversarial networks (GANs) such as
in [39, 42, 35, 13], guaranteeing semantic alignment of the
generated image with the input text remains challenging.

In contrast to fundamental image generation problems,
T2I generation is conditioned on text descriptions rather
than starting with noise alone. Leveraging the power of
GANs [10], different T2I methods have been proposed to
generate visually realistic and text-relevant images. For in-
stance, Reed et al. proposed to tackle text to image synthe-
sis problem by ﬁnding a visually discriminative representa-
tion for the text descriptions and using this representation to
generate realistic images [24]. Zhang et al. proposed Stack-
GAN to generate images in two separate stages [39]. Hong
et al. proposed extracting a semantic layout from the input
text and then converting it into the image generator to guide

11505

(b)(c)this bird has a grey side and a brown backthis bird is blue with white and has a pointy beak×this bird is blue with white and has a pointy beaka small bird with a white breast and blue wingsT2II2Ttextimagetext(a)this bird is blue with white and has a pointy beaka small bird with a white breast and blue wingsT2II2Tthe generative process [13]. Zhang et al. proposed training
a T2I generator with hierarchically nested adversarial ob-
jectives [42]. These methods all utilize a discriminator to
distinguish between the generated image and correspond-
ing text pair and the ground truth image and corresponding
text pair. However, due to the domain gap between text and
images, it is difﬁcult and inefﬁcient to model the underly-
ing semantic consistency within each pair when relying on
such a discriminator alone. Recently, the attention mecha-
nism [35] has been exploited to address this problem, which
guides the generator to focus on different words when gen-
erating different image regions. However, using word-level
attention alone does not ensure global semantic consistency
due to the diversity between text and image modalities. Fig-
ure 1 (b) shows an example generated by [35].

T2I generation can be regarded as the inverse prob-
lem of image captioning (or image-to-text generation, I2T)
[34, 29, 16], which generates a text description given an im-
age. Considering that tackling each task requires modeling
and aligning the underlying semantics in both domains, it
is natural and reasonable to model both tasks in a uniﬁed
framework to leverage the underlying dual regulations. As
shown in Figure 1 (a) and (c), if an image generated by T2I
is semantically consistent with the given text description, its
redescription by I2T should have exactly the same seman-
tics with the given text description. In other words, the gen-
erated image should act like a mirror that precisely reﬂects
the underlying text semantics. Motivated by this observa-
tion, we propose a novel text-to-image-to-text framework
called MirrorGAN to improve T2I generation, which ex-
ploits the idea of learning T2I generation by redescription.
MirrorGAN has three modules: STEM, GLAM and
STREAM. STEM generates word- and sentence-level em-
beddings, which are then used by the GLAM. GLAM is
a cascaded architecture that generates target images from
coarse to ﬁne scales, leveraging both local word attention
and global sentence attention to progressively enhance the
diversity and semantic consistency of the generated images.
STREAM tries to regenerate the text description from the
generated image, which semantically aligns with the given
text description.

To train the model end-to-end, we use two adversar-
ial losses: visual realism adversarial loss and text-image
paired semantic consistency adversarial loss. In addition,
to leverage the dual regulation of T2I and I2T, we further
employ a text-semantics reconstruction loss based on cross-
entropy (CE). Thorough experiments on two public bench-
mark datasets demonstrate the superiority of MirrorGAN
over other representative state-of-the-art methods with re-
spect to both visual realism and semantic consistency.

The contributions of this work can be summarized as fol-

lows:

• We propose a novel uniﬁed framework called Mirror-

GAN for modeling T2I and I2T together, speciﬁcally target-
ing T2I generation by embodying the idea of learning T2I
generation by redescription.

• We propose a global-local collaborative attention
model that is seamlessly embedded in the cascaded gener-
ators to preserve cross-domain semantic consistency and to
smoothen the generative process.

• Except commonly used GAN losses, we addition-
ally propose a CE-based text-semantics reconstruction loss
to supervise the generator to generate visually realistic
and semantically consistent images. Consequently, we
achieve new state-of-the-art performance on two bench-
mark datasets.

2. Related work

Similar ideas to our own have recently been used in
CycleGAN and DualGAN, which handle the bi-directional
translations within two domains together [43, 37, 1, 32], sig-
niﬁcantly advance image-to-image translation [14, 28, 15,
38, 23]. Our MirrorGAN is partly inspired by CycleGAN
but has two main differences: 1) we speciﬁcally tackle the
T2I problem rather than image-to-image translation. The
cross-media domain gap between text and images is prob-
ably much larger than the one between images with differ-
ent attributes, e.g., styles. Moreover, the diverse seman-
tics present in each domain make it much more challeng-
ing to maintain cross-domain semantic consistency. 2) Mir-
rorGAN embodies a mirror structure rather than the cycle
structure used in CycleGAN. MirrorGAN conducts super-
vised learning by using paired text-image data rather than
training from unpaired image-image data. Moreover, to em-
body the idea of learning T2I generation by redescription,
we use a CE-based reconstruction loss to regularize the se-
mantic consistency of the redescribed text, which is differ-
ent from the L1 cycle consistency loss in CycleGAN, which
addresses visual similarities.

Attention models have been extensively exploited in
computer vision and natural language processing, for in-
stance in object detection [21, 6, 18, 41], image/video cap-
tioning [34, 9, 31], visual question answering [2, 33, 36,
22], and neural machine translation [19, 8]. Attention can
be modeled spatially in images or temporally in language,
or even both in video- or image-text-related tasks. Differ-
ent attention models have been proposed for image cap-
tioning to enhance the embedded text feature representa-
tions during both encoding and decoding. Recently, Xu
et al. proposed an attention model to guide the generator
to focus on different words when generating different im-
age subregions [35]. However, using only word-level at-
tention does not ensure global semantic consistency due to
the diverse nature of both the text and image modalities,
e.g., each image has 10 captions in CUB and 5 captions in
COCO,however, they express the same underlying semantic

1506

Figure 2: Schematic of the proposed MirrorGAN for text-to-image generation.

information. In particular, for multi-stage generators, it is
crucial to make “semantically smooth” generations. There-
fore, global sentence-level attention should also be consid-
ered in each stage such that it progressively and smoothly
drives the generators towards semantically well-aligned tar-
gets. To this end, we propose a global-local collaborative
attentive module to leverage both local word attention and
global sentence attention and to enhance the diversity and
semantic consistency of the generated images.

3. MirrorGAN for text-to-image generation

As shown in Figure 2, MirrorGAN embodies a mirror
structure by integrating both T2I and I2T. It exploits the idea
of learning T2I generation by redescription. After an image
is generated, MirrorGAN regenerates its description, which
aligns its underlying semantics with the given text descrip-
tion. Technically, MirrorGAN consists of three modules:
STEM, GLAM and STREAM. Details of the model will be
introduced below.

3.1. STEM: Semantic Text Embedding Module

First, we introduce the semantic text embedding module
to embed the given text description into local word-level
features and global sentence-level features. As shown in the
leftmost part of Figure 2, a recurrent neural network (RNN)
[4] is used to extract semantic embeddings from the given
text description T , which include a word embedding w and
a sentence embedding s.

w, s = RN N (T ) ,

(1)

where T = {Tl |l = 0, . . . , L − 1 }, L represents the sen-
tence length, w = (cid:8)wl |l = 0, . . . , L − 1(cid:9) ∈ RD×L is the
concatenation of hidden state wl of each word, s ∈ RD is
the last hidden state, and D is the dimension of wl and s.
Due to the diversity of the text domain, text with few permu-
tations may share similar semantics. Therefore, we follow

the common practice of using the conditioning augmenta-
tion method [39] to augment the text descriptions. This
produces more image-text pairs and thus encourages robust-
ness to small perturbations along the conditioning text man-
ifold. Speciﬁcally, we use Fca to represent the conditioning
augmentation function and obtain the augmented sentence
vector:

sca = Fca (s) ,

(2)

where sca ∈ RD′

, D′ is the dimension after augmentation.

3.2. GLAM: Global Local collaborative Attentive

Module in Cascaded Image Generators

We next construct a multi-stage cascaded generator by
stacking three image generation networks sequentially. We
adopt the basic structure described in [35] due to its good
performance in generating realistic images. Mathemati-
cally, we use {F0, F1, ..., Fm−1} to denote the m visual
feature transformers and {G0, G1, ..., Gm−1} to denote the
m image generators. The visual feature fi and generated
image Ii in each stage can be expressed as:

f0 = F0 (z, sca) ,
fi = Fi (fi−1, Fatti (fi−1, w, sca)) , i ∈ {1, 2, . . . , m − 1} ,
Ii = Gi (fi) , i ∈ {0, 1, 2, . . . , m − 1} ,

(3)

where fi ∈ RMi×Ni and Ii ∈ Rqi×qi , z ∼ N (0, 1) de-
notes random noises. Fatti is the proposed global-local
collaborative attention model which includes two com-
ponents Attw
i−1, i.e., Fatti (fi−1, w, sca) =
concat (cid:0)Attw

i−1 and Atts
i−1, Atts
i−1(cid:1).

First, we use the word-level attention model proposed in
[35] to generate an attentive word-context feature. It takes
the word embedding w and the visual feature f as the input
in each stage. The word embedding w is ﬁrst converted into
an underlying common semantic space of visual features
by a perception layer Ui−1 as Ui−1w. Then, it is multiplied

1507

sentence feature sthis bird has a grey back and a white bellyRNN...FiF0...Gi...scaAtti-wAtti-sfi-fiZ ~ N(0,1)word feature wLSTMSoftmaxSoftmaxSoftmaxSoftmaxWeWeWeLSTMLSTMLSTMCNN<start>thisbird<end><start>thisbelly...(a) STEM: Semantic Text Embedding Module(b) GLAM: Global-Local collaborative Attentive Module in Cascaded Image Generators(c) STREAM: Semantic Text REgeneration and Alignment Module......111with the visual feature fi−1 to obtain the attention score. Fi-
nally, the attentive word-context feature is obtained by cal-
culating the inner product between the attention score and
Ui−1w:

L−1

l=0

X

Attw

i−1 =

(cid:0)Ui−1wl(cid:1) (cid:0)sof tmax (cid:0)f T

i−1 (cid:0)Ui−1wl(cid:1)(cid:1)(cid:1)T
(4)
i−1 ∈ RMi−1×Ni−1 . The
where Ui−1 ∈ RMi−1×D and Attw
attentive word-context feature Attw
i−1 has the exact same
dimension as fi−1, which is further used for generating the
ith visual features fi by concatenation with fi−1.

,

Then, we propose a sentence-level attention model to
enforce a global constraint on the generators during gen-
eration. By analogy to the word-level attention model, the
augmented sentence vector sca is ﬁrst converted into an un-
derlying common semantic space of visual features by a
perception layer Vi−1 as Vi−1sca. Then, it is element-wise
multiplied with the visual feature fi−1 to obtain the atten-
tion score. Finally, the attentive sentence-context feature is
obtained by calculating the element-wise multiplication of
the attention score and Vi−1sca:

Atts

i−1 = (Vi−1sca) ◦ (sof tmax (fi−1 ◦ (Vi−1sca))) ,

and Atts

(5)
where ◦ denotes the element-wise multiplication, Vi ∈
RMi×D′
The attentive
sentence-context feature Atts
i−1 is further concatenated
i−1 for generating the ith visual features
with fi−1 and Attw
fi as depicted in the second equality in Eq. (3).

i−1 ∈ RMi−1×Ni−1 .

3.3. STREAM: Semantic Text REgeneration and

Alignment Module

As described above, MirrorGAN includes a semantic
text regeneration and alignment module (STREAM) to re-
generate the text description from the generated image,
which semantically aligns with the given text descrip-
tion.
Speciﬁcally, we employ a widely used encoder-
decoder-based image caption framework [16, 29] as the ba-
sic STREAM architecture. Note that a more advanced im-
age captioning model can also be used, which is likely to
produce better results. However, in a ﬁrst attempt to val-
idate the proposed idea, we simply exploit the baseline in
the current work.

The image encoder is a convolutional neural network
(CNN) [11] pretrained on ImageNet [5], and the decoder is
a RNN [12]. The image Im−1 generated by the ﬁnal stage
generator is fed into the CNN encoder and RNN decoder as
follows:

x−1 = CN N (Im−1),
xt = WeTt, t ∈ {0, ...L − 1},
pt+1 = RN N (xt), t ∈ {0, ...L − 1},

(6)

where x−1 ∈ RMm−1 is a visual feature used as the input
at the beginning to inform the RNN about the image con-
tent. We ∈ RMm−1×D represents a word embedding ma-
trix, which maps word features to the visual feature space.
pt+1 is a predicted probability distribution over the words.
We pre-trained STREAM as it helped MirrorGAN achieve
a more stable training process and converge faster, while
jointly optimizing STREAM with MirrorGAN is instable
and very expensive in terms of time and space. The encoder-
decoder structure in [29] and then their parameters keep
ﬁxed when training the other modules of MirrorGAN.

3.4. Objective functions

Following common practice, we ﬁrst employ two adver-
sarial losses: a visual realism adversarial loss and a text-
image paired semantic consistency adversarial loss, which
are deﬁned as follows.

During each stage of training MirrorGAN, the generator
G and discriminator D are trained alternately. Specially,
the generator Gi in the ith stage is trained by minimizing
the loss as follows:

LGi = − 1

2 EIi∼pIi [log (Di (Ii))]

− 1

2

EIi∼pIi [log (Di (Ii, s))] ,

(7)

where Ii is a generated image sampled from the distribu-
tion pIi in the ith stage. The ﬁrst term is the visual real-
ism adversarial loss, which is used to distinguish whether
the image is visually real or fake, while the second term is
the text-image paired semantic consistency adversarial loss,
which is used to determine whether the underlying image
and sentence semantics are consistent.

We further propose a CE-based text-semantic recon-
struction loss to align the underlying semantics between the
redescription of STREAM and the given text description.
Mathematically, this loss can be expressed as:

Lstream = −

L−1

X

t=0

log pt(Tt).

(8)

It is noteworthy that Lstream is also used during STREAM
pretraining. When training Gi, gradients from Lstream are
backpropagated to Gi through STREAM, whose network
weights are kept ﬁxed.

The ﬁnal objective function of the generator is deﬁned

as:

LG =

m−1

X

i=0

LGi + λLstream,

(9)

where λ is a loss weight to handle the importance of adver-
sarial loss and the text-semantic reconstruction loss.

The discriminator Di is trained alternately to avoid be-
ing fooled by the generators by distinguishing the inputs as
either real or fake. Similar to the generator, the objective

1508

of the discriminators consists of a visual realism adversarial
loss and a text-image paired semantic consistency adversar-
ial loss. Mathematically, it can be deﬁned as:

wrong. A higher score represents a higher visual-semantic
similarity between the generated images and input text.

The Inception Score and the R-precision were calculated

LDi = − 1

− 1
E

i

i

2

2

E

I GT

(cid:2)log (cid:0)Di (cid:0)I GT

∼pIGT

i
EIi∼pIi [log (1 − Di (Ii))]
, s(cid:1)(cid:1)(cid:3)
I GT
EIi∼pIi [log (1 − Di (Ii, s))] ,

(cid:2)log (cid:0)Di (cid:0)I GT

∼pIGT

i

i

i

2

− 1
− 1

2

(cid:1)(cid:1)(cid:3)

accordingly as in [39, 35].

(10)

4.1.3

Implementation details

i

is from the real image distribution pI GT

in ith
where I GT
stage. The ﬁnal objective function of the discriminator is
deﬁned as:

i

m−1

LD =

LDi .

X

i=0

(11)

4. Experiments

In this section, we present extensive experiments that
evaluate the proposed model. We ﬁrst compare MirrorGAN
with the state-of-the-art T2I methods GAN-INT-CLS [24],
GAWWN [25], StackGAN [39], StackGAN++ [40], PPGN
[20] and AttnGAN [35]. Then, we present ablation stud-
ies on the key components of MirrorGAN including GLAM
and STREAM.

4.1. Experiment setup

4.1.1 Datasets

We evaluated our model on two commonly used datasets,
CUB bird dataset [30] and MS COCO dataset [17]. The
CUB bird dataset contains 8,855 training images and 2,933
test images belonging to 200 categories, each bird im-
age has 10 text descriptions. The COCO dataset contains
82,783 training images and 40,504 validation images, each
image has 5 text descriptions. Both datasets were pre-
processed using the same pipeline as in [39, 35].

4.1.2 Evaluation metric

Following common practice [39, 35], the Inception Score
[26] was used to measure both the objectiveness and di-
versity of the generated images. Two ﬁne-tuned inception
models provided by [39] were used to calculate the score.

Then, the R-precision introduced in [35] was used to
evaluate the visual-semantic similarity between the gener-
ated images and their corresponding text descriptions. For
each generated image, its ground truth text description and
99 randomly selected mismatched descriptions from the test
set were used to form a text description pool. We then calcu-
lated the cosine similarities between the image feature and
the text feature of each description in the pool, before count-
ing the average accuracy at three different settings: top-1,
top-2, and top-3. The ground truth entry falling into the
top-k candidates was treated as correct, otherwise, it was

MirrorGAN has three generators in total and GLAM is em-
ployed over the last two generators, as shown in Eq. (3).
64×64, 128×128, 256×256 images are generated progres-
sively. Followed [35], a pre-trained bi-directional LSTM
[27] was used to calculate the semantic embedding from
text descriptions. The dimension of the word embedding D
was 256. The sentence length L was 18. The dimension Mi
of the visual embedding was set to 32. The dimension of
the visual feature was Ni = qi × qi, where qi was 64, 128,
and 256 for the three stages. The dimension of augmented
sentence embedding D′ was set to 100. The loss weight λ
of the text-semantic reconstruction loss was set to 20.

4.2. Main results

In this section, we present both qualitative and quantita-
tive comparisons with other methods to verify the effective-
ness of MirrorGAN. First, we compare MirrorGAN with
state-of-the-art text-to-image methods [24, 25, 39, 40, 20,
35] using the Inception Score and R-precision score on both
CUB and COCO datasets. Then, we present subjective vi-
sual comparisons between MirrorGAN and the state-of-the-
art method AttnGAN [35]. We also present the results of a
human study designed to test the authenticity and visual se-
mantic similarity between input text and images generated
by MirrorGAN and AttnGAN [35].

4.2.1 Quantitative results

The Inception Scores of MirrorGAN and other methods are
shown in Table 1. MirrorGAN achieved the highest Incep-
tion Score on both CUB and COCO datasets. Speciﬁcally,
compared with the state-of-art method AttnGAN [35], Mir-
rorGAN improved the Inception Score from 4.36 to 4.56 on
CUB and from 25.89 to 26.47 on the more difﬁcult COCO
dataset. These results show that MirrorGAN can generate
more diverse images of better quality.

The R-precision scores of AttnGAN [35] and Mirror-
GAN on CUB and COCO datasets are listed in Table 2.
MirrorGAN consistently outperformed AttnGAN [35] at all
settings by a large margin, demonstrating the superiority
of the proposed text-to-image-to-text framework and the
global-local collaborative attentive module, since Mirror-
GAN generated high-quality images with semantics consis-
tent with the input text descriptions.

1509

Figure 3: Examples of images generated by (a) AttnGAN [35], (b) MirrorGAN Baseline, and (c) MirrorGAN conditioned on
text descriptions from CUB and COCO test sets and (d) the corresponding ground truth.

Table 1: Inception Scores of state-of-the-art methods and
MirrorGAN on CUB and COCO datasets.

Model

CUB

COCO

GAN-INT-CLS [24]
GAWWN [25]
StackGAN [39]
StackGAN++ [40]
PPGN [20]
AttnGAN [35]

2.88 ± 0.04
3.62 ± 0.07
3.70 ± 0.04
3.82 ± 0.06

-

4.36 ± 0.03

7.88 ± 0.07

-

8.45 ± 0.03

-

9.58 ± 0.21
25.89 ± 0.47

MirrorGAN

4.56 ± 0.05

26.47 ± 0.41

Table 2: R-precision [%] of the state-of-the-art AttnGAN
[35] and MirrorGAN on CUB and COCO datasets.

Dataset

top-k

CUB

COCO

k=1

k=2

k=3

k=1

k=2

k=3

AttnGAN [35]
MirrorGAN

53.31
57.67

54.11
58.52

54.36
60.42

72.13
74.52

73.21
76.87

76.53
80.21

4.2.2 Qualitative results

Subjective visual comparisons: Subjective visual compar-
isons between AttnGAN [35], MirrorGAN Baseline, and
MirrorGAN are presented in Figure 3. MirrorGAN Base-
line refers to the model using only word-level attention for
each generator in the MirrorGAN framework.

It can be seen that the image details generated by At-
tnGAN are lost, colors are inconsistent with the text de-
scriptions (3rd and 4th column), and the shape looks strange
(2nd, 3rd, 5th and 8th column) for some hard examples.

Furthermore, the skier is missing in the 5th column. Mirror-
GAN Baseline achieved better results with more details and
consistent colors and shapes compared to AttnGAN. For
example, the wings are vivid in the 1st and 2nd columns,
demonstrating the superiority of MirrorGAN and that it
takes advantage of the dual regularization by redescription,
i.e., a semantically consistent image should be generated
if it can be redescribed correctly. By comparing Mirror-
GAN with MirrorGAN Baseline, we can see that GLAM
contributes to producing ﬁne-grained images with more de-
tails and better semantic consistency. For example, the color
of the underbelly of the bird in the 4th column was corrected
to white, and the skier with a red jacket was recovered. The
boats and city backdrop in the 7th column and the horses
on the green ﬁeld in the 8th column look real at ﬁrst glance.
Generally, content in the CUB dataset is less diverse than in
COCO dataset. Therefore, it is easier to generate visually
realistic and semantically consistent results on CUB. These
results conﬁrm the impact of GLAM, which uses global and
local attention collaboratively.

Human perceptual test: To compare the visual real-
ism and semantic consistency of the images generated by
AttnGAN and MirrorGAN, we next performed a human
perceptual test on the CUB test dataset. We recruited 100
volunteers with different professional backgrounds to con-
duct two tests: the Image Authenticity Test and the Seman-
tic Consistency Test. The Image Authenticity Test aimed
to compare the authenticity of the images generated using
different methods. Participants were presented with 100
groups of images consecutively. Each group had 2 images
arranged in random order from AttnGAN and MirrorGAN

1510

(a)AttnGAN(b)MirrorGAN Baseline(c)MirrorGAN(d)Ground Trutha yellow bird with brown and white wings and a pointed billthis bird is blue and black in color, with a sharp black beakthis small blue bird has a white underbellyInputboats at the dock with a city backdropa skier with a red jacket on going down the side of a mountainthe  pizza  is cheesy with pepperoni for the toppingbrown horses are running on a green fielda small bird with a red belly, and a small bill and red wingsexcluding/including these components in MirrorGAN. The
results are listed in Table 3.

First, the hyper-parameter λ is important. A larger λ led
to higher Inception Scores and R-precision on both datasets.
On the CUB dataset, when λ increased from 5 to 20, the
Inception Score increased from 4.01 to 4.54 and R-precision
increased from 32.07% to 57.67%. On the COCO dataset,
the Inception Score increased from 21.85 to 26.21 and R-
precision increased from 52.55% to 74.52%. We set λ to 20
as default.

MirrorGAN without STREAM (λ = 0) and global atten-
tion (GA) achieved better results than StackGAN++ [40]
and PPGN [20].
Integrating STREAM into MirrorGAN
led to further signiﬁcant performance gains. The Inception
Score increased from 3.91 to 4.47 and from 19.01 to 25.99
on CUB and COCO, respectively, and R-precision showed
the same trend. Note that MirrorGAN without GA already
outperformed the state-of-the-art AttnGAN (Table 1) which
also used the word-level attention. These results indicate
that STREAM is more effective in helping the generators
achieve better performance. This attributes to the intro-
duction of a more strict semantic alignment between gener-
ated images and input text, which is provided by STREAM.
Speciﬁcally, STREAM forces the generated images to be
redescribed as the input text sequentially, which potentially
prevents possible mismatched visual-text concept. More-
over, MirrorGAN integration with GLAM further improved
the Inception Score and R-precision to achieve new state-of-
the-art performance. These results show that the global and
local attention in GLAM collaboratively help the generator
to generate visually realistic and semantically consistent re-
sults by telling it where to focus on.

Visual inspection on the cascaded generators: To bet-
ter understand the cascaded generation process of Mirror-
GAN, we visualized both the intermediate images and the
attention maps in each stage (Figure 5). In the ﬁrst stage,
low-resolution images were generated with primitive shape
and color but lacking details. With guidance from GLAM
in the following stages, MirrorGAN generated images by
focusing on the most relevant and important areas. Conse-
quently, the quality of the generated images progressively
improved, e.g., the colors and details of the wings and
crown. The top-5 global and local attention maps in each
stage are shown below the images. It can be seen that: 1) the
global attention concentrated more on the global context in
the earlier stage and then the context around speciﬁc regions
in later stages, 2) the local attention helped the generator
synthesize images with ﬁne-grained details by guiding it to
focus on the most relevant words, and 3) the global attention
is complementary to the local attention, they collaboratively
contributed to the progressively improved generation.

In addition, we also present the images generated by
MirrorGAN by modifying the text descriptions by a single

1511

Figure 4: Results of Human perceptual test. A higher value
of the Authenticity Test means more convincing images.
A higher value of the Semantic Consistency Test means a
closer semantics between input text and generated images.

Table 3: Inception Score and R-precision results of Mirror-
GAN with different weight settings.

Evaluation Metric

Inception Score

R-precision (top-1)

CUB

COCO

CUB

COCO

MirrorGAN w/o GA, λ=0
MirrorGAN w/o GA, λ=20
MirrorGAN, λ=5
MirrorGAN, λ=10
MirrorGAN, λ=20

3.91± .09
4.47± .07
4.01± .06
4.30± .07
4.54 ± .17

19.01± .42
25.99± .41
21.85± .43
24.11± .31
26.47± .41

39.09
55.67
32.07
43.21
57.67

50.69
73.28
52.55
63.40
74.52

given the same text description. Participants were given
unlimited time to select the more convincing images. The
Semantic Consistency Test aimed to compare the semantic
consistency of the images generated using different meth-
ods. Each group had 3 images corresponding to the ground
truth image and two images arranged at random from At-
tnGAN and MirrorGAN. The participants were asked to se-
lect the images that were more semantically consistent with
the ground truth. Note that we used ground truth images
instead of the text descriptions since it is easier to compare
the semantics between images.

After

the participants ﬁnished the experiment, we
counted the votes for each method in the two scenarios. The
results are shown in Figure 4. It can be seen that the images
from MirrorGAN were preferred over ones from AttnGAN.
MirrorGAN outperformed AttnGAN with respect to au-
thenticity, MirrorGAN was even more effective in terms of
semantic consistency. These results demonstrate the supe-
riority of MirrorGAN for generating visually realistic and
semantically consistent images.

4.3. Ablation studies

Ablation studies on MirrorGAN components: We
next conducted ablation studies on the proposed model and
its variants. To validate the effectiveness of STREAM and
GLAM, we conducted several comparative experiments by

Figure 5: Attention visualization on the CUB and the COCO test sets. The ﬁrst row shows the output 64 × 64 images
generated by G0, 128 × 128 images generated by G1 and 256 × 256 images generated by G2. And the following rows show
the Global-Local attention generated in stage 1 and 2. Please refer to the supplementary material for more examples.

this bird has a yellow
crown and a white belly

this bird has a black

crown and a white belly

this bird has a black
crown and a red belly

this bird has blue wings 

and a red belly

Figure 6: Images generated by MirrorGAN by modifying
the text descriptions by a single word and the corresponding
top-2 attention maps in the last stage.

word (Figure 6). MirrorGAN captured subtle semantic dif-
ferences in the text descriptions.

4.4. Limitation and discussion

Although our proposed MirrorGAN shows superiority
in generating visually realistic and semantically consistent
images, some limitations must be taken into consideration
in future studies. First, STREAM and other MirrorGAN
modules are not jointly optimized with complete end-to-
end training due to limited computational resources. Sec-
ond, we only utilize a basic method for text embedding in
STEM and image captioning in STREAM, which could be
further improved, for example, by using the recently pro-
posed BERT model [7] and state-of-the-art image caption-
ing models [2, 3]. Third, although MirrorGAN is initially

designed for the T2I generation by aligning cross-media se-
mantics, we believe that its complementarity to the state-
of-the-art CycleGAN can be further exploited to enhance
model capacity for jointly modeling cross-media content.

5. Conclusions

In this paper, we address the challenging T2I gener-
ation problem by proposing a novel global-local atten-
tive and semantic-preserving text-to-image-to-text frame-
work called MirrorGAN. MirrorGAN successfully exploits
the idea of learning text-to-image generation by redescrip-
tion. STEM generates word- and sentence-level embed-
dings. GLAM has a cascaded architecture for generating
target images from coarse to ﬁne scales, leveraging both lo-
cal word attention and global sentence attention to progres-
sively enhance the diversity and semantic consistency of the
generated images. STREAM further supervises the gener-
ators by regenerating the text description from the gener-
ated image, which semantically aligns with the given text
description. We show that MirrorGAN achieves new state-
of-the-art performance on two benchmark datasets.

Acknowledgements: This work is supported in part by Chinsese Na-
tional Double First-rate Project about digital protection of cultural relics
in Grotto Temple and equipment upgrading of the Chinese National Cul-
tural Heritage Administration scientiﬁc research institutes, the National
Natural Science Foundation of China Project 61806062, and the Aus-
tralian Research Council Projects FL-170100117, DP-180103424, and IH-
180100002.

1512

a little bird with white belly, gray cheek patch and yellow crown and wing bars5:gray         1:bird         0:little           9:yellow       4:belly3:white         9:yellow         0:little         5:gray         4:bellyStage 1Stage 2Stage 1Stage 2table set for five laden with breakfast food     1:set             7:food           2:for          6:breakfast       5:with6:breakfast       7:food           4:laden           5:with           3:fiveReferences

[1] A. Almahairi, S. Rajeswar, A. Sordoni, P. Bachman, and
A. C. Courville. Augmented cyclegan: Learning many-to-
many mappings from unpaired data. In International Con-
ference on Machine Learning (ICML), 2018.

[2] P. Anderson, X. He, C. Buehler, D. Teney, M. Johnson,
S. Gould, and L. Zhang. Bottom-up and top-down attention
for image captioning and visual question answering. In The
IEEE Conference on Computer Vision and Pattern Recogni-
tion (CVPR), 2018.

[3] F. Chen, R. Ji, X. Sun, Y. Wu, and J. Su. Groupcap: Group-
based image captioning with structured relevance and diver-
sity constraints. In The IEEE Conference on Computer Vi-
sion and Pattern Recognition (CVPR), 2018.

[4] K. Cho, B. van Merrienboer, C. Gulcehre, F. Bougares,
H. Schwenk, and Y. Bengio. Learning phrase representations
using rnn encoder-decoder for statistical machine translation.
In Proceedings of conference on Empirical Methods on Nat-
ural Language Processing (EMNLP), 2014.

[5] J. Deng, W. Dong, R. Socher, L.-J. Li, K. Li, and L. Fei-
Fei.
Imagenet: A large-scale hierarchical image database.
In The IEEE Conference on Computer Vision and Pattern
Recognition (CVPR), 2009.

[6] H. Deubel and W. X. Schneider. Saccade target selection
and object recognition: Evidence for a common attentional
mechanism. Vision research, 1996.

[7] J. Devlin, M.-W. Chang, K. Lee, and K. Toutanova. Bert:
Pre-training of deep bidirectional transformers for language
understanding. arXiv preprint arXiv:1810.04805, 2018.

[8] O. Firat, K. Cho, and Y. Bengio. Multi-way, multilingual
neural machine translation with a shared attention mecha-
nism.
In North American Association for Computational
Linguistics (NAACL), 2016.

[9] L. Gao, Z. Guo, H. Zhang, X. Xu, and H. T. Shen. Video cap-
tioning with attention-based lstm and semantic consistency.
IEEE Transactions on Multimedia, 2017.

[10] I. Goodfellow,

J. Pouget-Abadie, M. Mirza, B. Xu,
D. Warde-Farley, S. Ozair, A. Courville, and Y. Bengio. Gen-
erative adversarial nets. In Advances In Neural Information
Processing Systems (NIPS), 2014.

[11] K. He, X. Zhang, S. Ren, and J. Sun. Deep residual learning
for image recognition. In The IEEE Conference on Computer
Vision and Pattern Recognition (CVPR), 2016.

[12] S. Hochreiter and J. Schmidhuber. Long short-term memory.

Neural computation, 1997.

[13] S. Hong, D. Yang, J. Choi, and H. Lee.

Inferring seman-
tic layout for hierarchical text-to-image synthesis.
In The
IEEE Conference on Computer Vision and Pattern Recogni-
tion (CVPR), 2018.

[14] P. Isola, J. Zhu, T. Zhou, and A. A. Efros. Image-to-image
translation with conditional adversarial networks. The IEEE
Conference on Computer Vision and Pattern Recognition
(CVPR), 2017.

[15] J. Johnson, A. Alahi, and L. Fei-Fei. Perceptual losses for
In European

real-time style transfer and super-resolution.
Conference on Computer Vision (ECCV), 2016.

[16] A. Karpathy and L. Fei-Fei. Deep visual-semantic align-
ments for generating image descriptions.
In The IEEE
Conference on Computer Vision and Pattern Recognition
(CVPR), 2015.

[17] T.-Y. Lin, M. Maire, S. Belongie, J. Hays, P. Perona, D. Ra-
manan, P. Doll´ar, and C. L. Zitnick. Microsoft coco: Com-
mon objects in context. In European Conference on Com-
puter Vision (ECCV), 2014.

[18] J. Liu, C. Gao, D. Meng, and A. G. Hauptmann. Decidenet:
Counting varying density crowds through attention guided
detection and density estimation. In The IEEE Conference
on Computer Vision and Pattern Recognition (CVPR), 2018.
[19] M.-T. Luong, H. Pham, and C. D. Manning. Effective ap-
proaches to attention-based neural machine translation.
In
Proceedings of conference on Empirical Methods on Natu-
ral Language Processing (EMNLP), 2015.

[20] A. Nguyen, J. Clune, Y. Bengio, A. Dosovitskiy, and
J. Yosinski. Plug & play generative networks: Conditional
iterative generation of images in latent space. In The IEEE
Conference on Computer Vision and Pattern Recognition
(CVPR), 2017.

[21] A. Oliva, A. Torralba, M. S. Castelhano, and J. M. Hender-
son. Top-down control of visual attention in object detec-
tion. In IEEE International Conference on Image Processing
(ICIP), 2003.

[22] T. Qiao, J. Dong, and D. Xu. Exploring human-like attention
supervision in visual question answering. In Thirty-Second
AAAI Conference on Artiﬁcial Intelligence, 2018.

[23] T. Qiao, W. Zhang, M. Zhang, Z. Ma, and D. Xu. Ancient
painting to natural image: A new solution for painting pro-
cessing.
IEEE Winter Conf. on Applications of Computer
Vision (WACV), 2019.

[24] S. Reed, Z. Akata, X. Yan, L. Logeswaran, B. Schiele, and
H. Lee. Generative adversarial text to image synthesis. In In-
ternational Conference on Machine Learning (ICML), 2016.
[25] S. E. Reed, Z. Akata, S. Mohan, S. Tenka, B. Schiele, and
H. Lee. Learning what and where to draw. In Advances in
Neural Information Processing Systems (NIPS), 2016.

[26] T. Salimans, I. Goodfellow, W. Zaremba, V. Cheung, A. Rad-
ford, and X. Chen. Improved techniques for training gans. In
Advances in Neural Information Processing Systems (NIPS),
2016.

[27] M. Schuster and K. K. Paliwal. Bidirectional recurrent neural

networks. IEEE Transactions on Signal Processing, 1997.

[28] Y. Taigman, A. Polyak, and L. Wolf. Unsupervised cross-
International Conference on

domain image generation.
Learning Representations (ICLR), 2017.

[29] O. Vinyals, A. Toshev, S. Bengio, and D. Erhan. Show and
tell: A neural image caption generator. In The IEEE Confer-
ence on Computer Vision and Pattern Recognition (CVPR),
2015.

[30] C. Wah, S. Branson, P. Welinder, P. Perona, and S. Belongie.
The caltech-ucsd birds-200-2011 dataset. California Insti-
tute of Technology, 2011.

[31] J. Wang, W. Jiang, L. Ma, W. Liu, and Y. Xu. Bidirectional
attentive fusion with context gating for dense video caption-
ing. In The IEEE Conference on Computer Vision and Pat-
tern Recognition (CVPR), 2018.

1513

[32] J. Wen, R. Liu, N. Zheng, Q. Zheng, Z. Gong, and J. Yuan.
Exploiting local feature patterns for unsupervised domain
adaptation.
In Thirty-Third AAAI Conference on Artiﬁcial
Intelligence, 2019.

[33] H. Xu and K. Saenko. Ask, attend and answer: Exploring
question-guided spatial attention for visual question answer-
ing. In European Conference on Computer Vision (ECCV),
2016.

[34] K. Xu, J. Ba, R. Kiros, K. Cho, A. Courville, R. Salakhudi-
nov, R. Zemel, and Y. Bengio. Show, attend and tell: Neural
image caption generation with visual attention. In Interna-
tional Conference on Machine Learning (ICML), 2015.

[35] T. Xu, P. Zhang, Q. Huang, H. Zhang, Z. Gan, X. Huang,
and X. He. Attngan: Fine-grained text to image genera-
tion with attentional generative adversarial networks. In The
IEEE Conference on Computer Vision and Pattern Recogni-
tion (CVPR), 2018.

[36] Z. Yang, X. He, J. Gao, L. Deng, and A. Smola. Stacked
In The
attention networks for image question answering.
IEEE Conference on Computer Vision and Pattern Recog-
nition (CVPR), 2016.

[37] Z. Yi, H. Zhang, P. Tan, and M. Gong. Dualgan: Unsuper-
vised dual learning for image-to-image translation. The IEEE
International Conference on Computer Vision (ICCV), 2017.
[38] J. Yu, Z. Lin, J. Yang, X. Shen, X. Lu, and T. S. Huang. Gen-
erative image inpainting with contextual attention.
In The
IEEE Conference on Computer Vision and Pattern Recogni-
tion (CVPR), 2018.

[39] H. Zhang, T. Xu, H. Li, S. Zhang, X. Huang, X. Wang, and
D. Metaxas. Stackgan: Text to photo-realistic image synthe-
sis with stacked generative adversarial networks.
In IEEE
International Conference on Computer Vision (ICCV), 2017.
[40] H. Zhang, T. Xu, H. Li, S. Zhang, X. Wang, X. Huang,
and D. Metaxas. Stackgan++: Realistic image synthesis
with stacked generative adversarial networks. arXiv preprint
arXiv:1710.10916, 2017.

[41] X. Zhang, T. Wang, J. Qi, H. Lu, and G. Wang. Progres-
sive attention guided recurrent network for salient object de-
tection.
In The IEEE Conference on Computer Vision and
Pattern Recognition (CVPR), 2018.

[42] Z. Zhang, Y. Xie, and L. Yang. Photographic text-to-image
synthesis with a hierarchically-nested adversarial network.
In The IEEE Conference on Computer Vision and Pattern
Recognition (CVPR), 2018.

[43] J. Zhu, T. Park, P. Isola, and A. A. Efros. Unpaired image-
to-image translation using cycle-consistent adversarial net-
works. The IEEE International Conference on Computer Vi-
sion (ICCV), 2017.

1514

