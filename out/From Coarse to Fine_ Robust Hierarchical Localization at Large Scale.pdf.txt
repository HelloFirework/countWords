From Coarse to Fine: Robust Hierarchical Localization at Large Scale

Paul-Edouard Sarlin1 Cesar Cadena1 Roland Siegwart1 Marcin Dymczyk1

2

,

1Autonomous Systems Lab, ETH Z¨urich

2Sevensense Robotics AG

Abstract

Query

Robust and accurate visual localization is a fundamental
capability for numerous applications, such as autonomous
driving, mobile robotics, or augmented reality. It remains,
however, a challenging task, particularly for large-scale
environments and in presence of signiﬁcant appearance
changes. State-of-the-art methods not only struggle with
such scenarios, but are often too resource intensive for cer-
tain real-time applications. In this paper we propose HF-
Net, a hierarchical localization approach based on a mono-
lithic CNN that simultaneously predicts local features and
global descriptors for accurate 6-DoF localization. We
exploit the coarse-to-ﬁne localization paradigm: we ﬁrst
perform a global retrieval to obtain location hypotheses
and only later match local features within those candidate
places. This hierarchical approach incurs signiﬁcant run-
time savings and makes our system suitable for real-time
operation. By leveraging learned descriptors, our method
achieves remarkable localization robustness across large
variations of appearance and sets a new state-of-the-art on
two challenging benchmarks for large-scale localization.1

1. Introduction

The precise 6-Degree-of-Freedom (DoF) localization of
a camera within an existing 3D model is one of the core
computer vision capabilities that unlocks a number of re-
cent applications. These include autonomous driving in
GPS-denied environments [7, 29, 31, 5] and consumer
devices with augmented reality features [30, 22], where
a centimeter-accurate 6-DoF pose is crucial to guarantee re-
liable and safe operation and fully immersive experiences,
respectively. More broadly, visual localization is a key com-
ponent in computer vision tasks such as Structure-from-
Motion (SfM) or SLAM. This growing range of applica-
tions of visual localization calls for reliable operation both
indoors and outdoors, irrespective of the weather, illumina-
tion, or seasonal changes.

Robustness to such large variations is therefore critical,
along with limited computational resources. Maintaining
a model that allows accurate localization in multiple con-

1Code available at https://github.com/ethz-asl/hf_net

Hierarchical	
Localization

1)	Global
Matching

3)	6-DoF	

pose

Sparse	3D	model

2)	Local
Matching

Retrieved

Direct	

Matching

Query

Figure 1. Hierarchical localization. A global search ﬁrst retrieves
candidate images, which are subsequently matched using powerful
local features to estimate an accurate 6-DoF pose. This two-step
process is both efﬁcient and robust in challenging situations.

ditions, while remaining compact, is thus of utmost im-
portance. In this work, we investigate whether it is actu-
ally possible to robustly localize in large-scale changing en-
vironments with constrained resources of mobile devices.
More speciﬁcally, we aim at estimating the 6-DoF pose of a
query image w.r.t. a given 3D model with the highest possi-
ble accuracy.

Current leading approaches mostly rely on estimating
correspondences between 2D keypoints in the query and
3D points in a sparse model using local descriptors. This
direct matching is either robust but intractable on mo-
bile [48, 51, 41], or optimized for efﬁciency but fragile [27].
In both cases, the robustness of classical localization meth-
ods is limited by the poor invariance of hand-crafted local
features [8, 26]. Recent features emerging from convolu-
tional neural networks (CNN) exhibit unrivalled robustness
at a low compute cost [12, 13, 32]. They have been, how-
ever, only recently [49] applied to the visual localization
problem, and only in a dense, expensive manner. Learned
sparse descriptors [12, 36] promise large beneﬁts that re-
main yet unexplored in localization.

Alternative localization approaches based on image re-
trieval have recently shown promising results in terms of
robustness and efﬁciency, but are not competitive in terms
of accuracy. The beneﬁts of an intermediate retrieval step
have been demonstrated earlier [40], but fall short of reach-

12716

ing the scalability required by city-scale localization.

In this paper, we propose to leverage recent advances in
learned features to bridge the gap between robustness and
efﬁciency in the hierarchical localization paradigm. Sim-
ilar to how humans localize, we employ a natural coarse-
to-ﬁne pose estimation process which leverages both global
descriptors and local features, and scales well with large
environments (Figure 1). We show that learned descrip-
tors enable unrivaled robustness in challenging conditions,
while learned keypoints improve the efﬁciency in terms of
compute and memory thanks to their higher repeatability.
To further improve the efﬁciency of this approach, we pro-
pose a Hierarchical Feature Network (HF-Net), a CNN that
jointly estimates local and global features, and thus maxi-
mizes the sharing of computations. We show how such a
compressed model can be trained in a ﬂexible way using
multitask distillation. By distilling multiple state-of-the-art
predictors jointly into a single model, we obtain an incom-
parably fast, yet robust and accurate, localization. Such het-
erogenous distillation is applicable beyond visual localiza-
tion to tasks that require both multimodal expensive predic-
tions and computational efﬁciency. Overall, our contribu-
tions are as follows:

– We set a new state-of-the-art in several public bench-
marks for large-scale localization with an outstanding
robustness in particularly challenging conditions;

– We introduce HF-Net, a monolithic neural network
which efﬁciently predicts hierarchical features for
a fast and robust localization;

– We demonstrate the practical usefulness and effective-
ness of multitask distillation to achieve runtime goals
with heterogeneous predictors.

2. Related Work

In this section we review other works that relate to dif-
ferent components of our approach, namely: visual local-
ization, scalability, feature learning, and deployment on re-
source constrained devices.

6-DoF visual localization methods have traditionally been
classiﬁed as either structure-based or image-based. The for-
mer perform direct matching of local descriptors between
2D keypoints of a query image and 3D points in a 3D SfM
model [48, 51, 41, 25, 49]. These methods are able to es-
timate accurate poses, but often rely on exhaustive match-
ing and are thus compute intensive. As the model grows in
size and perceptual aliasing arises, this matching becomes
ambiguous, impairing the robustness of the localization,
especially under strong appearance changes such as day-
night [42]. Some approaches directly regress the pose from
a single image [6, 20], but are not competitive in term of
accuracy [44]. Image-based methods are related to image

retrieval [1, 52, 53] and are only able to provide an approx-
imate pose up to the database discretization, which is not
sufﬁciently precise for many applications [42, 49]. They are
however signiﬁcantly more robust than direct local match-
ing as they rely on the global image-wide information. This
comes at the cost of increased compute, as state-of-the-art
image retrieval is based on large deep learning models.

Scalable localization often deals with the additional com-
pute constrains by using features that are inexpensive to ex-
tract, store, and match together [8, 24, 37]. These improve
the runtime on mobile devices but further impair the ro-
bustness of the localization, limiting their operations to sta-
ble conditions [27]. Hierarchical localization [19, 30, 40]
takes a different approach by dividing the problem into a
global, coarse search followed by a ﬁne pose estimation.
Recently, [40] proposed to search at the map level using
image retrieval and localize by matching hand-crafted local
features against retrieved 3D points. As we discuss further
in Section 3, its robustness and efﬁciency are limited by the
underlying local descriptors and heterogeneous structure.

Learned local features have recently been developed in at-
tempt to replace hand-crafted descriptors. Dense pixel-wise
features naturally emerge from CNNs and provide a power-
ful representation used for image matching [10, 13, 35, 38]
and localization [49, 42]. Matching dense features is how-
ever intractable with limited computing power. Sparse
learned features, composed of keypoints and descriptors,
provide an attractive drop-in replacement to their hand-
crafted counterparts and have recently shown outstanding
performance [12, 36, 16]. They can easily be sampled from
dense features, are fast to predict and thus suitable for mo-
bile deployment. CNN keypoint detections have also been
shown to outperform classical methods, although they are
notably difﬁcult to learn. SuperPoint [12] learns from self-
supervision, while DELF [34] employs an attention mecha-
nism to optimize for the landmark recognition task.

Deep learning on mobile. While learning some build-
ing blocks of the localization pipeline improves perfor-
mance and robustness, deploying them on mobile devices
is a non-trivial task. Recent advances in multi-task learn-
ing allow to efﬁciently share compute across tasks without
manual tuning [21, 9, 47], thus reducing the required net-
work size. Distillation [18] can help to train a smaller net-
work [39, 55, 56] from a larger one that is already trained,
but is usually not applied in a multi-task setting.

To the best of our knowledge, our approach is the ﬁrst
of its kind that combines advances in the aforementioned
ﬁelds to optimize for both efﬁciency and robustness. The
proposed method seeks to leverage the synergies of these
algorithms to deliver a competitive large-scale localization
solution and bring this technology closer to real-time, on-
line applications with constrained resources.

12717

Local	Features

Database	Images

SfM

Reconstruction

SfM Model

HF-Net

Global
Index

HF-Net

NN	search

Global	

Descriptor

2D-3D	matches

Query	Image

E
N
I
L
F
F
O

E
N
I
L
N
O

6-DoF	Pose

Retrieved
Cameras

Figure 2. The hierarchical localization with HF-Net is signiﬁ-
cantly simpler than concurrent approaches [41, 48], yet more ro-
bust, accurate, and efﬁcient.

3. Hierarchical Localization

We aim at maximizing the robustness of the localiza-
tion while retaining tractable computational requirements.
Our method is loosely based on the hierarchical localiza-
tion framework [40], which we summarize here.

Prior retrieval. A coarse search at the map level is per-
formed by matching the query with the database images
using global descriptors. The k-nearest neighbors (NN),
called prior frames, represent candidate locations in the
map. This search is efﬁcient given that there are far fewer
database images than points in the SfM model.

Covisibility clustering.
The prior frames are clustered
based on the 3D structure that they co-observe. This
amounts to ﬁnding connected components, called places,
in the covisibility graph that links database images to 3D
points in the model.

Local feature matching. For each place, we successively
match the 2D keypoints detected in the query image to the
3D points contained in the place, and attempt to estimate a
6-DoF pose with a PnP [23] geometric consistency check
within a RANSAC scheme [14]. This local search is also
efﬁcient as the number of 3D points considered is signif-
icantly lower in the place than in the whole model. The
algorithm stops as soon as a valid pose is estimated.

Discussion.
In the work of [40], a large state-of-the-art
network for image retrieval, NetVLAD [1], is distilled into
a smaller model, MobileNetVLAD (MNV). This helps to
achieve given runtime constraints while partly retaining the
accuracy of the original model. The local matching step is
however based on SIFT [26], which is expensive to com-
pute and generates a large number of features, making this
step particularly expensive. While this method exhibits
good performance in small-scale environments, it does not
scale well to larger, denser models. Additionally, SIFT is
not competitive with recent learned features, especially un-
der large illumination changes [16, 36, 12, 32]. Lastly, a

signiﬁcant part of the computation of local and global de-
scriptors is redundant, as they are both based on the image
low-level clues. The heterogeneity of hand-crafted features
and CNN image retrieval is thus computationally subopti-
mal and could be critical on resource-constrained platforms.

4. Proposed Approach

We now show how we address these issues and achieve
improved robustness, scalability, and efﬁciency. We ﬁrst
motivate the use of learned features with a homogeneous
network structure, and then detail the architecture in Sec-
tion 4.1 and our novel training procedure in Section 4.2.

Learned features appear as a natural ﬁt for the hierar-
chical localization framework. Recent methods like Su-
perPoint [12] have shown to outperform popular baseline
like SIFT in terms of keypoint repeatability and descriptor
matching, which are both critical for localization. Some
learned features are additionally signiﬁcantly sparser than
SIFT, thus reducing the number of keypoints to be matched
and speeding up the matching step. We show in Section 5.1
that a combination of state-of-the-art networks in image re-
trieval and local features naturally achieves state-of-the-art
localization. This approach particularly excels in extremely
challenging conditions, such as night-time queries, outper-
forming competitive methods by a large margin along with
a smaller 3D model size.

While the inference of such networks is signiﬁcantly
faster than computing SIFT on GPU, it still remains a large
computational bottleneck for the proposed localization sys-
tem. With the goal of improving the ability to localize on-
line on mobile devices, we introduce here a novel neural
network for hierarchical features, HF-Net, enabling an ef-
ﬁcient coarse-to-ﬁne localization. It detects keypoints and
computes local and global descriptors in a single shot, thus
maximizing sharing of computations, but retaining perfor-
mance of a larger baseline network. We show in Figure 2 its
application within the hierarchical localization framework.

4.1. HF Net Architecture

Convolutional neural networks intrinsically exhibit a hi-
erarchical structure. This paradigm ﬁts well the joint pre-
dictions of local and global features and comes at low ad-
ditional runtime costs. The HF-Net architecture (Figure 3)
is composed of a single encoder and three heads predicting:
i) keypoint detection scores, ii) dense local descriptors and
iii) a global image-wide descriptor. This sharing of com-
putation is natural: in state-of-the-art image retrieval net-
works, the global descriptors are usually computed from the
aggregation of local feature maps, which might be useful to
predict local features.

The encoder of HF-Net is a MobileNet [39] backbone, a
popular architecture optimized for mobile inference. Sim-
ilarly to MNV [40], the global descriptor is computed by

12718

Input	
image

Keypoint

scores

SuperPoint

Decoder

Local

descriptors

Global

descriptor

Shared	
features

MobileNet (1)

MobileNet (2)

NetVLAD

Layer

Global	teacher	model

Local	teacher	model

TRAINING	ONLY

Figure 3. HF-Net generates three outputs from a single image:
a global descriptor, a map of keypoint detection scores, and dense
keypoint descriptors. All three heads are trained jointly with multi-
task distillation from different teacher networks.

a NetVLAD layer [1] on top of the last feature map of
MobileNet. For the local features, the SuperPoint [12] ar-
chitecture is appealing for its efﬁciency, as it decodes the
keypoints and local descriptors in a ﬁxed non-learned man-
ner. This is much faster than applying transposed convolu-
tions to upsample the features. It predicts dense descriptors
which are fast to sample bilinearly, resulting in a runtime
independent from the number of detected keypoints. On
the other hand, patch-based architectures like LF-Net [36]
apply a Siamese network to image patches centered at all
keypoint locations, resulting in a computational cost pro-
portional to the number of detections.

For its efﬁciency and ﬂexibility, we thus adopt the Super-
Point decoding scheme for keypoints and local descriptors.
The local feature heads branch out from the MobileNet en-
coder at an earlier stage than the global head, as a higher
spatial resolution is required to retain spatially discrimina-
tive features, local features are on a lower semantic level
than image-wide descriptors [13].

4.2. Training Process

Data scarcity.
Local and global descriptors are often
trained with metric learning using ground truth positive
and negative pairs of local patches and full images. These
ground truth correspondences are particularly difﬁcult to
obtain at the scale required to train large CNNs. While
global supervision naturally emerges from local correspon-
dences,
there is currently no such dataset that simulta-
neously i) exhibits a sufﬁcient perceptual diversity at the
global image level, e.g. with various conditions such as day,
night, seasons, and ii) contains ground truth local corre-
spondences between matching images. These correspon-
dences are often recovered from the dense depth [36] com-
puted from an SfM model [45, 46], which is intractable to
build at the scale required by image retrieval.

Data augmentation. Self-supervised methods that do not
rely on correspondences, such as SuperPoint, require heavy
data augmentation, which is key to the invariance of the lo-
cal descriptor. While data augmentation often captures well
the variations in the real world at the local level, it can break
the global consistency of the image and make the learning
of the global descriptor very challenging.

Multi-task distillation is our solution to this data problem.
We employ distillation to learn the representation directly
from an off-the-shelf trained teacher model. This alleviates
the above issues, with a simpler and more ﬂexible training
setup that allows the use of arbitrary datasets, as inﬁnite
amount of labeled data can be obtained from the inference
of the teacher network. Directly learning to predict the out-
put of the teacher network additionally eases the learning
task, allowing to directly train a smaller student network.
We note an interesting similarity with SuperPoint, whose
detector is training by bootstrapping, supervised by itself
through the different training runs. This process could also
be referred as self-distillation, and shows the effectiveness
of distillation as a practical training scheme.

The supervision of local and global features can origi-
nate from different teacher networks, resulting in a multi-
task distillation training that allows to leverage state-of-the-
art teachers. Recent advances [21] in multi-task learning
enable a student s to optimally copy all teachers t1,2,3 with-
out any manual tuning of the weights that balance the loss:

s − dg

L = e−w1 ||dg

s − dl
+ 2e−w3 CrossEntropy(ps, pt3 ) + X

2 + e−w2 ||dl

t1 ||2

t2 ||2

2

(1)

wi,

i

where dg and dl are global and local descriptors, p are key-
point scores, and w1,2,3 are optimized variables.

More generally, our formulation of the multi-task distil-
lation can be applied to any application that requires mul-
tiple predictions while remaining computationally efﬁcient,
particularly in settings where ground truth data for all tasks
is expensive to collect.
It could also be applied to some
hand-crafted descriptors deemed too compute-intensive.

5. Experiments

In this section, we present experimental evaluations of
the building blocks of HF-Net and of the network as a
whole. We want to prove its applicability to large-scale
localization problems in challenging conditions while re-
maining computationally tractable. We ﬁrst perform in Sec-
tion 5.1 a thorough evaluation of current top-performing
classical and learning-based methods for local feature de-
tection and description. Our goal is to explain how these in-
sights inﬂuenced the design choices of HF-Net presented in
Section 5.2. We then evaluate in Section 5.3 our method on
challenging large-scale localization benchmarks [42] and

12719

demonstrate the advantages of the coarse-to-ﬁne localiza-
tion paradigm. To address our real-time localization focus,
we conclude with runtime considerations in Section 5.4.

5.1. Local Features Evaluation

We start our evaluation by investigating the performance
of local matching methods under different settings on two
datasets, HPatches [3] and SfM [36], that provide dense
ground truth correspondences between image pairs for both
2D and 3D scenes.

Datasets. HPatches [3] contains 116 planar scenes con-
taining illumination and viewpoint changes with 5 image
pairs per scene and ground truth homographies. SfM is a
dataset built by [36] composed of photo-tourism collections
collected by [17, 50]. Ground truth correspondences are
obtained from dense per-image depth maps and relative 6-
DoF poses, computed using COLMAP [45]. We select 10
sequences for our evaluation and for each randomly sam-
ple 50 image pairs with a given minimum overlap. A met-
ric scale cannot be recovered with SfM reconstruction but
is important to compute localization metrics. We therefore
manually label each SfM model using metric distances mea-
sured in Google Maps.

Metrics. We compute and aggregate pairwise metrics de-
ﬁned by [12] over all pairs for each dataset. For the detec-
tors, we report the repeatability and localization error of the
keypoint locations. Both are important for visual localiza-
tion as they can impact the number of inlier matches, the re-
liability of the matches, but also the quality of the 3D model.
We compute nearest neighbor matches between descriptors
and report the mean average precision and the matching
score. The former reﬂects the ability of the method to re-
ject spurious matches. The latter assesses the quality of the
detector and the descriptor together. We also compute the
recall of pose estimation, either a homography for HPatches
or a 6-DoF pose for the SfM dataset, with thresholds of
3 pixels and 3 meters, respectively.

Methods. We evaluate the classical detectors Difference of
Gaussian (DoG) and Harris [15] and the descriptor Root-
SIFT [2]. For the learning-based methods, we evaluate
the detections and descriptors of SuperPoint [12] and LF-
Net [11]. We additionally evaluate a dense version of
DOAP [16] and the feature map conv3_3 of NetVLAD [1]
and use SuperPoint detections for both. More details are
provided in the supplementary material.

Detectors. We report the results in Table 1. Harris exhibits
the highest repeatability but also the highest localization er-
ror. Conversely, DoG is less repeatable but has the lowest
error, likely due to the multi-scale detection and pixel re-
ﬁnement. SuperPoint seems to show the best trade-off be-
tween repeatability and error.

HPatches
Rep. MLE Rep. MLE

SfM

0.307
DoG
0.535
Harris
SuperPoint 0.495
LF-Net
0.460

0.94
1.14
1.04
1.13

0.284
0.510
0.509
0.454

1.20
1.46
1.45
1.44

Table 1. Evaluation of the keypoint detectors. We report the
repeatability (rep.) and mean localization error (MLE).

(detector / descriptors) Homography MS mAP

Pose MS mAP

HPatches

SfM

Root-SIFT
LF-Net
SuperPoint
Harris / SuperPoint
SuperPoint / DOAP
SuperPoint / NetVLAD

0.681
0.629
0.810
0.669

-

0.788

0.307 0.651 0.700 0.199 0.236
0.305 0.572 0.676 0.221 0.207
0.441 0.846 0.794 0.418 0.488
0.448 0.737 0.684 0.404 0.397
0.838 0.448 0.554
0.419 0.798 0.800 0.374 0.423

-

-

Table 2. Evaluation of the local descriptors. The matching score
(MS) and mean Average Precision (mAP) are reported, in addition
to the homography correctness for HPatches and the pose accuracy
for the SfM dataset.

Descriptors. DOAP outperforms SuperPoint on all metrics
on the SfM dataset, but cannot be evaluated on HPatches as
it was trained on this dataset. NetVLAD shows good pose
estimation but poor matching precision on SfM, which is
disadvantageous when the number of keypoints is limited
or the inlier ratio important, e.g. for localization. Overall, it
stands that learned features outperform hand-crafted ones.

Interestingly, SuperPoint descriptors perform poorly
when extracted from Harris detections, although the latter
is also a corner detector with high repeatability. This hints
that learned descriptors can be highly coupled with the cor-
responding detections.

LF-Net and SIFT, both multi-scale approaches with sub-
pixel detection and patch-based description, are outper-
formed by dense descriptors like DOAP and SuperPoint. A
simple representation trained with the right supervision can
thus be more effective than a complex and computational-
heavy architecture. We note that SuperPoint requires signif-
icantly fewer keypoints to estimate a decent pose, which is
highly beneﬁcial for runtime-sensitive applications.

5.2. Implementation Details

Motivated by the results presented in Section 5.1, this
section brieﬂy introduces the design and implementation of
HF-Net. Below, we explain our choices of the distillation
teacher models, training datasets and improvements to the
baseline 2D-3D local matching.

Teacher models. We evaluate the impact of the two best
descriptors, DOAP and SuperPoint, on the localization in
Section 5.3. Results show that the latter is more robust to
day-night appearance variations, as its training set included
low-light data. We eventually chose it as the supervisor
teacher network for the descriptor head of HF-Net. The
global head is supervised by NetVLAD.

12720

Training data. In this work, we target urban environments
in both day and night conditions. To maximize the perfor-
mance of the student model on this data, we select training
data that ﬁts this distribution. We thus train on 185k im-
ages from the Google Landmarks dataset [34], containing
a wide variety of day-time urban scenes, and 37k images
from the night and dawn sequences of the Berkeley Deep
Drive dataset [54], composed of road scenes with motion
blur. We found the inclusion of night images in the training
dataset to be critical for the generalization of the global re-
trieval head to night queries. For example, a network trained
on day-time images only would easily confuse a night-time
dark sky with a day-time dark tree. We also train with pho-
tometric data augmentation but use the targets predicted on
the clean images.

Efﬁcient hierarchical localization. Sarlin et al. [40] iden-
tiﬁed the local 2D-3D matching as the bottleneck of the
pipeline. Our system signiﬁcantly improves on the efﬁ-
ciency of their approach:
i) Spurious local matches are
ﬁltered out using a modiﬁed ratio test that only applies
if the ﬁrst and second nearest neighbor descriptors cor-
respond to observations of different 3D points, similarly
to [33], thus retaining more matches in highly covisible ar-
eas. ii) Learned global and local descriptors are normalized
and matched with a single matrix multiplication on GPU.
Additional implementation details and hyperparameters are
provided in the supplementary material.

5.3. Large scale Localization

Under the light of the local evaluation, we now evalu-
ate our hierarchical localization on three challenging large-
scale benchmarks introduced by [42].

Datasets. Each dataset is composed of a sparse SfM model
built with a set of reference images. The Aachen Day-Night
dataset [43] contains 4,328 day-time database images from
a European old town, and 824 and 98 queries taken in day
and night conditions respectively. The RobotCar Seasons
dataset [28] is a long-term urban road dataset that spans
multiple city blocks. It is composed of 20,862 overcast ref-
erence images and a total of 11,934 query images taken in
multiple conditions, such as sun, dusk, and night. Lastly,
the CMU Seasons dataset [4] was recorded in urban and
suburban environments over a course of 8.5 km. It contains
7,159 reference images and 75,335 query images recorded
in different seasons. This dataset is of signiﬁcantly lower
scale as the queries are localized against isolated submod-
els containing around 400 images each.

Large scale model construction. SfM models built with
COLMAP [45, 46] using RootSIFT are provided by the
dataset authors. These are however not suitable when local-
izing with methods based on different feature detectors. We
thus build new 3D models with keypoints detected by Su-

perPoint and HF-Net. The process is as follows: i) we per-
form 2D-2D matching between reference frames using our
features and an initial ﬁltering ratio test; ii) the matches are
further ﬁltered within COLMAP using two-view geometry;
iii) 3D points are triangulated using the provided ground
truth reference poses. Those steps result in a 3D model with
the same scale and reference frame as the original one.

Comparison of model quality. The HF-Net Aachen model
contains fewer 3D points (685k vs 1,899k for SIFT) and
fewer 2D keypoints per image (2,576 vs 10,230 for SIFT).
However, a larger ratio of the original 2D keypoints is
matched (33.8% vs 18.8% for SIFT), and each 3D point is
on average observed from more reference images. Match-
ing a query keypoint against this model is thus more likely
to succeed, showing that our feature network produces 3D
models more suitable for localization.

Methods. We ﬁrst evaluate our hierarchical localization
based on learned features extracted by NetVLAD [1] and
SuperPoint [12]. Named NV+SP, it uses the most pow-
erful predictors available. We then evaluate a more efﬁ-
cient localization with global descriptors and local features
computed by HF-Net. We also consider several localiza-
tion baselines evaluated by the benchmark authors. Active
Search (AS) [41] and City Scale Localization (CSL) [48]
are both 2D-3D direct matching methods representing
the current state-of-the-art in terms of accuracy. Den-
seVLAD [52] and NetVLAD [1] are image retrieval ap-
proaches that approximate the pose of the query by the
pose of the top retrieved database image. The recently-
introduced Semantic Match Consistency (SMC) [51] relies
on semantic segmentation for outlier rejection. It assumes
known gravity direction and camera height and, for the
RobotCar dataset, was trained on the evaluation data using
ground truth semantic labels. We introduce an additional
baseline, NV+SIFT, that performs hierarchical localization
with RootSIFT as local features, and is an upper bound to
the MNV+SIFT method of [40].

Results. We report the pose recall at position and orien-
tation thresholds different for each sequence, as deﬁned by
the benchmark [42]. Table 3 shows the localization results
for the different methods. Cumulative plots for the three
most challenging sequences are presented in Figure 4.

Localization with NV+SP. On the Aachen dataset, NV+SP
is competitive on day-time queries and outperforms all
methods for night-time queries, where the performance
drop w.r.t. the day is signiﬁcantly smaller than for direct
matching methods, which suffer from the increased ambi-
guity of the matches. On the RobotCar dataset, it performs
similarly to other methods on the dusk sequence, where
the accuracy tends to saturate. In the more challenging se-
quences, image retrieval methods tend to work better than
direct matching approaches, but are far outperformed by

12721

Aachen

day

night

distance [m]
orient. [deg]

.25/.50/5.0

0.5/1.0/5.0

2/5/10

2/5/10

RobotCar

dusk

.25/.50/5.0

2/5/10

sun

.25/.50/5.0

2/5/10

night

.25/.50/5.0

2/5/10

night-rain
.25/.50/5.0

2/5/10

CMU

urban

.25/.50/5.0

2/5/10

suburban
.25/.50/5.0

2/5/10

57.3 / 83.7 / 96.6 19.4 / 30.6 / 43.9
52.3 / 80.0 / 94.3 24.5 / 33.7 / 49.0
0.0 / 0.1 / 22.8 0.0 / 2.0 / 14.3
0.0 / 0.2 / 18.9 0.0 / 2.0 / 12.2

AS
CSL
DenseVLAD
NetVLAD
SMC
82.8 / 88.1 / 93.1 30.6 / 43.9 / 58.2
NV+SIFT
NV+SP (ours) 79.7 / 88.0 / 93.7 40.8 / 56.1 / 74.5
HF-Net (ours) 75.7 / 84.3 / 90.9 40.8 / 55.1 / 72.4

-

-

44.7 / 74.6 / 95.9
56.6 / 82.7 / 95.9
10.2 / 38.8 / 94.2
7.4 / 29.7 / 92.9

25.0 / 46.5 / 69.1
28.0 / 47.0 / 70.4
5.7 / 16.3 / 80.2
5.7 / 16.5 / 86.7

0.5 / 1.1 / 3.4
0.2 / 0.9 / 5.3
0.9 / 3.4 / 19.9
0.2 / 1.8 / 15.5
(53.8 / 83.0 / 97.7) (46.7 / 74.6 / 95.9) (6.2 / 18.5 / 44.3)
4.1 / 9.1 / 24.4
55.6 / 83.5 / 95.3
6.6 / 17.1 / 32.2
54.8 / 83.0 / 96.2
53.9 / 81.5 / 94.2
2.7 / 6.6 / 15.8

46.3 / 67.4 / 90.9
51.7 / 73.9 / 92.4
48.5 / 69.1 / 85.7

55.2 / 60.3 / 65.1 20.7 / 25.9 / 29.9
1.4 / 3.0 / 5.2
36.7 / 42.0 / 53.1 8.6 / 11.7 / 21.1
0.9 / 4.3 / 9.1
1.1 / 5.5 / 25.5
22.2 / 48.7 / 92.8 9.9 / 26.6 / 85.2
17.4 / 40.3 / 93.2 7.7 / 21.0 / 80.5
0.5 / 2.7 / 16.4
(8.0 / 26.4 / 46.4) 75.0 / 82.1 / 87.8 44.0 / 53.6 / 63.7
63.9 / 71.9 / 92.8 28.7 / 39.0 / 82.1
2.3 / 10.2 / 20.5
91.7 / 94.6 / 97.7 74.6 / 81.6 / 91.4
5.2 / 17.0 / 26.6
4.7 / 16.8 / 21.8
90.4 / 93.1 / 96.1 71.8 / 78.2 / 87.1

Table 3. Evaluation of the localization on the Aachen Day-Night, RobotCar Seasons, and CMU Seasons datasets. We report the recall [%]
at different distance and orientation thresholds and highlight for each of them the best and second-best methods. X+Y denotes hierarchical
localization with X (Y) as global (local) descriptors. SMC is excluded from the comparison for RobotCar as it uses extra semantic data.

Figure 4. Cumulative distribution of position errors for the Aachen night (left), RobotCar night-all (center) and CMU suburban (right)
datasets. On Aachen, HF-Net and NV+SP have similar performance and outperform approaches based on global retrieval and on feature
matching. On RobotCar, HF+Net performs worse than NV+SP, which suggests a limitation of the distillation process. On CMU, the
hierarchical localization shows a signiﬁcant boost over other methods, particularly for small distance thresholds.

NV+SP in both ﬁne- and coarse-precision regimes. On the
difﬁcult CMU dataset, NV+SP achieves an outstanding ro-
bustness compared to all baselines, including the most re-
cent SMC. Overall, NV+SP sets a new state-of-the-art on
the CMU dataset and on the challenging sequences of the
Aachen and RobotCar datasets. The superior performance
in both ﬁne- and coarse-precision regimes shows that our
approach is both more accurate and more robust.

Figure 5. In the RobotCar night sequences, HF-Net is sig-
niﬁcantly worse than NV+SP. We attribute this to the poor
performance of the distilled global descriptors on blurry
low-quality images. This highlights a clear limitation of our
approach: on large, self-similar environment, the model ca-
pacity of HF-Net becomes the limiting factor. A complete
failure of the global retrieval directly translates into a failure
of the hierarchical localization.

Comparison with NV+SIFT. We observe that NV+SIFT
consistently outperforms AS and CSL, although all meth-
ods are based on the same RootSIFT features. This shows
that our hierarchical approach with a coarse initial prior
brings signiﬁcant beneﬁts, especially in challenging con-
ditions where image-wide information helps disambiguate
matches. It thus provides a better outlier rejection than com-
plex domain-speciﬁc heuristics used in AS and CSL. The
superiority of NV+SP highlights the simple gain of learned
features like SuperPoint. On the Aachen night and Robot-
Car dusk sequences, which are the easiest ones, NV+SIFT
performs marginally better than NV+SP for the ﬁne thresh-
old. This is likely due to the lower localization accuracy
of the SuperPoint keypoints, as highlighted in Section 5.1,
since DoG performs a subpixel reﬁnement.

Localization with HF-Net. On most sequences, HF-Net
performs similarly to its upper bound NV+SP, with a recall
drop of 2.6% on average. We show qualitative results in

Distance thresh. NV+SP NV+HF-Net NV+DOAP HF-Net

Day

Night

0.25m
0.5m
5m
0.5m
1m
5m

79.7
88.0
93.7
40.8
56.1
74.5

81.2
88.2
94.2
40.8
56.1
76.5

80.0
88.5
93.3
34.7
52.0
72.4

75.7
84.3
90.9
40.8
55.1
72.4

Table 4. Ablation study on the Aachen Day-Night dataset. We
report the recall [%] of the hierarchical localization with diffrent
gloabal descriptors (NetVLAD and HF-Net) and local features
(SuperPoint, DOAP, and HF-Net).

Ablation study.
In Table 4, we evaluate the inﬂuence
of different predictors within the hierarchical localization
framework. Comparing NV+SP with NV+HF, we note that
local HF-Net features perform better than the SuperPoint
model that was used to train them. This demonstrates the
beneﬁts of multi-task distillation, where the supervision sig-
nal from the global teacher can improve intermediate fea-
tures and help local descriptors. We also observe that the lo-
calization with DOAP is signiﬁcantly worse at night, which

12722

Hierarchical localization. Timings of NV+SP and HF-Net
show that our coarse-to-ﬁne approach scales well to large
environments. The global search is fast, and only depends
on the number of images used to build the model. It success-
fully reduces the set of potential candidate correspondences
and enables a tractable 2D-3D matching. This strongly de-
pends on the SfM model – the denser the covisibility graph
is, the more 3D points are retrieved and matched per prior
frame, which increases the runtime. NV+SIFT is there-
fore prohibitively slow, as its SfM model is much denser,
especially on Aachen. NV+SP signiﬁcantly improves on
it, as the sparser SfM model yield clusters with fewer 3D
points. The inference of NetVLAD and SuperPoint how-
ever accounts for 75% of its runtime, and is thus, as pre-
viously mentioned, the bottleneck. HF-Net mitigates this
issues with an inference 7 times faster.

Existing approaches. CSL and SMC are not listed in
Table 5 as they both require several tens of seconds per
query, and are thus three orders of magnitude slower than
our fastest method. AS improves on this, but is still slower,
especially in case of a low success rate, such as on Robot-
Car night. Overall, our localization system based on HF-
Net can run at 20 FPS on very large-scale environments. It
is 10 times faster than AS, designed for efﬁciency, and is
much more accurate on all datasets.

6. Conclusion

In this paper, we have presented a method for visual lo-
calization that is at the same time robust, accurate, and runs
in real-time. Our system follows a coarse-to-ﬁne localiza-
tion paradigm. First, it performs a global image retrieval
to obtain a set of database images, which are subsequently
clustered into places using the covisibility graph of a 3D
SfM model. We then perform local 2D-3D matching within
the candidate places to obtain an accurate 6-DoF estimate
of the camera pose.

A version of our method is based on existing neural net-
works for image retrieval and feature matching.
It out-
performs state-of-the-art localization approaches on several
large-scale benchmarks that include day-night queries and
substantial appearance variations across weather conditions
and seasons. We then improve its efﬁciency by proposing
HF-Net, a novel CNN that computes keypoints as well as
global and local descriptors in a single shot. We demon-
strate the effectiveness of multitask distillation to train it in
a ﬂexible manner while retaining the original performance.
The resulting localization systems runs at more than 20 FPS
at large scale and offers an unparalleled robustness in chal-
lenging conditions.

Acknowledgements. We thank the reviewers for their valuable
comments, Torsten Sattler for helping to evaluate the localization,
and Eduard Trulls for providing support for the SfM dataset.

12723

Figure 5. Successful localization with HF-Net on the Aachen
Day-Night dataset. We show two queries (left) and the retrieved
database images with the most inlier matches (right).

might be due to the complex augmentation schemes Su-
perPoint is based on. Finally, the comparison of HF-Net
with NV+HF-Net reveals that HF-Net global descriptors
have a somewhat limited capacity compared to the original
NetVLAD and are limiting the performance.

5.4. Runtime Evaluation

As our propose localization solution was developed
keeping the computational constraints in mind, we analyze
its runtime and compare it with baselines presented in Sec-
tion 5.3. These were measured on a PC equipped with an
Intel Core i7-7820X CPU (3.60GHz) CPU, 32GB of RAM
and an NVIDIA GeForce GTX 1080 GPU. Table 5 presents
the detailed timings.

Datasets Methods

Features Global Covis. Local

n
e
h
c
a
A

r
a
C
t
o
b
o
R

Day

Night

Dusk

AS

263

NV+SIFT 92+263
NV+SP
92+26
HF-Net

NV+SIFT 92+263
NV+SP
92+26
HF-Net

NV+SIFT 92+189
NV+SP
92+26
HF-Net

15
263

15
189

15
189

AS

AS

AS

Night

NV+SIFT 92+189
NV+SP
92+26
HF-Net

15

-
7
7
7
-
7
7
7
-
13
13
13
-
13
13
13

-
8
5
5
-
8
5
5
-
3
1
1
-
3
1
1

29
9
9

PnP Total
375
1356
148
45
395
1655
158
55
472
575
139
36

56
18
18

14
4
4

112

1220

9
9

132

1492

10
10

283

264

3
3

1021

389

6
6

149
38
38

1210
835
176
73

Table 5. Timings [ms] for the different steps of hierarchical local-
ization: feature extraction, global search, covisibility clustering,
local matching, and pose estimation with PnP. Feature extraction
with SIFT or CNN and matching of learned descriptors are per-
formed on the GPU, and other operations on the CPU. We high-
light the fastest method for each sequence. Localizing with HF-
Net is 10 times faster than with AS, the fastest method available.

References

[1] Relja Arandjelovi´c, Petr Gronat, Akihiko Torii, Tomas Pa-
jdla, and Josef Sivic. NetVLAD: CNN architecture for
weakly supervised place recognition.
In CVPR, 2016. 2,
3, 4, 5, 6

[2] Relja Arandjelovi´c and Andrew Zisserman. Three things ev-
eryone should know to improve object retrieval. In CVPR,
2012. 5

[3] Vassileios Balntas, Karel Lenc, Andrea Vedaldi, and Krys-
tian Mikolajczyk. HPatches: A benchmark and evaluation of
handcrafted and learned local descriptors. In CVPR, 2017. 5

[4] Aayush Bansal, Hernan Badino, and Daniel Huber. Under-
standing how camera conﬁguration and environmental con-
ditions affect appearance-based localization. In IEEE Intel-
ligent Vehicles (IV), 2014. 6

[5] Ioan Andrei Barsan, Shenlong Wang, Andrei Pokrovsky, and
Raquel Urtasun. Learning to localize using a lidar intensity
map. In Conference on Robot Learning (CoRL), 2018. 1

[6] Samarth Brahmbhatt, Jinwei Gu, Kihwan Kim, James Hays,
and Jan Kautz. Geometry-aware learning of maps for camera
localization. In CVPR, 2018. 2

[7] Mathias B¨urki, Lukas Schaupp, Marcin Dymczyk, Renaud
Dub´e, Cesar Cadena, Roland Siegwart, and Juan Nieto.
Vizard: Reliable visual localization for autonomous vehicles
in urban outdoor environments. arXiv:1902.04343, 2019. 1

[8] Michael Calonder, Vincent Lepetit, Christoph Strecha, and
Pascal Fua. BRIEF: Binary robust independent elementary
features. In ECCV, 2010. 1, 2

[9] Zhao Chen, Vijay Badrinarayanan, Chen-Yu Lee, and An-
drew Rabinovich. GradNorm: Gradient normalization for
adaptive loss balancing in deep multitask networks. In ICML,
2018. 2

[10] Christopher B Choy, JunYoung Gwak, Silvio Savarese, and
Manmohan Chandraker. Universal Correspondence Net-
work. In NIPS, 2016. 2

[11] Titus Cieslewski, Siddharth Choudhary, and Davide Scara-
muzza. Data-efﬁcient decentralized visual SLAM. In ICRA,
2018. 5

[12] Daniel DeTone, Tomasz Malisiewicz, and Andrew Rabi-
novich. SuperPoint: Self-supervised interest point detection
and description. In Workshop on Deep Learning for Visual
SLAM at CVPR, 2018. 1, 2, 3, 4, 5, 6

[13] Mohammed E. Fathy, Quoc-Huy Tran, M. Zeeshan Zia, Paul
Vernaza, and Manmohan Chandraker. Hierarchical metric
learning and matching for 2d and 3d geometric correspon-
dences. In ECCV, 2018. 1, 2, 4

[14] Martin A Fischler and Robert C Bolles. Random sample
consensus: a paradigm for model ﬁtting with applications to
image analysis and automated cartography. Communications
of the ACM, 24(6):381–395, 1981. 3

[15] Chris Harris and Mike Stephens. A combined corner and
edge detector. In Alvey vision conference, volume 15, pages
10–5244, 1988. 5

[16] Kun He, Yan Lu, and Stan Sclaroff. Local descriptors opti-

mized for average precision. In CVPR, 2018. 2, 3, 5

[17] Jared Heinly, Johannes L Schonberger, Enrique Dunn, and
Jan-Michael Frahm. Reconstructing the World in Six Days.
In CVPR, 2015. 5

[18] Geoffrey Hinton, Oriol Vinyals, and Jeff Dean. Distilling the
knowledge in a neural network. arXiv:1503.02531, 2015. 2
[19] Arnold Irschara, Christopher Zach, Jan-Michael Frahm, and
Horst Bischof. From structure-from-motion point clouds to
fast location recognition. In CVPR, 2009. 2

[20] Alex Kendall, Roberto Cipolla, et al. Geometric loss func-
In

tions for camera pose regression with deep learning.
CVPR, 2017. 2

[21] Alex Kendall, Yarin Gal, and Roberto Cipolla. Multi-task
learning using uncertainty to weigh losses for scene geome-
try and semantics. In CVPR, 2018. 2, 4

[22] Georg Klein and David Murray. Parallel tracking and map-
ping for small ar workspaces. In International Symposium
on Mixed and Augmented Reality. IEEE Computer Society,
2007. 1

[23] Laurent Kneip, Davide Scaramuzza, and Roland Siegwart.
A novel parametrization of the perspective-three-point prob-
lem for a direct computation of absolute camera position and
orientation. In CVPR, 2011. 3

[24] Stefan Leutenegger, Margarita Chli, and Roland Y Siegwart.
BRISK: Binary robust invariant scalable keypoints. In ICCV,
2011. 2

[25] Liu Liu, Hongdong Li, and Yuchao Dai. Efﬁcient global 2d-
3d matching for camera localization in a large-scale 3d map.
In CVPR, 2017. 2

[26] David G Lowe. Distinctive image features from scale-
invariant keypoints. International Journal of Computer Vi-
sion, 60(2):91–110, 2004. 1, 3

[27] Simon Lynen, Torsten Sattler, Michael Bosse, Joel A Hesch,
Marc Pollefeys, and Roland Siegwart. Get out of my lab:
Large-scale, real-time visual-inertial localization.
In RSS,
2015. 1, 2

[28] Will Maddern, Geoff Pascoe, Chris Linegar, and Paul New-
man. 1 Year, 1000km: The Oxford RobotCar Dataset. In-
ternational Journal of Robotics Research, 36(1):3–15, 2017.
6

[29] Colin McManus, Winston Churchill, Will Maddern, Alexan-
der D Stewart, and Paul Newman. Shady dealings: Robust,
long-term visual localisation using illumination invariance.
In ICRA, 2014. 1

[30] Sven Middelberg, Torsten Sattler, Ole Untzelmann, and Leif
Kobbelt. Scalable 6-DOF localization on mobile devices. In
ECCV, 2014. 1, 2

[31] Michael J Milford and Gordon F Wyeth. Seqslam: Visual
route-based navigation for sunny summer days and stormy
winter nights. In ICRA, 2012. 1

[32] Anastasiia Mishchuk, Dmytro Mishkin, Filip Radenovic,
and Jiri Matas. Working hard to know your neighbor’s mar-
gins: Local descriptor learning loss. In NIPS, 2017. 1, 3

[33] Dmytro Mishkin, Jiri Matas, and Michal Perdoch. Mods:
Fast and robust method for two-view matching. Computer
Vision and Image Understanding, 141:81–93, 2015. 6

[34] Hyeonwoo Noh, Andre Araujo, Jack Sim, Tobias Weyand,
and Bohyung Han. Large-scale image retrieval with attentive
deep local features. In CVPR, 2017. 2, 6

12724

[35] David Novotny, Samuel Albanie, Diane Larlus, and Andrea
Vedaldi. Self-supervised learning of geometrically stable
features through probabilistic introspection. In CVPR, 2018.
2

[36] Yuki Ono, Eduard Trulls, Pascal Fua, and Kwang Moo Yi.
LF-Net: Learning local features from images. In NeurIPS,
2018. 1, 2, 3, 4, 5

[37] J. Philbin, O. Chum, M. Isard, J. Sivic, and A. Zisserman.
Lost in quantization: Improving particular object retrieval in
large scale image databases. In CVPR, 2008. 2

[52] Akihiko Torii, Relja Arandjelovi´c, Josef Sivic, Masatoshi
Okutomi, and Tomas Pajdla. 24/7 place recognition by view
synthesis. In CVPR, 2015. 2, 6

[53] Tobias Weyand, Ilya Kostrikov, and James Philbin. PlaNet
- photo geolocation with convolutional neural networks. In
ECCV, 2016. 2

[54] Fisher Yu, Wenqi Xian, Yingying Chen, Fangchen Liu, Mike
Liao, Vashisht Madhavan, and Trevor Darrell. Bdd100k: A
diverse driving video database with scalable annotation tool-
ing. arXiv:1805.04687, 2018. 6

[38] Ignacio Rocco, Mircea Cimpoi, Relja Arandjelovi´c, Akihiko
Torii, Tomas Pajdla, and Josef Sivic. Neighbourhood con-
sensus networks. In NeurIPS, 2018. 2

[55] Xiangyu Zhang, Xinyu Zhou, Mengxiao Lin, and Jian Sun.
Shufﬂenet: An extremely efﬁcient convolutional neural net-
work for mobile devices. In CVPR, 2018. 2

[39] Mark Sandler, Andrew Howard, Menglong Zhu, Andrey Zh-
inverted

moginov, and Liang-Chieh Chen. MobileNetV2:
residuals and linear bottlenecks. In CVPR, 2018. 2, 3

[56] Barret Zoph, Vijay Vasudevan, Jonathon Shlens, and Quoc V
Le. Learning transferable architectures for scalable image
recognition. In CVPR, 2018. 2

[40] P.-E. Sarlin, F. Debraine, M. Dymczyk, R. Siegwart, and C.
Cadena. Leveraging deep visual descriptors for hierarchi-
cal efﬁcient localization. In Conference on Robot Learning
(CoRL), 2018. 1, 2, 3, 6

[41] Torsten Sattler, Bastian Leibe, and Leif Kobbelt. Efﬁcient
& effective prioritized matching for large-scale image-based
localization. IEEE PAMI, 39(9):1744–1756, 2017. 1, 2, 3, 6
[42] Torsten Sattler, Will Maddern, Carl Toft, Akihiko Torii,
Lars Hammarstrand, Erik Stenborg, Daniel Safari, Masatoshi
Okutomi, Marc Pollefeys, Josef Sivic, Fredrik Kahl, and
Tomas Pajdla. Benchmarking 6DOF outdoor visual local-
ization in changing conditions. In CVPR, 2018. 2, 4, 6

[43] Torsten Sattler, Tobias Weyand, Bastian Leibe, and Leif
Kobbelt. Image retrieval for image-based localization revis-
ited. In CVPR, 2008. 6

[44] Torsten Sattler, Qunjie Zhou, Marc Pollefeys, and Laura
Leal-Taixe. Understanding the limitations of cnn-based ab-
solute camera pose regression. In CVPR, 2019. 2

[45] Johannes Lutz Sch¨onberger and Jan-Michael Frahm.

Structure-from-motion revisited. In CVPR, 2016. 4, 5, 6

[46] Johannes Lutz Sch¨onberger, Enliang Zheng, Marc Pollefeys,
and Jan-Michael Frahm. Pixelwise view selection for un-
structured multi-view stereo. In ECCV, 2016. 4, 6

[47] Ozan Sener and Vladlen Koltun. Multi-task learning as

multi-objective optimization. In NeurIPS, 2018. 2

[48] Linus Sv¨arm, Olof Enqvist, Fredrik Kahl, and Magnus Os-
karsson. City-scale localization for cameras with known ver-
tical direction. IEEE PAMI, 39(7):1455–1461, 2017. 1, 2, 3,
6

[49] Hajime Taira, Masatoshi Okutomi, Torsten Sattler, Mircea
Cimpoi, Marc Pollefeys, Josef Sivic, Tomas Pajdla, and Ak-
ihiko Torii.
InLoc: Indoor visual localization with dense
matching and view synthesis. In CVPR, 2018. 1, 2

[50] Bart Thomee, David A Shamma, Gerald Friedland, Ben-
jamin Elizalde, Karl Ni, Douglas Poland, Damian Borth, and
Li-Jia Li. YFCC100M: The new data in multimedia research.
arXiv:1503.01817, 2015. 5

[51] Carl Toft, Erik Stenborg, Lars Hammarstrand, Lucas Brynte,
Marc Pollefeys, Torsten Sattler, and Fredrik Kahl. Seman-
tic match consistency for long-term visual localization.
In
ECCV, 2018. 1, 2, 6

12725

