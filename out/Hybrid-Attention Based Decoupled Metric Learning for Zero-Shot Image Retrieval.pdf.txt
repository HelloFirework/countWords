Hybrid-Attention based Decoupled Metric Learning for Zero-Shot Image

Retrieval

Binghui Chen1, 2, Weihong Deng1∗

1Beijing University of Posts and Telecommunications

2AI Labs, Didi Chuxing, Beijing 100193, China
chenbinghui@bupt.edu.cn, whdeng@bupt.edu.cn

Abstract

In zero-shot image retrieval (ZSIR) task, embedding
learning becomes more attractive, however, many meth-
ods follow the traditional metric learning idea and omit
the problems behind zero-shot settings. In this paper, we
ﬁrst emphasize the importance of learning visual discrim-
inative metric and preventing the partial/selective learn-
ing behavior of learner in ZSIR, and then propose the De-
coupled Metric Learning (DeML) framework to achieve
these individually. Instead of coarsely optimizing an uni-
ﬁed metric, we decouple it into multiple attention-speciﬁc
parts so as to recurrently induce the discrimination and ex-
plicitly enhance the generalization. And they are mainly
achieved by our object-attention module based on random
walk graph propagation and the channel-attention module
based on the adversary constraint, respectively. We demon-
strate the necessity of addressing the vital problems in ZSIR
on the popular benchmarks, outperforming the state-of-the-
art methods by a signiﬁcant margin. Code is available at
http://www.bhchen.cn
1. Introduction

In zero-shot image retrieval (ZSIR), the model is re-
quired to learn embedding from the seen classes and
then to be capable of utilizing the learned knowledge
to distinguish the unseen classes without any attributes
or semantic information. Most existing works adopt
deep embedding (metric) learning and dedicate to explor-
ing powerful loss functions, such as pair-based methods
[33, 43, 29, 23, 32, 2, 35], and hard-example mining strate-
gies [16, 39, 29, 32], etc. These ideas can be summarised as:
learn a good matric on the seen categories so as to boost the
performance on the unseen ones. However, in fact, they ne-
glect the existence and signiﬁcance of some vital problems
to ZSIR, thus are easily stuck in the particular data distri-
bution and knowledge zone of the seen training set, some
helpful knowledge for unseen classes may have been left

∗Corresponding author

Figure 1: Differences between (a) uniﬁed metric learning and (b) DeML. Our DeML
decouples the uniﬁed representations into multiple attention-speciﬁc learners so as to
encourage the discrimination and generalization of the holistic metric.

out with a high probability, as a result, their performances
are almost on par with each other and unsatisfactory.

Speciﬁcally, in ZSIR, the ideas above are actually un-
reasonable as the discrimination and generalization abili-
ties of the learned metric are highly inﬂuenced by the fol-
lowing two aspects: (1) the undiscriminating visual input,
which contains much noisy information (it is hard to know
where should be focused on), resulting in poor descriptors
and inducing difﬁculty in distinguishing the unseen classes.
In another word, undiscriminating visual input deteriorates
the discrimination of features. (2) partial/selective learning
behavior of deep models[3], speciﬁcally, for a functional
learner parameterized by CNN, when given an arbitrary in-
put, it will selectively learn partial attributes knowledge that
are the easiest ones to decrease the current training empir-
ical risk over the seen categories, instead of learning all-
sided details and information, thus yielding over-ﬁtting on
seen categories and generalizing worse to the unseen ones.
For example on birds, if the head knowledge is enough to
distinguish the training seen classes, the deep model will
only focus on the head and ignore the other body parts
like back, foot and wing, while when testing on the un-
seen classes (which have similar head features but differ-
ent wing features), the trained model will easily fail to dis-
tinguish them1. This partial learning behavior sometimes

1Since in zero-shot settings, the unseen classes have no intersection

with the seen classes, this partial learning behavior is common.

2750

is one reason for neural redundancy, since all the neurons
only focus on the certain easy knowledge, causing that the
performance doesn’t increase much with the feature dimen-
sion. Moreover, when optimizing an uniﬁed metric as in the
aforementioned methods (as in Fig.1.(a)), these two issues
are commonly mixed with each other and jointly impede the
learning of representation, and without explicit and helpful
guidance, the poor discrimination and generalization char-
acteristics of features are greatly exacerbated regardless of
the efﬁcacy of objective function and hard-sample mining
strategy. And most ZSIR works ignore the importance of
learning both discriminative and robust discriminators. To
this end, proposing knowledge-preserving and discrimina-
tive metric learning framework remains important.

In this paper, inspired by the idea of “divide and rule”,
we propose the Decoupled Metric Learning (DeML), a
novel and generally applicable framework, to alleviate the
above problems by decoupling the embedding representa-
tion into multiple attention-speciﬁc learners so as to encour-
age its discrimination and generalization in an explicit man-
ner, as shown in Fig.1.(b). Moreover, equipping each learn-
ers with the particular attention tasks will further alleviate
the neural redundancy and give chances of performance im-
provement. Our DeML is a model-agnostic learning frame-
work, and different from the existing metric learning works,
it has no need to mine hard samples or construct elaborate
sample-pairs. The main contributions are as follows:

• We provide insights of two vital problems to ZSIR that undis-
criminating visual input and partial/selective learning behavior of
learner will impede the discrimination and generalization of the
metric, resp. And propose DeML, a hybrid-attention based decou-
pling method, to address these challenges individually.

• DeML decouples the commonly used uniﬁed metric into
object-attention root-learners and channel-attention sub-learners,
aiming at recurrently inducing the discrimination and explicitly
promoting the diversity together with the generalization, resp.

• The decoupled learners are supported by the corresponding
random walk inferred object-attention modules (OAM)2 and the
adversarial channel-attention modules (CAM). They can be easily
performed as the drop-in parts and are model–agnostic.

• We demonstrate the necessity to learn discriminative and ro-
bust metric via our decoupling idea. Extensive experiments have
been performed on several challenging datasets for ZSIR, includ-
ing CUB [36], CARS [15], Stanford Online Products [23] and In-
Shop [18]. Our DeML achieves state-of-the-art performances and
surpasses other methods by a signiﬁcant margin.

2. Related Work

Zero-shot learning: ZSL has been widely studied in
many tasks, such as image classiﬁcation [17, 1, 8, 44],
hashing[31], video recognition [6] etc. However, different
from these ZSL tasks that are capable of exploiting the ex-
tra auxiliary supervision signals of unseen classes (e.g. se-

2Some works call it spatial-attention.

mantic word embedding of class name and explicit attribute
information), our DeML concentrates on a more general
version of zero-shot image retrieval (ZSIR), where there
are only similarity labels spq ∈ {0, 1} available. There-
fore, how to capture the discriminative and all-sided infor-
mation only from the input image is the mainstay of this
task.

Deep embedding/metric learning: With only spq avail-
able, many works seek to exploring deep metric learning
for ZSIR task. For example, sampling-Matters [39] pro-
poses distance weighted sampling strategy. Proxy-NCA
[21] explains why popular classiﬁcation loss works from
a proxy-agent view, and its implementation is very similar
with Softmax. ALMN [2] proposes to optimize an adap-
tive large margin objective via the generated virtual points
instead of mining hard-samples. However, all the above
methods are to tackle with the uniﬁed metric by designing
losses and exploring sample-mining strategies, thus suffer
from the aforementioned issues easily. Additionally, HDC
[43] employs the cascaded models and selects hard-samples
from different levels and models. BIER loss [24, 25] adopts
the online gradients boosting methods. Although these two
methods try to improve the performances by resorting to the
ensemble idea, they can only learn from the undiscriminat-
ing input and also suffer from the partial learning behavior,
as a result, the discrimination and generalization of holistic
features are still limited.

Attention mechanism: Attention serves as a tool to bias
the allocation of available resources towards the most infor-
mative parts of an input. Many are implemented in combi-
nation with a gating mechanism (e.g. softmax or sigmoid)
and are widely applied in many tasks, e.g. image caption-
ing [4, 40], lip reading [5], image classiﬁcation [12, 37, 7].
Schwartz et at. [30] adopt high order attention modules for
VQA. Fu et at. [7] propose to learn an attention network so
as to produce the attention proposals, while, it is optimized
in a two-stage manner, i.e. iteratively train the embedding
model and attention model. We emphasize that our DeML
is a hybrid-attention system. First, it adopts a parameter-
free object-attention module, which is performed by ran-
dom walk graph propagation and can be directly plugged
into any bedrock CNNs without training. Second, differ-
ent from [12, 4] where the channel-attention operations are
cascaded, i.e. only the most informative signal will be
captured, our DeML is equipped with a series of channel-
attention modules in parallelism, which are optimized by
the adversary module and insist to learn various combina-
tions of attributes simultaneously and to capture knowledge
as much as possible.

3. Decoupled Metric Learning

As discussed in Sec.1, in zero-shot setting, simply opti-
mizing an uniﬁed representation like in most existing works

2751

Figure 2: The framework of our DeML. J indicates the joint operation of cropping and zooming. The FC layer is ﬁrst decoupled into two object-attention
root-learners(dashed rectangle and ellipse) for coarse and ﬁner scale, resp. Then, each root-learner is further decoupled into three channel-attention sub-
learners (best viewed in colors). Each (root or sub) learner is supported by the corresponding attention module (OAM or CAM). The parameters to be shared
across streams have been annotated by ’shared’. (F N et+GN et) is the whole GooglenetV1, and we use F N eti, GN eti to indicate the nets at scale i.
Details of the adversary net is in Fig.3.(c)

wouldn’t guide the learning of discriminative and robust
metric as a joint result of (1) undiscriminating visual input
and (2) the partial/selective learning behavior3.

Naturally motivated by “divide and rule”, the intuitive
solution is to decouple the single representation into a se-
ries of artiﬁcially deﬁned learners so as to explicitly en-
courage different learners to attend to different latent fea-
tures and improve the holistic feature’s discrimination and
diversity. Moreover, many research works point out that at-
tention mechanism is a crucial component connecting data
embeddings with decision making modules, and diverse at-
tentional cues allows the learning of various knowledge. We
follow this inspiring idea and recast the above solution as
hybrid-attention learning by decoupling the original uniﬁed
metric into several attention-speciﬁc parts, each part is fol-
lowed by the corresponding fc learner, i.e. object-attention
(OA) root-learner and channel-attention (CA) sub-learner.
The overall framework of DeML is illustrated in Fig.2 (for
clarity, we depict the network with only two OA root-
learners and three CA sub-learners under each root-learner
as an example).

Speciﬁcally, for the i-th scale,

i.e. Googlenet-V1 [34] (we decompose it

consists of three different components:
CNN,
(Conv1−P ool3)

the embedding part
(1) the bedrock
into
the object-attention
module (OAM) is to incrementally pinpoint the informa-
tive object-based region proposals for discriminative fea-
ture learning, and (3) the channel-attention module (CAM)
is to concurrently produce diverse attribute-based channel-

(Incep4−P ool5)

GN et

F N et

(2)

),

attention proposal cap(i,j). When given an image xn, we
will directly use it for the ﬁrst scale input and employ its
cropped&zoomed version for the next scale input. At the
i-th scale, the input will ﬁrst be encoded by FNeti and then
fed into multiple CAMs. The produced channel-attention
proposals cap(i,j) will then be encoded by the correspond-
ing subsequent GNeti and CA sub-learners. All the CA sub-
learners at the same scale constitute one OA root-learner.
We now deﬁne OAi, CA(i,j) as the corresponding learners
and OAi(·), CA(i,j)(·) as the corresponding encoding func-
tions, then give the holistic feature representation ϕ[xn] as:

ϕ[xn] = {OA1[x1

n]; OA2[x2

n];

· · · }

(1)

where OAi[·] = {· · · ; CA(i,j)[·];

· · · }

n

by OAMi−1, and x1

where the input xn ∈ Xseen ≡ {xn}N

n=1, xi
n
is the i-th scale image which is cropped and zoomed
from xi−1
n = xn is the origi-
nal scale image. Notably, we use square brackets “[]”
to show the conditional relation, e.g. CA(i,j)[xi
n] indi-
cates the CA learner CA(i,j) is conditional on input xi
n,
and this relation can also be formulated as CA(i,j)[xi
n] =
CA(i,j)(gi(CAM(i,j)(f i(xi
n)))) (shows the encoding pro-
cess from image to feature space), where f i and gi in-
dicate the encoding functions of FNeti and GNeti, resp,
CAM(i,j) denotes the corresponding channel-attention
module (CAM), i ∈ [1 · · · I], j ∈ [1 · · · J] (in Fig.2,
I=2, J =3). The total size of ϕ[xn] is d-dim, thus for I
OA learners and I × J CA learners, OAi(·) ∈ R
I and
CA(i,j)(·) ∈ R

I×J .

d

d

3Notably,

these shortcomings also reside in conventional full-shot
tasks, while they heavily exacerbate the performances in zero-shot settings.

Below, we will introduce our OAM and CAM in Sec.3.1
and Sec.3.2 resp, and then show the objective metric loss
together with the regularization term in Sec.3.3.

2752

Figure 3: (a) The generation of object-attention proposal M l via random walk graph propagation. (b) The generation of channel-attention proposal cap(i,j)
via CAM, in this case, ’foot’ and ’wing’ are activated while ’body’ is suppressed, and if there are diverse CAMs , different cases will turn up, (c) The
adversary network, which is placed after the CA sub-learners.

3.1. Random Walk Inferred OAM

As we discussed above, in order to learn discriminative
OA learner, we should ﬁrst provide the discriminative vi-
sual inputs. However, unlike the detection methods that
have precise bounding-box annotations about object loca-
tions(e.g. RPN [10, 26]), there are no auxiliary annotations
for training in ZSIR. We thus present the random walk in-
ferred object-attention module(OAM), a parameter-free and
spatial attention method, by performing graph propagation
over the receptive ﬁelds of deep responses in Conv maps, so
as to produce the object-attention proposals.

As illustrated in Fig.2, our OAM takes as input many
convolutional response maps (U lk ∈ RClk ×Hlk ×Wlk , k ∈
[1, 2, · · · ], Clk , Hlk and Wlk denote the number of chan-
nels, height and width of the lk-th layer, respectively), and
then gives the ﬁnal object-attention proposal. For clarity, we
give a toy example and omit the subscript k for written con-
venience (if not speciﬁed), each spatial location (h, w) on
U l has a feature vector ul
h,w ∈ RCl . To produce the spatial
object-attention proposal M l ∈ RHl×Wl , a fully connected
directed graph Gl is ﬁrst constructed by connecting every
location on U l with the weight matrix Dl ∈ RHlWl×HlWl ,
where Dl
hWl+w,h′ Wl+w′ indicates the weight of the edge

from node (h, w) to (h

′

′

, w

Dl

hWl+w,h

′

Wl+w

) and is deﬁned as:
′ , kul

h,w − ul

′

h

,w

′ k

(2)

Before performing propagation, the weights of the out-
a,b ←

bound edges of each node are normalized to 1, i.e. Dl

a,b

Dl
HlWl
=1
b

′

Dl

a,b

′

P

. Then, a random walk graph propagation al-

deep features ul. By the globally objectness ﬂow, it can not
only collects object evidence but also depresses noise re-
gions. For the convenience of random walk calculation, the
proposal map M l is ﬁrst reshaped to a HlWl-dim vector,
and then it is updated by the iterative multiplication with
the weight matrix Dl, i.e. M ← D × M .

Moreover, as a common knowledge that the response
maps at different layers are of different information, e.g. the
bottom layers have better predictive power for shape while
the top layers are robust to noisy regions [19, 27], our OAM
takes as input multiple Conv. layers U lk , k ∈ [1, 2, · · · ] so
as to avoid the inﬂuence of noise surroundings (e.g. trees
around birds), and each object-attention proposal M lk can
be obtained by performing random walk graph propagation
over U lk as follows:

T

M lk ← (

Y

t=1

Dlk )M lk

(3)

1
Wlk
Hlk

M lk is ﬁrst initialized with value

, and the weight
matrix Dlk is conditional on the response map U lk , then the
iterative update of M lk like M ← D × M can be rewrit-
ten as the above equation and each M lk can reach its sta-
ble state with T = 10. After Eq.3, all M lk are reshaped
to 2D maps and resized to the same size as the input im-
age, then they are averaged to a single map, i.e.
the ﬁnal
In experiments, we ﬁnd using
object-attention proposal.
{k ∈ [1, 2], and l1 = Incep4e, l2 = Incep5b} is enough,
As in Fig.2, with the help of this proposal, the coarse scale
image is processed into the ﬁner scale by operation J,
and then the ﬁner scale input will beneﬁt the discriminative
learning of the corresponding OA learner.

gorithm [20] is employed to produce the object-attention
proposal M l. As shown in Fig.3.(a), the node (h, w) re-
ceives and diffuses mass via the inbound and outbound di-
rected edges respectively. Then this random walk propaga-
tion iteratively collects mass at the nodes that have high dis-
similarity with their surroundings (i.e. it will highlight the
saliency foreground object region), since the edge weight
(i.e. transition probability) is proportional to the dissimilar-
ity between two nodes as deﬁned by Eq.2, transitions into
such subgraphs is likely, and unlikely if nodes have similar

Remark: The procedure in Eq.3 can be viewed as a vari-
ant of the eigenvector centrality measure [22], which out-
puts a proposal map to indicate the mass of each location on
the deep response maps. It can also be regarded as a Markov
chain that can reach unique stable state since the chain is er-
godic, a property which emerges from the fact that the graph
G is by construction strongly connected. [11, 45]. More-
over, the random-walk based informative-region search is
computationally lightweight and parameter-free, thus it can
be easily employed in any bedrock CNNs and has no need to

2753

be additionally optimized, i.e. when given the well trained
convolutional maps U , it can directly infer the important ob-
ject region in an unsupervised manner. Finally, recurrently
executing OAMs will incrementally improve the discrimi-
nation of the corresponding OA learners.

3.2. Adversarial CAM

Although the OA learners can produce discriminative
representations, each single OA learner will still be likely to
suffer from the partial/selective learning behavior, i.e. only
focuses on certain attributes (e.g. heads of birds, bellows
of car, etc.) which are the easiest ones to reduce the cur-
rent training risk. Therefore, in order to improve the diver-
sity of each OA root-learner, we further decouple it into J
CA sub-learners which insist to capture various attributes
information coming from diverse channel-attention propos-
als cap(i,j) as in Fig.2, and each cap(i,j) is produced by a
particular channel-attention mudule (CAM(i,j)). For clar-
ity, we take one CAM for example, as shown in Fig.3.(b), it
takes as input U l ∈ RCl×Hl×Wl of the l-th layer (omit sub-
script k for convenience) and outputs a channel-weighted
counterpart of U l, i.e. cap(i,j). We formulate it as:

(i,j)δ(W 1

(i,j)Ψ(U l))]

cap(i,j) = CAM(i,j)(U l) = U l ⊡ σ[W 2
where U l

is ﬁrst aggregated to a channel descriptor
through spatial average pooling Ψ, then is passed through
two fully-connected layers (parameterized by W 1
(i,j) ∈
R64×Cl , W 2
(i,j) ∈ RCl×64) that intend to capture the in-
teractions among channels and are followed by ReLU (δ)
and Sigmoid (σ) respectively. Finally, U l is reweighted by
the channel-wise multiplication ⊡ between 2D map U l
c and
scalar σ[W2δ(W1Ψ(U l))]c, where c is the channel index.

Since the ﬁlters in certain convolutional layers serve as
the local attribute detectors to some extend, the resulting
deep response maps will reserve the attribute information
in channels. In another word, different attributes reside in
different channels. Therefore, the reweighting operation in
our CAM can be regarded as an attributes selector(e.g. in
Fig.3.(b) it selects ’foot’ and ’wing’ yet ignores ’body’),
and the concerned cues(within cap(i,j)) will be passed to
the corresponding CA sub-learner. If there are diverse se-
lectors, i.e. multiple CAMs, capable of capturing differ-
ent combinations of attributes information in parallel, the
corresponding CA learners will focus on different attributes
knowledge, and the richness and diversity of each OA root-
learner will be signiﬁcantly improved.

While, to explicitly encourage the diversity of CAMs,
directly adding diversity constraints after CAMs might be
detrimental, since in fact it is hard to know which channel
contains what attribute signal and which kind of channel
combination is beneﬁcial to the embedding learning. To this
end, as shown in Fig.2, all cap(i,j) are ﬁrst fed into the cor-
responding subsequent shared embedding layers, and the
diversity of CAMs are naturally transferred to that of the
CA learners. And in order to explicitly encourage the diver-
sity of CAMs, we can instead impose diversity constraints

on the CA learners. Then, an adversarial optimization strat-
egy is introduced as the diversity constraint by playing a
max min game, i.e.
the adversary network tries to mini-
mize the discrepancies among CA learners while CAMs try
to maximize these discrepancies as follows:

max

f i,gi,CAM s

min
̥i

Ladv(xi

n; ̥i; f i; gi; CAM s) =

J

λ0

X

k̥i[CA(i,j)[xi

n]] − ̥i[CA(i,j

′ )[xi

n]]k2
2

(4)

′

j,j

where f i, gi and ̥i indicate the mapping functions
of F N eti, GN eti and the adversary network respectively,
λ0 is the loss weight. The above equation is a discrep-
ancy measurement over all J CA sub-learners that be-
long to the i-th OA root-learner. Moreover, to simplify
the two-stage optimization in this max min game, a gra-
dients reverse layer (GRL) [9] is introduced as shown in
Fig.3.(c), so as to make Eq.4 be equivalent to min̥i Ladv
and min(f i,gi,CAM s)(−Ladv).

Remark: Since at each scale i the params of GN eti (gi)
in different channel-attention branches are shared as shown
in Fig.2, when optimizing min(f i,gi,CAM s)(−Ladv), the
only differentiating parts are CAMs, in other words, only
diverse CAMs will make (−Ladv) small. Moreover, the
reason of using adversary objective instead of directly con-
strain CA learners to be different with each other is because
the deﬁnition of difference between learners is likely to be
hard to be artiﬁcially made than the similarity, we thus play
the above adversarial game so as to allow the automatic
learning of the optimal discrepancies between CAMs.

3.3. Objective Loss and Regularization Term

Employing multiple OAMs and CAMs, the holistic fea-
ture representation ϕ[xn] can be decoupled into a series of
attention-speciﬁc parts. Then, the binomial deviance loss
[41] is utilized and the empirical metric loss over all CA
sub-learners can be formulated as:

Lmetric =

1
IJ

I

J

X

X

X

i=1

j=1

p, q

1
wpq

log (1 + e−(2spq −1)α(D

(i,j)

pq −β)γpq )

p],CA(i,j)[xi
p]kkCA(i,j)[xi

(5)
where α = 2, β = 0.5 are the scaling and translation
parameters resp. γpq is the penalty coefﬁcient and is set
to 1 if spq = 1(i.e.
images xp, xq are from the same
class), otherwise γpq = 35. wpq is the number of posi-
tive pairs(negative pairs) if spq = 1(spq = 0). D(i,j)
pq =
<CA(i,j)[xi
q]>
q]k measures the distance between in-
kCA(i,j)[xi
puts xi
q at learner CA(i,j). Notably, if J = 1,
the OA root-learner has no need to be decoupled, thus
CA(i,j) = OAi. Additionally, the learners are trained on
the relatively small datasets (compared to ImageNet [28])
from scratch and thus are easier to be over-ﬁtting, following
the commonly used weight decay strategy which regularizes
the value of parameters not to be too large so as to reduce

p and xi

2754

over-ﬁtting, we present a regularization term for optimiz-
ing each learner, called activation decay, to constraint the
representation value as follows:

Lact =

λ1

2IJ N

I

J

N

X
i=1

X
j=1

X
n=1

I

J

where Lntri = λ2

X
i=1

X
j=1

kCA(i,j)[xi

n]k2

2 + Lntri

(6)

tr[(ωij ωT

ij − I) ⊗ (ωij ωT

ij − I)]

where Lntri is used to avoid the trivial solution(i.e. all pa-
rameters are optimized to 0) when minimizing Lact, λ1, λ2
IJ ×d1 are the pa-
are trade-off hyper-parameters. ωij ∈ R
rameters in learner CA(i,j), d1 indicates its input channel
number. ⊗ refers to the Hadamard-Product. Finally, DeML
can be trained by jointly optimizing Eq.4, 5 & 6.
3.4. Discussion

d

Why decoupling? In ZSIR, the traditional idea of de-
vising loss functions for optimizing an uniﬁed metric omits
the issues of (1) undiscriminating visual input regions and
(2) the partial/selective learning behavior of learner, and
thus exhibits limitations in discriminative and knowledge-
preserving feature learning that is crucial for ZSIR. How-
ever, in our DeML, decoupling this uniﬁed metric into mul-
tiple separate learners gives us chances and ﬂexibilities to
mitigate the above problems individually, i.e. recurrently
improve the discrimination via OA root-learners and ex-
plicitly encourage the diversity and richness via CA sub-
learners, and as a result, the redundancy in features is re-
duced and the representation ability is encouraged as well.
Additionally, in Sec.4, we show that our decoupling idea
outperforms the existing methods in ZSIR by a signiﬁcant
margin even without hard-samples mining.

Relation to other ensemble methods: In deep metric
learning community, there are some other ensemble works
related to us. Yuan et al [43] employ multiple layers at dif-
ferent depths for hard-aware samples mining and then cas-
cade the learned embeddings together. Opitz et at [24, 25]
adopt the online gradients boosting and optimize different
learners with the reweighted data. Kim et at [13] try to in-
crease the feature diversity via contrastive loss but ignore
the importance of learning discriminative metric in ZSIR
task. In summary, although these methods aim at learning
ensemble metric, they easily suffer from the undiscriminat-
ing inputs, and the partial learning behaviors are not effec-
tively constrained as well. We emphasize that our DeML re-
casts the ensemble problem as a hybrid-attention model that
has a clear object of addressing the aforementioned issues
individually, and decouples the uniﬁed metric into multi-
ple attention-speciﬁc parts, so as to explicitly intensify both
the discrimination and diversity within each part of features,
thus capturing rich knowledge and being capable of gener-
alizing to unseen categories.

Relation to other attention mechanism: Many other
attention works, such as spatial-attention [40, 8], channel-
attention [4, 12] and semantic-attention [42, 30], employ

the task-speciﬁc attention modules to mine the most infor-
mative signals. While, we emphasize that our DeML is a
hybrid-attention system, which dedicates to capturing not
only the informative object-attention regions via OAMs but
also the diversity of attributes via CAMs. Moreover, OAM
differs from works [4, 40, 7] in that it is performed by the
random walk graph propagation, which is in a parameter-
free manner and can be directly employed without train-
ing. And different from [4, 12] where the channel-attention
modules are to extract the most informative channel-signals,
our parallel CAMs are constrained by the adversary task
such that they are different with each other and capable of
extracting rich and complementary attributes knowledge. In
summary, CAMs can work in conjunction with OAMs, and
the generalization and discrimination of the holistic metric
are explicitly and naturally ensured.

4. Experiments

Notation: For clarity, the conventional uniﬁed metric
learning(i.e. directly train d-dim features with Eq.5) is de-
noted by Ud, e.g. U512, and we set it as our baseline. The
proposed method is denoted by DeML(I,J), where there are
I OA root-learners and I × J CA sub-learners in total, d is
set to 512 by default and each OA(CA) learner is 512
IJ )-
dim, if not divisible, operation ﬂoor is performed.

I ( 512

Implementation details: Following the codes released
by [3, 23], we choose the pretrained GooglenetV1 [34] as
our bedrock network and adopt the same data preprocess
method so as to make fair comparisons with other works.
The learners, CAMs and adversary networks are initialized
with random weights. CAMs are placed after pool3 layer,
OAM takes as inputs incep4e output and incep5b output.

Training: The optimizer is Adam [14] with learning rate
1e − 5 and weight decay 2e − 4. The training iterations
are 15k(CUB), 25k(CARS), 100k(Stanford Online Prod-
ucts and In-shop) resp. We set λ0 = 1, λ1 = 0.014, λ2 =
0.25 and 10 times learning rate for the learners.

Evaluation and datasets: For fair comparison, we fol-
low [23] to evaluate the retrieval performance by Recall@K
metric. For testing unseen images, the outputs of I × J
learners will be concatenated into the holistic feature af-
ter L2 normalization. Then we use the simple cosine dis-
tance rule for similarity measurement. The datasets include
CUB[36], CARS[15], Stanford Online Products[23] and In-
Shop[18]. There is no intersection of classes between
training and testing sets.

4.1. Results

Effect of activation decay: From Tab.1, one can ob-
serve that with the help of our activation decay Lact,
the performances of uniﬁed metric learning under differ-
ent feature sizes are consistently improved over both CUB

2755

Figure 4: (a) Object-attention regions at different scales inferred by OAMs. (b) Channel-attention proposals at certain channels output by CAMs.

U64

U512

U384

U192

Method

U64+Lact

U512+Lact

U192+Lact

U384+Lact

CUB (R@1) CARS (R@1)

Table 1: Effect of Lact.

65.4
67.1 ↑
68.3
74.6 ↑
69.1
77.4 ↑
68.4
77.6 ↑

50.0
50.9 ↑
52.4
54.9 ↑
53.0
55.6 ↑
52.9
56.2 ↑

and CARs datasets, e.g.
(U512+Lact) vs. U512,
moreover, from Fig.5 one
can observe that the train-
ing curve of U512 rises fast
to a higher level, i.e. 1, but
its testing curve ﬁrst rises a
bit and then drops continu-
ously to 0.2, indicating that U512 suffers from serious over-
ﬁtting over the seen categories, while the training curve of
(U512+Lact) rises slower than U512 and its testing curve
has a rising trend, implying that Lact indeed serves as a
regularization term and can improve the generalization abil-
ity on unseen categories by reducing over-ﬁtting. Addi-
tionally, from the results of (U64+Lact) to (U512+Lact),
one can observe that the performances increase with dimen-
sion d, but when d is large enough (e.g. from 384 to 512),
the performance gain is small (55.6% vs. 56.2% on CUB,
77.4% vs. 77.6% on CARS), and the similar phenomenon
can be observed from U64 to U512 as well, indicating that
the neural redundancy indeed exists and limits the further
improvement, and highlighting the necessity of our decou-
pling idea laterally.

Attention visualization: In order to intuitively under-
stand our attention modules, we provide clear visualiza-
tions of the corresponding attention proposals for qualita-
tive analysis, i.e. the attended regions at multiple scales by
the proposed OAMs and the diverse attribute proposals by
CAMs, Fig.4. Firstly, for object-attention regions, one can
observe that these localized regions at second or third scales
are discriminative to the corresponding categories, and are
easier to be recognized than the ﬁrst scale. Secondly, for
channel-attention proposals, it can be observed that differ-
ent CAMs process the same input U l into diverse proposals,
which contain different attributes combinations, by differ-
ent weighting strategies. Thus forcing the following CA
learners to concentrate on different knowledge, the partial
learning behavior can be avoided. These above results are
consistent with human perception that it would be helpful to
look closer for better decisions and to learn rich knowledge
for handling unseen categories.

Effect of attention modules: We also conduct quanti-

DeML

(I=1,J=1)
(I=1,J=4)
(I=1,J=8)
(I=2,J=1)
(I=2,J=4)
(I=3,J=1)
(I=3,J=3)

H

56.1
56.6
59.0
60.9
61.7
64.9
65.4

CUB (R@1)

O (1st/2nd/3rd)

-
-
-

54 / 58.8
54.9 / 59.7

54 / 58 / 60.1

54.1 / 58.4 / 60.6

CARS (R@1)

O (1st/2nd/3rd)

-
-
-

76.9 / 79.2
77.7 / 79.9

75.4 / 77.5 / 78.9
75.3 / 78.9 / 80.4

H

77.9
81.1
82.5
83.4
84.8
85.6
86.3

Table 2: Effect of attention modules. H and O indicate the retrieval results of features
coming from the holistic learner and OA root-learners, resp.

 

t
e
S
g
n
n
a
r
T

i

i

1

0.8

0.6

 

0.4
0
0.8

 

t
e
S
g
n
i
t
s
e
T

0.6

0.4

 

0.2
0

Recall@1

10

15

Iteration

10

15

Iteration

 

25

 

U512
U512+act
our DeML(I=1,J=8)

20

U512
U768+act
our DeML(I=1,J=8)

20

25

5

5

Figure 5: Training (seen) and testing (unseen) curves on CUB.

tative comparisons on attention modules in Tab.2. By de-
fault, dimension d is set to 512. The model DeML(I=1,J=1)
is very similar to model (U512+Lact) with only a small
difference of an extra single CAM, and from Tab.1 and
Tab.2, one can observe that their performances are almost
the same(56.2% vs. 56.1% on CUB, 77.6% vs. 77.9%
on CARS), implying that capturing the single attentional
knowledge via attention module might not be helpful for
ZSIR. Moreover, in Tab.2 one can observe that, by ﬁx-
ing J=1,
the holistic performance (H) will signiﬁcantly
increase with I (56.1% → 60.9% → 64.9% on CUB,
77.9% → 83.4% → 85.6% on CARS), and the OA learner
at ﬁner scale will be more discriminative than that at coarse
scale, e.g. in DeML(I=3,J=1) on CUB, the third OA learner
achieves 60.1%, the second gets 58% and the ﬁrst gets 54%,
indicating that the more discernible the input is, the more
discriminative embedding is. Furthermore, when ﬁxing I
to a certain value, decoupling each OA root-learner into
multiple CA sub-learners will consistently improve the per-
formances over both CUB and CARS, e.g. when I=1, the
result (H) increases with J from 56.1% to 59.0% (77.9%
to 82.5%) on CUB (CARS), and the similar improvements
can be also observed when I=2 or 3, revealing that explic-
itly encouraging the diversity and capturing rich knowledge
indeed improve the generalization of metric in ZSIR. This

2756

R@K(%)
Method

Lifted [23]
N-pair [32]
Angular [38]

Proxy NCA [21]

ALMN [2]
ECAML [3]
HDC [43] ◦
BIER [24] ◦
ABE [13]4 ◦
A-BIER [25] ◦
baseline(U512)
DeML(I=3,J=3)

CUB-200
2
4

58.9
63.3
65.0
61.9
64.8
66.5
65.7
67.2
69.9
68.7
65.0
75.3

70.2
74.3
75.3
67.9
75.4
76.7
77.0
76.9
79.4
78.3
75.4
83.7

1

47.2
51.0
53.6
49.2
52.4
55.7
53.6
55.3
58.6
57.5
52.9
65.4

8

80.2
83.2
83.7
72.4
84.3
85.1
85.6
85.1
87.1
86.0
83.6
89.5

1

49.0
71.1
71.3
73.2
71.6
84.5
73.7
78.0
82.7
82.0
68.4
86.3

CARS-196

2

60.3
79.7
80.7
82.4
81.3
90.4
83.2
85.8
88.8
89.0
78.7
91.2

4

72.1
86.5
87.0
86.4
88.2
93.8
89.5
91.1
93.1
93.2
86.0
94.3

8

81.5
91.6
91.8
88.7
93.4
96.6
93.8
95.1
96.0
96.1
91.2
97.0

Stanford Online Products
1

10
79.8
83.8
85.0

100
91.3
93.0
93.5

1000
97.4
97.8
98.0

-

84.8
85.6
84.4
86.5
87.9
86.9
84.0
88.4∗

-

92.8
93.6
92.8
94.0
94.2
94.0
92.7
94.9∗

-
-

98.0
97.7
98.0
98.0
97.8
97.6
98.1∗

62.1
67.7
70.9
73.7
69.9
71.3
69.5
72.7
74.7
74.2
68.7
76.1∗

1
-
-
-
-
-

83.8
62.1
76.9
86.2
83.1
81.8
88.2

10
-
-
-
-
-

95.1
84.9
92.8
96.1
95.1
94.1
97.0

In-Shop
30
20
-
-
-
-
-
-
-
-
-
-

96.6
89.0
95.2
97.5
96.9
95.7
98.0

97.3
91.2
96.2
97.9
97.5
96.5
98.3

40
-
-
-
-
-

97.7
92.3
96.7
98.2
97.8
97
98.6

50
-
-
-
-
-

98.0
93.1
97.1
98.5
98.0
97.3
98.8

Table 3: Retrieval results on CUB [36], CARS [15] and Stanford Online Products [23]. Here, ◦ refers to other ensemble methods, the superscript ∗ indicates
the results are from model DeML(I=2,J=4) not DeML(I=3,J=3).

conclusion can also be demonstrated by Fig.5, i.e. the train-
ing curve of DeML(I=1,J=8) is much lower than that of
U512 or (U512+Lact), showing that the learned knowledge
are not specially prepared for the training seen categories
and the partial learning behavior is mitigated, while its test-
ing curve outperforms both U512 and (U512+Lact), imply-
ing that learning diverse knowledge will further improve the
generalization ability by reducing over-ﬁtting. Worthy of
mention is that in theory bigger J will be more helpful(e.g.
J=8), however due to the limitation of GPU memory, during
training when I=3, J is limited to 3. In summary, the appro-
priate combination of (I,J) will signiﬁcantly improve both
the discrimination and generalization of the deep metric in
an interpretable attention-based decoupling manner.

Effect of adversary loss: Unlike OAMs that can auto-
matically extract the object-attention regions via random-
walk graph propagation, the CAMs should be extra con-
strained so as to explicitly encourage the learning of com-
plementary attributes knowledge instead of the partial one.
From Tab.4, one can observe that without the constraint of
Ladv, the performances of DeML(I=1,J=8) are drastically
decreased over both CUB and CARS (i.e. from 59.0% to
52.0% on CUB and 82.5% to 68.2% on CARS), and the
similarities between different CA learners are obviously in-
creased from 0 to nearly 1, verifying that our adversary
loss Ladv indeed encourages the discrepancies between CA
learners (and CAMs) and reduces the neural redundancy,
as a result, the diverse and rich information are captured
such that the generalization ability is enhanced. More-
over, one can observe that even if there are 8 64-dim learn-
ers in (DeML(I=1,J=8) without Ladv), the performances
are close to (U64+Lact), since these 8 learners are super-
vised independently and thus are all likely to focus on the
same attributes knowledge that are the easiest one to reduce
the training risk, and then have little differences with each
other(’sim’ is close to 1), implying the redundant learners
will not contribute much and the partial learning behavior
will turn up easily without the diversity constraint.

Comparison with State-of-the-art: In order to high-
light the signiﬁcance of our decoupling idea for zero-shot
retrieval, we compare DeML with some remarkable embed-

CUB (R@K)

DeML(I=1,J=8)

DeML(I=1,J=8) without Ladv

U64+Lact

CARS (R@K)
DeML(I=1,J=8)

DeML(I=1,J=8) without Ladv

U64+Lact

1

59.0
52.0 ↓
50.9

1

82.5
68.2 ↓
67.1

2

70.2
63.9 ↓
62.8

2

89.5
78.3 ↓
77.6

4

79.7
74.0 ↓
74.0

4

93.5
85.4 ↓
85.0

8

87.4
82.3 ↓
82.6

8

96.1
90.9 ↓
90.6

sim

-0.08 ±0.01
0.92 ±0.02 ↑

-

sim

-0.09 ±0.01
0.95 ±0.01 ↑

-

Table 4: Effect of adversary loss. ’sim’ indicates the mean cosine similarity between
CA learners.
ding works4, over the popular used datasets CUB, CARS,
Stanford Online Products and In-Shop Clothes. The com-
parison results are listed in Tab.3. From these tables, one
can observe that our baseline(U512) can only achieve the
general performances, and the performances of traditional
ideas of loss-designing and samples-mining are almost on
par with each other, while, by explicitly intensifying both
the discrimination and diversity within the deep metric,
our DeML can signiﬁcantly improve the performances over
baseline model and outperforms other state-of-the-art meth-
ods by a noteworthy margin, demonstrating the necessity of
our explicit enhancement for discrimination and generaliza-
tion via the decoupling idea. Moreover, different from the
listed ensemble methods [43, 24, 25, 13], DeML has clear
objects of jointly mitigating the aforementioned issues that
are vital to ZSIR, and thus can easily surpass them. Worthy
of mention is that, we ﬁnd DeML(I=2,J=4) is enough for
Stanford Online Products dataset, since as in Fig.4 the sec-
ond scale has been capable of localizing the discriminative
regions.

5. Conclusion

In this paper, we propose an interpretable DeML, a
hybrid-attention based decoupling method, for zero-shot
image retrieval task by explicitly intensifying the discrimi-
nation and generalization within the learned metric with the
proposed OAMs and CAMs. Extensive experiments vali-
date the necessity and effectiveness of our decoupling idea.
Acknowledgments: This work was partially supported by
the National Natural Science Foundation of China under Grant
Nos. 61871052, 61573068, 61471048, and 61375031, and by
the Beijing Nova Program under Grant No. Z161100004916088,
DiDi GAIA Research Collaboration Initiative and BUPT Excellent
Ph.D. Students Foundation CX2019307.

4For fair comparison, we report the reproducing results of [13] when

using the same training settings as us, e.g. batchsize and loss function.

2757

References

[1] Soravit Changpinyo, Wei-Lun Chao, Boqing Gong, and Fei
Sha. Synthesized classiﬁers for zero-shot learning. In Pro-
ceedings of the IEEE Conference on Computer Vision and
Pattern Recognition (CVPR), pages 5327–5336, 2016.

[2] Binghui Chen and Weihong Deng. Almn: Deep embedding
learning with geometrical virtual point generating. arXiv
preprint arXiv:1806.00974, 2018.

[3] Binghui Chen and Weihong Deng. Energy confused adver-
sarial metric learning for zero-shot image retrieval and clus-
tering. In AAAI Conference on Artiﬁcial Intelligence, 2019.

[4] Long Chen, Hanwang Zhang, Jun Xiao, Liqiang Nie, Jian
Shao, Wei Liu, and Tat-Seng Chua. Sca-cnn: Spatial and
channel-wise attention in convolutional networks for image
captioning. In Proceedings of the IEEE Conference on Com-
puter Vision and Pattern Recognition (CVPR), pages 6298–
6306. IEEE, 2017.

[5] Joon Son Chung, Andrew Senior, Oriol Vinyals, and Andrew
Zisserman. Lip reading sentences in the wild. arXiv preprint
arXiv:1611.05358, 2, 2016.

[6] Jeffrey Dalton, James Allan, and Pranav Mirajkar. Zero-shot
video retrieval using content and concepts. In Proceedings
of the 22nd ACM international conference on Information &
Knowledge Management, pages 1857–1860. ACM, 2013.

[7] Jianlong Fu, Heliang Zheng, and Tao Mei. Look closer to
see better: Recurrent attention convolutional neural network
for ﬁne-grained image recognition.
In Proceedings of the
IEEE Conference on Computer Vision and Pattern Recogni-
tion (CVPR), 2017.

[8] Yanwei Fu, Timothy M Hospedales, Tao Xiang, and Shao-
gang Gong. Transductive multi-view zero-shot learning.
IEEE transactions on pattern analysis and machine intelli-
gence (TPAMI), 37(11):2332–2345, 2015.

[9] Yaroslav Ganin, Evgeniya Ustinova, Hana Ajakan, Pas-
cal Germain, Hugo Larochelle, Franc¸ois Laviolette, Mario
Marchand, and Victor Lempitsky. Domain-adversarial train-
ing of neural networks. The Journal of Machine Learning
Research, 17(1):2096–2030, 2016.

[10] Ross Girshick. Fast r-cnn. In IEEE International Conference
on Computer Vision (ICCV), pages 1440–1448. IEEE, 2015.

[11] Jonathan Harel, Christof Koch, and Pietro Perona. Graph-
In Advances in neural information

based visual saliency.
processing systems (NIPS), pages 545–552, 2007.

[12] Jie Hu, Li Shen, and Gang Sun. Squeeze-and-excitation net-

works. arXiv preprint arXiv:1709.01507, 2017.

[13] Wonsik Kim, Bhavya Goyal, Kunal Chawla, Jungmin Lee,
and Keunjoo Kwon. Attention-based ensemble for deep met-
ric learning. In The European Conference on Computer Vi-
sion (ECCV), September 2018.

[14] Diederik P Kingma and Jimmy Ba. Adam: A method for
arXiv preprint arXiv:1412.6980,

stochastic optimization.
2014.

[15] Jonathan Krause, Michael Stark, Jia Deng, and Li Fei-Fei.
3d object representations for ﬁne-grained categorization. In
IEEE International Conference on Computer Vision Work-
shops (ICCVW), pages 554–561, 2013.

[16] Vijay BG Kumar, Ben Harwood, Gustavo Carneiro, Ian Reid,
and Tom Drummond. Smart mining for deep metric learning.
arXiv preprint arXiv:1704.01285, 2017.

[17] Yan Li, Junge Zhang, Jianguo Zhang, and Kaiqi Huang. Dis-
criminative learning of latent features for zero-shot recogni-
tion. arXiv preprint arXiv:1803.06731, 2018.

[18] Ziwei Liu, Ping Luo, Shi Qiu, Xiaogang Wang, and Xiaoou
Tang. Deepfashion: Powering robust clothes recognition
and retrieval with rich annotations.
In Proceedings of the
IEEE Conference on Computer Vision and Pattern Recogni-
tion (CVPR), pages 1096–1104, 2016.

[19] Jonathan Long, Evan Shelhamer, and Trevor Darrell. Fully
convolutional networks for semantic segmentation. In Pro-
ceedings of the IEEE conference on computer vision and pat-
tern recognition (CVPR), pages 3431–3440, 2015.

[20] L´aszl´o Lov´asz. Random walks on graphs. Combinatorics,

Paul erdos is eighty, 2(1-46):4, 1993.

[21] Yair Movshovitz-Attias, Alexander Toshev, Thomas K. Le-
ung, Sergey Ioffe, and Saurabh Singh. No fuss distance met-
ric learning using proxies. In The IEEE International Con-
ference on Computer Vision (ICCV), Oct 2017.

[22] Mark EJ Newman. The mathematics of networks. The new

palgrave encyclopedia of economics, 2(2008):1–12, 2008.

[23] Hyun Oh Song, Yu Xiang, Stefanie Jegelka, and Silvio
Savarese. Deep metric learning via lifted structured feature
embedding. In Proceedings of the IEEE Conference on Com-
puter Vision and Pattern Recognition (CVPR), pages 4004–
4012, 2016.

[24] Michael Opitz, Georg Waltner, Horst Possegger, and Horst
Bischof. Bier - boosting independent embeddings robustly.
In The IEEE International Conference on Computer Vision
(ICCV), Oct 2017.

[25] Michael Opitz, Georg Waltner, Horst Possegger, and Horst
Bischof. Deep metric learning with bier: Boosting indepen-
dent embeddings robustly. arXiv preprint arXiv:1801.04815,
2018.

[26] Shaoqing Ren, Kaiming He, Ross Girshick, and Jian Sun.
Faster r-cnn: Towards real-time object detection with region
proposal networks. In Advances in neural information pro-
cessing systems (NIPS), pages 91–99, 2015.

[27] Olaf Ronneberger, Philipp Fischer, and Thomas Brox. U-
net: Convolutional networks for biomedical image segmen-
tation. In International Conference on Medical image com-
puting and computer-assisted intervention, pages 234–241.
Springer, 2015.

[28] Olga Russakovsky, Jia Deng, Hao Su, Jonathan Krause, San-
jeev Satheesh, Sean Ma, Zhiheng Huang, Andrej Karpathy,
Aditya Khosla, Michael Bernstein, et al.
Imagenet large
scale visual recognition challenge. International Journal of
Computer Vision, 115(3):211–252, 2015.

[29] Florian et al. Schroff. Facenet: A uniﬁed embedding for
face recognition and clustering. In Proceedings of the IEEE
Conference on Computer Vision and Pattern Recognition
(CVPR), pages 815–823, 2015.

[30] Idan Schwartz, Alexander Schwing, and Tamir Hazan. High-
order attention models for visual question answering.
In
Advances in Neural Information Processing Systems (NIPS),
pages 3667–3677, 2017.

2758

localization. In Proceedings of the IEEE International Con-
ference on Computer Vision, pages 1841–1850, 2017.

[31] Yuming Shen, Li Liu, Fumin Shen, and Ling Shao. Zero-shot
arXiv preprint arXiv:1803.02284,

sketch-image hashing.
2018.

[32] Kihyuk Sohn.

Improved deep metric learning with multi-
class n-pair loss objective. In Advances in Neural Informa-
tion Processing Systems (NIPS), pages 1857–1865, 2016.

[33] Yi Sun, Yuheng Chen, Xiaogang Wang, and Xiaoou Tang.
Deep learning face representation by joint identiﬁcation-
veriﬁcation. In Advances in neural information processing
systems (NIPS), pages 1988–1996, 2014.

[34] Christian Szegedy, Wei Liu, Yangqing Jia, Pierre Sermanet,
Scott Reed, Dragomir Anguelov, Dumitru Erhan, Vincent
Vanhoucke, and Andrew Rabinovich. Going deeper with
convolutions. In IEEE Conference on Computer Vision and
Pattern Recognition (CVPR), pages 1–9, 2014.

[35] Yuan Tongtong, Deng Weihong, Tang Jian, Tang Yinan, and
Chen Binghui. Signal-to-noise ratio: A robust distance met-
ric for deep metric learning.
In Proceedings of the IEEE
Conference on Computer Vision and Pattern Recognition
(CVPR), 2019.

[36] Catherine Wah, Steve Branson, Peter Welinder, Pietro Per-
ona, and Serge Belongie. The caltech-ucsd birds200-2011
dataset. California Institute of Technology, 2011.

[37] Fei Wang, Mengqing Jiang, Chen Qian, Shuo Yang, Cheng
Li, Honggang Zhang, Xiaogang Wang, and Xiaoou Tang.
Residual attention network for image classiﬁcation. In Pro-
ceedings of the IEEE Conference on Computer Vision and
Pattern Recognition (CVPR), July 2017.

[38] Jian Wang, Feng Zhou, Shilei Wen, Xiao Liu, and Yuanqing
Lin. Deep metric learning with angular loss. arXiv preprint
arXiv:1708.01682, 2017.

[39] Chao-Yuan Wu, R. Manmatha, Alexander J. Smola, and
Philipp Krahenbuhl. Sampling matters in deep embedding
learning.
In The IEEE International Conference on Com-
puter Vision (ICCV), Oct 2017.

[40] Kelvin Xu, Jimmy Ba, Ryan Kiros, Kyunghyun Cho, Aaron
Courville, Ruslan Salakhudinov, Rich Zemel, and Yoshua
Bengio. Show, attend and tell: Neural image caption gen-
eration with visual attention. In International Conference on
Machine Learning (ICML), pages 2048–2057, 2015.

[41] Dong Yi, Zhen Lei, Shengcai Liao, and Stan Z Li. Deep
metric learning for person re-identiﬁcation. In International
Conference on Pattern Recognition (ICPR), pages 34–39.
IEEE, 2014.

[42] Quanzeng You, Hailin Jin, Zhaowen Wang, Chen Fang, and
Jiebo Luo. Image captioning with semantic attention. In Pro-
ceedings of the IEEE Conference on Computer Vision and
Pattern Recognition (CVPR), pages 4651–4659, 2016.

[43] Yuhui Yuan, Kuiyuan Yang, and Chao Zhang. Hard-aware
deeply cascaded embedding. In The IEEE International Con-
ference on Computer Vision (ICCV), Oct 2017.

[44] Ziming Zhang and Venkatesh Saligrama. Zero-shot learning
via semantic similarity embedding.
In Proceedings of the
IEEE International Conference on Computer Vision (ICCV),
pages 4166–4174, 2015.

[45] Yi Zhu, Yanzhao Zhou, Qixiang Ye, Qiang Qiu, and Jianbin
Jiao. Soft proposal networks for weakly supervised object

2759

