CrowdPose: Efﬁcient Crowded Scenes Pose Estimation and A New Benchmark

Jiefeng Li1, Can Wang1, Hao Zhu1, Yihuan Mao2, Hao-Shu Fang1, Cewu Lu1†∗

1Shanghai Jiao Tong University, 2Tsinghua University

{ljf likit,wangcan123,lucewu}@sjtu.edu.cn

haozhu@zju.edu.cn maoyh16@mails.tsinghua.edu.cn fhaoshu@gmail.com

Abstract

Mask R-CNN

Ours

Multi-person pose estimation is fundamental to many
computer vision tasks and has made signiﬁcant progress
in recent years. However, few previous methods explored
the problem of pose estimation in crowded scenes while
it remains challenging and inevitable in many scenarios.
Moreover, current benchmarks cannot provide an appro-
priate evaluation for such cases.
In this paper, we pro-
pose a novel and efﬁcient method to tackle the problem
of pose estimation in the crowd and a new dataset to bet-
ter evaluate algorithms. Our model consists of two key
components: joint-candidate single person pose estimation
(SPPE) and global maximum joints association. With multi-
peak prediction for each joint and global association us-
ing the graph model, our method is robust to inevitable
interference in crowded scenes and very efﬁcient in infer-
ence. The proposed method surpasses the state-of-the-art
methods on CrowdPose dataset by 5.2 mAP and results on
MSCOCO dataset demonstrate the generalization ability
of our method. Source code and dataset are available at
https://github.com/Jeff-sjtu/CrowdPose

1. Introduction

Estimating multi-person poses in images plays an im-
portant role in the area of computer vision.
It has at-
tracted tremendous interest for its wide applications in ac-
tivity understanding [14, 11], human-object interaction de-
tection [41, 37], human parsing [18, 42] etc. Some works
focus on 3D human pose estimation [33, 34, 31]. Currently,
most of the 2D methods can be roughly divided into two
categories: i) top-down approaches that ﬁrstly detect each
person and then perform single person pose estimation, or
ii) bottom-up approaches which detect each joint and then
associate them into a whole person.

†Cewu Lu is the corresponding author.
∗Cewu Lu is a member of Department of Computer Science and Engi-
neering, Shanghai Jiao Tong University, MoE Key Lab of Artiﬁcial Intelli-
gence, AI Institute, Shanghai Jiao Tong University, and SJTU-SenseTime
AI Lab.

Figure 1. Qualitative comparison of Mask R-CNN and our Crowd-
Pose method in crowded scenes. Though current methods achieve
good performance in public benchmarks [13, 15, 20], they fail in
crowded cases. There are mainly two types of errors: i) assemble
wrong joints into a pose; ii) predict redundant poses in crowded
scenes.

To evaluate the performance of multi-person pose esti-
mation algorithms, several public benchmarks were estab-
lished, such as MSCOCO [15], MPII [13] and AI Chal-
lenger [20]. In these benchmarks, the images are usually
collected from daily life where crowded scenes appear less
frequently. As a result, most of the images in these bench-
marks have few mutual occlusion among humans. For ex-
ample, in MSCOCO dataset (persons subset), 67.01% of the
images have no overlapped person. Current methods have
obtained encouraging success on these datasets.

However, despite the good performance that current
methods have achieved on previous benchmarks, we ob-
serve an obvious degradation of their performance in
crowded cases. As shown in Figure 1, for the current state-
of-the-art methods [40, 27, 23, 26] of both bottom-up and

10863

Joint-candidate

Loss

Training

Human Node

Joint Node
Wrong Connection

Correct Connection

SPPE

SPPE

SPPE

Human Detection

Joint-candidate SPPE

Global Association

Final Results

Candidate list

Figure 2. Pipeline of our proposed method. JC SPPE uses joint-candidate loss function during training phase. In inference phase, JC SPPE
receives human proposals and generates joint candidates. Then we utilize human proposals and joint candidates to build a person-joint
graph. Finally, we associate joints with human proposals by solving the assignment problem in our graph model.

timization algorithm is the same as the conventional NMS
algorithm.

To better evaluate human pose estimation algorithms in
crowded scenes and promote the development in this area,
we collect a dataset of crowded human poses. We deﬁne
a Crowd Index to measure the crowding level of an im-
age. Images in our dataset have a uniform distribution of
Crowd Index among [0, 1], which means only an algorithm
that performs well on both uncrowded and crowded scenes
can achieve a high score in our dataset.

To sum up, the contributions of this paper are as fol-
lows: i) we propose a novel method to tackle the crowded
problem of pose estimation; ii) we collect a new dataset
of crowded human poses to better evaluate algorithms in
crowded scenes. We conduct experiments on our pro-
posed method. When using a same ResNet-101 based net-
work backbone, our method surpasses all the state-of-the-
art methods by 5.2 mAP on our dataset. Moreover, we re-
place the SPPE and post-processing steps in the state-of-
the-art method with our module and brings 0.8 mAP im-
provement on MSCOCO dataset. That is, our method can
generally work in non-crowded scenes.

2. Related Work

2.1. 2D Pose Estimation Dataset

Pioneer works on 2D human pose estimation dataset on
RGB images involve LSP [4], FashionPose [9], PASCAL
Person Layout [6], J-HMDB [12], etc. These datasets have
contributed to encouraging progress of human pose estima-
tion. However, they only evaluate for single person pose
estimation. With the improvement of algorithms, more
researchers focus on multi-person pose estimation prob-
lems, and several datasets are established, e.g., MPII [13],
MSCOCO [15], AI Challenger [20]. In spite of the preva-
lence of these datasets,
they suffer from a low-density
problem, which makes the current model overﬁtted to un-
crowded scenes. The performance of the state-of-the-art

10864

Figure 3. State-of-the-art methods evaluation results on MSCOCO
dataset. The x-axis is the Crowd Index which we deﬁned to mea-
sure the crowding level of an image. Compared to uncrowded
scenes, the accuracy (mAP@0.5:0.95) of state-of-the-art methods
are about 20 mAP lower in crowded cases.

top-down approaches, their performance decreases dramat-
ically as the crowd level increases (as Figure 3). Few previ-
ous methods aimed to tackle the problem of pose estimation
in crowded scene, and no public benchmark has been built
for this purpose. Meanwhile, crowded scenes are inevitable
in many scenarios.

In this paper, we propose a novel method to tackle the
problem of pose estimation in a crowd, using a global view
to address interference problem. Our method follows the
top-down framework, which ﬁrst detects individual persons
and then performs single person pose estimation (SPPE).
We propose a joint-candidate SPPE and a global maximum
joints association algorithm. Different from previous meth-
ods that only predict target joints for input human proposals,
our joint-candidate SPPE outputs a list of candidate loca-
tions for each joint. The candidate list includes target and
interference joints. Then our association algorithm utilizes
these candidates to build a person-joint connection graph.
At last, we solve the joint association problem in this graph
model with a global maximum joints association algorithm.
Moreover, the computational complexity of our graph op-

0.20.40.60.81.0Crowd Index0.40.50.60.70.8mAPAlphaPoseMask R-CNNOpenPosemethods decreases as the number of human increases.

2.2. Multi Person Pose Estimation

Part-Based Framework Representative works on the
part-based framework [26, 38, 35, 31] are reviewed. Part-
based methods detect joints and associate them into a whole
person. The state-of-the-art part-based methods are mainly
different on their association methods. Cao et al. [26] asso-
ciate joints with a part afﬁnity ﬁeld and greedy algorithm.
Zanﬁr et al. [31] propose a limb scoring network to esti-
mate the connection likelihood of joints and group people
by binary integer programming. Papandreou et al. [38] de-
tect individual joints and predict relative displacements for
association. Kocabas et al. [35] propose a multi-task model
and assign joints to detected persons by a pose residual net-
work. The joint detectors in part-based approached are rel-
atively vulnerable because they only consider small local
regions and output smaller response heatmaps.

Two-Step Framework Our work follows the two-step
approach. A two-step approach ﬁrst detects human pro-
posals [16, 24] and then performs single person pose es-
timation [19, 22]. The state-of-the-art two-step meth-
ods [21, 40, 27, 23] achieve signiﬁcantly higher scores than
the part-based methods. However, the two-step approaches
highly depend on human detection results, and it fails in
crowded scenes [30]. When people stay close to each other
in a crowd, it is improbable to crop a bounding box that only
contains one person. Some works [5, 8, 39, 25] in human
tracking area use temporal information to ﬁx wrong detec-
tion with CNN or RNN [3, 32] module. As a supplement to
them, we propose a novel and efﬁcient method that signif-
icantly increases pose estimation performance in crowded
scenes, which is robust to human detection results.

3. Our Method

The pipeline of our proposed method is illustrated in
Figure 2. Human bounding box proposals obtained by hu-
man detector are fed into joint-candidate (JC) single person
pose estimator (SPPE). JC SPPE locates the joint candidates
with different response scores on the heatmap (Sec. 3.1).
Then our joint association algorithm takes these results and
builds a person-joint connection graph (Sec. 3.2). Finally,
we solve the graph matching problem to ﬁnd the best joint
association result with a global maximum joints association
algorithm (Sec. 3.3).

3.1. Joint Candidates SPPE

Joint-candidate SPPE receives a human proposal im-
age and outputs a group of heatmaps to indicate human
joint locations. Though a human proposal should indicates
only one human instance, in the crowded scenarios, we in-
evitably need to handle a large number of joints from other

human instances. Previous works [40, 21, 27] use SPPE
to suppress interference joints. However, SPPE fails in
crowded scenes because their receptive ﬁelds are limited by
the input human proposals. To address this problem, we
propose joint-candidate SPPE with a novel loss designed in
a more global view.

3.1.1 Loss Design

For the ith human proposal, we input its region Ri into our
SPPE network and get the output heatmap Pi. There are
two types of joints in Ri, that is, the joints belong to the
ith person, and the joints belong to other human instances
(not the ith person). We name them as target joints and
interference joints respectively.

We adopt heatmap in our loss module, which is widely
used in many areas [29, 28] for its pixel-wise supervision
and fully convolution structure. Our goal is to enhance
target joints response and suppress interference joints re-
sponse. However, we don’t suppress them directly since in-
terference joints for the current proposal can be regarded as
target joints for other proposals. Thus, we can leverage in-
terference joints to estimate human poses with other human
proposals in a global manner. Therefore, to utilize those
two kinds of joint candidates, we output them with different
intensities.

Heatmap Loss For the kth joint in the ith person, we
denote the target joint heatmap as Tk
i , consisting of a 2D
i |σ), centered at the target joint location pk
Gaussian G(pk
i ,
with standard deviation σ.

For interference joints, we denote them as a set Ωk

heatmap of interference joints is denoted as Ck
of a Gaussian mixture distribution Pp∈Ωk

i

G(p|σ).

Our proposed loss is deﬁned as,

i . The
i , consisting

Loss i =

1
K

K

X

k=1

M SE[Pk

i , Tk

i + µCk
i ]

(1)

where µ is an attenuation factor ranged in [0,1]. As afore-
mentioned, interference joints will be useful in indicating
joints of other human instances. Therefore, we should con-
sider it in a global view by cross-validation. Finally, we
have µ = 0.5, which ﬁts our intuition: interference joints
should be attenuated but not over-suppressed. The conven-
tional heatmap loss function can be regarded as our special
case where µ = 0.

3.1.2 Discussion

A conventional SPPE depends on a high-quality human de-
tection result. Its tasks are locating and identifying target
joints according to the given human proposal. If SPPE mis-
takes interference joints for target joints, it will be an un-
recoverable error. Missing joints cannot be restored in the
post-processing step like pose-NMS.

10865

Our proposed joints candidate loss is aimed to tackle this
limitation. This loss function encourages JC SPPE network
to predict multi-peak heatmaps and sets all the possible
joints as candidates. In crowded scenes, while conventional
SPPE is hard to identify target joints, JC SPPE can still pre-
dict a list of joint candidates and guarantee high recall. We
leave the association problem to the next procedure, where
we have more global information from other JC SPPEs (on
other human proposals) to solve it.

3.2. Person Joint Graph

Due to our joint-candidate mechanism and redundant hu-
man proposals from human detector, joint candidates are
numerically much greater than the actual joint numbers. To
reduce redundant joints, we build a person-joint graph and
apply a maximum person-joint matching algorithm to con-
struct the ﬁnal human poses.

Input Human Proposals

Response Heatmaps

Wrong Detected Pose

Right head

Lefft knee
Right knee

Right leg

Same
Right Knee

Same
Right leg

Figure 4. In crowded scenes, human proposals are highly over-
lapped. Overlapped human proposals tend to predict same actual
joint. In this example, if we directly connect the highest response
to build ﬁnal poses, two human proposals will locate same right
knee and right leg. Our proposed association algorithm can solve
this problem by globally best matching.

rather than a constant threshold is to guarantee that, only
if p1 and p2 fall into each others’ control domain (radii are
uk
1δk, uk
2δk) simultaneously, we group them together. One
node represents a group of joints that cluster together by the
above criterion.

Now, by building a joint group as one node, we have joint
node set J = {vk
j : for k ∈ {1, . . . , K}, j ∈ {1, . . . , Nk}},
where Nk is the number of joint nodes of body part k, vk
j is
the jth node of body part k. The total number of joint nodes
in J is Pk Nk.
3.2.2 Person Node Building

Person nodes represent the human proposals detected by hu-
man detector. We denote person node set as H = {hi : ∀i ∈
{1 . . . M }}, where hi is the ith person node, and M is the
number of detected human proposals.

Ideally, a qualiﬁed human proposal tightly bounds a hu-
man instance. However, in crowded scenes, this condi-
tion is not always satisﬁed. The human detector will pro-
duce many redundant proposals, including truncated and
incompact bounding boxes. We will eliminate these low-
quality person nodes during global person-joint matching
in Sec. 3.3.

3.2.3 Person-Joint Edge

After obtaining the node of both joints and persons, we con-
nect them to construct our person-joint graph. For each per-
son node hi, JC-SPPE will predict several candidate results
of joints. If one of these candidates contributes to the joint
node vk
i,j between them. The weight
of ek
i,j is the response score of that candidate joint, which is
denoted as wk
i,j . In this way, we can construct the edge set
E = {ek

j , we build an edge ek

i,j : ∀i, j, k}.

The person-joints graph can then be written as:

3.2.1

Joint Node Building

G = ((H, J ), E).

(3)

Since highly overlapped human proposals tend to predict
the same actual joint (as Figure 4), we ﬁrst group these can-
didates that represent the same actual joint as one joint node.
Thanks to the high-quality joint prediction, candidate
joints that indicate the same joint are always close to each
other. Thus, we can group them using the following crite-
rion: given two candidate joints located at pk
2 with
control deviation δk, we label them as the same group, if

1 and pk

||p(k)

1 − p(k)

2 ||2 ≤ min{uk

1, uk

2}δ(k),

(2)

1 and uk

where uk
2 are the Gaussian response size of two
joints on heatmaps, determined by the Gaussian response
deviation. δ(k) is the parameter for controlling deviation
of the kth joint, which we directly adopt from MSCOCO
keypoint dataset [15]. The reason why we use min{u1, u2}

3.3. Globally Optimizing Association

From now on, our goal of estimating human poses in
the crowd is transformed into solving the above person-joint
graph and maximizing the total edge weights. We have our
objective function as:

max

d

G = max

d

w(k)
i,j · d(k)

i,j

X

i,j,k

s.t. X

d(k)
i,j ≤ 1,

j

X

d(k)
i,j ≤ 1,

i

∀k ∈ {1, . . . , K},

∀i ∈ {1, . . . , M }

∀k ∈ {1, . . . , K},
∀j ∈ {1, . . . , Nk}

d(k)
i,j ∈ {0, 1},

∀i, j, k

(4)

(5)

(6)

(7)

10866

i,j indicates whether we keep the edge ek

where d(k)
i,j in our
ﬁnal graph or not. The constraints of Eq. 5 and 6 enforce
that each human proposal can only match at most one kth
joint.

Note that G can be decomposed into K sub-graph Gk =
((H, J (k)), E (k)), where Gk is the sub-graph the only con-
sist of the kth kind of joints. Thus, our objective function
can be formulated as

0). According to the work of Carpaneto et al. [1], this lin-
ear assignment problem for the sparse matrix can be solved
in O(n2), i.e., O((|H| + |J (k)|)2). Since we have elimi-
nated the redundant joints and there is a one-to-one corre-
spondence between joints and persons, the expectation of
|J (k)| is equal to |H|. Thus we have O((|H| + |J (k)|)2) =
O(|H|2). Such computation complexity is the same as the
complexity of conventional greedy NMS algorithms.

max

d

G = max

d

w(k)
i,j · d(k)

i,j

X

i,j,k

=

=

K

X

k=1

K

X

k=1

d(k) X
(max

i,j

w(k)
i,j · d(k)
i,j )

max
d(k)

Gk.

(8)

(9)

(10)

As shown in Eq. 10, solving the global assignment prob-
lem in person-joint graph G is mathematically equivalent to
solving its sub-graph Gk separately. Gk is a bipartite graph
that composed of person subset and the kth joint subset. For
each sub-graph, the updated Kuhn-Munkres algorithm [1] is
applied to get the optimized result. By addressing each Gk
respectively, we obtain the ﬁnal result set R.

if d(k)

Given the graph matching result,

i,j = 1 the
j is assigned to the ith human proposal
weighted center of vk
as its kth joint. Here, weighted center means the linear com-
bination of candidate joints coordinate in vk
j and the weights
are their heatmap response scores. In this way, the pose of
each human proposal can be constructed. The person nodes
that can not match any joint will be removed.

Computational Complexity The inference speed of pose
estimation is essential in many applications. We prove that
our global association algorithm is as efﬁcient as common
greedy NMS algorithms.

As the hereditary property identiﬁed by White and
Whiteley [2], a graph G is (k, l)−sparse if every nonempty
sub-graph X has at most k|X| − l edges, where |X| is the
number of vertices in sub-graph X and 0 ≤ l < 2k.

Consider the sub-graph G(k) = ((H, J (k)), E (k)). It rep-
resents the connection between human proposals and the
kth type of joints. According to our statistics (Fig. 5), ev-
ery human bounding box covers four persons at most in
crowded scenes. Therefore, one person node builds connec-
tion edges to 4 joints at most. In other words, our person-
joint sub-graph G(k) is (4, 0) − sparse since

|E (k)| ≤ 4|G(k)| − 0.

(11)

Due to the sparsity of our person-joint graph, we can
solve the association problem efﬁciently. We transform E (k)
into an adjacency matrix Mek (unconnected nodes refer to

Figure 5. Instance-Joint connection distribution. The x-axis denote
the number of human bounding boxes that cover a same joint. This
statistical result is based on the ground truth annotations.

3.4. Discussion

Our method adopts the graph-based approach to asso-
ciate joints with human proposals in a globally optimal
manner. Human proposals compete with each other for
joint nodes. In this way, unqualiﬁed human proposals with-
out dominant human instance would fail to be assigned any
joints, since their joint response scores are all relatively
low due to missing dominant human instance. Therefore,
many redundant and poor human proposals are rejected. In
comparison to our approach, conventional NMS is a greedy
and instance-based algorithm, which is less effective. Al-
though [10, 17, 27] proposed pose-NMS to utilize pose in-
formation, their algorithms are based on instances and can-
not tackle the missing joints and wrong assembling prob-
lem. Our globally optimizing association method can deal
with such situations well.

4. CrowdPose Dataset

In this section, we introduce another contribution of
our paper, namely, CrowdPose dataset, including crowded
scenes deﬁnition, data collection process, and the dataset
statistics.
4.1. Crowding Level Deﬁnition

To build a dataset of crowded human pose, we need to
deﬁne a Crowd Index ﬁrst, which measure the crowding
level in a given image.

Intuitively, the number of persons in an image seems to
be a good measurement. However, the principal obstacle to

10867

0246Connecting joints number to per node0%10%20%30%40%(a) MSCOCO

(b) MPII

(c) AI Challenger

(d) CrowdPose

Figure 6. CrowdI ndex distributions of current popular datasets
and our dataset. Three public datasets are dominated by un-
crowded images. Meanwhile, our CrowdPose dataset has a near
uniform distribution.
solving crowded cases is not caused by the number of per-
sons, but rather by occlusion in a crowd. Therefore, we need
a new Crowd Index to indicate crowding level. In the bound-
ing box of the ith human instance, we denote the number of
joints that belonging to the ith person and other (not ith)
persons as N a
is the crowd
ratio of the ith human instance. Our Crowd Index is derived
by averaging the crowd ratio of all persons in an image:

i respectively. N b

i and N b

i /N a
i

Crowd Index =

1
n

n

X

i=1

N b
i
N a
i

,

(12)

where n indicates the total number of persons in the image.
We evaluate the Crowd Index distribution of three public
benchmarks: MSCOCO (person subset), MPII and AI Chal-
lenger. As shown in Figure 6, uncrowded scenes dominate
these benchmarks, which leads the SOTA methods only fo-
cus on these simple cases and ignore the crowded ones.

4.2. Data Collection

To set up a benchmark that covers various scenes and
encourages models to adapt to different kinds of situations,
we wish our benchmark covers not only crowded cases but
also simple daily life scenes. To achieve that, we ﬁrst ana-
lyze three public benchmarks [15, 13, 20] and divide their
images into 20 groups according to Crowd Index, ranging
from 0 to 1. The step among different groups is 0.05. Then
we sample 30,000 images uniformly from these groups in
total.

4.3. Image Annotation

cases. Thus, we re-annotate these images by the following
steps.

• We annotate 14 keypoints and full-body bounding

boxes for persons in 30,000 images.

• We analyze the Crowd Index for 30,000 images again
with new annotations, and select 20,000 high-quality
images.

• We further crop each person in the images, and then

annotate the interference keypoints in each box.

We use cross annotation, which means at least two anno-
tators annotate each image. If these two annotations have a
large deviation, we regard them as mistakes and re-annotate
this image. Finally, we take the average value of each key-
point location to ensure the annotation quality.

4.4. Dataset Statistics

Dataset Size
In total, our dataset consists of 20,000 im-
ages, containing about 80,000 persons. The training, vali-
dation and testing subset are split in proportional to 5:1:4.

Crowd Index Distribution The Crowd Index distribution
of CrowdPose is shown in Figure 6 (d). Unlike the other
datasets, CrowdPose has a uniform distribution of Crowd
Index. Note that we do not simply force CrowdPose to reach
high Crowd Index. If a model is only trained on crowded
scenes, it may degrade its performance on uncrowded cases
due to the bias of training set. Uniform distribution can
promote a model to adapt to various scenes.

Average IoU We further calculate the average intersec-
tion over union(IoU) of human bounding boxes. It turns out
that CrowdPose has an average bounding box IoU of 0.27,
while MSCOCO, MPII, and AI Challenger have 0.06, 0.11
and 0.12 respectively.

5. Experiments

In this section, we ﬁrst introduce datasets and settings
for evaluation. Then we report our results and comparisons
with state-of-the-art methods, and ﬁnally conduct ablation
studies on components in our method.

5.1. Datasets
CrowdPose Our proposed CrowdPose dataset contains
20,000 images in total and 80,000 human instances.
Its
Crowd Index satisﬁes uniform distribution in [0, 1]. Crowd-
Pose dataset aims to promote performance in crowded cases
and make models generalize to different scenarios.

Although these images have been annotated, their label
formats are not fully aligned. In terms of annotated joints
number, MSCOCO has 17 keypoints, while MPII has 16
and AI Challenger annotates 14 keypoints. Meanwhile, hu-
man annotators are easier to make mistakes in the crowded

MSCOCO Keypoints We also evaluate our method on
the MSCOCO Keypoints dataset [15].
It contains over
150,000 instances for training and 80,000 instances for test-
ing. The persons in this dataset overlap less frequently than
CrowdPose, and it has a Crowd Index centralized near zero.

10868

0.00.51.00%20%40%60%0.00.51.00%25%50%75%0.00.51.00%20%40%60%0.00.51.00%5%10%Figure 7. Qualitative results of our models predictions is presented. Different person poses are painted in different colors to achieve better
visualization.

Method

mAP @0.5:0.95 mAP@0.5 mAP @0.75 mAR @0.5:0.95 mAR @0.5 mAR @0.75

Mask R-CNN [23]

AlphaPose [27]
Xiao et al. [40]

Ours

57.2
61.0
60.8
66.0

83.5
81.3
81.4
84.2

60.3
66.0
65.7
71.5

65.9
67.6
67.3
72.7

89.5
86.7
86.3
89.5

69.4
71.8
71.8
77.5

Table 1. Results on CrowdPose test set.

Method

APEasy APM edium APHard

OpenPose [36]

Mask R-CNN [23]

AlphaPose [27]
Xiao et al. [40]

Ours

62.7
69.4
71.2
71.4
75.5

48.7
57.9
61.4
61.2
66.3

32.3
45.8
51.1
51.2
57.4

FPS

5.3
2.9
10.9

-

10.1

Table 2. Results on CrowdPose test set. Test set is divided into
three part and we report the results respectively. FPS column re-
ports the runtime speed on the whole test set.

5.2. Evaluation Metric

We follow the evaluation metric of MSCOCO, using
average precision (AP) and average recall (AR) to evalu-
ate the result. Object keypoint similarity (OKS) plays the
same role as the IoU to adopt AP/AR for keypoints detec-
tion. We consider mAP, averaged over multiple OKS val-
ues (.50:.05:.95), as our primary metric. Moreover, we di-
vide the CrowdPose dataset into three crowding levels by
Crowd Index: easy (0-0.1), medium (0.1-0.8) and hard (0.8-
1), to better evaluate our model performance in different
crowded scenarios. We use the same keypoint standard de-
viations as MSCOCO when calculating OKS in all experi-
ments.

5.3. Implementation Details

Our method follows the two-step framework. Since
human detector and pose estimation network are not
what we focus on, we simply adopt the human detector
(YoloV3 [43]) and pose estimation network provided by Al-
phaPose [27] which is a state-of-the-art two-step method.
During the training step, we adopt rotation (±30), scaling
(±30%) and ﬂipping data augmentation. The input reso-
lution is 320 × 256 and the output heatmap resolution is
80 × 64. The learning rate is set to 1 × 10−4 and 1 × 10−5
after 80 epochs. Mini-batch size is set to 64, and RM-
Sprop [7] optimizer is used. During testing, the detected hu-
man bounding boxes are ﬁrst extended by 30% along both
the height and width directions and then forwarded through
the Joint-candidate SPPE. The locations of joint candidates
are obtained from the averaged output heatmaps of original
and ﬂipped input image. We conduct our experiments on
two Nvidia 1080Ti GPUs. Our whole framework is imple-
mented in PyTorch.

For comparison with current state-of-the-art meth-
ods [23, 40, 27] on CrowdPose dataset, we retrain them
based on the conﬁguration provided by the authors. To
be fair, we use ResNet-101 as backbone for all SPPE net-
works and use the same human detector for [40]. For Mask
R-CNN we also use the FPN-based ResNet-101 backbone.

10869

Method

mAP @0.5:0.95 mAR @0.5:0.95

Mask R-CNN [23]

AlphaPose [27]
Xiao et al. [40]

Ours

64.8
70.1
69.8
70.9

71.1
74.4
74.1
76.4

Table 3. Results on MSCOCO test-dev set. We compare the state-
of-the-art methods with same detection backbone.

Method

mAP mAR

(a)

(b)

Ours (SPPE++Association)

w/o joint-candidate Loss

Greedy NMS

Parametric Pose-NMS [27]

66.0
61.7
49.1
64.2

72.7
68.7
63.1
71.1

Table 4. Results on CrowdPose test set. mAP and mAR are the
average value over multiple OKS values (0.50:0.05:0.95). “w/o X”
means without X module in our pipeline. “Greedy NMS” means a
conventional NMS method based on proposal scores and IoU.

Same training batch size is used for a fair comparison.

5.4. Results

CrowdPose Quantitative results on CrowdPose test set
are given in Table 1. Our method achieves 5.2 mAP higher
than state-of-the-art methods.
It demonstrates the effec-
tiveness of our proposed method to tackle the problem of
pose estimation in crowded scenes. To further evaluate
our method in crowded scenes, we report the results on
three crowding level in Table 2, i.e., uncrowded, medium
crowded and extremely crowded. Notably, our method im-
proves 4.1 mAP in uncrowded scenes, while achieves 4.9
and 6.2 mAP higher in medium crowded and extremely
crowded scenes separately. This result demonstrates that
our method has superior performance in crowded scenes.
We present some qualitative results in Figure 7. More re-
sults will be given in supplementary ﬁle.

MSCOCO We also evaluate our method on MSCOCO
dataset to show the generalization ability of our method and
results are given in Table 3. Without bells and whistles,
our method achieves 70.9 mAP on COCO test-dev set. It
brings 0.8 mAP improvements over AlphaPose [27] given
the same human detector and SPPE network, which proves
that our method can perform general improvement on pose
estimation problem. Note that for [40], the results reported
in their paper use a strong human detector which is not
open-sourced. To make a fair comparison, we report the
results using YOLOV3 as human detector.

Inference Speed The runtime speed of
fully open-
sourced method is tested and shown in Table 2. We obtain
the FPS results by averaging the inference time on the test
set. To achieve the best performance, we use the most ac-
curate conﬁguration for OpenPose [36], which has an input
resolution of 1024×736. As shown in the table, our method

achieves 10.1 FPS on the test set, which is slightly slower
than AlphaPose [27] but faster than other methods. It proves
that our method works the most accurate yet very efﬁcient
in crowded cases.

5.5. Ablation Studies

We study different components of our method on Crowd-

Pose test set, as reported in Table 4.

Joints Candidate Loss We ﬁrst evaluate the effective-
ness of our joint-candidate loss. In this experiment, we re-
place our joint-candidate loss with mean square loss, which
is widely used in state-of-the-art pose estimation methods.
The experimental result is shown in Table 4(a). The ﬁ-
nal mAP drops from 66.0% to 61.7%.
It proves that our
loss function can encourage SPPE to predict more possible
joints and resist interference.

Globally Optimizing Association Next, we compare our
association algorithm to several NMS algorithms, includ-
ing bounding box NMS, poseNMS [10, 17] and parametric
poseNMS [27]. The experimental results are shown in Ta-
ble 4(b). We can see that our association algorithm greatly
outperforms previous methods. We note that these NMS al-
gorithms are all instance-based. They eliminate redundancy
on instance level. Instance-based elimination is not the best
solution for pose estimation problem. Because of the com-
plexity of human pose, we need to reduce redundancy on
joints level. Meanwhile, all the NMS algorithms are greedy
algorithms essentially. Therefore, their results may be not
the global optimum. Our association algorithm can give the
global optimal result while running as efﬁcient as previous
NMS algorithm.

6. Conclusion

In this paper, we propose a novel method to tackle
the occlusion problem of pose estimation. By building a
person-joint graph based on the outputs of our joint can-
didates SPPE, we transform the pose estimation problem
into a graph matching problem and optimize the results in
a global manner. To better evaluate the model performance
in crowded scenes, we set up a CrowdPose dataset with a
normal distribution of Crowd Index. Our proposed method
signiﬁcantly outperforms the state-of-the-art methods in
CrowdPose dataset. Experiments on MSCOCO dataset also
demonstrate that our method can generalize to different sce-
narios.

Acknowledgement

This work is supported in part by the National Key R&D
Program of China, No. 2017YFA0700800, National Natural
Science Foundation of China under Grants 61772332.

10870

References

[1] Giorgio Carpaneto and Paolo Toth. Algorithm for the solu-
tion of the assignment problem for sparse matrices. Comput-
ing, 1983. 5

[2] Walter Whiteley. Some matroids from discrete applied ge-

ometry. Contemporary Mathematics, 1996. 5

[3] Sepp Hochreiter and J¨urgen Schmidhuber. Long short-term

memory. Neural computation, 9(8):1735–1780, 1997. 3

[4] Sam Johnson and Mark Everingham. Clustered pose and
nonlinear appearance models for human pose estimation. In
BMVC, 2010. 2

[5] Jialue Fan, Wei Xu, Ying Wu, and Yihong Gong. Human
tracking using convolutional neural networks. IEEE Trans-
actions on Neural Networks, 2010. 3

[6] Mark Everingham, Luc Van Gool, Christopher KI Williams,
John Winn, and Andrew Zisserman. The pascal visual object
classes (VOC) challenge. In ICCV, 2010. 2
[7] Tijmen Tieleman and Geoffrey Hinton.

Lecture 6.5-
RMSprop: Divide the gradient by a running average of its
recent magnitude. COURSERA: Neural networks for ma-
chine learning, 2012. 7

[8] Irshad Ali and Matthew N. Dailey. Multiple human tracking
in high-density crowds. Image and Vision Computing, 2012.
3

[9] Matthias Dantone, Juergen Gall, Christian Leistner, and Luc
Van Gool. Human pose estimation using body parts depen-
dent joint regressors. In CVPR, 2013. 2

[10] Xavier P Burgos-Artizzu, David C Hall, Pietro Perona, and
Piotr Doll´ar. Merging pose estimates across space and time.
In BMVC, 2013. 5, 8

[11] Hamid Izadinia, Varun Ramakrishna, Kris M. Kitani, and
Daniel Huber. Multi-pose multi-target tracking for activity
understanding. In WACV, 2013. 1

[12] H. Jhuang, J. Gall, S. Zufﬁ, C. Schmid, and M. J. Black.
Towards understanding action recognition. In ICCV, 2013. 2
[13] Mykhaylo Andriluka, Leonid Pishchulin, Peter Gehler, and
Bernt Schiele. 2D human pose estimation: New benchmark
and state of the art analysis. In CVPR, 2014. 1, 2, 6

[14] Leonid Pishchulin, Mykhaylo Andriluka, and Bernt Schiele.
Fine-grained activity recognition with holistic and pose
based features. GCPR, 2014. 1

[15] Tsung-Yi Lin, Michael Maire, Serge Belongie, James Hays,
Pietro Perona, Deva Ramanan, Piotr Doll´ar, and C Lawrence
Zitnick. Microsoft COCO: Common objects in context. In
ECCV, 2014. 1, 2, 4, 6

[16] Shaoqing Ren, Kaiming He, Ross Girshick, and Jian Sun.
Faster R-CNN: Towards real-time object detection with re-
gion proposal networks. In NIPS, 2015. 3

[17] Xianjie Chen and Alan L Yuille. Parsing occluded people by

ﬂexible compositions. In CVPR, 2015. 5, 8

[18] Fangting Xia, Jun Zhu, Peng Wang, and Alan L Yuille. Pose-
guided human parsing by an and/or graph using pose-context
features. In AAAI, 2016. 1

[19] Alejandro Newell, Kaiyu Yang, and Jia Deng. Stacked hour-
glass networks for human pose estimation. In ECCV, 2016.
3

[20] Jiahong Wu, He Zheng, Bo Zhao, Yixin Li, Baoming
Yan, Rui Liang, Wenjia Wang, Shipei Zhou, Guosen Lin,
Yanwei Fu, et al. AI Challenger: A large-scale dataset
for going deeper in image understanding. arXiv preprint
arXiv:1711.06475, 2017. 1, 2, 6

[21] Yilun Chen, Zhicheng Wang, Yuxiang Peng, Zhiqiang
Zhang, Gang Yu, and Jian Sun. Cascaded pyramid net-
work for multi-person pose estimation.
arXiv preprint
arXiv:1711.07319, 2017. 3

[22] Wei Yang, Shuang Li, Wanli Ouyang, Hongsheng Li, and
Xiaogang Wang. Learning feature pyramids for human pose
estimation. In ICCV, 2017. 3

[23] Kaiming He, Georgia Gkioxari, Piotr Doll´ar, and Ross Gir-

shick. Mask R-CNN. In ICCV, 2017. 1, 3, 7, 8

[24] Chao Peng, Tete Xiao, Zeming Li, Yuning Jiang, Xi-
angyu Zhang, Kai Jia, Gang Yu, and Jian Sun. MegDet:
A large mini-batch object detector.
arXiv preprint
arXiv:1711.07240, 2017. 3

[25] Yongyi Lu, Cewu Lu, and Chi-Keung Tang. Online video
object detection using association lstm. In The IEEE Inter-
national Conference on Computer Vision (ICCV), Oct 2017.
3

[26] Zhe Cao, Tomas Simon, Shih-En Wei, and Yaser Sheikh. Re-
altime multi-person 2D pose estimation using part afﬁnity
ﬁelds. In CVPR, 2017. 1, 3

[27] Hao-Shu Fang, Shuqin Xie, Yu-Wing Tai, and Cewu Lu.
In ICCV,

RMPE: Regional multi-person pose estimation.
2017. 1, 3, 5, 7, 8

[28] Wenguan Wang, Yuanlu Xu, Jianbing Shen, and Song-Chun
Zhu. Attentive fashion grammar network for fashion land-
mark detection and clothing category classiﬁcation.
In
CVPR, pages 4271–4280, 2018. 3

[29] Hei Law and Jia Deng. Cornernet: Detecting objects as
paired keypoints. In The European Conference on Computer
Vision (ECCV), September 2018. 3

[30] Shuai Shao, Zijian Zhao, Boxun Li, Tete Xiao, Gang Yu,
Xiangyu Zhang, and Jian Sun. CrowdHuman: A bench-
mark for detecting human in a crowd.
arXiv preprint
arXiv:1805.00123, 2018. 3

[31] Andrei Zanﬁr, Elisabeta Marinoiu, Mihai Zanﬁr, Alin-Ionut
Popa, and Cristian Sminchisescu. Deep network for the in-
tegrated 3d sensing of multiple people in natural images. In
Advances in Neural Information Processing Systems, pages
8420–8429, 2018. 1, 3

[32] Bo Pang, Kaiwen Zha, Hanwen Cao, Chen Shi, and Cewu
Lu. Deep rnn framework for visual sequential applications.
arXiv preprint arXiv:1811.09961, 2018. 3

[33] Xiao Sun, Bin Xiao, Fangyin Wei, Shuang Liang, and Yichen
Wei. Integral human pose regression. In Proceedings of the
European Conference on Computer Vision (ECCV), pages
529–545, 2018. 1

[34] Hao-Shu Fang, Yuanlu Xu, Wenguan Wang, Xiaobai Liu,
and Song-Chun Zhu. Learning pose grammar to encode hu-
man body conﬁguration for 3d pose estimation. In Thirty-
Second AAAI Conference on Artiﬁcial Intelligence, 2018. 1
[35] Muhammed Kocabas, Salih Karagoz, and Emre Akbas. Mul-
tiPoseNet: Fast multi-person pose estimation using pose
residual network. In ECCV, 2018. 3

10871

[36] Zhe Cao, Gines Hidalgo, Tomas Simon, Shih-En Wei, and
Yaser Sheikh. OpenPose: realtime multi-person 2D pose es-
timation using Part Afﬁnity Fields, 2018. 7, 8

[37] Hao-Shu Fang, Jinkun Cao, Yu-Wing Tai, and Cewu Lu.
Pairwise body-part attention for recognizing human-object
interactions. In The European Conference on Computer Vi-
sion (ECCV), September 2018. 1

[38] George Papandreou, Tyler Zhu, Liang-Chieh Chen, Spyros
Gidaris, Jonathan Tompson, and Kevin Murphy. Person-
Lab: Person pose estimation and instance segmentation with
a bottom-up, part-based, geometric embedding model. arXiv
preprint arXiv:1803.08225, 2018. 3

[39] Yuliang Xiu, Jiefeng Li, Haoyu Wang, Yinghong Fang, and
In

Cewu Lu. Pose Flow: Efﬁcient online pose tracking.
BMVC, 2018. 3

[40] Bin Xiao, Haiping Wu, and Yichen Wei. Simple baselines
for human pose estimation and tracking. In ECCV, 2018. 1,
3, 7, 8

[41] Yong-Lu Li, Siyuan Zhou, Xijie Huang, Liang Xu, Ze Ma,
Hao-Shu Fang, Yan-Feng Wang, and Cewu Lu. Transferable
interactiveness prior for human-object interaction detection.
arXiv preprint arXiv:1811.08264, 2018. 1

[42] Hao-Shu Fang, Guansong Lu, Xiaolin Fang, Jianwen Xie,
Yu-Wing Tai, and Cewu Lu. Weakly and semi supervised
human body part parsing via pose-guided knowledge trans-
fer. In CVPR, 2018. 1

[43] Joseph Redmon and Ali Farhadi. YOLOv3: An incremental

improvement. arXiv preprint arXiv:1804.02767, 2018. 7

10872

