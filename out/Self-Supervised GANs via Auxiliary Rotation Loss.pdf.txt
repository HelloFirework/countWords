Self-Supervised GANs via Auxiliary Rotation Loss

Ting Chen∗

University of California, Los Angeles

Xiaohua Zhai
Google Brain

Marvin Ritter
Google Brain

tingchen@cs.ucla.edu

xzhai@google.com

marvinritter@google.com

Mario Lucic
Google Brain

Neil Houlsby
Google Brain

lucic@google.com

neilhoulsby@google.com

Abstract

Conditional GANs are at the forefront of natural image
synthesis. The main drawback of such models is the neces-
sity for labeled data. In this work we exploit two popular
unsupervised learning techniques, adversarial training and
self-supervision, and take a step towards bridging the gap
between conditional and unconditional GANs. In particular,
we allow the networks to collaborate on the task of repre-
sentation learning, while being adversarial with respect to
the classic GAN game. The role of self-supervision is to
encourage the discriminator to learn meaningful feature rep-
resentations which are not forgotten during training. We test
empirically both the quality of the learned image represen-
tations, and the quality of the synthesized images. Under
the same conditions, the self-supervised GAN attains a simi-
lar performance to state-of-the-art conditional counterparts.
Finally, we show that this approach to fully unsupervised
learning can be scaled to attain an FID of 23.4 on uncondi-
tional IMAGENET generation.1

1. Introduction

Generative Adversarial Networks (GANs) are a class of
unsupervised generative models [1]. GANs involve train-
ing a generator and discriminator model in an adversarial
game, such that the generator learns to produce samples from
a desired data distribution. Training GANs is challenging
because it involves searching for a Nash equilibrium of a non-
convex game in a high-dimensional parameter space. In prac-
tice, GANs are typically trained using alternating stochastic
gradient descent which is often unstable and lacks theoretical
guarantees [2]. Consequently, training may exhibit instabil-
ity, divergence, cyclic behavior, or mode collapse [3]. As a
result, many techniques to stabilize GAN training have been

∗Work done at Google.
1Code at https://github.com/google/compare_gan.

proposed [4, 5, 6, 7, 8, 9, 10]. A major contributor to train-
ing instability is the fact that the generator and discriminator
learn in a non-stationary environment. In particular, the dis-
criminator is a classiﬁer for which the distribution of one
class (the fake samples) shifts as the generator changes dur-
ing training. In non-stationary online environments, neural
networks forget previous tasks [11, 12, 13]. If the discrimi-
nator forgets previous classiﬁcation boundaries, training may
become unstable or cyclic. This issue is usually addressed
either by reusing old samples or by applying continual learn-
ing techniques [14, 15, 16, 17, 18, 19]. These issues become
more prominent in the context of complex data sets. A key
technique in these settings is conditioning [9, 20, 21, 22]
whereby both the generator and discriminator have access to
labeled data. Arguably, augmenting the discriminator with
supervised information encourages it to learn more stable
representations which opposes catastrophic forgetting. Fur-
thermore, learning the conditional model for each class is
easier than learning the joint distribution. The main draw-
back in this setting is the necessity for labeled data. Even
when labeled data is available, it is usually sparse and covers
only a limited amount of high level abstractions.

Motivated by the aforementioned challenges, our goal is
to show that one can recover the beneﬁts of conditioning,
without requiring labeled data. To ensure that the representa-
tions learned by the discriminator are more stable and useful,
we add an auxiliary, self-supervised loss to the discriminator.
This leads to more stable training because the dependence
of the discriminator’s representations on the quality of the
generator’s output is reduced. We introduce a novel model –
the self-supervised GAN – in which the generator and dis-
criminator collaborate on the task of representation learning,
and compete on the generative task.

Our contributions We present an unsupervised gener-
ative model that combines adversarial training with self-
supervised learning. Our model recovers the beneﬁts of
conditional GANs, but requires no labeled data. In particu-

112154

Figure 1: Discriminator with rotation-based self-supervision. The discriminator, D, performs two tasks: true vs. fake binary
classiﬁcation, and rotation degree classiﬁcation. Both the fake and real images are rotated by 0, 90, 180, and 270 degrees. The
colored arrows indicate that only the upright images are considered for true vs. fake classiﬁcation loss task. For the rotation
loss, all images are classiﬁed by the discriminator according to their rotation degree.

lar, under the same training conditions, the self-supervised
GAN closes the gap in natural image synthesis between un-
conditional and conditional models. Within this setting the
quality of discriminator’s representations is greatly increased
which might be of separate interest in the context of transfer
learning. A large-scale implementation of the model leads to
promising results on unconditional IMAGENET generation,
a task considered daunting by the community. We believe
that this work is an important step in the direction of high
quality, fully unsupervised, natural image synthesis.

2. A Key Issue: Discriminator Forgetting

The original value function for GAN training is [1]:

V (G, D) =E

x∼Pdata(x)[log PD(S = 1 | x)]
+ E

x∼PG(x)[log(1 − PD(S = 0 | x))]

(1)

where Pdata is the true data distribution, and PG is the
distribution induced by transforming a simple distribution
z ∼ P (z) using the deterministic mapping given by the gen-
erator, x = G(z), and PD is the discriminator’s Bernoulli
distribution over the labels (true or fake). In the original
minimax setting the generator maximizes Equation 1 with
respect to it’s parameters, while the discriminator minimizes
it. Training is typically performed via alternating stochastic
gradient descent. Therefore, at iteration t during training,
the discriminator classiﬁes samples as coming from Pdata
or P (t)
G . As the parameters of G change, the distribution
P (t)
G changes, which implies a non-stationary online learn-
ing problem for the discriminator.

This challenge has received a great deal of attention and
explicit temporal dependencies have been proposed to im-
prove training in this setting [2, 15, 17, 19]. Furthermore,
in online learning of non-convex functions, neural networks
have been shown to forget previous tasks [11, 12, 13]. In
the context of GANs, learning varying levels of detail, struc-
ture, and texture, can be considered different tasks. For
example, if the generator ﬁrst learns the global structure,
the discriminator will naturally try to build a representation
which allows it to efﬁciently penalize the generator based
only on the differences in global structure, or the lack of lo-
cal structure. As such, one source of instability in training is
that the discriminator is not incentivised to maintain a useful
data representation as long as the current representation is
useful to discriminate between the classes.

Further evidence can be gathered by considering the gen-
erator and discriminator at convergence. Indeed, Goodfel-
low et al. [1] show that the optimal discriminator estimates
the likelihood ratio between the generated and real data
distributions. Therefore, given a perfect generator, where
PG = Pdata, the optimal discriminator simply outputs 0.5,
which is a constant and doesn’t depend on the input. Hence,
this discriminator would have no requirement to retain mean-
ingful representations. Furthermore, if regularization is ap-
plied, the discriminator might ignore all but the minor fea-
tures which distinguish real and fake data.

We demonstrate the impact of discriminator forgetting in
two settings. (1) A simple scenario shown in Figure 3(a),
and, (2) during the training of a GAN shown in Figure 2. In
the ﬁrst case a classiﬁer is trained sequentially on 1-vs.-all

12155

180°D0°Fake imageReal imageReal / FakeRotation degree90°270°Shared weightsDFigure 2: Performance of a linear classiﬁcation model,
trained on IMAGENET on representations extracted from
the ﬁnal layer of the discriminator. Uncond-GAN denotes
an unconditional GAN. SS-GAN denotes the same model
when self-supervision is added. For the Uncond-GAN, the
representation gathers information about the class of the
image and the accuracy increases. However, after 500k
iterations, the representations lose information about the
classes and performance decreases. SS-GAN alleviates this
problem. More details are presented in Section 4.

classiﬁcation tasks on each of the ten classes in CIFAR10. It
is trained for 1k iterations on each task before switching to
the next. At 10k iterations the training cycle repeats from the
ﬁrst task. Figure 3(a) shows substantial forgetting, despite
the tasks being similar. Each time the task switches, the
classiﬁer accuracy drops substantially. After 10k iterations,
the cycle of tasks repeats, and the accuracy is the same as
the ﬁrst cycle. No useful information is carried across tasks.
This demonstrates that the model does not retain general-
izable representations in this non-stationary environment.
In the second setting shown in Figure 2 we observe a simi-
lar effect during GAN training. Every 100k iterations, the
discriminator representations are evaluated on IMAGENET
classiﬁcation; the full protocol is described in Section 4.4.
During training, classiﬁcation of the unconditional GAN
increases, then decreases, indicating that information about
the classes is acquired and later forgotten. This forgetting
correlates with training instability. Adding self-supervision,
as detailed in the following section, prevents this forgetting
of the classes in the discriminator representations.

3. The Self-Supervised GAN

Motivated by the main challenge of discriminator forget-
ting, we aim to imbue the discriminator with a mechanism
which allows learning useful representations, independently
of the quality of the current generator. To this end, we exploit
recent advancements in self-supervised approaches for repre-
sentation learning. The main idea behind self-supervision is

Figure 3: Image classiﬁcation accuracy when the underly-
ing class distribution shifts every 1k iterations. The vertical
dashed line indicates the end of an entire cycle through the
tasks, and return to the original classiﬁcation task at t = 0.
Left: vanilla classiﬁer. Right: classiﬁer with an additional
self-supervised loss. This example demonstrates that a clas-
siﬁer may fail to learn generalizable representations in a
non-stationary environment, but self-supervision helps miti-
gate this problem.

to train a model on a pretext task like predicting rotation an-
gle or relative location of an image patch, and then extracting
representations from the resulting networks [23, 24, 25]. We
propose to add a self-supervised task to our discriminator.

In particular, we apply the state-of-the-art

self-
supervision method based on image rotation [26]. In this
method, the images are rotated, and the angle of rotation be-
comes the artiﬁcial label (cf. Figure 1). The self-supervised
task is then to predict the angle of rotation of an image.
The effects of this additional loss on the image classiﬁca-
tion task is evident in Figure 3(b): When coupled with the
self-supervised loss, the network learns representations that
transfer across tasks and the performance continually im-
proves. On the second cycle through the tasks, from 10k
iterations onward, performance is improved. Intuitively, this
loss encourages the classiﬁer to learn useful image represen-
tations to detect the rotation angles, which transfers to the
image classiﬁcation task.

We augment the discriminator with a rotation-based loss

which results in the following loss functions:

LG = −V (G, D) − αEx∼PG
LD = V (G, D) − βEx∼Pdata

Er∼R [log QD(R = r | x
Er∼R [log QD(R = r | x

r)] ,
r)] ,

where V (G, D) is the value function from Equation 1, r ∈ R
is a rotation selected from a set of possible rotations. In this
work we use R = {0
} as in Gidaris et al.
[26]. Image x rotated by r degrees is denoted as xr, and
Q(R | xr) is the discriminator’s predictive distribution over
the angles of rotation of the sample.

, 180

, 270

, 90

◦

◦

◦

◦

12156

100k200k300k400k500k600k700k800k900k1MGAN training iterations0.050.100.150.200.250.300.350.400.45AccuracyGANSS-GAN05k10k15k20kIterations  (a) Regular training.0.50.60.70.80.9Classifier accuracy05k10k15k20kIterations  (b) With self-supervision.Collaborative Adversarial Training In our model, the
generator and discriminator are adversarial with respect to
the true vs. fake prediction loss, V (G, D), however, they are
collaborative with respect to the rotation task. First, consider
the value function of the generator which biases the gener-
ation towards images, that when rotated, the discriminator
can detect their rotation angle. Note that the generator is
not conditional but only generates “upright” images which
are subsequently rotated and fed to the discriminator. On
the other hand, the discriminator is trained to detect rota-
tion angles based only on the true data. In other words, the
parameters of the discriminator get updated only based on
the rotation loss on the true data. This prevents the undesir-
able collaborative solution whereby the generator generates
images whose subsequent rotation is easy to detect. As a
result, the generator is encouraged to generate images that
are rotation-detectable because they share features with real
images that are used for rotation classiﬁcation.

In practice, we use a single discriminator network with
two heads to compute PD and QD. Figure 1 depicts the
training pipeline. We rotate the real and generated images in
four major rotations. The goal of the discriminator on non-
rotated images is to predict whether the input is true or fake.
On rotated real images, its goal is to detect the rotation angle.
The goal of the generator is to generate images matching
the observed data, whose representation in the feature space
of the discriminator allows detecting rotations. With α > 0
convergence to the true data distribution PG = Pdata is
not guaranteed. However, annealing α towards zero during
training will restore the guarantees.

4. Experiments

We demonstrate empirically that (1) self-supervision im-
proves the representation quality with respect to baseline
GAN models, and that (2) it leads to improved unconditional
generation for complex datasets, matching the performance
of conditional GANs, under equal training conditions.

4.1. Experimental Settings

Datasets We focus primarily on IMAGENET, the largest
and most diverse image dataset commonly used to evaluate
GANs. Until now, most GANs trained on IMAGENET are
conditional. IMAGENET contains 1.3M training images and
50k test images. We resize the images to 128 × 128 × 3
as done in Miyato and Koyama [21] and Zhang et al. [9].
We provide additional comparison on three smaller datasets,
namely CIFAR10, CELEBA-HQ, LSUN-BEDROOM, for which
unconditional GANs can be successfully trained. The LSUN-
BEDROOM dataset [27] contains 3M images. We partition
these randomly into a test set containing approximately 30k
images and a train set containing the rest. CELEBA-HQ
contains 30k images [10]. We use the 128 × 128 × 3 version

DATASET

METHOD

CIFAR10

IMAGENET

LSUN-BEDROOM

CELEBA-HQ

Uncond-GAN
Cond-GAN
SS-GAN
SS-GAN (sBN)

Uncond-GAN
Cond-GAN
SS-GAN
SS-GAN (sBN)

Uncond-GAN
SS-GAN
SS-GAN (sBN)

Uncond-GAN
SS-GAN
SS-GAN (sBN)

FID

19.73
15.60
17.11
15.65

56.67
42.07
47.56
43.87

16.02
13.66
13.30

23.77
26.11
24.36

Table 1: Best FID attained across three random seeds. In this
setting the proposed approach recovers most of the beneﬁts
of conditioning.

obtained by running the code provided by the authors.2 We
use 3k examples as the test set and the remaining examples as
the training set. CIFAR10 contains 70k images (32 × 32 × 3),
partitioned into 60k training instances and 10k test instances.

Models We compare the self-supervised GAN (SS-GAN)
to two well-performing baseline models, namely (1) the
unconditional GAN with spectral normalization proposed
in Miyato et al. [6], denoted Uncond-GAN, and (2) the condi-
tional GAN using the label-conditioning strategy and the Pro-
jection Conditional GAN (Cond-GAN) [21]. We chose the
latter as it was shown to outperform the AC-GAN [20], and is
adopted by the best performing conditional GANs [9, 3, 22].
We use ResNet architectures for the generator and dis-
criminator as in Miyato et al. [6]. For the conditional gen-
erator in Cond-GAN, we apply label-conditional batch nor-
malization. In contrast, SS-GAN does not use conditional
batch normalization. However, to have a similar effect on
the generator, we consider a variant of SS-GAN where we
apply the self-modulated batch normalization which does
not require labels [7] and denote it SS-GAN (sBN). We note
that labels are available only for CIFAR10 and IMAGENET,
so Cond-GAN is only applied on those data sets.

We use a batch size of 64 and to implement the rotation-
loss we rotate 16 images in the batch in all four considered
directions. We do not add any new images into the batch to
compute the rotation loss. For the true vs. fake task we use
the hinge loss from Miyato et al. [6]. We set β = 1 or the
the self-supervised loss. For α we performed a small sweep

2https://github.com/tkarras/progressive_

growing_of_gans.

12157

TYPE

λ

β1

β2

D ITERS UNCOND-GAN SS-GAN

UNCOND-GAN SS-GAN

CIFAR10

IMAGENET

GRADIENT PENALTY

SPECTRAL NORM

1

10

0

0.0

0.900

0.5

0.999

0.0

0.900

0.5

0.999

0.0

0.900

0.5

0.999

1

2

1

1

2

1

1

2

1

121.05 ± 31.44

25.8 ± 0.71

183.36 ± 77.21

80.67 ± 0.43

28.11 ± 0.66

26.98 ± 0.54

85.13 ± 2.88

83.08 ± 0.38

78.54 ± 6.23

25.89 ± 0.33

104.73 ± 2.71

91.63 ± 2.78

188.52 ± 64.54

28.48 ± 0.68

227.04 ± 31.45

85.38 ± 2.7

29.11 ± 0.85

27.74 ± 0.73

227.74 ± 16.82

80.82 ± 0.64

117.67 ± 17.46

25.22 ± 0.38

242.71 ± 13.62

144.35 ± 91.4

87.86 ± 3.44

19.65 ± 0.9

129.96 ± 6.6

86.09 ± 7.66

20.24 ± 0.62

17.88 ± 0.64

80.05 ± 1.33

70.64 ± 0.31

86.87 ± 8.03

18.23 ± 0.56

201.94 ± 27.28

99.97 ± 2.75

Table 2: FID for unconditional GANs under different hyperparameter settings. Mean and standard deviations are computed
across three random seeds. Adding the self-supervision loss reduces the sensitivity of GAN training to hyperparameters.

α ∈ {0.2, 0.5, 1}, and select α = 0.2 for all datasets (see the
appendix for details). For all other hyperparameters, we use
the values in Miyato et al. [6] and Miyato and Koyama [21].
We train CIFAR10, LSUN-BEDROOM and CELEBA-HQ for
100k steps on a single P100 GPU. For IMAGENET we train
for 1M steps. For all datasets we use the Adam optimizer
with learning rate 0.0002.

(Table 1), the performance gap is within 5%. On CIFAR10
and LSUN-BEDROOM we observe a substantial improvement
over the unconditional GAN and matching the performance
of the conditional GAN. Self-supervision appears not to
signiﬁcantly improve the results on CELEBA-HQ. We posit
that this is due to low-diversity in CELEBA-HQ, and also for
which rotation task is less informative.

4.2. Comparison of Sample Quality

Metrics To evaluate generated samples from different
methods quantitatively, we use the Frechet Inception Dis-
tance (FID) [28]. In FID, the true data and generated sam-
ples are ﬁrst embedded in a speciﬁc layer of a pre-trained
Inception network. Then, a multivariate Gaussian is ﬁt
to the data and the distance computed as FID(x, g) =
||µx − µg||2
2 ), where µ and
Σ denote the empirical mean and covariance and subscripts
x and g denote the true and generated data respectively. FID
is shown to be sensitive to both the addition of spurious
modes and to mode dropping [29, 30]. An alternative ap-
proximate measure of sample quality is Inceptions Score
(IS) Salimans et al. [2]. Since it has some ﬂaws Barratt and
Sharma [31], we use FID as the main metric in this work.

2 + Tr(Σx + Σg − 2(ΣxΣg)

1

Results Figure 4 shows FID training curves on CIFAR10
and IMAGENET. Table 1 shows the FID of the best run
across three random seeds for each dataset and model com-
bination. The unconditional GAN is unstable on IMAGENET
and the training often diverges. The conditional counterpart
outperforms it substantially. The proposed method, namely
SS-GAN, is stable on IMAGENET, and performs substan-
tially better than the unconditional GAN. When equipped
with self-modulation it matches the performance on the con-
ditional GAN. In terms of mean performance (Figure 4)
the proposed approach matches the conditional GAN, and
in terms of the best models selected across random seeds

Robustness across hyperparameters GANs are fragile;
changes to the hyperparameter settings have a substantial
impact to their performance [30, 32]. Therefore, we evaluate
different hyperparameter settings to test the stability of SS-
GAN. We consider two classes of hyperparameters: First,
those controlling the Lipschitz constant of the discriminator,
a central quantity analyzed in the GAN literature [6, 33]. We
evaluate two state-of-the-art techniques: gradient penalty [5],
and spectral normalization [6]. The gradient penalty intro-
duces a regularization strength parameter, λ. We test two
values λ ∈ {1, 10}. Second, we vary the hyperparameters of
the Adam optimizer. We test two popular settings (β1, β2):
(0.5, 0.999) and (0, 0.9). Previous studies ﬁnd that multiple
discriminator steps per generator step help training [1, 2], so
we try both 1 and 2 discriminator steps per generator step.

Table 2 compares the mean FID scores of the uncondi-
tional models across penalties and optimization hyperpa-
rameters. We observe that the proposed approach yields
consistent performance improvements. We observe that in
settings where the unconditional GAN collapses (yielding
FIDs larger than 100) the self-supervised model does not
exhibit such a collapse.

4.3. Large Scale Self Supervised GAN

We scale up training the SS-GAN to attain the best pos-
sible FID for unconditional IMAGENET generation. To do
this, we increase the model’s capacity to match the model

12158

(a) CIFAR10

(b) IMAGENET

Figure 4: FID learning curves on CIFAR10 and IMAGENET. The curves show the mean performance across three random
seeds. The unconditional GAN (Uncond-GAN) attains signiﬁcantly poorer performance than the conditional GAN (Cond-
GAN). The unconditional GAN is unstable on IMAGENET and the runs often diverge after 500k training iterations. The
addition of self-supervision (SS-GAN) stabilizes Uncond-GAN and boosts performance. Finally, when we add the additional
self-modulated Batch Norm (sBN) [7] to SS-GAN, which mimics generator conditioning in the unconditional setting, this
unconditional model attains the same mean performance as the conditional GAN.

in [22].3 We train the model on 128 cores of Google TPU
v3 Pod for 500k steps using batch size of 2048. For com-
parison, we also train the same model without the auxiliary
self-supervised loss (Uncond-GAN). We report the FID at
50k to be comparable other literature reporting results on
IMAGENET. We repeat each run three times with different
random seeds.

For SS-GAN we obtain the FID of 23.6 ± 0.1 and
71.6 ± 66.3 for Uncond-GAN. Self-supervision stabilizes
training; the mean and variance across random seeds is
greatly reduced because, unlike for the regular unconditional
GAN, SS-GAN never collapsed. We observe improvement
in the best model across random seeds, and the best SS-GAN
attains an FID of 23.4. To our knowledge, this is the best
results attained training unconditionally on IMAGENET.

4.4. Representation Quality

We test empirically whether self-supervision encourages
the discriminator to learn meaningful representations. For
this, we compare the quality of the representations extracted
from the intermediate layers of the discriminator’s ResNet
architecture. We apply a common evaluation method for
representation learning, proposed in Zhang et al. [25]. In
particular, we train a logistic regression classiﬁer on the
feature maps from each ResNet block to perform the 1000-
way classiﬁcation task on IMAGENET or 10-way on CIFAR10
and report top-1 classiﬁcation accuracy.

We report results using the Cond-GAN, Uncond-GAN,

3The details can be found at https://github.com/google/

compare_gan.

Figure 5: A random sample of unconditionally generated
images from the self-supervised model. To our knowledge,
this is the best results attained training unconditionally on
IMAGENET.

and SS-GAN models. We also ablate the adversarial loss
from our SS-GAN which results in a purely rotation-based
self-supervised model (Rot-only) which uses the same ar-
chitecture and hyperparameters as the SS-GAN discrimi-
nator. We report the mean accuracy and standard deviation

12159

010k20k30k40k50k60k70k80k90k100kIteration1520253035FIDUncond-GANCond-GANSS-GANSS-GAN (sBN)0100k200k300k400k500k600k700k800k900k1MIteration405060708090100110120FIDUncond-GANCond-GANSS-GANSS-GAN (sBN)across three independent models with different random seeds.
Training details for the logistic classiﬁer are in the appendix.

Results Table 4 shows the quality of representation at after
1M training steps on IMAGENET. Figure 6 shows the learning
curves for representation quality of the ﬁnal ResNet block
on IMAGENET. The curves for the other blocks are provided
in appendix. Note that “training steps” refers to the training
iterations of the original GAN, and not to the linear classiﬁer
which is always trained to convergence. Overall, the SS-
GAN yields the best representations across all blocks and
training iterations. We observe similar results on CIFAR10
provided in Table 3.

In detail, the IMAGENET ResNet contains six blocks.
For Uncond-GAN and Rot-only, Block 3 performs best,
for Cond-GAN and SS-GAN, the ﬁnal Block 5 performs
best. The representation quality for Uncond-GAN drops at
500k steps, which is consistent with the FID drop in Fig-
ure 4. Overall, the SS-GAN and Cond-GAN representations
are better than Uncond-GAN, which correlates with their
improved sample quality. Surprisingly, the the SS-GAN
overtakes Cond-GAN after training for 300k steps. One pos-
sibility is that the Cond-GAN is overﬁtting the training data.
We inspect the representation performance of Cond-GAN
on the training set and indeed see a very large generalization

Uncond. Cond. Rot-only

SS-GAN (sBN)

Block0
Block1
Block2
Block3

0.719
0.762
0.778
0.776

0.719
0.759
0.776
0.780

0.710
0.749
0.762
0.752

Best

0.778

0.780

0.762

0.721
0.774
0.796
0.799

0.799

Table 3: Top-1 accuracy on CIFAR10. Mean score across
three training runs of the original model. All standard devia-
tions are smaller than 0.01 and are reported in the appendix.

Method Uncond. Cond. Rot-only

SS-GAN (sBN)

Block0
Block1
Block2
Block3
Block4
Block5

0.074
0.063
0.073
0.083
0.077
0.074

0.156
0.187
0.217
0.272
0.253
0.337

0.147
0.134
0.158
0.202
0.196
0.195

Best

0.083

0.337

0.202

0.158
0.222
0.250
0.327
0.358
0.383

0.383

Figure 6: IMAGENET Top 1 accuracy (mean across three
seeds) to predict labels from discriminator representations.
X-axis gives the number of GAN training iterations.

gap, which indicates overﬁtting.

When we ablate the GAN loss, leaving just the rotation
loss, the representation quality substantially decreases. It
seems that the adversarial and rotation losses complement
each other both in terms of FID and representation qual-
ity. We emphasize that our discriminator architecture is
optimized for image generation, not representation quality.
Rot-only, therefore, is an ablation method, and is not a state-
of-the-art self-supervised learning algorithm. We discuss
these next.

Table 5 compares the representation quality of SS-GAN
to state-of-the-art published self-supervised learning algo-
rithms. Despite the architecture and hyperparameters being
optimized for image quality, the SS-GAN model achieves
competitive results on IMAGENET. Among those methods,
only BiGAN [34] also uses a GAN to learn representations;
but SS-GAN performs substantially (0.073 accuracy points)
better. BiGAN learns the representation with an additional
encoder network, while SS-GAN is arguably simpler because
it extracts the representation directly from the discriminator.
The best performing method is the recent DeepClustering
algorithm [35]. This method is just 0.027 accuracy points
ahead of SS-GAN and requires expensive ofﬂine clustering
after every training epoch.

In summary, the representation quality evaluation high-
lights the correlation between representation quality and
image quality. It also conﬁrms that the SS-GAN does learn
relatively powerful image representations.

Table 4: Top-1 accuracy on IMAGENET. Mean score across
three training runs of the original model. All standard devia-
tions are smaller than 0.01, except for Uncond-GAN whose
results exhibit high variance due to training instability. All
standard deviations are reported in the appendix.

5. Related Work

GAN forgetting Catastrophic forgetting was previously
considered as a major cause for GAN training instability.
The main remedy suggested in the literature is to introduce

12160

100k200k300k400k500k600k700k800k900k1MGAN training iterations0.050.100.150.200.250.300.350.400.45final block (block5)UncondCondRot-OnlySS-GANMethod

Accuracy

Context [24]
BiGAN [34, 36]
Colorization [25]
RotNet [26]
DeepClustering [35]
SS-GAN (sBN)

0.317
0.310
0.326
0.387
0.410
0.383

Table 5: Comparison with other self-supervised representa-
tion learning methods by top-1 accuracy on IMAGENET. For
SS-GAN, the mean performance is presented.

temporal memory into the training algorithm in various ways.
For example, Grnarova et al. [19] induce discriminator mem-
ory by replaying previously generated images. An alternative
is to instead reuse previous models: Salimans et al. [2] intro-
duce checkpoint averaging, where a running average of the
parameters of each player is kept, and Grnarova et al. [19]
maintain a queue of models that are used at each training
iteration. Kim et al. [18] add memory to retain information
about previous samples. Other papers frame GAN training
as a continual learning task. Thanh-Tung et al. [14] study
catastrophic forgetting in the discriminator and mode col-
lapse, relating these to training instability. Liang et al. [15]
counter discriminator forgetting by leveraging techniques
from continual learning directly (Elastic Weight Sharing [11]
and Intelligent Synapses [37]).

Conditional GANs Conditional GANs are currently the
best approach for generative modeling of complex data sets,
such as ImageNet. The AC-GAN was the ﬁrst model to
introduce an auxiliary classiﬁcation loss for the discrimina-
tor [20]. The main difference between AC-GAN and the
proposed approach is that self-supervised GAN requires
no labels. Furthermore, the AC-GAN generator generates
images conditioned on the class, whereas our generator is
unconditional and the images are subsequently rotated to pro-
duce the artiﬁcial label. Finally, the self-supervision loss for
the discriminator is applied only over real images, whereas
the AC-GAN uses both real and fake.

More recently, the P-cGAN model proposed by Miyato
and Koyama [21] includes one real/fake head per class [21].
This architecture improves performance over AC-GAN. The
best performing GANs trained on GPUs [9] and TPUs [22]
use P-cGAN style conditioning in the discriminator. We
note that conditional GANs also use labels in the generator,
either by concatenating with the latent vector, or via FiLM
modulation [38].

Self-supervised learning Self-supervised learning is a
family of methods that learn the high level semantic repre-
sentation by solving a surrogate task. It has been widely used

in the video domain [39, 40], the robotics domain [41, 42]
and the image domain [24, 35]. We focused on the image
domain in this paper. Gidaris et al. [26] proposed to rotate
the image and predict the rotation angle. This conceptually
simple task yields useful representations for downstream
image classiﬁcation tasks. Apart form trying to predict the
rotation, one can also make edits to the given image and
ask the network to predict the edited part. For example, the
network can be trained to solve the context prediction prob-
lem, like the relative location of disjoint patches [24, 43] or
the patch permutation of a jigsaw puzzle [44]. Other surro-
gate tasks include image inpainting [45], predicting the color
channels from a grayscale image [25], and predicting the
unsupervised clustering classes [35]. Recently, Kolesnikov
et al. [46] conducted a study on self-supervised learning with
modern neural architectures.

6. Conclusions and Future Work

Motivated by the desire to counter discriminator forget-
ting, we propose a deep generative model that combines
adversarial and self-supervised learning. The resulting novel
model, namely self-supervised GAN when combined with
the recently introduced self-modulation, can match equiva-
lent conditional GANs on the task of image synthesis, with-
out having access to labeled data. We then show that this
model can be scaled to attain an FID of 23.4 on unconditional
ImageNet generation which is an extremely challenging task.

This line of work opens several avenues for future re-
search. First, it would be interesting to use a state-of-the-art
self-supervised architecture for the discriminator, and op-
timize for best possible representations. Second, the self-
supervised GAN could be used in a semi-supervised setting
where a small number of labels could be used to ﬁne-tune the
model. Finally, one may exploit several recently introduced
techniques, such as self-attention, orthogonal normalization
and regularization, and sampling truncation [9, 22], to yield
even better performance in unconditional image synthesis.

We hope that this approach, combining collaborative self-
supervision with adversarial training, can pave the way to-
wards high quality, fully unsupervised, generative modeling
of complex data.

Acknowledgements

We would also like to thank Marcin Michalski, Karol
Kurach and Anton Raichuk for their help with infustrature,
and major contributions to the Compare GAN library. We
appreciate useful discussions with Ilya Tolstikhin, Olivier
Bachem, Alexander Kolesnikov, Josip Djolonga, and Tian-
sheng Yao. Finally, we are grateful for the support of other
members of the Google Brain team, Zürich.

12161

References

[1] Ian Goodfellow, Jean Pouget-Abadie, Mehdi Mirza, Bing
Xu, David Warde-Farley, Sherjil Ozair, Aaron Courville, and
Yoshua Bengio. Generative adversarial nets. In Advances in
Neural Information Processing Systems (NIPS), 2014.

[2] Tim Salimans, Ian Goodfellow, Wojciech Zaremba, Vicki
Cheung, Alec Radford, and Xi Chen. Improved techniques for
training gans. In Advances in Neural Information Processing
Systems (NIPS), 2016.

[3] Lars Mescheder, Andreas Geiger, and Sebastian Nowozin.
Which training methods for gans do actually converge? In In-
ternational Conference on Machine Learning (ICML), 2018.

[4] Xudong Mao, Qing Li, Haoran Xie, Raymond YK Lau, Zhen
Wang, and Stephen Paul Smolley. Least squares generative ad-
versarial networks. In International Conference on Computer
Vision (ICCV), 2016.

[5] Ishaan Gulrajani, Faruk Ahmed, Martin Arjovsky, Vincent
Dumoulin, and Aaron Courville. Improved training of Wasser-
stein GANs. Advances in Neural Information Processing
Systems (NIPS), 2017.

[6] Takeru Miyato, Toshiki Kataoka, Masanori Koyama, and
Yuichi Yoshida. Spectral normalization for generative ad-
versarial networks. International Conference on Learning
Representations (ICLR), 2018.

[7] Ting Chen, Mario Lucic, Neil Houlsby, and Sylvain Gelly.
On Self Modulation for Generative Adversarial Networks.
In International Conference on Learning Representations
(ICLR), 2019.

[8] Alec Radford, Luke Metz, and Soumith Chintala. Unsuper-
vised representation learning with deep convolutional gener-
ative adversarial networks. In International Conference on
Learning Representations (ICLR), 2016.

[9] Han Zhang, Ian Goodfellow, Dimitris Metaxas, and Augustus
Odena. Self-attention generative adversarial networks. arXiv
preprint arXiv:1805.08318, 2018.

[10] Tero Karras, Timo Aila, Samuli Laine, and Jaakko Lehtinen.
Progressive growing of gans for improved quality, stability,
and variation. In International Conference on Learning Rep-
resentations (ICLR), 2018.

[11] James Kirkpatrick, Razvan Pascanu, Neil Rabinowitz, Joel
Veness, Guillaume Desjardins, Andrei A Rusu, Kieran Milan,
John Quan, Tiago Ramalho, Agnieszka Grabska-Barwinska,
et al. Overcoming catastrophic forgetting in neural networks.
Proceedings of the National Academy of Sciences, 2017.

[13] Robert M French. Catastrophic forgetting in connectionist

networks. Trends in cognitive sciences, 1999.

[14] Hoang Thanh-Tung, Truyen Tran, and Svetha Venkatesh. On
catastrophic forgetting and mode collapse in generative adver-
sarial networks. ICML Workshop on Theoretical Foundations
and Applications of Deep Generative Models, 2018.

[15] Kevin J Liang, Chunyuan Li, Guoyin Wang, and Lawrence
Carin. Generative Adversarial Network Training is a Con-
tinual Learning Problem. arXiv preprint arXiv:1811.11083,
2018.

[16] Ari Seff, Alex Beatson, Daniel Suo, and Han Liu. Contin-
ual learning in Generative Adversarial Nets. arXiv preprint
arXiv:1705.08395, 2017.

[17] Ashish Shrivastava, Tomas Pﬁster, Oncel Tuzel, Joshua
Susskind, Wenda Wang, and Russell Webb. Learning from
simulated and unsupervised images through adversarial train-
ing. In Computer Vision and Pattern Recognition (CVPR),
2017.

[18] Youngjin Kim, Minjung Kim, and Gunhee Kim. Memoriza-
tion precedes generation: Learning unsupervised gans with
memory networks. International Conference on Learning
Representations (ICLR), 2018.

[19] Paulina Grnarova, Kﬁr Y Levy, Aurelien Lucchi, Thomas
Hofmann, and Andreas Krause. An online learning approach
to generative adversarial networks. In International Confer-
ence on Learning Representations (ICLR), 2018.

[20] Augustus Odena, Christopher Olah, and Jonathon Shlens.
Conditional image synthesis with auxiliary classiﬁer GANs.
In International Conference on Machine Learning (ICML),
2017.

[21] Takeru Miyato and Masanori Koyama. cgans with projec-
International Conference on Learning

tion discriminator.
Representations (ICLR), 2018.

[22] Andrew Brock, Jeff Donahue, and Karen Simonyan. Large
scale gan training for high ﬁdelity natural image synthesis.
arXiv preprint arXiv:1809.11096, 2018.

[23] Alexey Dosovitskiy, Jost Tobias Springenberg, Martin Ried-
miller, and Thomas Brox. Discriminative unsupervised fea-
ture learning with convolutional neural networks. In Advances
in Neural Information Processing Systems (NIPS), 2014.

[24] Carl Doersch, Abhinav Gupta, and Alexei A Efros. Unsuper-
vised visual representation learning by context prediction. In
International Conference on Computer Vision (ICCV), 2015.

[25] Richard Zhang, Phillip Isola, and Alexei A Efros. Colorful
image colorization. In European Conference on Computer
Vision (ECCV), 2016.

[12] Michael McCloskey and Neal J Cohen. Catastrophic interfer-
ence in connectionist networks: The sequential learning prob-
lem. In Psychology of learning and motivation, volume 24.
Elsevier, 1989.

[26] Spyros Gidaris, Praveer Singh, and Nikos Komodakis. Unsu-
pervised representation learning by predicting image rotations.
In International Conference on Learning Representations
(ICLR), 2018.

12162

[27] Fisher Yu, Yinda Zhang, Shuran Song, Ari Seff, and Jianxiong
Xiao. Lsun: Construction of a large-scale image dataset
using deep learning with humans in the loop. arXiv preprint
arXiv:1506.03365, 2015.

[40] Hsin-Ying Lee, Jia-Bin Huang, Maneesh Singh, and Ming-
Hsuan Yang. Unsupervised representation learning by sorting
sequences. In International Conference on Computer Vision
(ICCV), 2017.

[41] Eric Jang, Coline Devin, Vincent Vanhoucke, and Sergey
Levine. Grasp2vec: Learning object representations from
self-supervised grasping. In Conference on Robot Learning
(CoRL, 2018.

[42] Lerrel Pinto and Abhinav Gupta. Supersizing self-supervision:
Learning to grasp from 50k tries and 700 robot hours. In In-
ternational Conference on Robotics and Automation (ICRA),
2016.

[43] T Nathan Mundhenk, Daniel Ho, and Barry Y Chen. Improve-
ments to context based self-supervised learning. In Computer
Vision and Pattern Recognition (CVPR), 2018.

[44] Mehdi Noroozi and Paolo Favaro. Unsupervised learning of
visual representations by solving jigsaw puzzles. In European
Conference on Computer Vision (ECCV), 2016.

[45] Deepak Pathak, Philipp Krahenbuhl, Jeff Donahue, Trevor
Darrell, and Alexei A Efros. Context encoders: Feature learn-
ing by inpainting. In Computer Vision and Pattern Recogni-
tion (CVPR), 2016.

[46] Alexander Kolesnikov, Xiaohua Zhai, and Lucas Beyer. Re-
In

visiting self-supervised visual representation learning.
Computer Vision and Pattern Recognition (CVPR), 2019.

[28] Martin Heusel, Hubert Ramsauer, Thomas Unterthiner, Bern-
hard Nessler, Günter Klambauer, and Sepp Hochreiter. GANs
trained by a two time-scale update rule converge to a Nash
equilibrium. In Advances in Neural Information Processing
Systems (NIPS), 2017.

[29] Mehdi SM Sajjadi, Olivier Bachem, Mario Lucic, Olivier
Bousquet, and Sylvain Gelly. Assessing generative models
via precision and recall. In Advances in Neural Information
Processing Systems (NIPS), 2018.

[30] Mario Lucic, Karol Kurach, Marcin Michalski, Sylvain Gelly,
and Olivier Bousquet. Are GANs Created Equal? A Large-
scale Study. In Advances in Neural Information Processing
Systems (NIPS), 2018.

[31] Shane Barratt and Rishi Sharma. A note on the inception

score. arXiv preprint arXiv:1801.01973, 2018.

[32] Karol Kurach, Mario Lucic, Xiaohua Zhai, Marcin Michalski,
and Sylvain Gelly. The GAN Landscape: Losses, archi-
tectures, regularization, and normalization. arXiv preprint
arXiv:1807.04720, 2018.

[33] Zhiming Zhou, Yuxuan Song, Lantao Yu, and Yong Yu.
Understanding the effectiveness of lipschitz constraint in
training of gans via gradient analysis.
arXiv preprint
arXiv:1807.00751, 2018.

[34] Jeff Donahue, Philipp Krähenbühl, and Trevor Darrell. Ad-
versarial feature learning. In International Conference on
Learning Representations (ICLR), 2017.

[35] Mathilde Caron, Piotr Bojanowski, Armand Joulin, and
Matthijs Douze. Deep clustering for unsupervised learning
of visual features. European Conference on Computer Vision
(ECCV), 2018.

[36] Richard Zhang, Phillip Isola, and Alexei A Efros. Split-brain
autoencoders: Unsupervised learning by cross-channel pre-
diction. In Proceedings of the IEEE conference on Computer
Vision and Pattern Recognition (CVPR), 2017.

[37] Friedemann Zenke, Ben Poole, and Surya Ganguli. Contin-
ual learning through synaptic intelligence. In International
Conference on Machine Learning (ICML), 2017.

[38] Harm De Vries, Florian Strub, Jérémie Mary, Hugo
Larochelle, Olivier Pietquin, and Aaron C Courville. Mod-
ulating early visual processing by language. In Advances in
Neural Information Processing Systems (NIPS), 2017.

[39] Pulkit Agrawal, Joao Carreira, and Jitendra Malik. Learning
to see by moving. In International Conference on Computer
Vision (ICCV), 2015.

12163

