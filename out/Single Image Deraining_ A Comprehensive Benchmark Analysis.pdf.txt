Single Image Deraining: A Comprehensive Benchmark Analysis

Siyuan Li1∗, Iago Breno Araujo2∗, Wenqi Ren3†, Zhangyang Wang4†, Eric K. Tokuda2,

Roberto Hirata Junior2, Roberto Cesar-Junior2, Jiawan Zhang1, Xiaojie Guo1, Xiaochun Cao3
2University of Sao Paulo 3SKLOIS, IIE, CAS 4Texas A&M University
1Tianjin University

https://github.com/lsy17096535/Single-Image-Deraining

Abstract

1.1. Rainy Image Formulation Models

Numerous single image deraining algorithms have been
recently proposed. However, these algorithms are mainly
evaluated using certain type of synthetic images, assuming
a speciﬁc rain model, plus a few real images.
It is thus
unclear how these algorithms would perform on rainy im-
ages acquired “in the wild” and how we could gauge the
progress in the ﬁeld. This paper aims to bridge this gap.
We present a comprehensive study and evaluation of exist-
ing single image deraining algorithms, using a new large-
scale benchmark consisting of both synthetic and real-
world rainy images of various rain types. This dataset high-
lights diverse rain models (rain streak, rain drop, rain and
mist), as well as a rich variety of evaluation criteria (full-
and no-reference objective, subjective, and task-speciﬁc)
Our evaluation and analysis indicate the performance gap
between synthetic rainy images and real-world images and
allow us to better identify the strengths and limitations of
each method as well as future research directions.

1. Introduction

Images captured in rainy days suffer from noticeable
degradation of scene visibility. The goal of single image de-
raining algorithms is to generate sharp images from a rainy
image input. Image deraining can potentially beneﬁt both
the human visual perception quality of images, and many
computer vision applications, such as outdoor surveillance
systems and intelligent vehicles.

The recent years have witnessed signiﬁcant progress in
single image deraining. The progress in this ﬁeld can be
attributed to various natural image priors [1, 2, 3, 4, 5] and
deep convolutional neural network (CNN)-based models [6,
7, 8]. However, a fair comprehensive study of the problem,
the existing algorithms, and the performance metrics have
been absent so far, which is the goal of this paper.

∗The ﬁrst two authors contributed equally.
†indicates corresponding author.

As a complicated atmospheric process, rain could cause
several different types of visibility degradations, due to a
magnitude of environmental factors including raindrop size,
rain density, and wind velocity [9]. When a rainy image is
taken, the visual effects of rain on that digital image further
hinges on many camera parameters, such as exposure time,
depth of ﬁeld, and resolution [10]. Most existing deraining
works assume one rain model (usually rain streak), which
might have oversimpliﬁed the problem. We group existing
rain models in literature into three major categories: rain
streak, raindrop, as well as rain and mist.

A rain streak image Rs can be modeled as a linear super-
imposition of the clean background scene B and the sparse,
line-shape rain streak component S:

Rs = B + S.

(1)

Rain streaks S accumulated throughout the scene reduce the
visibility of the background B. This is the most common
model assumed by the majority of deraining algorithms.

Adherent raindrops [11] that fall and ﬂow on camera
lenses or a window glasses can obstruct and/or blur the
background scenes. The raindrop degraded image Rd can
be modeled as the combination of the clean background B,
and the blurry or obstruction effect of the raindrops D in
scattered, small-sized local coherent regions:

Rd = (1 − M) ⊙ B + D.

(2)

M is a binary mask and ⊙ means element-wise multiplica-
tion. In the mask, a pixel x is part of a raindrop region if
M(x) = 1, and otherwise belongs to the background.

Further, rainy images often contain both rain and mist
in real cases [12]. In addition, distant rain streaks accumu-
lated throughout the scene reduce the visibility in a manner
more similarly to fog, creating a mist-like phenomenon in
the image background. Concerning this, we can deﬁne the
rain and mist model for the captured image Rm, based on

3838

Figure 1. Example images from the MPID dataset. The proposed dataset contains both synthetic and real-wold rainy images of rain streak,
raindrops, and rain & mist. In addition, we also annotate two sets of real-world images with object bounding boxes from autonomous
driving and video surveillance scenarios.

a composition of the rain streak model and the atmospheric
scattering haze model [13]:

Rm = B ⊙ t + A (1 − t) + S,

(3)

where S is the rain streak component; t and A are the
transmission map and atmospheric light that determines the
fog/mist component, respectively.

1.2. Our Contribution

one type of rain only, e.g., rain streak; ii) most quantitative
results are reported on synthetic images, which often fail to
capture the complexity and characteristics of real rain; iii)
as a result of the last point, the evaluation metrics have been
mostly limited to (the full-reference) PSNR and SSIM for
image restoration purposes. They may become poorly re-
lated when it comes to other task purposes, such as human
perception quality [14] or computer vision utility [15].

Regardless of what rain models to follow, image derain-
ing is a heavily ill-posed problem. Despite many impres-
sive methods published in recent few years, the lack of a
large dataset and algorithm benchmarking makes it difﬁcult
to evaluate the progress made, and how practically useful
those algorithms are. There are several unclear and unsatis-
factory aspects of current deraining algorithm development,
including but not limited to: i) the modeling of rain is over-
simpliﬁed, i.e., each method considers and is evaluated with

In this paper, we aim to systematically evaluate state-
of-the-art single image deraining methods, in a comprehen-
sive and fair setting. To this end, we construct a large-
scale benchmark, called Multi-Purpose Image Deraining
(MPID). An overview of MPID could be found in Table 1,
and image examples are displayed in Figure 1. Compared
with existing synthetic sets, the MPID dataset covers a
much larger diversity of rain models (rain streak, raindrop,
and rain and mist), including both synthetic and real-world

3839

images for evaluation, and featuring diverse contents and
sources (for real rainy images). In addition, as the ﬁrst-of-
its-kind efforts in image deraining, we have annotated two
sets of real-world rainy images with object bounding boxes
from autonomous driving and video surveillance scenarios,
respectively, for task-speciﬁc evaluation.

Using the MPID benchmark, we evaluate six state-of-
the-art single image deraining algorithms. We adopt a
wide range of full-reference metrics (PSNR and SSIM), no-
reference metrics (NIQE, BLIINDS-II, and SSEQ), as well
as human subjective scores to thoroughly examine the per-
formance of image deraining methods. A human subjec-
tive study is also conducted. Furthermore, as image derain-
ing might be expected as a preprocessing step for mid- and
high-level computer vision tasks, we also evaluate current
algorithms in terms of their impact on subsequent object
detection tasks, as a “task-speciﬁc” evaluation criterion. We
reveal the performance gap in various aspects, when these
algorithms are applied on synthetic and real images. By
extensively comparing the state-of-the-art single image de-
raining algorithms on the MPID dataset, we gain insights
into new research directions for image deraining.

2. Related Work

2.1. Overview of Deraining Algorithms

Multi-frame based approaches: Early methods often re-
quire multiple frames to deal with the deraining problem
[4, 16, 17, 18, 19, 5, 20, 11]. Garg and Nayar [21] proposed
a rain streak detection and removal method from a video by
taking the average intensity of the detected rain streaks from
the previous and subsequent frames. [10] further improved
the performance by selecting camera parameters without
appreciably altering the scene appearance. However, those
methods are not applicable to single image deraining.
Prior based algorithms: Many deraining methods capi-
talize on clean image or rain type priors to remove rain
[22, 1, 23, 24, 25]. Kang et al. [2] decomposed an input
image into its low and high frequency components. Then
they separated the rain streak frequencies from the high fre-
quency layer via sparse coding. Zhu et al. [26] introduced a
rain removal method based on the prior that rain streaks typ-
ically span a narrow range of directions. Chen and Hsu [3]
decomposed the background and rain streak layers based
on low-rank priors. Li et al. [27] use patch-based priors
for both the clean background and rain layers in the form
of Gaussian mixture models. All of the above approaches
rely on good (and relatively simple) crafted priors. As a re-
sult, they tend to have unsatisfactory performances on real
images with complicated scenes and rain forms.
Data-driven CNN models: Recently, CNNs have achieved
dominant success for image restoration [28, 29] including
single image deraining [30, 31]. Fu et al. [6] proposed a
deep detail network (DDN) for removing rain from single

images with detailed preserved. Yang et al. [32] presented
a CNN based method to jointly detect and remove rain
streaks, using a multi-stream network to capture the rain
streak component. A density-aware multi-stream densely
connected convolutional neural network was introduced in
[8] for joint rain density estimation and image deraining.
Qian et al. [7] addressed a different problem of removing
raindrops from single images, using visual attention with a
generative adversarial network (GAN). Despite the progress
of deep-learning-based approaches compared with prior-
based rain removal methods, their performance hinge on the
synthetic training data, which may become problematic if
real rainy images show a domain mismatch.

2.2. Datasets

Several datasets were used to measure and compare the
performance of image deraining algorithms. Li et al. [27]
introduced a set of 12 images using photo-realistic render-
ing techniques. Zhang et al. [33] synthesized a set of train-
ing and testing images with rain streak, using the same way
in [27]. The training set consists of 700 images and the
testing set consists of 100 images.
In addition, [33] also
collects a dataset of 50 real-world rainy images downloaded
from the web for qualitative visual comparison. [7] released
a set of clean and rain-drop corrupted image pairs, using a
special lens equipment. However, existing datasets are ei-
ther too small in scale and limited to one rain type (streak or
drop), or lack sufﬁcient real-world images for diverse eval-
uations. Besides, none of them has any semantic annotation
nor consider any subsequent task performance.

3. New Benchmark: Multi-Purpose Image De-

raining (MPID)

We present a new benchmark as a comprehensive plat-
form, for evaluating single image deraining algorithms from
a variety of perspectives. Our evaluation angles range from
traditional PSNR/SSIM, to no-reference perception-driven
metrics and human subjective quality, to “task-driven met-
rics” [15, 34] indicating how well a target computer vi-
sion task can be performed on the derained images. Fitting
those purposes, we generate/collect images in large scale,
from both synthesis and real world sources, covering di-
verse real-life scenes, and annotate them when needed. The
new benchmark, dubbed Multi-Purpose Image Deraining
(MPID), is introduced below in details. An overview of
MPID can be found in Table 1.

3.1. Training Sets: Three Synthesis Models

Following the three rain models in Section 1.1, we cre-
ate three training sets, named Rain streak (T), Rain drop
(T) and Rain and mist (T) sets (T short for “training”), re-
spectively. All three sets are synthesized in controlled set-

3840

Table 1. Overview of the proposed MPID dataset.

Training Set

Number of Images

Real/synthetic

Annotations

Metrics

2400 (pairs)
861 (pairs)
700 (pairs)

synthetic
synthetic
synthetic

No
No
No

Testing Set

/
/
/

Number of Images

Real/synthetic

Annotations

Metrics

200 (pairs)

50

149 (pairs)

58

70 (pairs)

30

synthetic

real

synthetic

real

synthetic

real

No
No
No
No
No
No

PSNR, SSIM, NIQE, BLIINDS-II, SSEQ

NIQE, BLIINDS-II, SSEQ

PSNR, SSIM, NIQE, BLIINDS-II, SSEQ

NIQE, BLIINDS-II, SSEQ

PSNR, SSIM, NIQE, BLIINDS-II, SSEQ

NIQE, BLIINDS-II, SSEQ

Number of Images

Task-Driven Evaluation Set
Annotations

Real/synthetic

2496
2048

real
real

Yes (bounding boxes)
Yes (bounding boxes)

Metrics

mAP
mAP

Subset
Rain streak (T)
Raindrop (T)
Rain and mist (T)

Subset
Rain streak (S)
Rain streak (R)
Raindrop (S)
Raindrop (R)
Rain and mist (S)
Rain and mist (R)

Subset
RID
RIS

tings from clean images.1. All clean images used are col-
lected from the web, and we speciﬁcally pick those outdoor
rain-free, haze-free photos taken in cloudy daylight, so that
the synthesized rainy images look more realistic in terms of
lighting condition (for example, there will be no rainy photo
in a sunny daylight background).

The Rain streak (T) set contains 2,400 pairs of clean and
rainy images, where the rainy images are generated from the
clean ones using (1), with the identical protocol and hyper-
parameters to [27, 33]. The Rain drop (T) set was borrowed
from [7]’s released training set consisting of 861 pairs of
clean and rain-drop corrupted images, upon their authors’
consent. The Rain and mist (T) set is synthesized by ﬁrst
adding haze using the atmospheric scattering model: for
each clean image, we estimate depth using the algorithm in
[35, 36] as recommended by [37], set different atmospheric
lights A by choosing each channel uniformly randomly be-
tween [0.7, 1.0], and select β uniformly at random between
[0.6, 1.8]. Then from the synthesized hazy version, we fur-
ther add rain streaks in the same way as Rain streak (T). We
end up with 700 pairs for the Rain and mist (T) set.

3.2. Testing Sets: From Synthetic To Real

Corresponding to three training sets, we generate three
synthetic testing set in the same way: denoted as Rain streak
(S), Rain drop (S), and Rain and mist (S) (S short for “syn-
thetic testing”), consisting of 200, 149, and 70 pairs, re-
spectively. On each testing set, we evaluate the restoration
performance of deraining algorithms, using classical PSNR
and SSIM metrics. Further, to predict the derained image’s
perceptual quality to human viewers, we introduce the us-
age of three no-reference IQA models: Naturalness Image
Quality Evaluator (NIQE) [38], spatial-spectral entropy-
based quality (SSEQ) [39], and blind image integrity no-
tator using DCT statistics (BLIINDS-II) [40], to comple-
ment the shortness of PSNR/SSIM. NIQE is a well-known

1Note that for Rain drop (T), the data generation used physical simula-

tion [7] , i.e., with/without lens, rather than algorithm simulation.

no-reference image quality score to indicate the perceived
“naturalness” of an image: a smaller score indicates better
perceptual quality. The score of SSEQ and BLIINDS-II that
we used range from 0 (worst) to 100 (best).2

Besides the three above synthetic test sets, we col-
lect three sets of real-world images, that fall into each of
three deﬁned rain categories, to evaluate the deraining algo-
rithms’ real-world generalization. The three sets, denoted
as Rain streak (R), Raindrop (R), and Rain and mist (R) (R
short for “real-world testing”), are collected from the Inter-
net and are carefully inspected to ensure that images in each
set ﬁt the pre-deﬁned rain type well. Due to the unavailabil-
ity of ground truth clean images in real world, we evaluate
NIQE, SSEQ, and BLIINDS-II on the three real-world sets.
In addition, we also pick a small set of real-world images
for human subjective rating of derained results.

3.3. Task Driven Evaluation Sets

As pointed out by several recent works [41, 15, 42, 43],
the performance of high-level computer vision tasks, such
as object detection and recognition, will deteriorate in the
presence of various sensory and environmental degrada-
tions. While deraining could be used as pre-processing for
many computer vision tasks executed in the rainy condi-
tions, there has been no systematical study on deraining
algorithms’ impact on those target tasks. We consider the
resulting task performance after deraining as an indirect in-
dicator of the deraining quality. Such a “task-driven” eval-
uation way has received little attention and can have great
implications for outdoor applications.

To conduct such task-driven evaluations, realistic anno-
tated datasets are necessary. To our best knowledge, there
has been no dataset available serving the purpose of evaluat-

2Note that in [39] and [40], a smaller SSEQ/BLIINDS-II score indi-
cates better perceptual quality. We reverse the two scores (100 minus) to
make their trends look consistent to full-reference metrics: in our tables
the bigger the two values, the better the perceptual quality. We did not do
the same to NIQE, because NIQE has no bounded maximum value.

3841

Table 2. Object Statistics in RID and RIS sets.

Categories

Car

Person

RID Set

Categories

7332

Car

1135

Person

RIS Set

11415

2687

Bus

613

Bus

488

Bicycle Motorcycle

268

968

Truck Motorcycle

673

275

ing deraining algorithms in task-driven ways. We therefore
collect two sets by our own: a Rain in Driving (RID) set
collected from car-mounted cameras when driving in rainy
weathers, and a Rain in surveillance (RIS) set collected
from networked trafﬁc surveillance cameras in rainy days.

For either set, we annotate object bounding boxes, and
evaluate object detection performance after applying de-
raining. A summary with object statistics on both RID and
RIS sets can be found in Table 2. The two sets differ in
many ways: rain type, image quality, object size and an-
gle, and so on. They are representative of real application
scenarios where deraining may be desired.
Rain in Driving (RID) Set This set contains 2,495 real
rainy images from high-resolution driving videos. As we
observe, its rain effect is closest to “raindrops” on camera
lens. They were captured in diverse real trafﬁc locations and
scenes during multiple drives. We label bounding boxes for
selected trafﬁc objects: car, person, bus, bicycle, and mo-
torcycle, that commonly appear on the roads of all images.
Most images are of 1920 × 990 resolution, with a few ex-
ceptions of 4023 × 3024 resolution.
Rain in Surveillance (RIS) Set This set contains 2,048
real rainy images from relatively lower-resolution surveil-
lance video cameras. They were extracted from a total of
154 surveillance cameras in daytime, ensuring diversity in
content (for example, we do not consider frames too close in
time). As we observe, its rain effect is closest to “rain and
mist” (many cameras have mist condensation during rain,
and the low resolution will also cause more foggy effects).
We selected and annotated the most common objects in the
trafﬁc surveillance scenes: car, person, bus, truck, and mo-
torcycle. The vast majority of cameras have the resolution
of 640 × 368, with a few exceptions of 640 × 480.

4. Experimental Comparison

We evaluate six representative state-of-the-art algorithms
on MPID: Gaussian mixture model prior (GMM) [27],
JOint Rain DEtection and Removal (JORDER) [32], Deep
Detail Network (DDN) [6], Conditional Generative Adver-
sarial Network (CGAN) [33], Density-aware Image De-
raining method using a Multistream Dense Network (DID-
MDN) [8], and DeRaindrop [7]. All except GMM are state-
of-the-art CNN-based deraining algorithms.
Evaluation Protocol. The ﬁrst ﬁve models are speciﬁcally
developed for removing rain streaks, while the last one tar-
gets at removing rain drops. Therefore, we compare them
for rain streak sets. Since DeRaindrop is the only recent
published method for raindrop removal, to provide more

baselines for its performance, we also re-train and eval-
uate the other ﬁve models on the raindrop sets. Finally,
since no published method was targeted for removing rain
and mist together, we create a cascaded pipeline, by ﬁrst
running each of the ﬁve rain streak removal algorithms,
followed by feeding into a pre-trained MSCNN dehazing
network [28]. MSCNN was chosen because recent dehaz-
ing studies [15, 48] endorsed it both to produce the best
human-favorable, artifact-free dehazing results, and to ben-
eﬁt subsequent high-level task in haze most. Such cascaded
pipeline can be tuned from end to end, and we freeze the
MSCNN part during tuning in order to focus on compar-
ing deraining components. All models will be re-trained on
the corresponding MPID training set, when evaluated on a
certain rain type.

4.1. Objective Comparison

We ﬁrst compare the derained results on the synthetic
images using two full-reference (PSNR and SSIM) and
three no-reference metrics (NIQE, SSEQ, and BLIINDS-
II). As seen from Table 3, the results have high consensus
levels on synthetic data. First, DDN is the obvious winner
on the rain streak (S) set, followed by JORDER; the same
two methods also perform consistently the best on the rain
and mist (S) set. Second, DerainDrop performs the best
on the rain drop (S) set, especially signiﬁcantly surpass-
ing the others in terms of PSNR and SSIM, showing that
its speciﬁc structure indeeds suits this problem. Other rain
streak removal models seem to even hurt PSNR, SSIM and
BLINDS-II, compared to the degraded images.

The effectiveness of the winners can be ascribed to the
two-step strategy of rain detection and removal. We note
that DDN focuses on high frequency details during train-
ing stage, while JORDER also ﬁrst detects the locations of
rain streak, then removes rain based on the estimated rain
streak regions. Coincidentally, DeRaindrop also uses an at-
tentive generative network to generate raindrops mask ﬁrst
then derain images capitalizing on the masks. Therefore,
removing background interference and attentively focusing
on rain regions seem to be the main reason of the winners.
We then show the derained results on the real-world im-
ages in Table 4, using three no-reference metrics (NIQE,
SSEQ, and BLIINDS-II). The rain streak (R) and raindrop
(R) sets show consistent results with their synthetic cases:
JORDER and DDN rank top-two on the former, while De-
rainDrop still dominates on the raindrop set. However,
some different tendency is observed on the rain and mist
(R) set: CGAN becomes the dominant winner on those real
images, outperforming both DDN and JORDER with large
margins. As we observed, since CGAN is most free of
physical priors or rain type assumptions, it has the largest
ﬂexibility for re-training to ﬁt different data. Its results is
also most photo-realistic due to the adversarial loss. Addi-
tionally, the result might also suggest a larger domain gap

3842

Table 3. Average full- and no-reference evaluations results on synthetic rainy images. We use bold and underline to indicate the best and
suboptimal performance, respectively.

Degraded

GMM [27]

JORDER [32]

DDN [6]

CGAN [33]

DID-MDN [8]

DeRaindrop [7]

PSNR
SSIM
SSEQ
NIQE

BLINDS-II

PSNR
SSIM
SSEQ
NIQE

BLINDS-II

PSNR
SSIM
SSEQ
NIQE

BLINDS-II

25.95
0.7565
70.24
5.4529
78.89

25.40
0.8403
78.48
3.8126
92.50

26.84
0.8520
72.37
3.4548
82.95

26.88
0.7674
67.46
4.4248
75.95

24.85
0.7808
64.73
5.1098
75.95

29.37
0.8960
65.39
3.2117
74.90

rain streak

26.26
0.8089
73.70
4.2337
84.21

27.52
0.8239
84.32
4.3278
88.05

29.39
0.7854
75.95
3.9834
91.71

raindrops

25.23
0.8366
77.62
4.1462
91.95

rain and mist

30.37
0.9262
70.55
2.8595
83.75

32.98
0.9350
69.80
2.9970
85.75

21.86
0.6277
70.02
4.6189
79.29

21.35
0.7306
63.15
3.3551
73.85

22.44
0.7636
68.71
2.8336
80.20

26.80
0.8028
60.05
4.8122
67.90

24.76
0.7930
58.42
4.1192
64.70

28.77
0.8430
65.33
3.0871
76.35

/
/
/
/
/

31.57
0.9023
72.42
5.0047
96.45

/
/
/
/
/

Table 4. Average no-reference evaluations results of derained results on real rainy images. We use bold and underline to indicate the best
and suboptimal performance except the degraded inputs, respectively.

Degraded

GMM [27]

JORDER [32]

DDN [6]

CGAN [33]

DID-MDN [8]

DeRaindrop [7]

SSEQ
NIQE

BLINDS-II

SSEQ
NIQE

BLINDS-II

SSEQ
NIQE

BLINDS-II

65.77
3.5236
78.04

78.23
3.8229
84.46

73.86
3.2602
84.00

61.63
3.2117
75.54

64.77
4.3801
71.21

59.51
4.4808
62.70

rain streak

64.00
3.5371
82.62

69.26
3.6579
80.04

63.51
3.5811
85.81

raindrops

67.62
3.8290
77.75

rain and mist

65.18
3.3238
78.62

64.56
3.7261
81.67

59.32
3.5374
78.42

62.18
4.4692
66.29

70.04
2.9532
84.91

55.11
5.1255
66.65

60.65
4.5631
66.63

63.85
3.2260
76.08

/
/
/

79.83
3.5953
87.13

/
/
/

between synthetic and real rain and mist data.

4.2. Subjective Comparison

We next conduct a human subjective survey to evaluate
the performance of image deraining algorithms. We follow
a standard setting that ﬁts a Bradley-Terry model [49] to es-
timate the subjective score for each method so that they can
be ranked, with the exactly same routine as described in pre-
vious similar works [15]. We select 10 images from Rain
streak (R), 6 images from Rain drop (R), and 11 images
from Rain and mist (R), taking all possible care to ensure
that they have very diverse contents and quality. Each rain
streak or rain & mist image is processed with each of the
ﬁve deraining algorithms (except DerainDrop), and the ﬁve
deraining results, together with the original rainy image, are
sent for pairwise comparison to construct the winning ma-
trix. For a rain drop image, the procedure is the same ex-
cept that it will be processed by all six methods. We collect
the pair comparison results of human subject studies from
11 human raters. Despite the relatively small numbers of
raters, we observed good consensus and small inter-person

variances among raters, on same pairs’ comparison results,
which make scores trustworthy.

The subjective scores are reported in Table 5. Note that
we did not normalize the scores: so it is the score rank rather
than the absolute score values that makes sense here. On the
rain streak images, it seems that most human viewers prefer
CGAN ﬁrst, and then DDN. As shown in the ﬁrst row of
Figure 2, the derained result generated by CGAN is more
smooth than others. On the raindrop images, it is somehow
to our surprise that DerainDrop is not favored by users; in-
stead, the non-CNN-based GMM method, which showed no
advantage under previous objective metrics, was highly pre-
ferred by users. We conjecture that the patch-based Gaus-
sian mixture prior can treat and remove both rain streaks
and raindrops as “outliers”, and is less sensitive to train-
ing/testing data domain difference. Finally on the rain and
mist images, DID-MDN receives the highest scores, while
CGAN is next to it. This is mainly thanks to incorporating
th rain-density subnetwork or GAN, that can provide more
information of the scene context and hence improve gener-
alization to complex rain conditions.

3843

Table 5. Average subjective scores of derained results on 10 real images.

rain streak
raindrops

rain and mist

rainy GMM [27]
0.64
0.80
0.44

0.80
1.14
1.00

JORDER [32] DDN [6] CGAN [33] DID-MDN [8] DeRaindrop [7]

0.91
0.75
0.70

1.15
0.83
0.90

1.26
0.85
1.22

0.97
0.95
1.40

–

0.80

–

Table 6. Detection results (mAP) on the RID and RIS sets. Detailed results for each class can be found in the supplementary material.

RID

RIS

FRCNN [44]

YOLO-V3 [45]
SSD-512 [46]
RetinaNet [47]
FRCNN [44]

YOLO-V3 [45]
SSD-512 [46]
RetinaNet [47]

Rainy
16.52
27.84
17.71
23.92
22.68
23.27
8.19
12.81

JORDER [32] DDN [6] CGAN [33] DID-MDN [8] DeRaindrop [7]

16.97
26.72
17.06
21.71
21.41
20.45
7.94
10.71

18.36
26.20
16.93
21.60
20.76
21.80
8.29
10.39

23.42
23.75
16.71
19.28
18.02
18.71
7.10
9.36

16.11
24.62
16.70
20.08
18.93
21.50
8.21
10.33

15.58
24.96
16.69
19.73
19.97
20.43
8.13
10.85

While we are in the process of recruiting more human
raters to solidify our subject score results more, our re-
sults seem to be consistent so far, and might in turn imply
that off-the-shelf no-reference perceptual metrics (SSEQ,
NIQE, BLINDS-II) do not align well with the real human
perception quality of deraining results. In fact, recent works
[50] already discovered similar misalignments, when apply-
ing standard no-reference metrics to estimating defogging
perceptual quality, and proposed fog-speciﬁc metrics. Sim-
ilar efforts have not been found for deraining yet, and we
expect this worthy effort to take place in near future.

4.3. Task driven Comparison

We ﬁrst apply all deraining algorithms except GMM3, to
pre-processing the two task-driven testing sets. Due to their
different rain characteristics, for the RID set, we use de-
raining algorithms trained on the rain and mist case; for the
RIS set, we use deraining algorithms trained on the rain-
drop case. We visually inspected the derained results and
found the rains to be visually attenuated after applying the
selected deraining algorithms. We show some derained re-
sults on the RID and RIS sets in the supplementary material.
We then study object detection performance on the de-
rained sets, using several state-of-the-art object detection
models: Faster R-CNN (FRCNN) [44], YOLO-V3 [45],
SSD-512 [46], and RetinaNet [47]. Finally, we compare
all deraining algorithms via the mean Average Precision
(mAP) results achieved. It is important to note that our pri-
mary goal is not to optimize detection performance in rainy
days, but to use a strong detection model as a ﬁxed, fair
metric on comparing deraining performance from a com-
plementary perspective.
In this way, the object detectors
should not be adapted for rainy or derained images, and we
use all authors’ pre-trained models on MS COCO. The un-
derlying hypothesis is: i) an object detector trained on clean

3We did not include GMM for the two sets, because (1) it did not yield
promising results when we tried to apply it to (part of) the two sets; (2) it
runs very slow, given we have two large sets.

natural images will perform the best, when the input is also
from the clean image domain or close; ii) for detection in
rain, the better the rain is removed, the better an object de-
tection model (trained on clean images) will then perform.
Such task-speciﬁc evaluation philosophy follows [34, 15].

Table 6 reports the mAP results comparison for different
deraining algorithms, achieved using four different detec-
tion models, on both RID and RIS sets. We ﬁnd that quite
aligned conclusions could be drawn from the two sets.

Perhaps surprisingly at the ﬁrst glance, we ﬁnd that al-
most all existing deraining algorithms will deteriorate
the detection performance compared to directly using
the rainy images4, for YOLO-V3, SSD-512, and Reti-
naNet. Our observation concurs the conclusion of another
recent study (on dehazing) [51]: since those deraining algo-
rithms were not trained/optimized towards the end goal of
object detection, they are unnecessary to help this goal, and
the deraining process itself might have lost discriminative,
semantically meaningful true information.

Both results on RID and RIS sets in Table 6 show that
YOLO-V3 achieves best detection performance, indepen-
dently of deraining algorithms applied. Figure 3 shows de-
tections using YOLO-V3 on the respectives rainy images
and their derained results for all deraining algorithms con-
sidered in this comparison. Since both RID and RIS have
many small objects due to their relative long distance from
the camera, we believe that here YOLO-V3 beneﬁts from
its new multi-scale prediction structure, that is known to im-
prove small object detection dramatically [45]. We further
notice a fairly weak correlation between the mAP results
with the no-reference evaluation results of the derained im-
ages: see supplementary for more details.

4The only exception is FRCNN on the RID set. However, its overall
mAP result is the worst compared to the other three. That implies a strong
domain mismatch, suggesting that FRCNN results might not be as reliable
an indicator for RID deraining performance as the other three.

3844

(a) Rainy input
Figure 2. Examples of derained results on real images: rain streak (ﬁrst row), raindrop (second row), and rain and mist (third row).

(f) DID-MDN [8]

(c)JORDER [32]

(e) CGAN [33]

(b) GMM [27]

(d) DDN [6]

(g) DeRaindrop [7]

(a) Rainy input

(g) Ground-truths
Figure 3. Visualization of object detection results after applying different deraining algorithms on two images (ﬁrst two rows) from the
RID dataset and two examples (last two rows) from the RIS dataset.

(f) DeRaindrop [7]

(e) DID-MDN [8]

(b) JORDER [32]

(d) CGAN [33]

(c) DDN [6]

5. Conclusions and Future Work

This paper proposes a new large-scale benchmark and
presents a thorough survey of state-of-the-art single image
deraining methods. Based on our evaluation and analysis,
we present overall remarks and hypotheses below, which
we hope can shed some light on future deraining research:

• Rain types are diverse and call for specialized mod-
els. Certain models or components are revealed to be
promising for speciﬁc rain types, e.g., rain detection
/attention, GANs, and priors like patch-level GMM.
We also advocate a combination of appropriate priors
and data-driven methods.

• There is no single best deraining algorithm for all
rain types. To deal with the real complicated, vary-
ing rains, one might need consider a mixture model of
experts. Another practically useful direction is to de-
velop scene-speciﬁc deraining, e.g., for trafﬁc views.

• There is also no single best deraining algorithm under
all metrics. When designing a deraining algorithm,
one needs be clear about its end purpose. Moreover,

classical perceptual metrics themselves might be prob-
lematic to evaluate deraining. Developing new metrics
could be as important as new algorithms.

• Algorithms trained on synthetic paired data may gen-
eralize poorly to real data, especially on complicated
rain types such as rain and mist. Unpaired training [52]
on all real data could be interesting to explore.

• No existing deraining method seems to directly help
detection. That may encourage the community to
develop new robust algorithms to account for high-
level vision problems on real-world rainy images. On
the other hand, to realize the goal of robust detec-
tion in rain does not have to adopt a de-raining pre-
processing; there are other domain adaptation type op-
tions, e.g., [53], which we will discuss in future work.

Acknowledgments. This work is supported in part by the Na-
tional Natural Science Foundation of China (No.
61802403,
U1605252U1736219), Beijing Natural Science Foundation (No.
L182057), and CCF-DiDi GAIA (YF20180101). The work of Z.
Wang is supported by the US National Science Foundation under
Grant 1755701.

3845

References

[1] Shao-Hua Sun, Shang-Pu Fan, and Yu-Chiang Frank Wang.
Exploiting image structural similarity for single image rain
removal. In IEEE International Conference on Image Pro-
cessing, pages 4482–4486, 2014. 1, 3

[2] Li-Wei Kang, Chia-Wen Lin, and Yu-Hsiang Fu. Auto-
matic single-image-based rain streaks removal via image
decomposition.
IEEE Transactions on Image Processing,
21(4):1742, 2012. 1, 3

[3] Yi-Lei Chen and Chiou-Ting Hsu. A generalized low-
rank appearance model for spatio-temporally correlated rain
streaks. In IEEE International Conference on Computer Vi-
sion, pages 1968–1975, 2013. 1, 3

[4] Xiaopeng Zhang, Hao Li, Yingyi Qi, Wee Kheng Leow, and
Teck Khim Ng. Rain removal in video by combining tempo-
ral and chromatic properties. In IEEE International Confer-
ence on Multimedia and Expo, 2006. 1, 3

[5] J´er´emie Bossu, Nicolas Hauti`ere, and Jean-Philippe Tarel.
Rain or snow detection in image sequences through use of a
histogram of orientation of streaks. International journal of
computer vision, 93(3):348–367, 2011. 1, 3

[6] Xueyang Fu, Jiabin Huang, Delu Zeng, Yue Huang, Xinghao
Ding, and John Paisley. Removing rain from single images
via a deep detail network. In IEEE Conference on Computer
Vision and Pattern Recognition, 2017. 1, 3, 5, 6, 7, 8

[7] Rui Qian, Robby T Tan, Wenhan Yang, Jiajun Su, and Jiay-
ing Liu. Attentive generative adversarial network for rain-
drop removal from a single image. In CVPR, 2018. 1, 3, 4,
5, 6, 7, 8

[8] He Zhang and Vishal M Patel. Density-aware single image
In IEEE
de-raining using a multi-stream dense network.
Conference on Computer Vision and Pattern Recognition,
2018. 1, 3, 5, 6, 7, 8

[9] Sudipta Mukhopadhyay and Abhishek Kumar Tripathi.
Combating bad weather part i: Rain removal from video.
Synthesis Lectures on Image, Video, and Multimedia Pro-
cessing, 7(2):1–93, 2014. 1

[10] Kshitiz Garg and Shree K Nayar. When does a camera see
rain? In IEEE International Conference on Computer Vision,
2005. 1, 3

[11] Shaodi You, Robby T Tan, Rei Kawakami, Yasuhiro
Mukaigawa, and Katsushi Ikeuchi. Adherent raindrop mod-
eling, detectionand removal in video. IEEE transactions on
pattern analysis and machine intelligence, 38(9):1721–1733,
2016. 1, 3

[12] Zheng Zhang, Wu Liu, Huadong Ma, and Xinchen Liu. Go-
ing clear from misty rain in dark channel guided network.
1

[13] Earl J McCartney. Optics of the atmosphere: scattering by
molecules and particles. New York, John Wiley and Sons,
Inc., 1976. 421 p., 1976. 2

[15] Boyi Li, Wenqi Ren, Dengpan Fu, Dacheng Tao, Dan Feng,
Wenjun Zeng, and Zhangyang Wang. Benchmarking single-
image dehazing and beyond. IEEE Transactions on Image
Processing, 28(1):492–505, 2019. 2, 3, 4, 5, 6, 7

[16] Abhishek Kumar Tripathi and Sudipta Mukhopadhyay. Re-
moval of rain from videos: a review. Signal, Image and Video
Processing, 8(8):1421–1430, 2014. 3

[17] Weihong Ren, Jiandong Tian, Zhi Han, Antoni Chan, and
Yandong Tang. Video desnowing and deraining based on
matrix decomposition.
In IEEE Conference on Computer
Vision and Pattern Recognition, 2017. 3

[18] Varun Santhaseelan and Vijayan K Asari. Utilizing local
phase information to remove rain from video. International
Journal of Computer Vision, 112(1):71–89, 2015. 3

[19] Tai-Xiang Jiang, Ting-Zhu Huang, Xi-Le Zhao, Liang-Jian
Deng, and Yao Wang. A novel tensor-based video rain
streaks removal approach via utilizing discriminatively in-
trinsic priors. In IEEE Conference on Computer Vision and
Pattern Recognition, 2017. 3

[20] Jin-Hwan Kim, Jae-Young Sim, and Chang-Su Kim. Video
deraining and desnowing using temporal correlation and
low-rank matrix completion. IEEE Transactions on Image
Processing, 24(9):2658–2670, 2015. 3

[21] Kshitiz Garg and Shree K Nayar. Detection and removal of
rain from videos. In IEEE Conference on Computer Vision
and Pattern Recognition, 2004. 3

[22] De-An Huang, Li-Wei Kang, Yu-Chiang Frank Wang, and
Chia-Wen Lin. Self-learning based image decomposition
with applications to single image denoising.
IEEE Trans-
actions on multimedia, 16(1):83–93, 2014. 3

[23] Yu Luo, Yong Xu, and Hui Ji. Removing rain from a single
In IEEE Interna-

image via discriminative sparse coding.
tional Conference on Computer Vision, 2015. 3

[24] Peter C Barnum, Srinivasa Narasimhan, and Takeo Kanade.
Analysis of rain and snow in frequency space. International
journal of computer vision, 86(2-3):256, 2010. 3

[25] Xianhui Zheng, Yinghao Liao, Wei Guo, Xueyang Fu, and
Xinghao Ding. Single-image-based rain and snow removal
using multi-guided ﬁlter.
In International Conference on
Neural Information Processing, 2013. 3

[26] Lei Zhu, Chi-Wing Fu, Dani Lischinski, and Pheng-Ann
Heng. Joint bilayer optimization for single-image rain streak
removal. In IEEE International Conference on Computer Vi-
sion, 2017. 3

[27] Yu Li, Robby T Tan, Xiaojie Guo, Jiangbo Lu, and Michael S
Brown. Rain streak removal using layer priors. In IEEE Con-
ference on Computer Vision and Pattern Recognition, pages
2736–2744, 2016. 3, 4, 5, 6, 7, 8

[14] Wei-Sheng Lai, Jia-Bin Huang, Zhe Hu, Narendra Ahuja,
and Ming-Hsuan Yang. A comparative study for single im-
age blind deblurring. In IEEE Conference on Computer Vi-
sion and Pattern Recognition, pages 1701–1709. 2

[28] Wenqi Ren, Si Liu, Hua Zhang, Jinshan Pan, Xiaochun Cao,
and Ming-Hsuan Yang. Single image dehazing via multi-
scale convolutional neural networks.
In European Confer-
ence on Computer Vision, 2016. 3, 5

3846

[29] Kai Zhang, Wangmeng Zuo, Shuhang Gu, and Lei Zhang.
Learning deep cnn denoiser prior for image restoration. In
IEEE Conference on Computer Vision and Pattern Recogni-
tion, 2017. 3

[30] Xueyang Fu, Jiabin Huang, Xinghao Ding, Yinghao Liao,
and John Paisley. Clearing the skies: A deep network archi-
tecture for single-image rain removal. IEEE Transactions on
Image Processing, 26(6):2944–2956, 2017. 3

[31] David Eigen, Dilip Krishnan, and Rob Fergus. Restoring an
image taken through a window covered with dirt or rain. In
IEEE International Conference on Computer Vision, 2013. 3

[32] Wenhan Yang, Robby T Tan, Jiashi Feng, Jiaying Liu, Zong-
ming Guo, and Shuicheng Yan. Deep joint rain detection
and removal from a single image. In IEEE Conference on
Computer Vision and Pattern Recognition, 2017. 3, 5, 6, 7, 8

[33] He Zhang, Vishwanath Sindagi, and Vishal M Patel.

Im-
age de-raining using a conditional generative adversarial net-
work. arXiv preprint arXiv:1701.05957, 2017. 3, 4, 5, 6, 7,
8

[34] Orest Kupyn, Volodymyr Budzan, Mykola Mykhailych,
Dmytro Mishkin, and Jiri Matas. Deblurgan: Blind mo-
tion deblurring using conditional adversarial networks. arXiv
preprint arXiv:1711.07064, 2017. 3, 7

[35] Fayao Liu, Chunhua Shen, Guosheng Lin, and Ian Reid.
Learning depth from single monocular images using deep
convolutional neural ﬁelds.
IEEE transactions on pattern
analysis and machine intelligence, 38(10):2024–2039, 2016.
4

[36] Boyi Li, Xiulian Peng, Zhangyang Wang, Jizheng Xu, and
Dan Feng. End-to-end united video dehazing and detection.
In Thirty-Second AAAI Conference on Artiﬁcial Intelligence,
2018. 4

[37] Boyi Li, Xiulian Peng, Zhangyang Wang, Jizheng Xu, and
Dan Feng. Aod-net: All-in-one dehazing network. In Pro-
ceedings of the IEEE International Conference on Computer
Vision, pages 4770–4778, 2017. 4

[38] Anish Mittal, Rajiv Soundararajan, and Alan C Bovik. Mak-
ing a” completely blind” image quality analyzer. IEEE Sig-
nal Process. Lett., 20(3):209–212, 2013. 4

[39] Lixiong Liu, Bao Liu, Hua Huang, and Alan Conrad Bovik.
No-reference image quality assessment based on spatial and
spectral entropies. Signal Processing: Image Communica-
tion, 29(8):856–863, 2014. 4

[40] Michele A Saad, Alan C Bovik, and Christophe Charrier.
Blind image quality assessment: A natural scene statistics
approach in the dct domain.
IEEE transactions on Image
Processing, 21(8):3339–3352, 2012. 4

[41] Rosaura G VidalMata, Sreya Banerjee, Brandon Richard-
Webster, Michael Albright, Pedro Davalos, Scott Mc-
Closkey, Ben Miller, Asong Tambo, Sushobhan Ghosh, Su-
darshan Nagesh, et al. Bridging the gap between compu-
tational photography and visual recognition. arXiv preprint
arXiv:1901.09482, 2019. 4

[42] Ding Liu, Bihan Wen, Xianming Liu, Zhangyang Wang, and
Thomas S Huang. When image denoising meets high-level
vision tasks: a deep learning approach.
In Proceedings of
the 27th International Joint Conference on Artiﬁcial Intelli-
gence, pages 842–848. AAAI Press, 2018. 4

[43] Zhangyang Wang, Shiyu Chang, Yingzhen Yang, Ding Liu,
and Thomas S Huang. Studying very low resolution recogni-
tion using deep networks. In Proceedings of the IEEE Con-
ference on Computer Vision and Pattern Recognition, pages
4792–4800, 2016. 4

[44] Shaoqing Ren, Kaiming He, Ross Girshick, and Jian Sun.
Faster r-cnn: Towards real-time object detection with region
proposal networks. In Advances in Neural Information Pro-
cessing Systems, pages 91–99. 2015. 7

[45] Joseph Redmon and Ali Farhadi. Yolov3: An incremental

improvement. arXiv preprint arXiv:1804.02767, 2018. 7

[46] Wei Liu, Dragomir Anguelov, Dumitru Erhan, Christian
Szegedy, Scott Reed, Cheng-Yang Fu, and Alexander C
Berg. Ssd: Single shot multibox detector. In European con-
ference on computer vision, pages 21–37, 2016. 7

[47] Tsung-Yi Lin, Priyal Goyal, Ross Girshick, Kaiming He, and
Piotr Doll´ar. Focal loss for dense object detection.
IEEE
transactions on pattern analysis and machine intelligence,
2018. 7

[48] Yu Liu, Guanlong Zhao, Boyuan Gong, Yang Li, Ritu Raj,
Niraj Goel, Satya Kesav, Sandeep Gottimukkala, Zhangyang
Wang, Wenqi Ren, et al. Improved techniques for learning
to dehaze and beyond: A collective study. arXiv preprint
arXiv:1807.00202, 2018. 5

[49] Ralph Allan Bradley and Milton E Terry. Rank analysis of
incomplete block designs: I. the method of paired compar-
isons. Biometrika, 39(3/4):324–345, 1952. 6

[50] Lark Kwon Choi, Jaehee You, and Alan Conrad Bovik. Ref-
erenceless prediction of perceptual fog density and percep-
tual image defogging. IEEE Transactions on Image Process-
ing, 24(11):3888–3901, 2015. 7

[51] Yanting Pei, Yaping Huang, Qi Zou, Yuhang Lu, and Song
Wang. Does haze removal help cnn-based image classiﬁca-
tion? arXiv preprint arXiv:1810.05716, 2018. 7

[52] Jun-Yan Zhu, Taesung Park, Phillip Isola, and Alexei A
Efros. Unpaired image-to-image translation using cycle-
consistent adversarial networks. arXiv preprint, 2017. 8

[53] Yuhua Chen, Wen Li, Christos Sakaridis, Dengxin Dai, and
Luc Van Gool. Domain adaptive faster r-cnn for object de-
tection in the wild. In Proceedings of the IEEE Conference
on Computer Vision and Pattern Recognition, pages 3339–
3348, 2018. 8

3847

