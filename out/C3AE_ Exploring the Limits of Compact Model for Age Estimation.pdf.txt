C3AE: Exploring the Limits of Compact Model for Age Estimation

Chao Zhang1

,

2, Shuaicheng Liu1

,

2, Xun Xu3, Ce Zhu1

∗

,

University of Electronic Science and Technology of China1 Megvii Technology2

National University of Singapore3

galoiszhang@gmail.com, liushuaicheng@megvii.com, eczhu@uestc.edu.cn, elexuxu@nus.edu.sg

Abstract

Age estimation is a classic learning problem in com-
puter vision. Many larger and deeper CNNs have been pro-
posed with promising performance, such as AlexNet, Vg-
gNet, GoogLeNet and ResNet. However, these models are
not practical for the embedded/mobile devices. Recently,
MobileNets and ShufﬂeNets have been proposed to reduce
the number of parameters, yielding lightweight models.
However, their representation has been weakened because
of the adoption of depth-wise separable convolution. In this
work, we investigate the limits of compact model for small-
scale image and propose an extremely Compact yet efﬁcient
Cascade Context-based Age Estimation model(C3AE).
This model possesses only 1/9 and 1/2000 parameters
compared with MobileNets/ShufﬂeNets and VggNet, while
achieves competitive performance.
In particular, we re-
deﬁne age estimation problem by two-points representa-
tion, which is implemented by a cascade model. More-
over, to fully utilize the facial context information, multi-
branch CNN network is proposed to aggregate multi-scale
context. Experiments are carried out on three age estima-
tion datasets. The state-of-the-art performance on compact
model has been achieved with a relatively large margin.

1. Introduction

Convolutional neural networks (CNNs) are being devel-
oped deeper and larger for more precise accuracy in recent
years. This trend has brought in unprecedented computa-
tion cost to either training or deploying. In particular, de-
ploying existing classic large models, e.g., AlexNet [17],
VggNet [33] and ResNet [11], on mobile phones, cars and
robots is next to impossible due to the model size and com-
putational cost.

To deal with above problem, recently MobileNets [12,
31] and ShufﬂeNets [40, 23] have been proposed to greatly
reduce the parameters by exploiting the depth-wise separa-

∗Corresponding author

Figure 1: Human can recognize the age of person in one of
the four images, regardless of different resolutions or scales.
Is it necessary to use the ﬁrst image that is with large size?
In this work, we use small-scale image (64 × 64 × 3) for
age estimation, which can achieve very competitive perfor-
mance.

ble convolution. In these models, the traditional convolu-
tion is replaced by two step convolutions, namely the ﬁlter-
ing layer and combining layer. For example, in MobileNets,
the ﬁltering layer ﬁrst convolves each corresponding chan-
nel separately, thus breaking the interactions among various
output channels, which can reduce the number of parame-
ters dramatically. A 1×1 convolution then stitches different
channels to combine the information acquired from differ-
ent input channels. For large-scale images, such operation is
reasonable because images need to be represented by large
number of channels, e.g., 512 and 384 in VggNet [33] and
ResNet [11]. Whereas, for small-scale images, e.g., images
with low resolution and small dimension, such predicate re-
mains questionable.

In contrast to large-scale images, small-scale images can
be often represented by fewer number of channels in the
network, and so does the number of parameters and mem-
ory. Therefore, standard convolution layer with small size
kernel does not require much more parameters and memory
compared with depth-wise separable convolution [12, 40].
From the perspective of image representation, the output
channels of depth-wise convolution are many times larger
than that of standard convolution. To compensate the rep-
resentation ability, the depth-wise convolution has to pay
for the cost of increased parameters. Therefore, we believe

112587

Initial image withhigh resolution/size200*240*3 Cropped image withlow resolution/size64*64*3   Cropped image withmedium resolution/size64*64*3   Cropped image withhigh resolution/size64*64*3   the conventional convolution layer with small kernel size is
more suitable for processing small-scale images than depth-
wise counterpart.

Images must often be stored and processed with low res-
olution and scale, aka small-scale images, on low-cost mo-
bile devices. One of the eminent problems which falls into
the category is age estimation. For example, human can eas-
ily recognize the age of the man in Fig. 1 in either full or low
resolution and partial or full view of the face. We, therefore,
conjecture such ability is applicable to contemporary CNNs
and design a compact with standard convolution layers with
small-scale face images as input for age estimation.

Recent advances in age estimation are usually summa-
rized into two mainstream directions: jointly category clas-
siﬁcation and value regression, and distribution matching.
For the former, the psychological evidence [15] reveals that
humans are inclined to give categorical ratings on image
rather than continuous scores, i.e., preferring to different
levels. Some works [19, 4] utilize the category informa-
tion and ordinal information to implement classiﬁcation and
regression simultaneously. For the latter one, distribution
matching can achieve promising results under the assump-
tion that distribution label of each image is provided. Never-
theless, acquiring distributional labels for thousands of face
images itself is a non-trivial task. In this work, we propose
to exploit the information on classiﬁcation, regression and
label distribution simultaneously. This is achieved by repre-
senting discrete age as a distribution over two discrete age
levels and the training objective is to minimize the match
between distributions.
In deep regression model, a fully
connected layer with semantic distribution is inserted in be-
tween the feature layer and age value prediction layer.

To summarize, we design a compact model that takes
small-scale image as input. Speciﬁcally, we utilize stan-
dard convolution instead of depth-wise convolution, with
suitable kernel and number of channels. To the best of
our knowledge, this is the smallest model that has been
obtained so far on the facial recognition, i.e., 0.19MB for
plain model and 0.25MB for full model. We then repre-
sent the discrete age value as a distribution and design a
cascade model. Moreover, we introduce a context based
regression model which takes as input multiple scales of fa-
cial image. With the Compact basic model, Casaced train-
ing and multi-scale Context, we aim to tackle small-scale
image Age Estimation. Thus we name the network C3AE.

Our main contributions are as follows. First, we study
the relationship between the channel number and the rep-
resentation on depth-wise convolution, especially on the
small scale image. Our discussion and results advocate a
rethinking of MobileNets and ShufﬂeNets for the small-
scale/medium-scale images. Second, we present a novel
age representation that exploits the information on clas-
siﬁcation, regression and label distribution simultaneously

and design a cascade model. Finally, we propose a con-
text based age inference method collecting different granu-
larity of input images. The proposed model, named C3AE,
achieves the state-of-the-art performance compared with al-
ternative compact models and even outperforms many bulky
models. With the extremely compact model (0.19MB and
0.25 MB for plain and full model, respectively), C3AE is
suitable to be deployed on low-end mobiles and embedded
platforms.

2. Related Work

Age Estimation The age progression displayed on faces
is uncontrollable and personalized [5], and the traditional
methods often have the problem of generalization. With
the success of deep learning, many recent works applied
deep CNN to achieve the state-of-the-art performance on
various applications such as image classiﬁcation [17, 33,
35, 36, 11, 34, 14], semantic segmentation [20, 2], object
detection [8, 27, 26]. As for age estimation, CNNs are
also being used for its strong generalization. Yi et al. [39]
ﬁrstly utilized CNN models to extract features from sev-
eral facial regions, and used a square loss for age estima-
tion. AgeNet [18] used one-dimensional real-value as an
age group for age classiﬁcation. Rothe et al. [29] proposed
to use expected value on the softmax probabilities and dis-
crete age values for age estimation. It is a weighted softmax
classiﬁer only in the testing phase. Niu et al. [24] formu-
lated age estimation as an ordinal regression by employing
multiple output CNNs. Following [24], Chen et al. [3] uti-
lized ranking-CNN for age estimation, in which there were
a series of basic binary CNNs, aggregating to the ﬁnal esti-
mation. Han et al. [9] used multiple attributes for multi-task
learning. Gao et al. [6] used KL divergence to measure the
similarity between the estimated and groundtruth distribu-
tions for age. Pan et al. [25] designed a new mean-variance
loss for distribution learning.

However, in real applications, the distribution is usually
not available for a face image. In this work, we consider
two objectives simultaneously. The ﬁrst one minimizes the
Kullback-Leibler loss between distributions, and the second
one optimizes the squared loss between discrete ages.
Compact Model As the increasing requirement of mo-
bile/embedded devices running deep learning, various ef-
ﬁcient models such as GoogLeNet [35], SqueezeNet [16],
ResNet [11] and SENet [13], are designed to cater this
wave. Recently, depth-wise convolution was adopted by
MobileNets [12, 31] and ShufﬂeNets [40, 23] to reduce
computation costs and model sizes. They were built pri-
marily from depth-wise separable convolutions initially in-
troduced in [32] and subsequently used in Inception models
[36, 34] to reduce the computation in the ﬁrst few layers. In
particular, the separation of ﬁltering - applying convolution
at each channel separately and combination - recombine

12588

the output of individual channels achieved fewer computa-
tions. MobileNet-V1 [12] based on the depth-wise separa-
ble convolution explored some important design guidelines
for an efﬁcient model. ShufﬂeNet-V1 [40] utilized novel
point-wise group convolution and channel shufﬂe to reduce
computation cost while maintaining accuracy. MobileNet-
V2 [31] proposed a novel inverted residual with linear bot-
tleneck. ShufﬂeNet-V2 [23] mainly analyzed the runtime
performance of the model and give four guidelines for efﬁ-
cient network design.

For age estimation, we argue that for small-scale images,
the channel size is often small and the depth-wise separation
does not beneﬁt. Instead, a standard convolution is adequate
for the trade-off between accuracy and compactness.

3. The Proposed Model

In this section, we ﬁrstly present the compact model and
its architecture as well as some important discussions on
practical guidelines. Then we describe a novel two-points
representation of age, and utilize the cascade style to insert
it in deep regression model. Next a context based module
is embedded into a single regression model by exploiting
facial information at three granularity levels. Finally some
discussions are given for rethinking.

3.1. Compact Model for Small scale Image: Revis 

iting Standard Convolution

Our plain model is composed of ﬁve standard convolu-
tion and two fully connected layers as shown in Tab. 11. For
standard convolution layer followed by batch normaliza-
tion, Relu and average pooling, its kernel, number of chan-
nels and parameters are 3, 32 and 9248, respectively. As a
basic module, we will show why we use standard convolu-
tion block instead of the separable convolution block that
used in MobileNets and ShufﬂeNets. We shall demonstrate
later in the experiment, our basic model produces competi-
tive performance compared with fashionable models though
its simplicity.

In MobileNets, the status regarding the saving of param-
eters and computation were analyzed, especially compar-
ing between standard convolution and depth-wise separable
convolution. That analysis is suitable for large-scale image
while for the small-scale/medium image it may not work
well.

Given an input and output as DF × DF × M feature map
F and DF × DF × N feature map G, DF denotes the size of
feature map, M and N are the number of input channels and
output channels for a convolution layer, respectively. The
number of computation cost is given by D2
F + M ·
N · D2
F [12]. In comparison, the standard convolution layer

K · M · D2

1(-) in the whole manuscript indicates value not available, or also use-

less for comparison.

Table 1: Overall architecture of the compact plain model

Kernel Stride Output size Parameters MACC

Layer
Image
Conv1
BRA
Conv2
BRA
Conv3
BRA
Conv4

-

3*3*32

-

3*3*32

-

3*3*32

-

3*3*32

BN+ReLu

-

Conv5
Feat
Pred

Total

1*1*32
1*1*12
1*1*1

-

1
1
1
1
1
1
1
1
1
1
1
1

-

64*64*3
62*62*32
31*31*32
29*29*32
14*14*32
12*12*32

6*6*32
4*4*32
4*4*32
4*4*32

12
1

-

-

896
128
9248
128
9248
128
9248
128
1056
6156

13

36377

-

3321216

-

7750656

-

1327104

-

147456

-

16384

-
-

-

(BRA) indicates batch normalization(BN), Relu and average pooling.
(MACC) Here we only count MACC of the conv layer.

K × ˆM ×
is parameterized by convolution kernel K of size D2
ˆN . The reduction between standard convolution and depth-
wise separable convolution in computation cost [12] is:

D2

K · M · D2

F + M · N · D2
F

D2

K · ˆM · ˆN · D2

F

=

M
ˆM ˆN

+

M N
ˆM ˆN D2
K

(1)

K

1

Only with the assumption that both the depth-wise con-
volution and standard convolution need the same channel
size, i.e. M = ˆM and N = ˆN , Eq. 1 can be reduced to
N + 1
< 1. However, the depth-wise convolution often
D2
requires much more channel numbers in order to perform
comparable to standard convolution on small-scale images.
Therefore, in reality, ˆM is much less than M and so does
ˆN . For instance, images can be represented by 32 chan-
nels in standard convolution rather than 144 or even larger
In this situation, the reduction ratio is
in MobileNet-V2.
32·32 + 144·144
·32·32 = 2.39 > 1. It indi-
ˆM · ˆN
cates a standard convolution can even save more than half
of computation cost compared with MobileNet-V2. Hence,
it is reasonable to select the standard convolution layer for
small size image and model.

+ M N

= 144

· ˆM · ˆN

D2

M

32

K

3.2. Two Points Representation of Age

In this section, we present a novel age representation as
a distribution over two discrete adjacent bins. Given a set
of images {(In, yn)}n=1,2,··· ,N , deep regression model can
be written as a mapping F : I → Y, where In and yn
represent image and regression label, respectively. For any
regression label yn, it can be represented as a convex com-
bination of two other numbers z1

n (z1

n 6= z2

n and z2

n),

yn = λ1z1

n + λ2z2
n,

(2)

where λ1 and λ2 are the weights, λ1, λ2 ∈ R+, λ1+λ2 = 1.
Given the age interval [a, b], a label yn ∈ [a, b] and bins
{zm} with uniform interval K , yn can be represented by

12589

Figure 2: Overview of our compact model on age estimation.

K (cid:5) · K and z2

n = (cid:4) yn
K (cid:7) · K, where ⌊·⌋ and ⌈·⌉ are
z1
the ﬂoor and ceiling function. Accordingly, the coefﬁcients
λ1 and λ2 are computed as

n = (cid:6) yn

λ1 =1 −

λ2 =1 −

yn − z1
n

K

z2
n − yn

K

yn − (cid:4) yn
K (cid:5) · K
K

K (cid:7) · K − yn

= 1 −
= 1 − (cid:6) yn

K

(3)

For example, as shown in Fig. 3, the corresponding rep-
resentation of 68 or 74 with K = 10 (second row in
Fig. 3) or K = 20 (third row in Fig. 3) is given.
If
K = 10, the set of bins is {10, 20, 30, 40, 50, 60, 70, 80}
and yn is 68, the corresponding vector representation is
yn = [0, 0, 0, 0, 0, 0.2, 0.8, 0]. This operation assigns a dis-
tribution to the label, and will not incur any additional cost
on distribution labeling. Moreover, the distribution of two-
points representation is sparse.

Figure 3: A new deﬁnition on the age estimation by two-
points representation. Any point is represented by two ad-
jacent bins instead of any other two or more bins.

In fact, λ1 and λ2 represent the probability belonging to
two bins, which include rich distribution information. The
main trend on age estimation includes two aspects: simulta-
neously classiﬁcation and regression, and distribution learn-
ing. For the former, according to the above Fig. 3, 68 more

likely belongs to bin 70 instead of bin 60. Two-points repre-
sentation can disambiguate this problem naturally. For the
latter, some methods [7, 6, 25] use distribution matching for
better results. However, that requires extensive labeling to
obtain the distribution that is very costly.

What is more, two-points representation gets two adja-
cent bins instead of any other two or more points, and the
two adjacent bins are assigned with nonzero elements. In
fact, each point/age in the linesegment can be represented
by multiple points in which the number of combinations
is very diversiﬁed. Each point can also be represented
by two points or any other more points. However, those
combinations is probably not what we want, e.g., 50 =
0.5×0+0.5×100 = 0.2×10+0.2×40+0.2×60+0.2×90.
For age estimation, these representation is useless. While
for deep regression model, these combinations need to be
eliminated.

3.3. Cascade Training

From the above section, age value yn can be represented
as distribution vector yn. However, the combination of yn
is diversiﬁed. Two-points representation is suitable to con-
trol it. The next question is how to embed the vector infor-
mation into an end-to-end network. We implement this step
by the cascade model shown in Fig. 2. In speciﬁc, a fully
connected layer with semantic distribution is inserted in be-
tween feature layer yn and the regression layer yn. The
mapping f from feature X to age value y can be decom-
posed into two steps f1 and f2, i.e., f = f2 ◦ f1. In fact,
W1−−→
the whole process can be denoted as f : In
yn

W2−−→ yn.
Here we deﬁne two losses for two cascade task. The ﬁrst
one measures discrepancy between ground-truth label and
predicted age distribution. We adopt KL-Divergence as the
measurement,

Conv−−−→ X

Lkl(yn, ˆyn) = X

DKL(yn|ˆyn) + λ||W1||1

n

= X

X

yk
nlog

n

k

yk
n
ˆyk
n

+ λ||W1||1,

(4)

where W1 is the weight of the mapping f1 from concate-
nated feature X to the distribution ˆyn, λ is used to control

12590

concat00.10.20.30.40.50.60.7Age yKL lossMAE lossDistribution y SharedPlainCNNW1W2010010020304050607080907468 in [60, 70]74 in [70, 80]6860807068 = 60 *0.2 + 70 * 0.874 = 70 *0.6 + 80 * 0.4846080812746868267468 = 60 *0.6 + 80 * 0.474 = 60 *0.3 + 80 * 0.714668       (0, 0, 0, 0, 0, 0, 0.2, 0.8, 0, 0, 0) 74       (0, 0, 0, 0, 0, 0, 0.6, 0.4, 0, 0, 0) 68       (0, 0, 0, 0.6, 0.4, 0)  74       (0, 0, 0, 0.3, 0.7, 0)  the sparsity of the ˆyn. The second loss controls the pre-
diction of the ﬁnal age and is implemented as L1 distance
(MAE loss),

Lreg(yn, ˆyn) = X

||yn − ˆyn||.

(5)

n

In the training process, two loss functions are trained in
cascade style as shown in Fig. 2. However they are still
trained jointly, and the total loss is given as

Ltotal = αLkl + Lreg

(6)

where α is the hyperparameter to balance two losses. The
cascade training can properly control the distribution ˆyn in
case of diversiﬁed combination.

3.4. Context based Regression Model

The resolution and the size of small-scale image is lim-
ited. Exploiting facial information at different granularity
levels is necessary. As shown in Fig. 1, each cropped image
has a special view on the face. The image with high res-
olution contains rich local information, in return one with
low resolution may contain global and scene information.
Other than selecting one aligned facial center in SSR [38],
we crop face centers with three granularity levels, as shown
in Fig. 2, then fed them into the shared CNN network. Fi-
nally the bottlenecks of three-scale facial images are aggre-
gated by concatenation that followed by cascade module.

3.5. Discussions

In this section, we summarize two non-trivial empirical
guidelines for small-scale images and models. We will sup-
port our claims by experiments in the next section.

Residual module For small-scale image and model, is
the residual module necessary? At least for age estimation
dataset, it is not. Residual module with shortcut strategy is
ﬁrst designed by [11] to solve the problem of gradient van-
ishing, especially on very deep network. Its shortcut power
can only be disclosed when enough layers were involved.
The small-size model usually includes only shallow layers.
According to our experiment, common connection on plain
convolution is enough for small image and model. This dis-
cussion reminds us to rethink the apparent ideas in deep
learning, especially on the small size image and model.

SE module The squeeze-and-excitation (SE) module has
been validated by many works [31, 23] for large scale im-
age. While for small size image and model it also works
well. So we integrate the SE module into our network and it
costs very few parameters. For example, when the squeeze
factor is 2, each SE module’s parameters is only 32*16 *2
= 1024.

4. Experiments

The experiments consist of three parts. The ﬁrst part is
ablation study I on the comparison among SSR, MobileNet-

V2, ShufﬂeNet-V2 and C3AE using plain model. The sec-
ond one gives ablation study II on necessity of cascade mod-
ule and context based module. The last one mainly provides
the comparison with some state-of-the-arts.

4.1. Datasets

We study age estimation on three datasets:

IMDB-
WIKI [29], Morph II [28] and FG-NET [5]. We follow
the conventions in the literature SSR [38], DEX [29] and
Hot [29], WIKI-IMDB are used for pre-training and the ab-
lation study. Because Morph II is the most popular and
large benchmark for age estimation, we choose it for ab-
lation studies. Morph II and FG-NET are used to compare
with the state-of-the-arts.

IMDB-WIKI is the largest facial dataset with age la-
bels, which is introduced in [29] and consists of 523, 051
images in total. The range is from 0 to 100. It is separated as
two parts: IMDB(460, 723 images) and WIKI (62, 328 im-
ages). However, it is not suitable for the performance eval-
uation on the age estimation because it contains much more
noise. Thus, following previous works, e.g., SSR [38] and
DEX [29], we utilize IMDB-WIKI only for pre-training.

Morph II is the most popular benchmark for age esti-
mation, which has around 55, 000 face images of 13, 000
subjects with age label. The age ranges from 16 to 77(on
average, 4 images per subject). Similar to some previous
works [24, 41], we randomly partition the dataset into two
independent parts: training (80%) and testing (20%).

FG-NET contains 1, 002 face images from 82 non-
celebrity subjects with large variation of lighting, pose, and
expression. The age ranges from 0 to 69 (on average, 12
images per subject) [5]. Since the size of FG-NET is small,
some previous methods usually use leave-one-out setting
which needs to train 82 deep models. Under this setting,
there are about 12 samples for the testing. Here we ran-
domly choose 30 samples as the testing set and the remain-
ing ones are for the training. We repeat this split 10 times
and compute their average performance.

4.2. Implementation Details

Following SSR [38] and DEX [29], the model is ﬁrstly
pre-trained on the IMDB and WIKI dataset, and is with size
of 64 × 64 × 3. In all the experiments, Adam optimizer
is employed. In the ﬁrst ablation study, because the plain
model of C3AE is compared with other plain models, each
model is trained 160 epochs with batch size of 50. Simi-
lar to SSR, the initial learning rate, dropout rate, the mo-
mentum and the weight decay are set to 0.002, 0.2, 0.9 and
0.0001, respectively. The learning rate is decreased by a
factor of the regression value with patience epochs 10 on
the change value of 0.0001. In the second ablation study, for
comparing with the state-of-the-art methods, each model is
trained 600 epochs in total with the batch size of 50. We

12591

use the strategy in [42] with randomly dropping out blocks
on the input image. In this phase, the initial learning rate,
dropout rate, the momentum and the weight decay are set to
0.005, 0.3, 0.9 and 0.0001, respectively. The learning rate is
decreased by a factor of the regression value with patience
epochs 20 on the change value of 0.0005. Following SSR
[38], the evaluation criteria is mean absolute value (MAE).
The factor α in Eq. 6 is set to 10 in all the experiments. For
all the cascade model, K in Eq. 3 is set to 10.

4.3. Ablation Study

The ablation study is conducted as two parts. For the ﬁrst
one, our plain model is compared with SSR, MobileNet-V2
and ShufﬂeNet-V2 to demonstrate that standard convolu-
tion yields competitive performance, even better than fash-
ionable models such as MobileNet-V2 and ShufﬂeNet-V2.
We further study whether the residual module and SE mod-
ule can beneﬁt small network. For the second part, we con-
duct ablation study on the necessity of two-points represen-
tation and context module.

4.3.1 Ablation Study I: the Plain Model of C3AE

This part includes three groups of experiments: compar-
ison among our plain model, SSR, MobileNet-V2 and
ShufﬂeNet-V2; comparing with/without residual module;
and comparing with/without SE module.

The results of three methods (SSR, MobileNet-V2 and
ShufﬂeNet-V2) on Morph II(M-MAE), IMDB (I-MAE) and
WIKI (W-MAE) are given in Tab. 2. For fair comparison,
we implement extensive factor combinations(Comb.).
In
Tab. 2, for MobileNet-V2 (M-V2)2, (αpw, αexp) means the
number of the pointwise ﬁlters and the expansion factor for
each expansion layer, respectively. For ShufﬂeNet-V2 (S-
V2)3, (αra, αf a) means ratio of bottleneck module’s out-
put channels for each stage and the scale factor for each
stage’s output channels, respectively. To conclude from the
comparison, our plain model even with minimal parame-
ters(Param.) and memory achieved best result regardless of
parameter tuning in the alternative three methods.

We also give a speed analysis from two points: MACC
and runtime speed. The former is the theoretical number
of multi-add operations. The latter is the measured speed
all under the same condition (forward single image 2000
times and then average), on CPU(Intel Xeon 2.1GHZ) and
GPU(Titan X). The comparison is shown in Tab. 3.

As shown in Fig. 4, the plain model of C3AE is consis-
tently better than SSR, ShufﬂeNet-V2 and MobileNet-V2
with lower validation loss (val loss in orange, training loss
in blue). More examples can be found in the supplemen-
tary material. For MobileNet-V2 and ShufﬂeNet-V2, with

2The code is from keras application
3The code is from https://github.com/opconty/keras-shufﬂenetV2

the depth-wise convolution, is by no means inferior than our
plain model with standard convolution. In addition, there is
a strange observation that the result of αexp = 4 is supe-
rior to αexp = 6. We believe that too large inverted bottle-
neck may be not suitable for small size model. For SSR, the
standard convolution is also used. However, its full model
is still inferior to our plain model. In addition, the gap be-
tween train and validate loss in our plain is the least.
It
shows our plain model has better generalization. All these
observations suggest the effectiveness of our plain model.
Although our plain model is plain enough without any bells
and whistles, it still can get very competitive performance.
We further investigate the effectiveness of residual con-
nection and SE module. According to the results in Tab. 4
and the comparison in supplementary material, we observe
that residual module does not beneﬁt in the small size
model, in particular for three datasets on age estimation.
While SE module work well for small size model.

Table 2: Comparsion among SSR, M-V2, S-V2 and C3AE.

M-V2

(0.25, 4)
(0.25, 6)
(0.5, 4)
(0.5, 6)
(0.75, 4)
(0.75, 6)
(0.25, 0.5)
(0.25, 1)
(0.5, 0.5)
(0.5, 1)

Methods Comb. M-MAE I-MAE W-MAE Param. Memory MACC
107129 808.7KB 2.2M
153561 994.7KB 3.0M
354713 1.8MB 5.7M
518857 2.5MB 8.1M
747961 3.4MB 12.3M
1102537 4.8MB 17.7M
1.0MB 0.6M
76589
464185 2.6MB 4.0M
155753 1.3MB 1.4M
1284087 5.9MB 12.7M
250829 1.7MB 2.5M
2473043 10.7MB 26.1M
40915 326.4KB 17.6M
36345 197.8KB 12.8M

3.72
4.26
3.71
4.05
3.24
4.10
4.85
4.11
4.11
3.83
3.98
3.63
3.16
3.13

7.23
7.01
6.76
6.75
6.57
6.69
8.22
7.67
7.66
7.40
7.55
7.07
6.94
6.57

7.29
7.30
6.76
6.83
6.49
6.72
8.78
8.02
8.04
7.63
7.91
7.19
6.76
6.44

SSR Full model
C3AE Plain model

(0.75, 0.5)
(0.75, 1)

S-V2

Table 3: The Speed analysis

our-plain SSR M-v2(.5,6) M-v2(.75,6) S-v2(.5,1) S-v2(.75,1)

evaluation
MACC (M)

12.8

17.6

8.1

runtime-cpu(s) 0.0126 0.0233 0.0245
runtime-gpu(s) 0.0029 0.0050 0.0070

MAE

3.13

3.16

4.05

17.7

0.0394
0.0080

4.10

12.7

0.0228
0.0080

3.83

26.1

0.0295
0.0082

3.63

Table 4: The role of residual module and SE

Datasets
Morph II

IMDB
WIKI

w/o Res+w/o SE

w. Res

3.13
6.57
6.44

3.21
6.66
6.57

w. SE
3.11
6.50
6.36

4.3.2 Ablation Study II: Cascade and Context Module

In this section, we analyze how the choice of cascade mod-
ule (two-points representation) and context module affect
the performance of age estimation.

12592

Figure 4: Comparison on the training process of M-V2, S-V2, SSR and our plain model.(Best viewed in color and magniﬁer.)

The result of two-points representation is implemented
by cascaded training, i.e., with/without cascade module. As
shown in Fig. 5, regardless of the regularizer λ in Eq. 4
we choose, the result with casacde module is consistently
better than that without cascade.
If the context module
is further applied (Cascade + Context) it outperforms the
other two.The validations demonstrate the importance of
two-points representation and context module.

In speciﬁc, we give some examples in Fig. 6. GT
means the groundtruth value, and the legend gives the pre-
dicted age. The X-axis is the learned weights W2, and the
Y-axis is the predicted vector ˆyn. Their dot/inner prod-
uct is the predicted age. We can see that the learned
weights are almost equivalent to groundtruth bins W2 =
[10, 20, 30, 40, 50, 60, 70, 80]. That is to say, W2 controls
two-points representation so that the diversiﬁed combina-
tions are eliminated. The last element of the predicted bins
is very strange, i.e., 92.73, 55.49. After the analysis of the
data distribution, we found that there are only 9 samples in
the range [70, 80], and it is easy to explain why the last
element is abnormal. The predicted distribution is sparse
with only two or three adjacent nonzero elements because
of two-points representation. Fully connected layer will
lead to the phenomenon that each age can be represented
by many different combinations.

In addition, as shown in Fig. 6, we also observe that the
predicted distribution and age on the top is better than that
on the bottom. The colors of the bar, legend and the distri-
bution correspond to the colored bounding box on the top
image. Context based model (top) achieves better perfor-
mance than that of single scale input (bottom).

Finally, in order to show generality of our model, we

E
A
M

3

2.8

2.6

2.4

w/o Cascade

Cascade

Cascade + Context

5e-5

5e-4

5e-3

5e-2

5e-1

5e0

Lambda

Figure 5: Evaluation of cascade and context module.

ﬁnetune the hyperparameters α as 5, 8, 10, 12 and 15 on
our full model, and the corresponding results are 2.79, 2.79,
2.75, 2.79 and 2.80, respectively. These results does not
change too much. It shows the robustness of our model.

4.4. Comparison with State of the arts on Morph 

II

In this section, we further compare our model with state-
of-the-art models on Morph II. As shown in Tab. 5, our
full model achieves 2.78 and 2.75 MAE under the condi-
tion: trained from scratch and pretrained on IMDB-WIKI,
which is the state-of-the-art performance among compact
models. The previous best performance achieved in the
compact model is 3.16 in SSR [38]. Some results in the
Tab. 5 are from SSR [38]. In fact, our plain model achieves
3.13 MAE even without any bells and whistles. The results
of all other compact models are pretrained on IMDB-WIKI.
Our results on with/without pretrained process are very sim-
ilar. We believe Morph II is large enough to train our tiny
model. On the other hand, our result is much competitive
compared with the bulky models, and it even surpasses sev-

12593

Our model(Plain): 197.8KBM-V2(Plain)-0.5-6: 2.5MBM-V2(Plain)-0.75-4: 3.4MBIMDBWIKIMORPHS-V2(Plain)-0.25-1: 2.6MBS-V2(Plain)-0.5-0.5: 1.3MBSSR(Full model): 326.4KBFigure 6: Some examples on the C3AE. Top: the result of the context based regression model. The yellow bars denote the
predicted distribution ˆyn, and the X-axis is the learned weight W2 from the distribution to age value. Bottom: Three different
colors RGB correspond to each facial context and predicted distribution ˆyn.(Best viewed in color and magniﬁer.)

eral bulky models despite it consumes only 1/2000 of their
model sizes. All the bulky models are pretrained on Ima-
geNet or IMDB-WIKI using VggNet. Our result without
pretrained process even surpasses some pretrained bulky
models.
In general, C3AE gets very competitive perfor-
mance on Morph II with extremely lightweight model.

Table 5: Comparsion with state-of-the-arts that use compact
and bulky basic models on Morph II.

Type

Compact

Bulky

C3AE

Hot [30]

Methods

SSR [38]

Ranking CNN [3]

MobileNet-V1 [12]

ORCNN [24]
MRCNN [24]
DenseNet [14]

MAE Memory Parameters
3.27 1.7MB 479.7K
3.42 1.7MB 479.7K
5.05 1.1MB 242.0K
6.50 1.0MB 226.3K
3.16 0.32MB 40.9K
500M
2.96 2.2GB
138M
3.45 530MB
3.12 530MB
138M
138M
3.25 530MB
138M
DEX (IMDB-WIKI) [29] 2.68 530MB
138M
3.00 530MB
138M
52 530MB
2
41 530MB
138M
MV (IMDB-WIKI) [25] 2.16 530MB
138M
2.78 0.25MB 39.7K
Full model (IMDB-WIKI) 2.75 0.25MB 39.7K

ARN [1]
AP [41]
MV [25]

ODFL [19]
DEX [29]

Full model (Scratch)

2

.

.

4.5. Comparison with State of the arts on FG NET

As shown in Tab. 6, we compare our model with state-
of-the-art models on FG-Net. Without training 82 models,
we randomly repeat the experiment ten times. This is also
challenging because we use less train dataset. In fact, Han
[10], Luu [21, 22] in Tab. 6 are also use the different splits.
Using mean-variance loss, MV [25] with pre-trained pro-
cess gets the best result of 2.68. While our result with pre-
trained process is 2.95 MAE and 0.17 std, i.e., the second
best performance compared with Bulky models. In addi-
tion, without any pre-trained process, our result of 4.09 is

slightly better than MV [25] of 4.10. In general, the valida-
tion on FG-NET demonstrate the effectiveness of C3AE.

Table 6: Comparison with state-of-the-arts on FG-Net.

Methods

Geng et al. [7]
Han et al. [10]
Luu et al. [21]
Luu et al. [22]
Wang et al. [37]
Feng et al. (1) [4]
Feng et al. (2) [4]

Zhu et al. (Actual) [43]

Zhu et al. (Synthesized) [43]

Liu et al. [19]

DEX [29]

DEX (WIKI-IMDB) [29]

MV [25]

-
-
-
-
-

-
-
-
-
-

MAE Memory Parameters
5.77
4.80
4.37
4.12
4.26
4.35
4.09
4.58
3.62
3.89
4.63
3.09
4
10

138M
138M
138M
138M
138M
138M
138M
138M
138M
19 0.25MB 39.7K
17 0.25MB 39.7K

530MB
530MB
530MB
530MB
530MB
530MB
530MB
530MB
530MB

.

MV (WIKI-IMDB) [25]

C3AE (Scratch)

C3AE (WIKI-IMDB)

2.68
09 ± 0

95 ± 0

.

.

4

.

2

.

5. Conclusion

In this paper, we have proposed a compact model, C3AE,
that has achieved state-of-the-art performance among com-
pact models and competitive performance among bulky
models. From various ablation study, we have demonstrated
the effectiveness of C3AE. For the small/medium-size im-
age and model, some analysis and rethinking are given. In
the future work, we will evaluate the effectiveness of our
observation on general datasets and applications.

6. Acknowledgements

This research was supported in part by National Nat-
ural Science Foundation of China (NSFC, No.61571102,
No.61602091, No.61872067), Research Programs of
Science and Technology in Sichuan (No.2018JY0035,
No.2019YFH0016).

12594

W2 * [0.42 0.58 0.   0.   0.   0.   0.   0.] = 15.77W2 * [0.   0.   0.39 0.61 0.   0.   0.   0.] = 36.11W2 * [0.2   0.74  0.05 0.  0.  0.  0.  0.] = 18.14W2 * [0.3   0.7    0.     0.  0.  0.  0.  0.] = 16.68W2 * [0.33 0.66  0.     0.  0.  0.  0.  0.] = 16.33W2 * [0.  0.02 0.34 0.50  0.12 0.01 0.  0.] = 37.42W2 * [0.  0.     0.44 0.54  0.01 0.     0.  0.] = 35.55W2 * [0.  0.01 0.57 0.41  0.     0.     0.  0.] = 34.08W2 * [0.  0.  0.01 0.33 0.59 0.07 0. 0.] = 47.14W2 * [0.  0.  0.01 0.53 0.44 0.02 0. 0.] = 44.63W2 * [0.  0.  0.01 0.45 0.51 0.03 0. 0.] = 45.63W2 * [0.   0.   0.   0.5  0.49 0.   0.   0.] = 45.00W2 * [0.   0.   0.   0.46 0.53 0.01 0.   0.] = 45.43W2 * [0.  0.01 0.07 0.33 0.47 0.11 0.01 0.] = 46.28W2 * [0.  0.     0.01 0.30 0.61 0.08 0.     0.] = 47.59W2 * [0.  0.     0.05 0.53 0.40 0.02 0.     0.] = 43.87W2 * [0.   0.   0.   0.   0.22 0.75 0.03 0.] = 57.99W2 * [0. 0. 0. 0.04 0.47 0.46 0.04 0.] = 54.80W2 * [0. 0. 0. 0.01 0.24 0.66 0.09 0.] = 58.02W2 * [0. 0. 0. 0.03 0.43 0.49 0.05 0.] = 55.35GT=16GT=36GT=45GT=45GT=57References

[1] E. Agustsson, R. Timofte, and L. Van Gool. Anchored re-
gression networks applied to age estimation and super reso-
lution. In ICCV, 2017. 8

[2] L.-C. Chen, G. Papandreou, I. Kokkinos, K. Murphy, and
A. L. Yuille. Deeplab: Semantic image segmentation with
deep convolutional nets, atrous convolution, and fully con-
nected crfs. IEEE Trans. on Pattern Analysis and Machine
Intelligence, 40(4):834–848, 2018. 2

[3] S. Chen, C. Zhang, M. Dong, J. Le, and M. Rao. Using

ranking-cnn for age estimation. In CVPR, 2017. 2, 8

[4] S. Feng, C. Lang, J. Feng, T. Wang, and J. Luo. Hu-
man facial age estimation by cost-sensitive label ranking and
trace norm regularization. IEEE Transactions on Multime-
dia, 19(1):136–148, 2017. 2, 8

[5] Y. Fu, G. Guo, and T. S. Huang. Age synthesis and estima-
tion via faces: A survey. IEEE Trans. on Pattern Analysis
and Machine Intelligence, 32(11):1955–1976, 2010. 2, 5

[6] B.-B. Gao, C. Xing, C.-W. Xie, J. Wu, and X. Geng. Deep
label distribution learning with label ambiguity. IEEE Trans.
on Image Processing, 26(6):2825–2838, 2017. 2, 4

[7] X. Geng and R. Ji. Label distribution learning. In ICDMW,

2013. 4, 8

[8] R. Girshick, J. Donahue, T. Darrell, and J. Malik. Rich fea-
ture hierarchies for accurate object detection and semantic
segmentation. In CVPR, 2014. 2

[9] H. Han, A. K. Jain, F. Wang, S. Shan, and X. Chen. Hetero-
geneous face attribute estimation: A deep multi-task learning
approach. IEEE Trans. on Pattern Analysis and Machine In-
telligence, 40(11):2597–2609, 2018. 2

[10] H. Han, C. Otto, X. Liu, and A. K. Jain. Demographic esti-
mation from face images: Human vs. machine performance.
IEEE Trans. on Pattern Analysis and Machine Intelligence,
(6):1148–1161, 2015. 8

[11] K. He, X. Zhang, S. Ren, and J. Sun. Deep residual learning

for image recognition. In CVPR, 2016. 1, 2, 5

[12] A. G. Howard, M. Zhu, B. Chen, D. Kalenichenko, W. Wang,
T. Weyand, M. Andreetto, and H. Adam. Mobilenets: Efﬁ-
cient convolutional neural networks for mobile vision appli-
cations. arXiv preprint arXiv:1704.04861, 2017. 1, 2, 3, 8

[13] J. Hu, L. Shen, and G. Sun. Squeeze-and-excitation net-

works. arXiv preprint arXiv:1709.01507, 7, 2017. 2

[14] G. Huang, Z. Liu, L. Van Der Maaten, and K. Q. Weinberger.
Densely connected convolutional networks. In CVPR, 2017.
2, 8

[15] E. Hutchins. Cognition in the Wild. Cambridge, MA, USA:

MIT Press, 1995. 2

[16] F. N. Iandola, S. Han, M. W. Moskewicz, K. Ashraf, W. J.
Dally, and K. Keutzer. Squeezenet: Alexnet-level accuracy
with 50x fewer parameters and 0.5 mb model size. arXiv
preprint arXiv:1602.07360, 2016. 2

[17] A. Krizhevsky, I. Sutskever, and G. E. Hinton.

classiﬁcation with deep convolutional neural networks.
NIPS, 2012. 1, 2

Imagenet
In

[18] G. Levi and T. Hassner. Age and gender classiﬁcation using

convolutional neural networks. In CVPRW, 2015. 2

[19] H. Liu, J. Lu, J. Feng, and J. Zhou. Ordinal deep feature

learning for facial age estimation. In FGR, 2017. 2, 8

[20] J. Long, E. Shelhamer, and T. Darrell. Fully convolutional

networks for semantic segmentation. In CVPR, 2015. 2

[21] K. Luu, K. Ricanek, T. D. Bui, and C. Y. Suen. Age esti-
mation using active appearance models and support vector
machine regression. In International Conference on Biomet-
rics: Theory, Applications, and Systems, 2009. 8

[22] K. Luu, K. Seshadri, M. Savvides, T. D. Bui, and C. Y. Suen.
In

Contourlet appearance model for facial age estimation.
International Joint Conference on Biometrics, 2011. 8

[23] N. Ma, X. Zhang, H.-T. Zheng, and J. Sun. Shufﬂenet v2:
Practical guidelines for efﬁcient cnn architecture design. In
ECCV, 2018. 1, 2, 3, 5

[24] Z. Niu, M. Zhou, L. Wang, X. Gao, and G. Hua. Ordinal
In

regression with multiple output cnn for age estimation.
CVPR, 2016. 2, 5, 8

[25] H. Pan, H. Han, S. Shan, and X. Chen. Mean-variance loss
for deep age estimation from a face. In CVPR, 2018. 2, 4, 8

[26] J. Redmon and A. Farhadi. Yolo9000: Better, faster, stronger.

In CVPR, 2017. 2

[27] S. Ren, K. He, R. Girshick, and J. Sun. Faster r-cnn: to-
wards real-time object detection with region proposal net-
works. IEEE Trans. on Pattern Analysis and Machine Intel-
ligence, (6):1137–1149, 2017. 2

[28] K. Ricanek and T. Tesafaye. Morph: A longitudinal image
database of normal adult age-progression. In FGR, 2006. 5

[29] R. Rothe, R. Timofte, and L. Van Gool. Deep expectation
of real and apparent age from a single image without facial
landmarks. Int. J. Comput. Vision (IJCV), 126(2-4):144–157,
2016. 2, 5, 8

[30] R. Rothe, R. Timofte, and L. Van Gool. Some like it hot-
visual guidance for preference prediction. In CVPR, 2016.
8

[31] M. Sandler, A. Howard, M. Zhu, A. Zhmoginov, and L.-C.
Chen. Mobilenetv2: Inverted residuals and linear bottle-
necks. In CVPR, 2018. 1, 2, 3, 5

[32] L. Sifre and S. Mallat. Rigid-motion scattering for image

classiﬁcation. PhD thesis, 2014. 2

[33] K. Simonyan and A. Zisserman. Very deep convolutional
networks for large-scale image recognition. arXiv preprint
arXiv:1409.1556, 2014. 1, 2

[34] C. Szegedy, S. Ioffe, V. Vanhoucke, and A. A. Alemi.
Inception-v4, inception-resnet and the impact of residual
connections on learning. In AAAI, 2017. 2

[35] C. Szegedy, W. Liu, Y. Jia, P. Sermanet, S. Reed,
D. Anguelov, D. Erhan, V. Vanhoucke, and A. Rabinovich.
Going deeper with convolutions. In CVPR, 2015. 2

[36] C. Szegedy, V. Vanhoucke, S. Ioffe, J. Shlens, and Z. Wojna.
Rethinking the inception architecture for computer vision. In
CVPR, 2016. 2

[37] X. Wang, R. Guo, and C. Kambhamettu. Deeply-learned

feature for age estimation. In WACV, 2015. 8

[38] T.-Y. Yang, Y.-H. Huang, Y.-Y. Lin, P.-C. Hsiu, and Y.-Y.
Chuang. Ssr-net: A compact soft stagewise regression net-
work for age estimation. In IJCAI, 2018. 5, 6, 7, 8

12595

[39] D. Yi, Z. Lei, and S. Z. Li. Age estimation by multi-scale

convolutional network. In ACCV, 2015. 2

[40] X. Zhang, X. Zhou, M. Lin, and J. Sun. Shufﬂenet: An
extremely efﬁcient convolutional neural network for mobile
devices. arxiv 2017. arXiv preprint arXiv:1707.01083. 1, 2,
3

[41] Y. Zhang, L. Liu, C. Li, et al. Quantifying facial age by pos-
terior of age comparisons. arXiv preprint arXiv:1708.09687,
2017. 5, 8

[42] Z. Zhong, L. Zheng, G. Kang, S. Li, and Y. Yang.
arXiv preprint

Random erasing data augmentation.
arXiv:1708.04896, 2017. 6

[43] H. Zhu, Q. Zhou, J. Zhang, and J. Z. Wang. Facial aging and
rejuvenation by conditional multi-adversarial autoencoder
with ordinal regression. arXiv preprint arXiv:1804.02740,
2018. 8

12596

