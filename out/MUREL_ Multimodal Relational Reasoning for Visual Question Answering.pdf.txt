MUREL: Multimodal Relational Reasoning for Visual Question Answering

Remi Cadene 1 ∗

Hedi Ben-younes 1

2 ∗

,

Matthieu Cord 1

Nicolas Thome 3

1 Sorbonne Universit´e, CNRS, LIP6, 4 place Jussieu, 75005 Paris

2 Heuritech, 110 avenue de la R´epublique, 75011 Paris

3 Conservatoire National des Arts et M´etiers, 75003 Paris

remi.cadene@lip6.fr, hedi.ben-younes@lip6.fr, matthieu.cord@lip6.fr, nicolas.thome@cnam.fr

Abstract

What is she
eating? 

MuRel network 

Multimodal attentional networks are currently state-of-
the-art models for Visual Question Answering (VQA) tasks
involving real images. Although attention allows to focus
on the visual content relevant to the question, this simple
mechanism is arguably insufﬁcient to model complex rea-
soning features required for VQA or other high-level tasks.
In this paper, we propose MuRel, a multimodal relational
network which is learned end-to-end to reason over real im-
ages. Our ﬁrst contribution is the introduction of the MuRel
cell, an atomic reasoning primitive representing interac-
tions between question and image regions by a rich vec-
torial representation, and modeling region relations with
pairwise combinations. Secondly, we incorporate the cell
into a full MuRel network, which progressively reﬁnes vi-
sual and question interactions, and can be leveraged to de-
ﬁne visualization schemes ﬁner than mere attention maps.

We validate the relevance of our approach with vari-
ous ablation studies, and show its superiority to attention-
based methods on three datasets: VQA 2.0, VQA-CP v2 and
TDIUC. Our ﬁnal MuRel network is competitive to or out-
performs state-of-the-art results in this challenging context.
github.com/Cadene/

Our code is available:

murel.bootstrap.pytorch

1. Introduction

Since the success of Convolutional Neural Networks
(ConvNets) at the ILSVRC 2012 challenge [29], Deep
Learning has become the baseline approach for any com-
puter vision problem. Beyond their outstanding perfor-
mances for perception tasks, e.g. classiﬁcation or detec-
tion [14], deep ConvNets have also been successfully used
for new artiﬁcial intelligence tasks like Visual Question An-
swering (VQA) [4, 17, 23]. VQA requires a high level un-
derstanding of images and questions, and is often consid-
ered to be a good proxy for visual reasoning. However, it

∗Equal contribution

Donut
✔

Step #1

Step #2

Step #3

Figure 1. Visualization of the MuRel approach. Our MuRel
network for VQA is an iterative process based on a rich vectorial
representation between the question and visual information explic-
itly modeling pairwise region relations. MuRel is thus able to ex-
press complex analysis primitives beyond attention maps: here the
two regions corresponding to the head and the donuts are selected
based on their visual cues and semantic relations to properly an-
swer the question ”what is she eating?”

is not straightforward to use ConvNets in a context where a
high level of reasoning is required. The question of leverag-
ing the perception power of deep CNNs for reasoning tasks
is crucial if we want to go further in visual scene under-
standing [21, 11].

It is also not trivial to deﬁne nor evaluate a model’s
capacity to reason about the visual modality in VQA. To
ﬁll this need, synthetic datasets have been released, e.g.
CLEVR [21], which speciﬁc structure controls the exact
reasoning primitives required to give the answer [22, 19,
34]. However, methods that tackle the VQA problem on
real data struggle to integrate this explicit reasoning pro-
cedure. Instead, state-of-the-art methods often rely on the
much simpler attentional framework [16, 8, 25, 12]. Despite
its effectiveness, this mechanism restricts visual reasoning
to a soft selection of regions that are relevant to answer the
question. This arguably limits the modeling power of such
models to bridge the gap between the perceptual strengths
of ConvNets and the high-level reasoning demand for VQA.

In this paper, we propose MuRel, a multimodal relational
network that goes one step further towards reasoning about
questions and images. Our ﬁrst contribution is to introduce
the MuRel cell, an atomic reasoning primitive enabling to

11989

represent rich interactions between question and image re-
gions. It is based on a vectorial representation that explicitly
models relations between regions. Our second contribution
is to embed this MuRel cell into an iterative reasoning pro-
cess, which progressively reﬁnes the internal network rep-
resentation to answer the question. The rationale of MuRel
is illustrated in Figure 1: for the question ”what is she eat-
ing”, our model focuses on two main regions (the head and
the donut) with important visual cues and semantic rela-
tions between them to provide the correct answer (”donut”).
The visual reasoning of our MuRel system is formed by this
multi-step relational module that discards useless informa-
tion to focus on the relevant regions.

In the experiments, we show additional results for ex-
plaining the behaviour of MuRel. We also provide various
ablative studies to validate the relevance of the MuRel cell
and the iterative reasoning process, and show that MuRel is
highly competitive or even outperforms state-of-the-art re-
sults on three of the most common VQA datasets: the VQA
2.0 dataset [17], VQA-CP v2 [1] and TDIUC [23].

2. Related work and contributions

Recently, the deep learning community started to tackle
complex visual reasoning problems such as relationship de-
tection [31], object recognition [11], multimodal retrieval
[10, 15], abstract reasoning [38], visual causality [30], or
visual dialog [13, 48], while more theoretical work attempt
to formalize relational reasoning [7].

But the most popular image reasoning task is certainly
Visual Question Answering (VQA), which has been a hot
research topic for the last ﬁve years [33, 4, 17, 23]. Since
the seminal work of [33], different sub-problems have been
identiﬁed for the resolution of VQA. In particular, explicit
reasoning techniques have been developed relying on syn-
thetic datasets [21, 41]. Meanwhile, real-data VQA sys-
tems are the test bed for more practical approaches based
on high quality visual representations or multimodal fusion
schemes.

Visual reasoning The research efforts towards VQA
models that are able to reason about a visual scene is mainly
conducted using the CLEVR dataset [21]. This artiﬁcial
dataset provides questions that require spatial and relational
reasoning on simple images coming from a visual world
with low variability. An important line of work attempts
to solve this task through explicit reasoning. In such meth-
ods [22, 19, 34], a neural network reads the question and
generates a program, corresponding to a graph of elemen-
tary neural operations that process the image. However,
there are two major downsides to these techniques. First,
their performance strongly depends on whether or not pro-
gram annotations are used to learn the program generator;
and second, they can be matched or surpassed by simpler

models that implicitly learn to reason without requiring pro-
In particular, FiLM [37] modulates the
gram annotation.
visual feature map with an afﬁne transformation whose pa-
rameters depend on the question. In more recent work, the
MAC network [20] draws inspiration from the Model-View-
Controller paradigm to design the trainable MAC cell on
which the network iterates. Finally, in [39], they reason over
all the possible pairs of objects in the picture, thus introduc-
ing relationship modeling in visual question answering.

VQA on real data An important part of the research
in VQA is focused on designing functions that can rep-
resent high-level correlations between two vector spaces.
Among these multimodal fusion algorithms, the most ef-
fective ones use second order (or higher [45]) interactions,
made tractable through sketching methods [16], or with
more success using the tensor decomposition framework
[25, 8, 44].

This line of work is often considered orthogonal to vi-
sual reasoning contributions. In a setup involving real data,
complex methods such as explicit or relational reasoning
are much more challenging to implement than with artiﬁ-
cial images and questions. This is certainly why the most
widely used reasoning framework involves soft attention
mechanisms [5, 42]. Given a question, these models as-
sign an importance score to each region, and use them to
weight-sum pool the visual representations. Multiple atten-
tion maps (also called glimpses) can even be computed in
parallel [25, 8, 44, 45] or sequentially [43]. More complex
attention strategies have been explored, such as the Struc-
tured Attention [12], where a locally-connected graphical
structure is considered to infer the region saliency scores.
[47] also leverages a graphical structure between regions
to address weaknesses of the soft-attention mechanism, im-
proving the VQA model’s ability to count. In [36], the im-
age representation is computed using pairwise semantic at-
tention and spatial graph convolutions. The soft attention
framework is questioned in [32], where regions are hardly
selected based on the norm of their feature. Finally, recent
work of [24] simultaneously attends over regions and word
tokens through a bilinear attention network.

Importantly, the type of visual features used to feed
the VQA system has an large impact on performance.
While early work have been using ﬁxed-grid representation
given by a fully-convolutional network (such as ResNet-152
[18]), performance can be improved using predictions from
an object detector [3]. Recently, a crucial component in the
VQA Challenge 2018 winning entry was the mix of multi-
ple types of visual features [46].

MuRel contributions
In this work, we move away from
the classical attention framework [25, 16, 8, 45] widely used
in real-data VQA systems. Instead, we use a vectorial rep-

1990

resentation, more expressive than scalar attention maps, to
model the semantic interaction between each region’s vi-
sual content and the question. In addition, we include a no-
tion of spatial and semantic context in the representations by
representing pairs of image regions through interactions be-
tween their visual embeddings and spatial coordinates. Dif-
ferently than the approach followed in [36] where a locally
connected graph structure is built, we use the relations be-
tween all possible pairs of regions.

Our MuRel network embodies an iterative process with
inspiration from works driven by the synthetic reasoning
CLEVR dataset, e.g., MAC [20] or FiLM [37], which we
adapt to the real data VQA purpose. In particular, we im-
prove the interactions between image regions and questions
by using richer bilinear fusion models and by explicitly in-
corporating relations between regions.

3. MuRel approach

Our VQA approach is depicted in Figure 3. Given an
image v ∈ I and a question q ∈ Q about this image, we
want to predict an answer ˆa ∈ A that matches the ground
truth answer a⋆. As very common in VQA, the prediction ˆa
is given by classiﬁcation scores:

ˆa = argmax
a∈A

pθ(a|v, q)

(1)

where pθ is our trainable model.
In our system, the im-
age is represented by a set of vectors {vi}i∈[1,N ], where
each vi ∈ Rdv corresponds to an object detected in the
picture. We also use the spatial coordinates of each region
bi = [x, y, w, h], where (x, y) are the coordinates of the
top-left point of the box, and h and w correspond to the
height and the width of the box. Note that x and w (respec-
tively y and h) are normalized by the width (resp. height) of
the image. For the question, we use a gated recurrent unit
network to provide a sentence embedding q ∈ Rdq .

In Section 3.1, we present the MuRel cell, a neural mod-
ule that learns to perform elementary reasoning operations
by blending question information into the set of spatially-
grounded visual representations. Next, in Section 3.2, we
leverage the power of this cell using the MuRel network, a
VQA architecture that iterates through a MuRel cell to rea-
son about the scene with respect to a question.

3.1. MuRel cell

The MuRel cell takes as input a bag of N visual features
si ∈ Rdv , along with their bounding box coordinates bi.
As shown in Figure 2, it is a residual function consisting
of two modules. First, an efﬁcient bilinear fusion module
merges question and region feature vectors to provide a lo-
cal multimodal embedding. This fusion is directly followed
by a pairwise modeling component, designed to update each
multimodal representation with respect to its own spatial
and visual context.

Bilinear 
Fusion

 q

 s

i

 m

i

skip-connection 

Pairwise 
Relational 
Modeling 

 x

i

+

 s

i

ˆ

Figure 2. MuRel cell.
In the MuRel cell, the bilinear fusion
represents rich and ﬁne-grained interactions between question and
region vectors q and si. All the resulting multimodal vectors mi
pass through a pairwise modeling block to provide a context-aware
embedding xi per region. The cell’s output ˆsi is ﬁnally computed
as a sum between si and xi, acting as residual function of si.

Multimodal fusion We want to include question infor-
mation within each visual representation si. Multiple
multimodal fusion strategies have been recently proposed
[25, 16, 8, 44, 45] to model the relevant interactions be-
tween two modalities. One of the most efﬁcient technique
is the one proposed by [9], based on the Tucker decomposi-
tion of third-order tensors. This bilinear fusion model learns
to focus on the relevant correlations between input dimen-
sions. It models rich and ﬁne-grained multimodal interac-
tions, while keeping a relatively low number of parameters.
Each input vector si is fused with the question embedding
q using the same bilinear fusion:

mi = B (si, q; Θ)

(2)

where Θ are the trainable parameters of the fusion module.
Each dimension m of mi can be written as a bilinear func-
i qq. Thanks to the Tucker de-
tion in the form Ps,q ws,q,mss
composition, the tensor {ws,q,m} is factorized into the list
of parameters Θ. We set the number of dimensions in mi
to dv to facilitate the use of residual connections throughout
our architecture.

In classical attention models, the fusion between image
region and question features s and q only learns to encode
whether a region is relevant. In the MuRel cell, the local
multimodal information is represented within a richer vec-
torial form mi which can encode more complex correla-
tions between both modalities. This allows to store more
speciﬁc information about what precise characteristic of a
particular region is important in a given textual context.

Pairwise interactions To answer certain types of ques-
tion, it can be necessary to reason over multiple object that
interact together. More generally, we want each representa-
tion to be aware of the spatial and semantic context around
it. Given that our features are structured as a bag of local-
ized vectors [3], modeling the visual context of each region
is not straightforward. Similarly to the recent work of [36],
we opt for a pairwise relationship modeling where each re-
gion receives a message based on its relations to its neigh-
bours. In their work, a region’s neighbours correspond to

1991

the K most similar regions, whereas in the MuRel cell the
neighbourhood is composed of every region in the image.
Besides, instead of using scalar pairwise attention and graph
convolutions with Gaussian kernels as they do, we merge
spatial and semantic representations to build relationship
vectors. In particular, we compute a context vector ˇei for
every region. It consists in an aggregation of all the pairwise
links ri,j coming into i. We deﬁne it as ˇei = maxj ri,j ,
where ri,j is a vector containing information about the con-
tent of both regions, but also about their relative spatial po-
sitioning. We use the max operator in the aggregation func-
tion to reduce the noise that can be induced by average or
sum poolings, which oblige all the regions to interact with
each other. To encode the relationship vector, we use the
following formulation:

ri,j = B (bi, bj; Θb) + B (mi, mj; Θm)

(3)

Through the B(., .; Θb) operator, the cell is free to learn
spatial concepts such as on top of, left, right, etc. In par-
allel, B(., .; Θs) encodes correlations between multimodal
vectors (si, sj), corresponding to semantic visual concepts
conditioned on the question representation. By summing
up both spatial and semantic fusions, the network can learn
high-level relational concepts such as wear, hold, etc.

The context representation ˇei is obtained by aggregating
the representations ri,j provided by its neighbours through
an element-wise max pooling. Using this operator, the net-
work can learn to ﬁlter our irrelevant interactions for each
features dimension. Then, the multimodal vector mi is up-
dated in an additive manner:

xi = mi + ˇei

(4)

This formulation of the pairwise modelling is actually
closer to the Graph Networks [7], where the notion of re-
lational inductive biases is formalized.

Finally, the MuREL cell’s output is computed as a resid-
ual function of its input, to avoid the vanishing gradient
problem. Each visual feature si is updated as: ˆsi = si + xi.
The chain of operations that updates the set of localized
region embeddings {si}i∈[1,N ] using the multimodal fusion
with q and the pairwise modeling operator is noted:

{ˆsi} = MurelCell ({si}; {bi}, q)

(5)

3.2. MuRel network

The MuRel network mimics a simple form of iterative
reasoning by leveraging the power of bilinear fusions to iter-
atively merge visual information into context-aware visual
embeddings. As we can see in Figure 3, the region state
vectors {si} are updated by a MuRel cell through multiple
steps, each time reﬁning the representations with contextual
and question information. More speciﬁcally, for each step
t = 1..T where T is the total number of steps, a MuRel cell
processes and updates the state vectors as follows:

{st

i} = MurelCell (cid:0){st−1

i

}; {bi}, q(cid:1)

(6)

The state vectors are initialized with the features outputted
by the object detector; for each region i, s0

i = vi.

The MuRel network represents each region regarding the
question, but also using its own visual context. This rep-
resentation is done iteratively, through multiple steps of a
MuRel cell. The residual nature of this module makes it
possible to align multiple cells without being subject to gra-
dient vanishing. Moreover, the weights of our model are
shared across the cells, which enables compact parametriza-
tion and good generalization.

At step t = T , the representations {sT

i } are aggregated
with a global max pooling operation to provide a single vec-
tor s ∈ Rdv . This scene representation contains information
about the objects, the spatial and semantic relations between
them, with respect to a particular question.

The scene representation s is merged with the question
embedding q to compute a score for every possible answer
ˆy = B (s, q; Θy). Finally, ˆa is the answer with maximum
score in ˆy.

Visualizing MuRel network Our model can also be
leveraged to deﬁne visualization schemes ﬁner than mere
attention maps. Especially, we can highlight important rela-
tions between image regions for answering a speciﬁc ques-
tion. At the end of the MuRel network, the visual fea-
tures {sT
i } are aggregated using a max operation, yield-
ing a dv−dimensional vector s. Thus, we can compute a
contribution map by measuring to what extent each region
contributes to the ﬁnal vector. To do so, we compute the
point-wise c = argmaxi{sT
i } ∈ [1, N ]dv , and measure the
occurrence frequency of each region in this vector c. This
provides a value for each region that estimates its contri-
bution to the ﬁnal vector. Interestingly, this process can be
done after each cell, and not exclusively at the last one. In-
tuitively, it measures what the contribution map would have
been if the iterative process had stopped at this point. As
we can see in Figures 1,3,5, these relevance scores match
human intuition and can be used to explain the model’s de-
cision, even if the network has not been trained with any
selection mechanism.

xi

Similarly, we are able to visualize the pairwise relation-
ships involved in the prediction of the MuRel cell. The ﬁrst
step is to ﬁnd i⋆, which is the region that is the most im-
pacted by the pairwise modeling. It is the region such that
k ˇei
k2 is maximal (cf. Equation (4)). This bounding box is
shown in green in all our visualizations. We then measure
the contribution of every other region to i⋆ using the oc-
currence frequencies in argmaxj ri,j . We show in red the
regions whose contribution to i⋆ is above a certain thresh-
old (0.2 in our visualizations). If there is no such region, the
green box is not shown.

1992

 v

Input Unit

Faster RCNN 

Step #1

Step #2

Step #3

Output Unit

GRU Encoder 

 q
Is she
wearing
a ring?

Argmax

MuRel Cell 

i

 v
 q

Argmax

MuRel Cell 

1

 s

i

Argmax

MuRel Cell 

2

 s

i

3

 s

i

Global 
Pooling 

Bilinear 
Fusion 

 s

Max

 aˆ
yes

 y

ˆ

Figure 3. MuRel network. The MuRel network merges the question embedding q into spatially-grounded visual representations {vi} by
iterating through a single MuRel cell. This module takes as input a set of localized vectors {si} and updates their representation using a
multimodal fusion component. Moreover, it models all the possible pairwise relations between regions by combining spatial and semantic
information. To construct the importance map at step t, we count the number of time each region provides the maximal value of maxi{s
i}
(over the 2048 dimensions).

t

Connection to previous work We can draw a comparison
between our MuRel network and the FiLM network pro-
posed in [37]. Beyond the fact that their model is built for
the synthetic CLEVR dataset [21] and ours processes real
data, some connections can be found between both models.
In their work, the image passes through multiple residual
cells, whereas we only have one cell through which we it-
erate. In FiLM, the multimodal interaction is modeled with
a feature-wise afﬁne modulation, while we use a bilinear
fusion strategy [8] which seems better suited to real world
data. Finally, both MuRel and FiLM leverage the spatial
structure of the image representation to model the relations
between regions. In FiLM, the image is represented with
a fully-convolutional network which outputs a feature map
disposed in a ﬁxed spatial grid. With this structure on image
features, the relations between regions are modeled with a
3 × 3 convolution inside each residual block. Thus, the rep-
resentation of each region depends on its neighbours in the
locally-connected graph induced by the ﬁxed grid structure.
In our MuRel network, the image is represented as a set of
localized features. This makes the relational modeling non
trivial. As we want to model relations between regions that
are potentially far apart, we consider that the set of regions
forms a complete graph, where each region is connected to
all the others.

4. Experiments

4.1. Experimental setup

Datasets: We validate the beneﬁts of the MuRel cell
and the MuRel network on three recent datasets. VQA 2.0
[17] is the most used dataset. It comes with a training set,
a validation set and an online testing set. We provide a
ﬁne grained analysis on the validation set, while we com-
pare MuRel to the state-of-the-art models on the testing set.
Then, we use VQA Changing Priors v2 [2] to demonstrate

Model

VQA 2.0 VQA CP v2 TDIUC

Attention baseline

MuRel

63.44
65.14

38.04
39.54

86.96
88.20

Table 1. Comparing MuRel to Attention. Comparison of the
MuRel strategy against a strong Attention-based model on the
VQA 2.0 val, VQA-CP v2 and TDIUC datasets. Both models have
an equivalent number of parameters (∼60 million) and are trained
on the same features following the same experimental setup.

the generalization capacity of MuRel. VQA-CP v2 uses the
same data as in VQA 2.0, but proposes different distribu-
tion of answers per question between training and valida-
tion splits. Finally, we use the TDIUC dataset [23] to con-
struct a more detailed analysis of our model’s performance
on 12 well-deﬁned types of question. TDIUC is currently
the biggest dataset for visual question answering.

Hyper-parameters: We use standard features extrac-
tion, preprocessings and loss function [16]. We use the re-
cent Bottom-up features provided by [3] to represent our
image as a set of 36 localized regions. For the question em-
bedding, we use the pretrained Skip-thought encoder from
[27]. Inspired by recent works, we use Adam as optimizer
[26] with a learning scheduler [46]. More details about the
experimental setup are given in appendix.

4.2. Model validation

We compare MuRel against models trained on the same
Bottom-up features [3] which are required to reach the best
performances.

Comparison to Attention-based model
In Table 1, we
compare MuRel against a strong attentional model based on
bilinear fusions [8], which encompasses a multi-glimpses
attentional process [16]. The goal of this experiments is to
compare our approach with strong baselines for real VQA in
controlled conditions. In addition to using the same bottom-

1993

Pairwise

Iter.

VQA 2.0 VQA CP v2 TDIUC

✗

✓

✗

✓

✗

✗

✓

✓

64.13
64.57
64.72
65.14

38.88
39.12
39.37
39.54

87.50
87.86
87.92
88.20

Table 2. Ablation study of MuRel. Experimental validation of
the pairwise module and the iterative processing on the VQA 2.0
val, VQA-CP v2 and TDIUC datasets.

up features, which are crucial for fair comparisons, we also
dimension the attention-based baseline to have an equiva-
lent amount of learned parameters than MuRel (∼60 mil-
lions including those from the GRU encoder). Also, we
train it following the same experimental setup to insure
competitiveness. MuRel reaches a higher accuracy on the
three datasets. We report a signiﬁcant gain of +1.70 on
VQA 2.0 and +1.50 on VQA CP v2. Not only these results
validate the ability of MuRel to better model interactions
between the question and the image, but also to generalize
when the distribution of the answers per question are com-
pletely different between the training and validation set as in
VQA CP v2. A gain of +1.24 on TDIUC demonstrates the
richer modeling capacity of MuRel in a ﬁne-grained context
of 12 well delimited question types.

Ablation study In Table 2, we compare three ablated in-
stances of MuRel to its complete form. First, we validate
the beneﬁts of the pairwise module. Adding it to a vanilla
MuRel without iterative process leads to higher accuracy
on every datasets. In fact, between line 1 and 2, we report a
gain of +0.44 on VQA 2.0, +0.24 on VQA CP v2 and +0.36
on TDIUC. Secondly, we validate the interest of the itera-
tive process. Between line 1 et 3, we report a gain of +0.59
on VQA 2.0, +0.49 on VQA CP v2 and +0.42 on TDIUC.
Notably, this modiﬁcation does not add any parameters, be-
cause we iterate over a single MuRel cell. Unsharing the
weights by using a different MuRel cell for each step gives
similar results. Finally, the pairwise module and the iter-
ative process are added to create the complete MuRel net-
work. This instance (in line 4) reaches the highest accuracy
on the three datasets. Interestingly, the gains provided by
the combination of the two methods are sometimes larger
than those of each one separately. For instance, we report a
gain of +1.01 on VQA 2.0 between line 1 and 4. This attests
to the complementary of the two modules.

Number of reasoning steps
In Figure 4, we perform an
analysis of the iterative process. We train four different
MuRel networks on the VQA 2.0 train split, each with a
different number of iterations over the MuRel cell. Per-
formance is reported on val split. Networks with two and
three steps respectively provides a gain of +0.30 and +0.57
in overall accuracy on VQA 2.0 over the network with a
single step. An interesting aspect of the iterative process

Figure 4. Number of iterations. Impact of the number of steps
in the iterative process on the different question types of VQA 2.0
val.

of MuRel is that the four networks have exactly the same
amount of parameters, but the accuracy signiﬁcantly varies
with respect to the number of steps. While the accuracy for
the answer type involving numbers keeps increasing, we re-
port a decrease in overall accuracy at four reasoning steps.
Counting is a challenging task: not only does the model
need to detect every occurrence of the desired object, but
also the representation computed after the ﬁnal aggregation
must keep the information of the number of detected in-
stances. The complexity of this question may require deeper
relational modeling, and thus beneﬁt from a higher number
of iterations over the MuRel cell.

4.3. State of the art comparison

VQA 2.0 In Table 3, we compare MuRel to the most re-
cent contributions on the VQA 2.0 dataset. For fairness con-
siderations, all the scores correspond to models trained on
the VQA 2.0 train+val split, using the Bottom-up visual
features [3]. Interestingly, our model surpasses both MU-
TAN [8] and MLB [25], which correspond to some of the
latest development in visual attention and bilinear models.
This tends to indicate that VQA models can beneﬁt from
retaining local information in mulitmodal vectors instead of
scalar coefﬁcients. Moreover, our model greatly improves
over the recent method proposed in [36] where the regions
are structured using pairwise attention scores, which are
leveraged through spatial graph convolutions. This shows
the interest of our spatial-semantic pairwise modeling be-
tween all possible pairs of regions. Finally, even though we
did not extensively tune the hyperparameters of our model,
our overall score on the test-dev split is highly competitive
with state-of-the-art methods. In particular, we are compa-
rable to Pythia [46] who won the VQA Challenge 2018.
Please note that they improve their overall scores up to
70.01% when they include multiple types of visual features
and more training data. Also, we did not report the score of
69.52% obtained by BAN [24] as they train their model on
extra data from the Visual Genome dataset [28].

1994

Model

Yes/No Num. Other

All

All

test-dev

test-std

RAU* MCB*
[35]

[16]

81.82

44.21

56.05

65.32

65.67

Bottom-up

✗

✗

Bottom-up

[3]

Graph Att.

[36]

MUTAN†

[8]

MLB†
[25]

DA-NTN

[6]

Pythia
[46]

Counter

[47]

-

-

-

-

66.18

82.88

44.54

56.50

66.01

66.38

83.58

44.92

56.34

66.27

66.62

84.29

47.14

57.92

67.56

67.94

-

-

-

68.05

-

83.14

51.62

58.97

68.09

68.41

MuRel

84.77

49.84

57.85

68.03

68.41

Table 3. State-of-the-art comparison on the VQA 2.0 dataset.
Results on test-dev and test-std splits. All these models were
trained on the same training set (VQA 2.0 train+val), using the
Bottom-up features provided by [3]. No ensembling methods have
been used. † have been trained by [6].

TDIUC One of the core aspect of VQA models lies in
their ability to address different tasks. The TDIUC dataset
enables a detailed analysis of the strengths and limitations
of a model by evaluating its performance on different types
of question. We show in Table 4 a detailed comparison of
recent models to our MuRel. We obtain state-of-the-art re-
sults on the Overall Accuracy and the arithmetic mean of
per-type accuracies (A-MPT), and surpass by a signiﬁcant
margin the second best model proposed by [40]. Interest-
ingly, we improve over this model even though it uses a
combination of Bottom-up and ﬁxed-grid features, as well
as a supervision on the question types (hence its 100% re-
sult on the Absurd task). MuRel notably surpasses all previ-
ous methods on the Positional reasoning (+5.9 over MCB),
Counting (+8.53 over QTA) questions. These improve-
ments are likely due to the pairwise structure induced within
the MuRel cell, which makes the answer prediction depend
on the spatial and semantic relations between regions. The
effectiveness of our per-region context modelling is also
demonstrated by our the improvement on Scene recogni-
tion questions. For these questions, representing the image
as a collection of independent objects shows lower perfor-
mance than replacing each of them in its spatial and se-
mantic context. Interestingly, our results on the harmonic
mean of per-type accuracies (H-MPT) are lower than state-
of-the-art. For MuRel, this harmonic metric is signiﬁcantly
harmed by our low score of 21.43% on the Utility and Af-
fordances task. As these questions concern the possible us-
ages of objects present in the scene (such as Can you eat

Scene Reco.
Sport Reco.
Color Attr.
Other Attr.

Activity Reco.
Pos. Reasoning

Object Reco.

Absurd

Util. and Afford.
Object Presence

Counting
Sentiment

Overall (A-MPT)
Overall (H-MPT)

93.96
93.47
66.86
56.49
51.60
35.26
86.11
96.08
31.58
94.38
48.43
60.09

67.81
59.00

93.06
92.77
68.54
56.72
52.35
35.40
85.54
84.82
35.09
93.64
51.01
66.25

67.90
60.47

QTA
[40]

✓

93.80
95.55
60.16
54.36
60.10
34.71
86.98
100.00
31.48
94.55
53.25
64.38

69.11
60.08

MuRel

✓

96.11
96.20
74.43
58.19
63.83
41.19
89.41
99.8
21.43
95.75
61.78
60.65

71.56
59.30

Overall Accuracy

84.26

81.86

85.03

88.20

Table 4. State-of-the-art comparison on the TDIUC dataset.
* trained by [23].

the yellow object?), and are not directly related to the visual
understanding of the scene.

VQA-CP v2 This dataset has been proposed to evaluate
and reduce the question-oriented bias in VQA models. In
particular, the distributions of answers with respect to ques-
In Table 5, we
tion types differ from train to val splits.
report the scores of two recent baselines [1, 32], on which
we improve signiﬁcantly. In particular, we demonstrate an
important gain over GVQA [1], whose architecture is de-
signed to focus on Yes/No questions. However, since both
methods do not use the Bottom-up features, the fairness of
the comparison can be questioned. So we also train an at-
tention model similar to [8] using these Bottom-up region
representation. We observe that MuRel provides a substan-
tial gain over this strong attention baseline. Given the distri-
bution mismatch between train and val splits, models that
only focus on linguistic biases to answer the question are
systematically penalized on their val scores. This property
of VQA-CP v2 implies that the pairwise iterative structure
of MuRel is less prone to question-based overﬁtting than
classical attention architectures.

4.4. Qualitative results

In Figure 5 we illustrate the behaviour of a MuRel net-
work with three shared cells. Iterations through the MuRel
cell tend to gradually discard regions, keeping only the most
relevant ones. As explained in Section 3.2, the regions
that are most involved in the pairwise modeling process are
shown in green and red. Both region contributions and pair-

1995

Original image

Step #1

Step #2

Step #3

What game are they
playing on the WII?

What position is 
the front dog in? 

What is the 
man holding? 

What is on the top 

of her head? 

bowling   
✔

sitting  

✔

kite  

✔

hat  ✔

Figure 5. Qualitative evaluation of MuRel. Visualization of the importance maps with colored regions related to the relational mechanism.
As in Figure 3, the most selected regions by the implicit attentional mechanism are shown in brighter. The green region is the most impacted
by the pairwise modeling, while the red regions impact the green regions the most. These colored regions are only represented if they are
greater than a certain threshold.

Model

HAN [32]
GVQA [1]
Attention

MuRel

Bottom

up

✗

✗

✓

✓

Yes/No Num. Other

All

52.25
57.99
41.56

13.79
13.68
12.19

20.33
22.14
43.29

28.65
31.30
38.04

42.85

13.17

45.04

39.54

Table 5. State-of-the-art comparison on the VQA-CP v2
dataset. The Attention model was trained by us using the Bottom-
up features.

wise links match human intuition. In the ﬁrst row, the most
relevant relations according to our model are between the
player’s hand, containing the WII controller, and the screen,
which explains the prediction bowling. In the third row, the
model answers kite using the relation between the man’s
hand and the kite he is holding. Finally, in the last row, our
model is able to address a third question on the same image
as in Figure 1 and 3. Here, the relation between the head of
the woman and her hat is used to provide the right answer.
As VQA models are often subject to linguistic bias [17, 1],
these visualizations tend to show the ability of the MuRel
network to rely on visual information to answer questions.

5. Conclusion

In this paper, we introduced MuRel, a multimodal rela-
tional network for Visual Question Answering task. Our
system is based on rich representations of visual image re-
gions that are progressively merged with the question repre-
sentation. We also included region relations with pairwise
combinations in our fusion, and the whole system can be
leveraged to deﬁne visualization schemes helping to inter-
pret the decision process of MuRel.

We validated our approach on three challenging datasets:
VQA 2.0, VQA-CP v2 and TDIUC. We exhibited vari-
ous ablation studies, clearly demonstrating the gain of our
vectorial representation to model the attention, the use of
pairwise combination, and the multi-step iterations in the
whole process. Our ﬁnal MuRel network is very compet-
itive and outperforms state-of-the-art results on two of the
most widely used datasets.

Acknowledgments

This work has been supported within the Labex SMART
supported by French state funds managed by the ANR
within the Investissements d’Avenir programme under ref-
erence ANR-11-LABX-65.

1996

References

[1] A. Agrawal, D. Batra, D. Parikh, and A. Kembhavi. Don’t
just assume; look and answer: Overcoming priors for visual
question answering. In IEEE Conference on Computer Vi-
sion and Pattern Recognition (CVPR), 2018. 2, 7, 8

[2] A. Agrawal, D. Batra, D. Parikh, and A. Kembhavi. Dont
just assume; look and answer: Overcoming priors for visual
question answering. In Proceedings of the IEEE Conference
on Computer Vision and Pattern Recognition, pages 4971–
4980, 2018. 5

[3] P. Anderson, X. He, C. Buehler, D. Teney, M. Johnson,
S. Gould, and L. Zhang. Bottom-up and top-down atten-
tion for image captioning and visual question answering. In
IEEE Conference on Computer Vision and Pattern Recogni-
tion CVPR, June 2018. 2, 3, 5, 6, 7

[4] S. Antol, A. Agrawal, J. Lu, M. Mitchell, D. Batra, C. L. Zit-
nick, and D. Parikh. VQA: Visual Question Answering. In
International Conference on Computer Vision (ICCV), 2015.
1, 2

[5] D. Bahdanau, K. Cho, and Y. Bengio. Neural machine trans-
lation by jointly learning to align and translate. ICLR 2015.
2

[6] Y. Bai, J. Fu, T. Zhao, and T. Mei. Deep attention neural ten-
sor network for visual question answering. In The European
Conference on Computer Vision (ECCV), September 2018. 7
[7] P. W. Battaglia et al. Relational inductive biases, deep learn-
ing, and graph networks. CoRR, abs/1806.01261, 2018. 2,
4

[8] H. Ben-Younes, R. Cad`ene, N. Thome, and M. Cord. Mu-
tan: Multimodal tucker fusion for visual question answering.
ICCV, 2017. 1, 2, 3, 5, 6, 7

[9] H. Ben-Younes, R. Cadene, N. Thome, and M. Cord. Block:
Bilinear superdiagonal fusion for visual question answering
and visual relationship detection. In Proceedings of the 33st
Conference on Artiﬁcial Intelligence (AAAI), 2019. 3

[10] M. Carvalho, R. Cadene, D. Picard, L. Soulier, N. Thome,
and M. Cord. Cross-modal retrieval in the cooking context:
Learning semantic text-image embeddings.
In The ACM
Conference on Research and Development in Information
Retrieval (SIGIR), 2018. 2

[11] X. Chen, L.-J. Li, L. Fei-Fei, and A. Gupta.

Iterative vi-
sual reasoning beyond convolutions. In Proceedings of the
IEEE Conference on Computer Vision and Pattern Recogni-
tion, 2018. 1, 2

[12] Z. Chen, Z. Yanpeng, H. Shuaiyi, T. Kewei, and M. Yi. Struc-
tured attentions for visual question answering. IEEE Inter-
national Conference on Computer Vision (ICCV), 2017. 1,
2

[13] A. Das, S. Kottur, K. Gupta, A. Singh, D. Yadav, J. M.
In Pro-
Moura, D. Parikh, and D. Batra. Visual Dialog.
ceedings of the IEEE Conference on Computer Vision and
Pattern Recognition (CVPR), 2017. 2

[14] T. Durand, T. Mordan, N. Thome, and M. Cord. WILD-
CAT: Weakly Supervised Learning of Deep ConvNets for
Image Classiﬁcation, Pointwise Localization and Segmen-
tation.
In The IEEE Conference on Computer Vision and
Pattern Recognition (CVPR), 2017. 1

[15] M. Engilberge, L. Chevallier, P. P´erez, and M. Cord. Finding
beans in burgers: Deep semantic-visual embedding with lo-
calization. In Proceedings of the IEEE Conference on Com-
puter Vision and Pattern Recognition, pages 3984–3993,
2018. 2

[16] A. Fukui, D. H. Park, D. Yang, A. Rohrbach, T. Darrell, and
M. Rohrbach. Multimodal compact bilinear pooling for vi-
sual question answering and visual grounding. In EMNLP.
The Association for Computational Linguistics, 2016. 1, 2,
3, 5, 7

[17] Y. Goyal, T. Khot, D. Summers-Stay, D. Batra, and
D. Parikh. Making the V in VQA matter: Elevating the role
of image understanding in Visual Question Answering.
In
IEEE Conference on Computer Vision and Pattern Recogni-
tion CVPR, 2017. 1, 2, 5, 8

[18] K. He, X. Zhang, S. Ren, and J. Sun. Deep residual learning
In IEEE Conference on Computer

for image recognition.
Vision and Pattern Recognition CVPR, 2016. 2

[19] R. Hu, J. Andreas, M. Rohrbach, T. Darrell, and K. Saenko.
Learning to reason: End-to-end module networks for visual
question answering.
In Proceedings of the IEEE Interna-
tional Conference on Computer Vision (ICCV), 2017. 1, 2

[20] D. A. Hudson and C. D. Manning. Compositional attention
In International Confer-

networks for machine reasoning.
ence on Learning Representations, 2018. 2, 3

[21] J. Johnson, B. Hariharan, L. van der Maaten, L. Fei-Fei, C. L.
Zitnick, and R. Girshick. CLEVR: A diagnostic dataset for
compositional language and elementary visual reasoning. In
IEEE Conference on Computer Vision and Pattern Recogni-
tion CVPR, 2017. 1, 2, 5

[22] J. Johnson, B. Hariharan, L. van der Maaten, J. Hoffman,
L. Fei-Fei, C. L. Zitnick, and R. Girshick. Inferring and ex-
ecuting programs for visual reasoning. In ICCV, 2017. 1,
2

[23] K. Kaﬂe and C. Kanan. An analysis of visual question an-
swering algorithms. In The IEEE International Conference
on Computer Vision (ICCV), Oct 2017. 1, 2, 5, 7

[24] J.-H. Kim, J. Jun, and B.-T. Zhang. Bilinear Attention Net-

works. arXiv preprint arXiv:1805.07932, 2018. 2, 6

[25] J.-H. Kim, K. W. On, W. Lim, J. Kim, J.-W. Ha, and B.-T.
Zhang. Hadamard Product for Low-rank Bilinear Pooling.
In The 5th International Conference on Learning Represen-
tations, 2017. 1, 2, 3, 6, 7

[26] D. P. Kingma and J. Ba. Adam: A method for stochastic

optimization. In ICLR, 2015. 5

[27] R. Kiros, Y. Zhu, R. Salakhutdinov, R. S. Zemel, A. Tor-
ralba, R. Urtasun, and S. Fidler. Skip-thought vectors.
In
Proceedings of the 28th International Conference on Neural
Information Processing Systems - Volume 2, NIPS’15, pages
3294–3302, Cambridge, MA, USA, 2015. MIT Press. 5

[28] R. Krishna, Y. Zhu, O. Groth, J. Johnson, K. Hata, J. Kravitz,
S. Chen, Y. Kalantidis, L.-J. Li, D. A. Shamma, et al. Vi-
sual genome: Connecting language and vision using crowd-
sourced dense image annotations. International Journal of
Computer Vision, 123(1):32–73, 2017. 6

[29] A. Krizhevsky, I. Sutskever, and G. E. Hinton.

classiﬁcation with deep convolutional neural networks.

Imagenet
In

1997

F. Pereira, C. J. C. Burges, L. Bottou, and K. Q. Weinberger,
editors, Advances in Neural Information Processing Systems
25, pages 1097–1105. Curran Associates, Inc., 2012. 1

[30] D. Lopez-Paz, R. Nishihara, S. Chintala, B. Sch¨olkopf, and
L. Bottou. Discovering causal signals in images. In IEEE
Conference on Computer Vision and Pattern Recognition
CVPR, Piscataway, NJ, USA, July 2017. IEEE. 2

[31] C. Lu, R. Krishna, M. Bernstein, and L. Fei-Fei. Visual re-
lationship detection with language priors. In European Con-
ference on Computer Vision, 2016. 2

[32] M. Malinowski, C. Doersch, A. Santoro, and P. Battaglia.
Learning visual question answering by bootstrapping hard
attention. In The European Conference on Computer Vision
(ECCV), September 2018. 2, 7, 8

[33] M. Malinowski and M. Fritz. A multi-world approach to
question answering about real-world scenes based on un-
certain input.
In Z. Ghahramani, M. Welling, C. Cortes,
N. Lawrence, and K. Weinberger, editors, Advances in Neu-
ral Information Processing Systems 27, pages 1682–1690.
Curran Associates, Inc., 2014. 2

[34] D. Mascharka, P. Tran, R. Soklaski, and A. Majumdar.
Transparency by design: Closing the gap between perfor-
mance and interpretability in visual reasoning. In IEEE Con-
ference on Computer Vision and Pattern Recognition CVPR,
June 2018. 1, 2

[35] H. Noh and B. Han. Training recurrent answering units
arXiv preprint

loss minimization for vqa.

with joint
arXiv:1606.03647, 2016. 7

ternational Conference on Machine Learning - Volume 37,
ICML’15, pages 2048–2057. JMLR.org, 2015. 2

[43] Z. Yang, X. He, J. Gao, L. Deng, and A. J. Smola. Stacked
attention networks for image question answering. In IEEE
Conference on Computer Vision and Pattern Recognition
CVPR, 2016. 2

[44] Z. Yu, J. Yu, J. Fan, and D. Tao. Multi-modal factorized bi-
linear pooling with co-attention learning for visual question
answering. IEEE International Conference on Computer Vi-
sion (ICCV), pages 1839–1848, 2017. 2, 3

[45] Z. Yu, J. Yu, C. Xiang, J. Fan, and D. Tao. Beyond bilin-
ear: Generalized multi-modal factorized high-order pooling
for visual question answering. IEEE Transactions on Neural
Networks and Learning Systems, 2018. 2, 3

[46] Yu Jiang*, Vivek Natarajan*, Xinlei Chen*, M. Rohrbach,
D. Batra, and D. Parikh. Pythia v0.1: the winning entry to
the vqa challenge 2018. arXiv preprint arXiv:1807.09956,
2018. 2, 5, 6, 7

[47] Y. Zhang, J. Hare, and A. Prgel-Bennett. Learning to count
objects in natural images for visual question answering.
In International Conference on Learning Representations,
2018. 2, 7

[48] B. Zhuang, Q. Wu, C. Shen, I. Reid, and A. van den Hen-
gel. Parallel attention: A uniﬁed framework for visual object
discovery through dialogs and queries. In Proceedings of the
IEEE Conference on Computer Vision and Pattern Recogni-
tion, pages 4252–4261, 2018. 2

[36] W. Norcliffe-Brown, E. Vafeias, and S. Parisot. Learning
conditioned graph structures for interpretable visual question
answering. 2018. 2, 3, 6, 7

[37] E. Perez, F. Strub, H. de Vries, V. Dumoulin, and A. C.
Courville. Film: Visual reasoning with a general condition-
ing layer. In AAAI, 2018. 2, 3, 5

[38] A. Santoro, F. Hill, D. G. T. Barrett, A. S. Morcos, and T. P.
Lillicrap. Measuring abstract reasoning in neural networks.
In ICML, volume 80 of JMLR Workshop and Conference
Proceedings, pages 4477–4486. JMLR.org, 2018. 2

[39] A. Santoro, D. Raposo, D. G. T. Barrett, M. Malinowski,
R. Pascanu, P. Battaglia, and T. Lillicrap. A simple neu-
ral network module for relational reasoning. In Advances in
Neural Information Processing Systems 30: Annual Confer-
ence on Neural Information Processing Systems 2017, 4-9
December 2017, Long Beach, CA, USA, pages 4974–4983,
2017. 2

[40] Y. Shi, T. Furlanello, S. Zha, and A. Anandkumar. Question
type guided attention in visual question answering. In The
European Conference on Computer Vision (ECCV), Septem-
ber 2018. 7

[41] D. Teney, L. Liu, and A. van den Hengel. Graph-structured
representations for visual question answering. In Proceed-
ings of the IEEE Conference on Computer Vision and Pattern
Recognition, pages 1–9, 2017. 2

[42] K. Xu, J. L. Ba, R. Kiros, K. Cho, A. Courville, R. Salakhut-
dinov, R. S. Zemel, and Y. Bengio. Show, attend and tell:
Neural image caption generation with visual attention.
In
Proceedings of the 32Nd International Conference on In-

1998

