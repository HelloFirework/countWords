Unsupervised Multi-modal Neural Machine Translation

Yuanhang Su∗

Kai Fan∗†

Nguyen Bach

University of Southern California

Alibaba Group Inc. (US)

Alibaba Group Inc. (US)

suyuanhang@hotmail.com

interfk@gmail.com

nguyenbh@gmail.com

C.-C. Jay Kuo

Fei Huang

University of Southern California

Alibaba Group Inc. (US)

cckuo@sipi.usc.edu

feirhuang@gmail.com

Abstract

Unsupervised neural machine translation (UNMT) has
recently achieved remarkable results [20] with only large
monolingual corpora in each language. However, the un-
certainty of associating target with source sentences makes
UNMT theoretically an ill-posed problem. This work inves-
tigates the possibility of utilizing images for disambigua-
tion to improve the performance of UNMT. Our assump-
tion is intuitively based on the invariant property of image,
i.e., the description of the same visual content by different
languages should be approximately similar. We propose an
unsupervised multi-modal machine translation (UMNMT)
framework based on the language translation cycle con-
sistency loss conditional on the image, targeting to learn
the bidirectional multi-modal translation simultaneously.
Through an alternate training between multi-modal and
uni-modal, our inference model can translate with or with-
out the image. On the widely used Multi30K dataset, the
experimental results of our approach are signiﬁcantly better
than those of the text-only UNMT on the 2016 test dataset.

En: A man in an orange  hat

starring at something

Parallel En-Fr Corpus

Fr: un homme avec un chapeau

orange regardant quelque chose

Supervised Learning

!

English
Encoder

$%&' (, * = ,-. /*, *

French
Decoder

"#

Unsupervised Multi-modal Learning

Emm, Looks

like 

En: A man in an orange  hat …                                            

English
Encoder

h
c
n
e
r
F

r
e
d
o
c
e
D

Image
Encoder

English
Decoder

Training

Trainin g

I
n

f

e

r

e

n

c

e

Copy

French
Decoder

!

=

0#

English
Encoder

Image
Encoder

French
Encoder

Fr: un homme avec un chapeau ...

$1&23 (, 4 = ,-. /(, (

( → 6* → 6(

$7879: (, 4 = ,-.( 6(, ()

Training with auto-encoding loss

Training with cycle-consistency loss

For two training losses

"!

0!

0#

Figure 1: Illustration of our proposed approach. We lever-
age the designed loss function to tackle a supervised task
with the unsupervised dataset only. SCE means sequential
cross-entropy.

1. Introduction

Our long-term goal is to build intelligent systems that
can perceive their visual environment and understand the
linguistic information, and further make an accurate transla-
tion inference to another language. Since image has become
an important source for humans to learn and acquire knowl-
edge (e.g. video lectures, [1, 18, 32]), the visual signal
might be able to disambiguate certain semantics. One way
to make image content easier and faster to be understood
by humans is to combine it with narrative description that
can be self-explainable. This is particularly important for

∗indicates equal contribution.
†corresponding author.

many natural language processing (NLP) tasks as well, such
as image caption [27] and some task-speciﬁc translation–
sign language translation [6]. However, [24] demonstrates
that most multi-modal translation algorithms are not signif-
icantly better than an off-the-shelf text-only machine trans-
lation (MT) model for the Multi30K dataset [12]. There
remains an open question about how translation models
should take advantage of visual context, because from the
perspective of information theory, the mutual information
of two random variables I(X, Y ) will always be no greater
than I(X; Y, Z), due to the following fact I(X; Y, Z) −
I(X; Y ) = KL(p(X, Y, Z)kp(X|Y )p(Z|Y )p(Y )), where
the Kullback-Leibler (KL) divergence is non-negative. This
conclusion makes us believe that the visual content will
hopefully help the translation systems.

432110482

Since the standard paradigm of multi-modal translation
always considers the problem as a supervised learning task,
the parallel corpus is usually sufﬁcient to train a good trans-
lation model, and the gain from the extra image input is very
limited. Moreover, the scarcity of the well formed dataset
including both images and the corresponding multilingual
text descriptions is also another constraint to prevent the de-
velopment of more scaled models. In order to address this
issue, we propose to formulate the multi-modal translation
problem as an unsupervised learning task, which is closer
to real applications. This is particularly important given the
massive amounts of paired image and text data being pro-
duced everyday (e.g., news title and its illustrating picture).

Our idea is originally inspired by the text-only unsuper-
vised MT (UMT) [8, 19, 20], investigating whether it is
possible to train a general MT system without any form of
supervision. As [20] discussed, the text-only UMT is fun-
damentally an ill-posed problem, since there are potentially
many ways to associate target with source sentences. In-
tuitively, since the visual content and language are closely
related, the image can play the role of a pivot “language” to
bridge the two languages without paralleled corpus, making
the problem “more well-deﬁned” by reducing the problem
to supervised learning. However, unlike the text translation
involving word generation (usually a discrete distribution),
the task to generate a dense image from a sentence descrip-
tion itself is a challenging problem [21]. High quality image
generation usually depends on a complicated or large scale
neural network architecture [23, 13, 30]. Thus, it is not rec-
ommended to utilize the image dataset as a pivot “language”
[7]. Motivated by the cycle-consistency [31], we tackle
the unsupervised translation with a multi-modal framework
which includes two sequence-to-sequence encoder-decoder
models and one shared image feature extractor. We don’t
introduce the adversarial learning via a discriminator be-
cause of the non-differentiable arg max operation during
word generation. With ﬁve modules in our framework, there
are multiple data streaming paths in the computation graph,
inducing the auto-encoding loss and cycle-consistency loss,
in order to achieve the unsupervised translation.

Another challenge of unsupervised multi-modal trans-
lation, and more broadly for general multi-modal transla-
tion tasks, is the need to develop a reasonable multi-source
encoder-decoder model that is capable of handling multi-
modal documents. Moreover, during training and inference
stages, it is better to process the mixed data format includ-
ing both uni-modal and multi-modal corpora.

First,

this challenge highly depends on the attention
mechanism across different domains. Recurrent Neu-
ral Networks (RNN) and Convolutional Neural Networks
(CNN) are naturally suitable to encode the language text
and visual image respectively; however, encoded features
of RNN has autoregressive property which is different from

the local dependency of CNN. The multi-head self-attention
transformer [26] can mimic the convolution operation, and
allow each head to use different linear transformations,
where in turn different heads can learn different relation-
ships. Unlike RNN, it reduces the length of the paths of
states from the higher layer to all states in the lower layer
to one, and thus facilitates more effective learning. For ex-
ample, the BERT model [9], that is completely built upon
self-attention, has achieved remarkable performance in 11
natural language tasks. Therefore, we employ transformer
in both the text encoder and decoder of our model, and de-
sign a novel joint attention mechanism to simulate the rela-
tionships among the three domains. Besides, the mixed data
format requires the desired attention to support the ﬂexi-
ble data stream. In other words, the batch fetched at each
iteration can be either uni-modal text data or multi-modal
text-image paired data, allowing the model to be adaptive to
various data during inference as well.

Succinctly, our contributions are three-fold: (1) We for-
muate the multi-modal MT problem as unsupervised set-
ting that ﬁts the real scenario better and propose an end-
(2) We
to-end transformer based multi-modal model.
present two technical contributions: successfully train the
proposed model with auto-encoding and cycle-consistency
losses, and design a controllable attention module to deal
(3) We ap-
with both uni-modal and multi-modal data.
ply our approach to the Multilingual Multi30K dataset in
English↔French and English↔German translation tasks,
and the translation output and the attention visualization
show the gain from the extra image is signiﬁcant in the un-
supervised setting.

2. Related Work

We place our work in context by arranging several prior
popular topics, along the the axes of UMT, image caption
and multi-modal MT.

Unsupervised Machine Translation Existing methods
in this area [2, 19, 20] are mainly modiﬁcations of encoder-
decoder schema. Their key ideas are to build a common
latent space between the two languages (or domains) and to
learn to translate by reconstructing in both domains. The
difﬁculty in multi-modal translation is the involvement of
another visual domain, which is quite different from the lan-
guage domain. The interaction between image and text are
usually not symmetric as two text domains. This is the rea-
son why we take care of the attention module cautiously.

Image Caption Most standard image caption models
are built on CNN-RNN based encoder-decoder framework
[17, 27], where the visual features are extracted from CNN
and then fed into RNN to output word sequences as cap-
tions. Since our corpora contain image-text paired data, our
method also draws inspiration from image caption model-
ing. Thus, we also embed the image-caption model within

432210483

our computational graph, whereas the transformer architec-
ture is adopted as a substitution for RNN.

Multi-modal Machine Translation This problem is ﬁrst
proposed by [24] on the WMT16 shared task at the intersec-
tion of natural language processing and computer vision. It
can be considered as building a multi-source encoder on top
of either MT or image caption model, depending on the def-
inition of extra source. Most Multi-modal MT research still
focuses on the supervised setting like [5], while [7, 22], to
our best knowledge, are the two pioneering works that con-
sider generalizing the Multi-modal MT to an unsupervised
setting. However, their setup puts restrictions on the input
data format. For example, [7] requires the training data to
be image text pair but the inference data is text-only input,
and [22] requires image text pair format for both training
and testing. These limit the model scale and generalization
ability, since large amount of monolingual corpora is more
available and less expensive. Thus, in our model, we specif-
ically address this issue with controllable attention and al-
ternative training scheme.

3. Methodology

In this section we ﬁrst brieﬂy describe the main MT sys-
tems that our method is built upon and then elaborate on our
approach.

3.1. Neural Machine Translation

If a bilingual corpus is available, given a source sentence
x = (x1, ..., xn) of n tokens, and a translated target sen-
tence y = (y1, ..., ym) of m tokens, where (x, y) ∈ X ×Y,
the NMT model aims at maximizing the likelihood,

p(y|x) =

m

Xt=1

p(yt|y<t, x).

(1)

The attention based sequence-to-sequence encoder-decoder
architecture [3, 29, 14, 26] is usually employed to parame-
terize the above conditional probability.

1, ..., he

The encoder

reads the source sentence and out-
puts the hidden representation vectors for each token,
{he
n} = Encx(x). The attention based decoder
is deﬁned in a recurrent way. Given the decoder has the
summarized representation vector hd
t = Decy(y<t, x) at
time stamp t, the model produces a context vector ct =
j based on an alignment model, {α1, ..., αn} =
Align(hd
j=1 αj = 1. There-
fore, the conditional probability to predict the next token
can be written as,

n}), such that Pn

Pn
j=1 αihe

t ,{he

1, ..., he

p(yt|y<t, x) = softmax(g(ct, yt−1, hd

(2)
in which g(·) denotes a non-linear function extracting fea-
tures to predict the target. The encoder and decoder model
described here is in a general formulation, not constrained
to be RNN [3] or transformer architecture [26].

t−1)).

3.2. Multi modal Neural Machine Translation

In this task, an image z and the description of the im-
age in two different languages form a triplet (x, y, z) ∈
X ×Y ×I. The problem naturally becomes maximizing the
new likelihood p(y|x, z). Though the overall framework
of such a translation task is still the encoder-decoder archi-
tecture, the detailed feature extractor and attention module
can vary greatly, due to the extra source image. The tradi-
tional approach [24, 10] is to encode the source text and the
image separately and combine them at the high level fea-
tures, where the image feature map can be represented as
k} = Encz(z) and Encz is usually a truncated im-
age classiﬁcation model, such as Resnet [16]. Unlike the
number of the text features which is exactly the number of
tokens in the source, the number of the image features de-
pends on the last layer in the truncated network. We propose
to compute the context vector via an attention module,
k})

ct = Attention(hd

n},{hi

t ,{he

1, ..., he

1, ..., hi

1, ..., hi

{hi

(3)

Since three sets of features appear in Eq (3), there are more
options of the attention mechanism than text-only NMT.
The decoder can remain the same in the recurrent fashion.

3.3. Unsupervised Learning

The unsupervised problem requires a new problem deﬁ-
nition. On both the source and the target sides, only mono-
lingual documents are presented in the training data, i.e.,
the data comes in the paired form of (x, z) ∈ X × I
and (y, z) ∈ Y × I. The triplet data format is no longer
available. The purpose is to learn a multi-modal translation
model X ×I → Y or a text-only one X → Y. Note there is
no explicit paired information cross two languages, making
it impossible to straightforwardly optimize the supervised
likelihood. Fortunately, motivated by the CycleGAN [31]
and the dual learning in [15], we can actually learn the trans-
lation model for both directions between the source and the
target in an unsupervised way. Additionally, we can even
make the multi-modal and uni-modal inference compatible
with deliberate ﬁne-tuning strategy.

3.4. Auto Encoding Loss

As Figure 2 illustrates, there are ﬁve main modules in the
overall architecture, two encoders and two decoders for the
source and target languages, and one extra image encoder.
Since the lack of triplet data, we can only build the ﬁrst two
following denoised auto-encoding losses without involving
the paired x and y,

Lauto(x, z) = SCE(Decx(Encx(x), Encz(z)), x)
Lauto(y, z) = SCE(Decy(Ency(y), Encz(z)), x)

(5)
where SCE(·,·) represents sequential cross-entropy loss.
We use “denoised” loss here, because the exact auto-
encoding structure will likely force the language model

(4)

432310484

4 x

Controllable 

Multi-modal Attention

ResNet

ResNet

Transformer Encoder

4 x

Feed Forward

Self-Attention

Ke

Ve Qe

Position encoding

Random deletion and permutation

a man in an orange hat starring at something .

 

(
t
o
4
b
3
5
_
R
e
L
U

)

R
e
s
N
e
t
-
1
5
2

R
e
s
h
a
p
e
 
t
o
1
9
6
x
1
0
2
4

 

 

F
e
e
d
F
o
r
w
a
r
d

 

Transformer Decoder

Softmax

Feed Forward

Masked Self-Attention

Kd

Vd Qd

Position encoding

A man in an orange hat ...

Transformer Encoder

Transformer Decoder

Random deletion and permutation

un bébé potelé avec un chapeau …

un bébé potelé avec un chapeau …

Auto-encoding Loss

English Corpus                                           French Corpus

En: A man in an orange  hat

Fr: un bébé potelé avec un chapeau ... 

noise

Transformer

Encoder

Transformer

Decoder

hat

noise

Transformer

Encoder

Transformer

Decoder

chapeau

Cycle-consistency Loss

English Corpus                                           French Corpus

En: A man in an orange  hat

Fr: un bébé potelé avec un chapeau ... 

ResNet

Transformer

Encoder

Transformer

Decoder

Transformer

Encoder

Transformer

Decoder

hat

Transformer

Encoder

Transformer

Decoder

Transformer

Encoder

Transformer

Decoder

chapeau

ResNet

Figure 2: Model overview. Left Panel: The detailed unsupervised multi-modal neural machine translation model includes
ﬁve modules, two transformer encoder, two transformer decoder and one ResNet encoder. Some detailed network struc-
tures within the transformer, like skip-connection and layer normalization, are omitted for clarity. Right Panel: The entire
framework consists of four training paths: the gray arrows in the paths for cycle-consistency loss indicate the model is under
inference mode. E.g., the time step decoding for token “hat” is illustrated.

learning a word-to-word copy network. The image is seem-
ingly redundant since the text input contains the entire in-
formation for recovery. However, it is not guaranteed that
our encoder is lossless, so the image is provided as an addi-
tional supplement to reduce the information loss.

3.5. Cycle Consistency Loss

The auto-encoding loss can, in theory, learn two func-
tional mappings X × I → X and Y × I → Y via the sup-
plied training dataset. However, the two mappings are es-
sentially not our desiderata, even though we can switch the
two decoders to build our expected mappings, e.g., X×I →
Y. The crucial problem is that the transferred mappings
achieved after switching decoders lack supervised training,
since no regularization pushes the latent encoding spaces
aligned between the source and target.

We argue that this issue can be tackled by another two
cycle-consistency properties (note that we use the square
brackets [] below to denote the inference mode, meaning no
gradient back-propagation through such operations),

Decx(Ency(Decy[Encx(x), Encz(z)]), Encz(z)) ≈ x (6)
Decy(Encx(Decx[Ency(y), Encz(z)]), Encz(z)) ≈ y (7)
The above two properties seem complicated, but we will
decompose them step-by-step to see its intuition, which are
also the key to make the auto-encoders translation models

across different languages. Without loss of generality, we
use Property (6) as our illustration, where the same idea is
applied to (7). After encoding the information from source
and image as the high level features, the encoded features
are fed into the decoder of another language (i.e. target lan-
guage), thus obtaining an inferred target sentence,

˜y = Fxz→y(x, z) , Decy[Encx(x), Encz(z)].

(8)

Unfortunately, the ground truth y corresponding to the in-
put x or z is unknown, so we cannot train Fxz→y at this
time. However, since x is the golden reference, we can
construct the pseudo supervised triplet (x, ˜y, z) as the aug-
mented data to train the following model,

Fyz→x(˜y, z) , Decx(Ency(˜y), Encz(z)).

(9)

Note that the pseudo input ˜y can be considered as the cor-
rupted version of the unknown y. The noisy training step
makes sense because injecting noise to the input data is a
common trick to improve the robustness of model even for
traditional supervised learning [25, 28]. Therefore, we in-
centivize this behavior using the cycle-consistency loss,

Lcyc(x, z) = SCE(Fyz→x(Fxz→y(x, z), z), x).

(10)

This loss indicates the cycle-consistency (6), and the map-
ping Y × I → X can be successfully reﬁned.

432410485

3.6. Controllable Attention

In additional to the loss function, another important in-
teraction between the text and image domain should focus
on the decoder attention module. In general, we proposal to
extend the traditional encoder-decoder attention to a multi-
domain attention.

ct = Att(hd

t , he) + λ1Att(hd

t , hi) + λ2Att(hd

t , he, hi)

(11)

where λ1 and λ2 can be either 1 or 0 during training, de-
pending on whether the fetched batch includes image data
or not. For example, we can easily set up a ﬂexible training
scheme by alternatively feeding the monolingual language
data and text-image multimodal data to the model. A nice
byproduct of this setup allows us to successfully make a
versatile inference with or without image, being more ap-
plicable to real scenarios.

In practice, we utilize the recent developed self-attention
mechanism [26] as our basic block, the hidden states con-
tain three sets of vectors Q, K, V , representing queries,
keys and values. Therefore, our proposed context vector
can be rewritten as,

ct = softmax(cid:18) Qd
t (K e)⊤
√d
+ λ2softmax(cid:18) Qd
t (K ei)⊤
√d
t (K ie)⊤
+ λ2softmax(cid:18) Qd
√d

(cid:19) V e + λ1softmax(cid:18) Qd
(cid:19) V ei
(cid:19) V ie

t (K i)⊤
√d (cid:19) V i

(12)

where d is the dimensionality of keys, and [K ei, V ei] =

FFN(cid:16)softmax(cid:16) Qe(K i)⊤
√d

(cid:17) V i(cid:17) means the attention from

text input to image input, and [K ie, V ie] represents the sym-
metric attention in the reverse direction. Note the notation
Qe has no subscript and denotes as a matrix, indicating the
softmax is row-wise operation. In practice, especially for
Multi30K dataset, we found λ2 is less important and λ2 = 0
brings no harm to the performance. Thus, we always set it
as 0 in our experiments, but non-zero λ2 may be helpful in
other cases.

4. Experiments

4.1. Training and Testing on Multi30K

We evaluate our model on Multi30K [12] 2016 test
set of English↔French (En↔Fr) and English↔German
(En↔De) language pairs. This dataset is a multilingual im-
age caption dataset with 29000 training samples of images
and their annotations in English, German, French [11] and
Czech [4]. The validation set and test set have 1014 and
1000 samples respectively. To ensure the model never sees

any paired sentences information (which is an unlikely sce-
nario in practice), we randomly split half of the training and
validation sets for one language and use the complemen-
tary half for the other. The resulting corpora is denoted as
M30k-half with 14500 and 507 training and validation sam-
ples respectively.

To ﬁnd whether the image as additional information used
in the training and/or testing stage can bring consistent per-
formance improvement, we train our model in two different
ways, each one has train with text only (-txt) and train with
text+image (-txt-img) modes. We would compare the best
performing training method to the state-of-the-art, and then
do side-by-side comparison between them:

Pre-large (P): To leverage the controllable attention
mechanism for exploring the linguistic information in the
large monolingual corpora, we create text only pre-training
set by combining the ﬁrst 10 million sentences of the WMT
News Crawl datasets from 2007 to 2017 with 10 times
M30k-half. This ends up in a large text only dataset of
10145000 unparalleled sentences in each language. P-txt:
We would then pre-train our model without the image en-
coder on this dataset and use the M30k-half validation set
for validation. P-txt-img: Once the text-only model is pre-
trained, we then use it for the following ﬁne-tuning stage on
M30k-half. Except for the image encoder, we initialize our
model with the pre-trained model parameters. The image
encoder uses pre-trained ResNet-152 [16]. The error gradi-
ent does not back-propagate to the original ResNet network.
Scratch (S): We are also curious about the role of image
can play when no pre-training is involved. We train from
scratch using text only (S-txt) and text with corresponding
image (S-txt-img) on M30k-half.

4.2. Implementation Details and Baseline Models

The text encoder and decoder are both 4 layers trans-
formers with dimensionality 512, and for the related lan-
guage pair, we share the ﬁrst 3 layers of transformer for
both encoder and decoder. The image encoder is the trun-
cated ResNet-152 with output layer res4b35 relu, and the
parameters of ResNet are freezing during model optimiza-
tion. Particularly, the feature map 14 × 14 × 1024 of layer
res4b35 relu is ﬂattened to 196× 1024 so that its dimension
is consistent with the sequential text encoder output. The
actual losses (4) and (5) favor a standard denoising auto-
encoders: the text input is perturbed with deletion and local
permutation; the image input is corrupted via dropout. We
use the same word preprocessing techniques (Moses tok-
enization, BPE, binarization, fasttext word embedding on
training corpora, etc.) as reported in [20], please refer to the
relevant readings for further details.

We would like to compare the proposed UMNMT model

to the following UMT models.

• MUSE [8]: It is an unsupervised word-to-word transla-

432510486

Models
MUSE
Game-NMT
UNMT-text

S-txt
S-txt-img
P-txt
P-txt-img

En→ Fr

Fr→ En

En→ De De→ En

8.54

-

32.76

6.01
9.40
37.20
39.79

16.77

-

32.07

6.75
10.04
38.51
40.53

15.72
16.6
22.74

6.27
8.85
20.97
23.52

5.39
19.6
26.26

6.81
9.97
25.00
26.39

Table 1: BLEU benchmarking. The numbers of baseline
models are extracted from the corresponding references.

Figure 3: Validation BLEU comparison between text-only
and text+image.

tion model. The embedding matrix is trained on large
scale wiki corpora.

• Game-NMT [7]: It is a multi-modal zero-source UMT

method trained using reinforcement learning.

• UNMT-text [19]:

It is a mono-modal UMT model
which only utilize text data and it is pretrained on syn-
thetic paired data generated by MUSE.

4.3. Benchmarking with state of the art

In this section, we report the widely used BLEU score
of test dataset in Table 1 for different MT models. Our
best model has achieved the state-of-the-art performance
by leading more than 6 points in En→Fr task to the sec-
ond best. Some translation examples are shown in Figure 4.
There is also close to 1 point improvement in the En→De
task. Although pre-training plays a signiﬁcant role to the
ﬁnal performance, the image also contributes more than 3
points in case of training from scratch (S-txt vs. S-txt-img),
and around 2 points in case of ﬁne tuning (P-txt vs. P-txt-
img). Interestingly, it is observed that the image contributes

GT

P-txt

P-txt-img

GT

P-txt

P-txt-img

GT

P-txt

P-txt-img

GT

P-txt

P-txt-img

un homme avec un chapeau orange regardant quelque chose

(a man in an orange hat starring at something)

un homme en orange maettant quelque chose au loin

(a man in orange putting something oﬀ)

un homme en chapeau orange en train de ﬁlmer quelque chose

(a man in an orange hat ﬁlming something)

une femme en t-shirt bleu et short blanc jouant au tennis
(a woman in a blue shirt and white shorts playing tennis)
une femme en t-shirt bleu et short blanc jouant au tennis
(a woman in blue t-shirt and white shorts playing tennis)
une femme en t-shirt bleu et short blanc jouant au tennis
(a woman in blue t-shirt and white shorts playing tennis)

un chien brun ramasse une brindille sur un revˆetement en pierre

(a brown dog picks up a twig from stone surface)

un chien marron retrouve un twig de pierre de la surface

(a brown dog ﬁnds a twig of stone from the surface)

un chien brun acc`ede `a la surface d’ un ´etang
(a brown dog reaches the surface of a pond)

un gar¸con saisit sa jambe tandis il saute en air

(a boy grabs his leg as he jumps in the air)

un gar¸con se met `a sa jambe devant lui

(a boy puts his leg in front of him)

un gar¸con installe sa jambe tandis il saute en air
(a boy installs his leg while he jumps in the air)

Figure 4: Translation results from different models (GT:
ground truth)

less performance improvement for pre-training than train-
ing from scratch. This suggests that there is certain informa-
tion overlap between the large monolingual corpus and the
M30k-half images. We also compare the Meteor, Rouge,
CIDEr score in Table 2 and validation BLEU in Figure 3 to
show the consistent improvement brought by using images.

4.4. Analysis

In this section, we would shed more light on how and
why images can help for unsupervised MT. We would ﬁrst
visualize which part of the input image helps the translation
by showing the heat map of the transformer attention. We
then show that image not only helps the translation by pro-
viding more information in the testing stage, it can also act
as a training regularizer by guiding the model to converge
to a better local optimal point in the training stage.

4.4.1 Attention

To visualize the transformer’s attention from regions in the
input image to each word in the translated sentences, we
use the scaled dot-production attention of the transformer
decoder’s multi-head attention block as shown in Figure 2,

t (K i)T
√d

more speciﬁcally, it is the softmax(cid:0) Qd
(cid:1). This is a ma-
trix of shape lT × lS, where lT is the translated sentence
length and lS is the source length. Since we ﬂatten the
14×14 matrix from the ResNet152, the lS = 196. A heat
map for the jth word in the translation is then generated by
mapping the value of kth entry in {ci[j, k]}196
k=1 to their re-
ceptive ﬁeld in the original image, averaging the value in the
overlapping area and then low pass ﬁltering. Given this heat
map, we would visualize it in two ways: (1) We overlay the
contour of the heat-map with the original image as shown

432610487

Models

Meteor Rouge CIDEr Meteor Rouge CIDEr Meteor Rouge CIDEr Meteor Rouge CIDEr

En→Fr

Fr→En

En→De

De→En

S-txt
S-txt-img
P-txt
P-txt-img

0.137
0.149
0.337
0.355

0.325
0.351
0.652
0.673

0.46
0.65
3.36
3.65

0.131
0.155
0.364
0.372

0.358
0.401
0.689
0.699

0.48
0.75
3.41
3.61

0.116
0.138
0.254
0.261

0.306
0.342
0.539
0.551

0.35
0.59
1.99
2.13

0.128
0.156
0.284
0.297

0.347
0.391
0.585
0.597

0.47
0.70
2.20
2.36

Table 2: UMNMT shows consistent improvement over text-only model across normalized Meteor, Rouge and CIDEr metrics.

Figure 5: Correct attention for {“humme”, “chapeau”, “orange”, “chose”} and {“bleu”, “t-shirt”, “blanc”, “short”}.

in the second, and ﬁfth rows of Figure 5 and the second row
of Figure 6; (2) We normalize the heat map between 0 and
1, and then multiply it with each color channel of the input
image pixel-wise as shown in the third and sixth rows of
Figure 5 and in the third row of Figure 6.

We visualize the text attention by simply plotting the text

attention matrix softmax(cid:0) Qd

t (K e)T
√d

(cid:1) in each transformer de-

coder layer as shown in “Text decoder attention by layers”
in these two ﬁgures.

Figure 5 shows two positive examples that when trans-
former attends to the right regions of the image like “or-
ange”, “chapeau”, or “humme” (interestingly, the nose) in

the upper image or “bleu”, “t-shirt”, “blanc” or “short” in
the lower image. Whereas in Figure 6, transformer attends
to the whole image and treat it as a pond instead of focus-
ing on the region where a twig exists. As a result, the twig
was mistook as pond. More visualization results can see the
detailed version1. For the text attention, we can see the text
heat map becomes more and more diagonal as the decoder
layer goes deeper in both ﬁgures. This indicates the text at-
tention gets more and more focused since the English and
French have similar grammatical rules.

1https://arxiv.org/pdf/1811.11365.pdf

432710488

Figure 6: Correct attention for {“chien”, “brun”, “acc`ede” and “surface”}, but missed “twig” for “´etang”.

Models
S-txt
S-txt-img
P-txt
P-txt-img

En→ Fr

Fr→ En

En→ De De→ En

6.01
7.55
37.20
39.44

6.75
7.66
38.51
40.30

6.27
7.70
20.97
23.18

6.81
7.53
25.00
25.47

Table 3: BLEU for testing with TEXT ONLY input

Models
S-txt
S-txt-img
P-txt
P-txt-img

En→ Fr
13.26 ↑
16.10 ↑
1.19 ↑
5.52 ↑

Fr→ En
11.37 ↑
13.30 ↑
1.70 ↑
2.46 ↑

En→ De De→ En

4.15 ↑
6.40 ↑
1.39 ↑
1.72 ↑

6.14 ↑
7.91 ↑
2.00 ↑
3.12 ↑

Table 4: BLEU INCREASE (↑) UMNMT model trained
on full Multi30k over UMNMT model trained on M30k-
half (Table 1 Row 5-8).

lingual text in the testing stage can be relaxed to feeding the
text-only data if paired image or images are not available.

4.4.3 Uncertainty Reduction

To show that images help MT by aligning different lan-
guages with similar meanings, we also train the UMNMT
model on the whole Multi30K dataset where the source
and target sentences are pretended unparalleled (i.e., still
feed the image text pairs to model). By doing this, we
greatly increase the sentences in different languages of sim-
ilar meanings, if images can help align those sentences, then
the model should be able to learn better than the model
trained with text only. We can see from Table 4 that the per-
formance increase by using images far outstrip the model
trained on text only data, in the case of En→ Fr, the P-txt-
img has more than 4 points gain than the P-txt.

4.4.2 Generalizability

5. Conclusion

As mentioned in the introduction, the model would cer-
tainly get more information when image is present in the
inferencing stage, but can images be helpful if they are used
in the training stage but not readily available during infer-
encing (which is a very likely scenario in practice)? Table
3 shows that even when images are not used, the perfor-
mance degradation are not that signiﬁcant (refer to Row 6-8
in Table 1 for comparison) and the trained with image model
still outperforms the trained with text only model by quite
a margin. This suggests that images can serve as additional
information in the training process, thus guiding the model
to converge to a better local optimal point. Such ﬁndings
also verify the proposed controllable attention mechanism.
This indicates the requirement of paired image and mono-

In this work, we proposed a new unsupervised NMT
model with multi-modal attention (one for text and one for
image) which is trained under an auto-encoding and cycle-
consistency paradigm. Our experiments showed that images
as additional information can signiﬁcantly and consistently
improve the UMT performance. This justiﬁes our hypothe-
sis that the utilization of the multi-modal data can increase
the mutual information between the source sentences and
the translated target sentences. We have also showed that
UMNMT model trained with images can still achieve better
performance than trained with text-only model even if im-
ages are not available in the testing stage. Overall, our work
pushes unsupervised machine translation more applicable
to the real scenario.

432810489

References

[1] Jean-Baptiste Alayrac, Piotr Bojanowski, Nishant Agrawal,
Josef Sivic, Ivan Laptev, and Simon Lacoste-Julien. Unsu-
pervised learning from narrated instruction videos. In Pro-
ceedings of the IEEE Conference on Computer Vision and
Pattern Recognition, pages 4575–4583, 2016.

[2] Mikel Artetxe, Gorka Labaka, Eneko Agirre,

and
Kyunghyun Cho. Unsupervised neural machine translation.
In International Conference on Learning Representations
(ICLR), 2018.

[3] Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Bengio.
Neural machine translation by jointly learning to align and
translate. arXiv preprint arXiv:1409.0473, 2014.

[4] Lo¨ıc Barrault, Fethi Bougares, Lucia Specia, Chiraag Lala,
Desmond Elliott, and Stella Frank. Findings of the third
shared task on multimodal machine translation.
In Pro-
ceedings of the Third Conference on Machine Translation:
Shared Task Papers, pages 304–323, 2018.

[5] Iacer Calixto, Miguel Rios, and Wilker Aziz. Latent vi-
arXiv preprint

sual cues for neural machine translation.
arXiv:1811.00357, 2018.

[6] Necati Cihan Camgoz, Simon Hadﬁeld, Oscar Koller, Her-
mann Ney, and Richard Bowden. Neural sign language trans-
lation. In Proceedings of the IEEE Conference on Computer
Vision and Pattern Recognition, pages 7784–7793, 2018.

[7] Yun Chen, Yang Liu, and Victor OK Li. Zero-resource neural
machine translation with multi-agent communication game.
In Proceedings of the Thirty-Second AAAI Conference on Ar-
tiﬁcial Intelligence, 2018.

[8] Alexis Conneau, Guillaume Lample, Marc’Aurelio Ranzato,
Ludovic Denoyer, and Herv´e J´egou. Word translation with-
out parallel data. In International Conference on Learning
Representations (ICLR), 2018.

[9] Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina
Pre-training of deep bidirectional
arXiv preprint

Toutanova.
transformers for language understanding.
arXiv:1810.04805, 2018.

Bert:

[10] Desmond Elliott, Stella Frank, Lo¨ıc Barrault, Fethi
Bougares, and Lucia Specia. Findings of the second shared
task on multimodal machine translation and multilingual im-
age description. arXiv preprint arXiv:1710.07177, 2017.

[11] Desmond Elliott, Stella Frank, Lo¨ıc Barrault, Fethi
Bougares, and Lucia Specia. Findings of the second shared
task on multimodal machine translation and multilingual im-
age description. In Proceedings of the Second Conference on
Machine Translation, Volume 2: Shared Task Papers, pages
215–233, Copenhagen, Denmark, September 2017. Associ-
ation for Computational Linguistics.

[12] Desmond Elliott, Stella Frank, Khalil Sima’an, and Lucia
Specia. Multi30k: Multilingual english-german image de-
scriptions.
In Proceedings of the 5th Workshop on Vision
and Language, pages 70–74. Association for Computational
Linguistics, 2016.

[13] Kai Fan, Qi Wei, Wenlin Wang, Amit Chakraborty, and
Katherine Heller. Inversenet: Solving inverse problems with
splitting networks. arXiv preprint arXiv:1712.00202, 2017.

[14] Jonas Gehring, Michael Auli, David Grangier, Denis Yarats,
and Yann N Dauphin. Convolutional sequence to sequence
learning. In International Conference on Machine Learning,
pages 1243–1252, 2017.

[15] Di He, Yingce Xia, Tao Qin, Liwei Wang, Nenghai Yu,
Tieyan Liu, and Wei-Ying Ma. Dual learning for machine
translation. In Advances in Neural Information Processing
Systems, pages 820–828, 2016.

[16] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.
Deep residual learning for image recognition. In Proceed-
ings of the IEEE conference on computer vision and pattern
recognition, pages 770–778, 2016.

[17] Andrej Karpathy and Li Fei-Fei. Deep visual-semantic align-
ments for generating image descriptions. In Proceedings of
the IEEE conference on computer vision and pattern recog-
nition, pages 3128–3137, 2015.

[18] Hilde Kuehne, Ali Arslan, and Thomas Serre. The language
of actions: Recovering the syntax and semantics of goal-
directed human activities. In Proceedings of the IEEE con-
ference on computer vision and pattern recognition, pages
780–787, 2014.

[19] Guillaume Lample, Alexis Conneau, Ludovic Denoyer, and
Marc’Aurelio Ranzato. Unsupervised machine translation
using monolingual corpora only. In International Conference
on Learning Representations (ICLR), 2018.

[20] Guillaume Lample, Myle Ott, Alexis Conneau, Ludovic De-
noyer, and Marc’Aurelio Ranzato. Phrase-based & neural
unsupervised machine translation.
In Proceedings of the
2018 Conference on Empirical Methods in Natural Lan-
guage Processing (EMNLP), 2018.

[21] Elman Mansimov, Emilio Parisotto, Jimmy Lei Ba, and Rus-
lan Salakhutdinov. Generating images from captions with
attention. In International Conference on Learning Repre-
sentations (ICLR), 2016.

[22] Hideki Nakayama and Noriki Nishida. Zero-resource ma-
chine translation by multimodal encoder–decoder network
with multimedia pivot. Machine Translation, 31(1-2):49–64,
2017.

[23] Scott Reed, Zeynep Akata, Xinchen Yan, Lajanugen Lo-
geswaran, Bernt Schiele, and Honglak Lee. Generative ad-
versarial text to image synthesis.
In Proceedings of the
33rd International Conference on International Conference
on Machine Learning-Volume 48, pages 1060–1069. JMLR.
org, 2016.

[24] Lucia Specia, Stella Frank, Khalil Sima’an, and Desmond
Elliott. A shared task on multimodal machine translation and
crosslingual image description. In Proceedings of the First
Conference on Machine Translation: Volume 2, Shared Task
Papers, volume 2, pages 543–553, 2016.

[25] Nitish Srivastava, Geoffrey Hinton, Alex Krizhevsky, Ilya
Sutskever, and Ruslan Salakhutdinov. Dropout: a simple way
to prevent neural networks from overﬁtting. The Journal of
Machine Learning Research, 15(1):1929–1958, 2014.

[26] Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszko-
reit, Llion Jones, Aidan N Gomez, Łukasz Kaiser, and Illia
Polosukhin. Attention is all you need. In Advances in Neural
Information Processing Systems, pages 5998–6008, 2017.

432910490

[27] Oriol Vinyals, Alexander Toshev, Samy Bengio, and Du-
mitru Erhan. Show and tell: A neural image caption gen-
erator. In Proceedings of the IEEE conference on computer
vision and pattern recognition, pages 3156–3164, 2015.

[28] Xinyi Wang, Hieu Pham, Zihang Dai, and Graham Neubig.
Switchout: an efﬁcient data augmentation algorithm for neu-
ral machine translation. In Proceedings of the 2018 Confer-
ence on Empirical Methods in Natural Language Processing,
pages 856–861, 2018.

[29] Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V Le,
Mohammad Norouzi, Wolfgang Macherey, Maxim Krikun,
Yuan Cao, Qin Gao, Klaus Macherey, et al. Google’s
neural machine translation system: Bridging the gap be-
tween human and machine translation.
arXiv preprint
arXiv:1609.08144, 2016.

[30] Tao Xu, Pengchuan Zhang, Qiuyuan Huang, Han Zhang,
Zhe Gan, Xiaolei Huang, and Xiaodong He. Attngan: Fine-
grained text to image generation with attentional generative
adversarial networks.
In Proceedings of the IEEE Confer-
ence on Computer Vision and Pattern Recognition, pages
1316–1324, 2018.

[31] Jun-Yan Zhu, Taesung Park, Phillip Isola, and Alexei A
Efros. Unpaired image-to-image translation using cycle-
consistent adversarial networkss.
In Computer Vision
(ICCV), 2017 IEEE International Conference on, 2017.

[32] Yizhe Zhu, Mohamed Elhoseiny, Bingchen Liu, Xi Peng,
and Ahmed Elgammal. A generative adversarial approach
for zero-shot learning from noisy texts.
In Proceedings of
the IEEE conference on computer vision and pattern recog-
nition, pages 1004–1013, 2018.

433010491

